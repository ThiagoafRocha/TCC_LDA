{
    "items": [{
        "tags": [
            "azure",
            "ssl",
            "x509",
            "iot"
        ],
        "is_answered": true,
        "view_count": 5287,
        "favorite_count": 3,
        "score": 6,
        "last_activity_date": 1631110697,
        "creation_date": 1483697831,
        "question_id": 41503468,
        "link": "https://stackoverflow.com/questions/41503468/azure-iot-hub-certificate",
        "title": "Azure IoT Hub Certificate",
        "body": "<p>I'm trying to publish some data on the Azure IoT hub using Mqtt.\nI've succesfully published some data, using a SAS token. </p>\n\n<p>But my customer wants a x509 self generated &amp; self signed certificate.\nAzure is supporting this, but doesn't give much information about it.\n(<a href=\"https://docs.microsoft.com/en-us/azure/iot-hub/iot-hub-devguide-security#supported-x509-certificates\" rel=\"noreferrer\">https://docs.microsoft.com/en-us/azure/iot-hub/iot-hub-devguide-security#supported-x509-certificates</a>)</p>\n\n<blockquote>\n  <p><strong>A self-generated and self-signed X-509 certificate.</strong> A device\n  manufacturer or in-house deployer can generate these certificates and\n  store the corresponding private key (and certificate) on the device.\n  You can use tools such as OpenSSL and Windows SelfSignedCertificate\n  utility for this purpose.</p>\n  \n  <p><strong><em>Note</em></strong>\n  IoT Hub does not require or store the entire X.509 certificate, only\n  the thumbprint.</p>\n</blockquote>\n\n<p>What I've done is created a CA certificate and key.</p>\n\n<pre><code>$openssl req -newkey rsa:2048 -x509 -nodes -sha256 -days 365 -extensions v3_ca -keyout ca.key -out ca.crt\n</code></pre>\n\n<p>Created a client key and signing request </p>\n\n<pre><code>$openssl genrsa -out client.key 2048\n\n$openssl req -new -sha256 -out client.csr -key client.key\n</code></pre>\n\n<p>Signed the request and created the certificate</p>\n\n<pre><code>$openssl x509 -req -sha256 -in client.csr -CA ca.crt -CAkey ca.key -CAcreateserial -CAserial ca.srl -out client.crt -days 365\n</code></pre>\n\n<p>I've uploaded the client key and certificate to the modem.\nAnd inserted the thumbprint of the client certificate.</p>\n\n<p>My modem can succesfully connect to <code>myhub.azure-devices.net/deviceId (port 8883)</code>\nBut when new data arrives it can't decode it.</p>\n\n<p>I'm kinda stuck from this point on. I've tried to use MqttFx, but with no luck. </p>\n\n<p>Can someone push me into the right direction here?</p>\n"
    }, {
        "tags": [
            "php",
            "laravel",
            "amazon-web-services",
            "iot",
            "aws-php-sdk"
        ],
        "is_answered": false,
        "view_count": 84,
        "favorite_count": 0,
        "score": 1,
        "last_activity_date": 1631015476,
        "creation_date": 1630596883,
        "question_id": 69033251,
        "link": "https://stackoverflow.com/questions/69033251/aws-iot-subscribe-with-php-sdk",
        "title": "aws iot subscribe with php sdk?",
        "body": "<p>I've implemented the aws-sdk for php / laravel.\nI am able to publish messages without any issue using the below code, but I can't seem to find anywhere how I can actually subscribe to that topic and see the response received from the IoT device, any help would be greatly appreciated!</p>\n<p>I thought the 'retain message' functions might contain that info, but it only contains the data sent/published, not the response.</p>\n<p>Many Thanks</p>\n<pre><code>        $iot = \\AWS::createClient('iotdataplane');\n        $result = $iot-&gt;publish([\n            'payload' =&gt; $request-&gt;message,\n            'retain' =&gt; false,\n            'qos' =&gt; 1,//1,\n            'topic' =&gt; $request-&gt;topic // REQUIRED\n        ]);\n</code></pre>\n"
    }, {
        "tags": [
            "angular",
            "websocket",
            "mqtt",
            "iot",
            "ws"
        ],
        "is_answered": false,
        "view_count": 276,
        "favorite_count": 0,
        "score": 0,
        "last_activity_date": 1630401091,
        "creation_date": 1609934302,
        "last_edit_date": 1610283174,
        "question_id": 65595363,
        "link": "https://stackoverflow.com/questions/65595363/unable-to-connect-to-test-mosquitto-org-for-testing",
        "title": "Unable to connect to test.mosquitto.org for testing",
        "body": "<p>I am trying to setup a project in Angular where I need to read mqtt packets over WS. I am using ngx-mqtt package for the same.</p>\n<p>Having set up the basic things, I tried listening to the mqtt server set up by <a href=\"https://test.mosquitto.org/\" rel=\"nofollow noreferrer\">test.mosquitto.org</a>. As mentioned in the link, I am trying to listen at port 8080 over WS.</p>\n<p>However, I keep getting the following error:</p>\n<p><a href=\"https://i.stack.imgur.com/P0OQy.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/P0OQy.png\" alt=\"enter image description here\" /></a></p>\n<p>For my angular part, I am following this <a href=\"https://bugfender.com/blog/using-mqtt-on-angular-apps/\" rel=\"nofollow noreferrer\">tutorial</a> and have everything setup exactly same except for port number and server obviously, which I am using as below:</p>\n<pre><code>export const environment = {\n  production: false,\n  mqtt: {\n        server: 'test.mosquitto.org',\n        protocol: &quot;ws&quot;,\n        port: 8080\n    }\n};\n</code></pre>\n<p>Is there a specific path or a specific topic that I should listen to. Can some one give me some more details regarding this test connection.</p>\n<p><strong>Update:</strong></p>\n<p>As suggested by @hardillb in the comments, I tried listening to other port and now I am not getting the attached error. I can see binary data Send/Receive in my WS section of browser's network tab.</p>\n<p>However, as normally expected in an angular application the below subscribe call back is not triggered after the data is received.</p>\n<pre><code>private subscribeToTopic() {\n      this.subscription = this.eventMqtt.topic('testing')\n        .subscribe((data: IMqttMessage) =&gt; {\n          let item = JSON.parse(String.fromCharCode.apply(null, new Uint8Array(data)));\n          this.events.push(item);\n          console.log(this.events);\n      });\n    }\n</code></pre>\n<p>Any suggestions? Do I need to approach this in any other way ? I really haven't worked before with WS, so I might be missing some basics here.</p>\n"
    }, {
        "tags": [
            "postman",
            "mqtt",
            "iot",
            "paho"
        ],
        "is_answered": true,
        "view_count": 60,
        "favorite_count": 0,
        "score": 0,
        "last_activity_date": 1630098065,
        "creation_date": 1629995070,
        "last_edit_date": 1630055144,
        "question_id": 68942193,
        "link": "https://stackoverflow.com/questions/68942193/communicating-with-mqtt-publisher-subscriber-using-an-api",
        "title": "communicating with MQTT publisher / subscriber using an API",
        "body": "<p>I have an MQTT publisher and subscriber written in Node JS.</p>\n<p>I was wondering if it is possible to have it in the form of an API, that we can connect to and publish messages to using PostMan.</p>\n<p>Here is my code for the publisher:</p>\n<p>Publisher.js:</p>\n<pre><code>const mqtt = require('mqtt');\nlet client = mqtt.connect('mqtt://broker.hivemq.com');\n\n\nclient.on('connect', () =&gt;{\n    console.log(`MQTT Client Connected Successfully!`);\n    client.publish('connected', `${true}`);\n});\n</code></pre>\n<p>Here is my code for the Subscriber:\nSubscriber.js:</p>\n<pre><code>const mqtt = require('mqtt');\nlet client = mqtt.connect('mqtt://broker.hivemq.com');\n\nlet connected = false;\n\n\nclient.on('connect', () =&gt;{\n    console.log(`MQTT Client Connected Successfully!`);\n    client.subscribe('connected');\n});\n\n\n\nclient.on('message', (topic, message) =&gt;{\n    if(topic === &quot;connected&quot;){\n      return handleGarageConnected(message);\n    }\n\n    console.log(&quot;No Handler for Topic %s&quot;, topic);\n\n});\n</code></pre>\n<p>I want to be able to communicate with the Publisher / Subscriber over the internet using an API that I create.</p>\n<p>Thank you.</p>\n"
    }, {
        "tags": [
            "websocket",
            "mqtt",
            "iot",
            "mosquitto",
            "aedes"
        ],
        "is_answered": false,
        "view_count": 24,
        "favorite_count": 0,
        "score": 0,
        "last_activity_date": 1629910268,
        "creation_date": 1629909826,
        "last_edit_date": 1629910268,
        "question_id": 68926867,
        "link": "https://stackoverflow.com/questions/68926867/extending-mosquitto-broker-in-c-c-java",
        "title": "Extending Mosquitto broker in C / C++ / Java",
        "body": "<p>I created a broker using Aedes (previously MoscaJS) for my IoT project in Node JS.</p>\n<p>I was wondering if there is a similar library available in C / C++ / Java to create a broker.</p>\n<p>I know there is Mosquitto library, but are there any resources available to create a custom broker using Mosquitto in C / C++ / Java.</p>\n<p><strong>Or should we just use the Mosquitto broker as it is in our projects.</strong></p>\n<p>Thanks in advance.</p>\n"
    }, {
        "tags": [
            "mqtt",
            "amazon-iam",
            "iot",
            "aws-iot"
        ],
        "is_answered": false,
        "view_count": 31,
        "favorite_count": 0,
        "score": 0,
        "last_activity_date": 1627053222,
        "creation_date": 1626914083,
        "last_edit_date": 1626914523,
        "question_id": 68477882,
        "link": "https://stackoverflow.com/questions/68477882/disable-aws-iot-wildcard-usage",
        "title": "Disable AWS IoT * Wildcard Usage",
        "body": "<p>Been working with AWS IoT for a few weeks now and it's pretty sick! It's very easy to connect and subscribe to MQTT topics with a single <code>iot:ClientId</code>. I like the fact that you can connect with a <code>iot:ClientId</code> and create IAM policies to stop users from subscribing to topics that don't include the <code>iot:ClientId</code> they used to connect.\nI have security concerns with a single feature of IoT...... The use of the <code>*</code> wildcard. Hackers could easily connect to the IoT core cloud with <code>*</code> as their <code>iot:ClientId</code>. This would then allow them to subscribe to any topic regardless of <code>iot:ClientId</code>. I am wondering if there are IAM policies I could create to stop developers from using the <code>*</code> wildcard in place of their <code>iot:ClientId</code>. I am looking for a solution that doesn't include defining static <code>iot:ClientId</code> in my IAM policy. I'm not sure why I can't find any actual examples of a solution for this problem as I'm sure there are a lot of people that hate the IoT wildcard system. Anyway, hoping for a solution that contains a zip tight IAM policy JSON example for <code>iot:Connect</code>. This is what I have so far:</p>\n<pre><code>...\n              - Effect: Allow\n                Action:\n                  - &quot;iot:Connect&quot;\n                Resource: \n                  - !Sub arn:aws:iot:${AWS::Region}:${AWS::AccountId}:client/${!iot:ClientId}\n...\n</code></pre>\n"
    }, {
        "tags": [
            "google-cloud-platform",
            "mqtt",
            "iot",
            "paho",
            "google-cloud-iot"
        ],
        "is_answered": true,
        "view_count": 2867,
        "favorite_count": 2,
        "score": 2,
        "last_activity_date": 1626290585,
        "creation_date": 1524079393,
        "last_edit_date": 1529270745,
        "question_id": 49907529,
        "link": "https://stackoverflow.com/questions/49907529/google-cloud-iot-invalid-mqtt-publish-topic",
        "title": "Google Cloud IoT - Invalid MQTT publish topic",
        "body": "<p>I am using a Python client with paho-mqtt to publish in this specific topic of Google Cloud IoT: <code>projects/my_project/topics/sm1</code>. My code is below, based on examples of the Google IoT documentation:</p>\n\n<pre class=\"lang-py prettyprint-override\"><code>import paho.mqtt.client as mqtt\nimport ssl, random, jwt_maker\nfrom time import sleep\n\nroot_ca = './../roots.pem'\npublic_crt = './../my_cert.pem'\nprivate_key = './../my_pr.pem'\n\nmqtt_url = \"mqtt.googleapis.com\"\nmqtt_port = 8883\nmqtt_topic = \"/projects/my_project/topics/sm1\"\nproject_id   = \"my_project\"\ncloud_region = \"us-central1\"\nregistry_id  = \"sm1\"\ndevice_id    = \"sm1\"\n\nconnflag = False\n\ndef error_str(rc):\n    \"\"\"Convert a Paho error to a human readable string.\"\"\"\n    return \"Some error occurred. {}: {}\".format(rc, mqtt.error_string(rc))\n\ndef on_disconnect(unused_client, unused_userdata, rc):\n    \"\"\"Paho callback for when a device disconnects.\"\"\"\n    print(\"on_disconnect\", error_str(rc))\n\ndef on_connect(client, userdata, flags, response_code):\n    global connflag\n    connflag = True\n    print(\"Connected with status: {0}\".format(response_code))\n\ndef on_publish(client, userdata, mid):\n    print(\"User data: {0} -- mid: {1}\".format(userdata, mid))\n    #client.disconnect()\n\nif __name__ == \"__main__\":\n\n    client = mqtt.Client(\"projects/{}/locations/{}/registries/{}/devices/{}\".format(\n                         project_id,\n                         cloud_region,\n                         registry_id,\n                         device_id))\n\n    client.username_pw_set(username='unused',\n                           password=jwt_maker.create_jwt(project_id,\n                                               private_key,\n                                               algorithm=\"RS256\"))\n\n    client.tls_set(root_ca,\n                   certfile = public_crt,\n                   keyfile = private_key,\n                   cert_reqs = ssl.CERT_REQUIRED,\n                   tls_version = ssl.PROTOCOL_TLSv1_2,\n                   ciphers = None)\n\n    client.on_connect = on_connect\n    client.on_publish = on_publish\n    client.on_disconnect = on_disconnect\n\n    print(\"Connecting to Google IoT Broker...\")\n    client.connect(mqtt_url, mqtt_port, keepalive=60)\n    client.loop_start() \n\n    while True:\n        sleep(0.5)\n        print connflag\n        if connflag == True:\n            print(\"Publishing...\")\n            ap_measurement = random.uniform(25.0, 150.0)\n            #payload = \"sm1/sm1-payload-{}\".format(ap_measurement)\n            res = client.publish(mqtt_topic, ap_measurement, qos=1)\n            if not res.is_published():\n               print(\"Data not published!!\")\n            else:\n               print(\"ActivePower published: %.2f\" % ap_measurement)\n        else:\n            print(\"Waiting for connection...\")\n</code></pre>\n\n<p>When I run, the client connect but does not publish. At Google IoT Console, I can see the following error message:</p>\n\n<blockquote>\n  <p>Invalid MQTT publish topic: projects/my_project/topics/sm1</p>\n</blockquote>\n\n<p>And here is the output:</p>\n\n<blockquote>\n  <p>Connecting to Google IoT Broker...<br>\n  Connected with status: 0  --  msg: Connection Accepted.<br>\n  True<br>\n  Publishing...<br>\n  Data not published!!<br>\n  ('on_disconnect', 'Some error occurred. 1: Out of memory.')</p>\n</blockquote>\n\n<p>It is really strange, because the topic is there, created, and have a subscription associated to it!</p>\n\n<p>Any help will be appreciated. I already read the following documentation and code:</p>\n\n<ul>\n<li><a href=\"https://cloud.google.com/iot/docs/how-tos/mqtt-bridge#iot-core-mqtt-auth-run-python\" rel=\"nofollow noreferrer\">https://cloud.google.com/iot/docs/how-tos/mqtt-bridge#iot-core-mqtt-auth-run-python</a></li>\n<li><a href=\"https://github.com/GoogleCloudPlatform/python-docs-samples/blob/master/iot/api-client/mqtt_example/cloudiot_mqtt_example.py\" rel=\"nofollow noreferrer\">https://github.com/GoogleCloudPlatform/python-docs-samples/blob/master/iot/api-client/mqtt_example/cloudiot_mqtt_example.py</a></li>\n</ul>\n"
    }, {
        "tags": [
            "mqtt",
            "iot",
            "mosquitto",
            "tasmota"
        ],
        "is_answered": true,
        "view_count": 25,
        "favorite_count": 0,
        "score": -1,
        "last_activity_date": 1626290318,
        "creation_date": 1626254586,
        "question_id": 68375382,
        "link": "https://stackoverflow.com/questions/68375382/sonoff-rf-bridge-to-mosquitto-on-windows-configuration",
        "title": "Sonoff RF Bridge to Mosquitto (on Windows) Configuration",
        "body": "<p>I've been searching high and low for a simple explanation for this. What configuration settings do I use to connect my Sonoff RF bridge to the Mosquitto server on my computer? I'm sure it's a configuration issue but most of the tutorials out there are for rPi. My skill level in this is basic and I'm sure it may be obvious to someone what's wrong.</p>\n<p>I'm running Mosquitto on Windows 10 and have verified that the Mosquitto server is running using netstat -a (I can see the broker is listening at 0.0.0.0:1883.</p>\n<p>I've installed Tasmota Eclipse on my Sonoff RF Bridge and have verified it is receiving signal from my door sensor by opening the UI in my browser and viewing the console.   I've tried multiple host addresses in the configuration menu; localhost, 0.0.0.0, 10.0.0.1, however Tasmota only seems to connect when I leave the host field blank.</p>\n<p>I've tried to use MQTTlens to verify that the broker is receiving messages on port 1883 and nothing seems to be coming through.</p>\n<p><a href=\"https://i.stack.imgur.com/xiV49.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/xiV49.jpg\" alt=\"Photo of Tasmota Configuration\" /></a>\n<a href=\"https://i.stack.imgur.com/wIM7t.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/wIM7t.png\" alt=\"Photo of MQTTLense Configuration\" /></a></p>\n"
    }, {
        "tags": [
            "amazon-web-services",
            "amazon-iam",
            "iot"
        ],
        "is_answered": false,
        "view_count": 32,
        "favorite_count": 0,
        "score": 0,
        "last_activity_date": 1626277854,
        "creation_date": 1626277854,
        "question_id": 68381284,
        "link": "https://stackoverflow.com/questions/68381284/sts-assumerole-getting-undefined-credentials",
        "title": "sts.assumeRole getting undefined credentials",
        "body": "<p>I have a role called awsiotsdk that has full access to iot. I'm trying to get temporary credentials for Connect, Subscribe, and Receive, but my credentials are undefined. What could be the reason for this?</p>\n<pre><code>var AWS = require(&quot;aws-sdk&quot;);\nvar sts = new AWS.STS({ apiVersion: &quot;2011-06-15&quot; });\n\nconst iotpolicy = `{\n    &quot;Version&quot;: &quot;2012-10-17&quot;,\n    &quot;Statement&quot;: [\n        {\n            &quot;Sid&quot;: &quot;VisualStudioCode&quot;,\n            &quot;Effect&quot;: &quot;Allow&quot;,\n            &quot;Action&quot;: [\n                &quot;iot:Connect&quot;,\n                &quot;iot:Subscribe&quot;,\n                &quot;iot:Receive&quot;\n            ],\n            &quot;Resource&quot;: &quot;*&quot;\n        }\n    ]\n}`;\n\nconst role = {\n  RoleArn: &quot;arn:aws:iam::258030452305:role/awsiotsdk&quot;,\n  Policy: iotpolicy,\n  RoleSessionName: &quot;RoleSession1&quot;,\n};\n\nsts.assumeRole(role, (err, data) =&gt; {\n  console.log({\n    accessKeyId: data.Credentials.accessKeyId,\n    secretAcessKey: data.Credentials.secretAccessKey,\n    sessionToken: data.Credentials.sessionToken,\n  });\n});\n</code></pre>\n<p>Output:</p>\n<pre><code>{\n  accessKeyId: undefined,\n  secretAcessKey: undefined,\n  sessionToken: undefined\n}\n</code></pre>\n"
    }, {
        "tags": [
            "python",
            "amazon-web-services",
            "boto3",
            "iot"
        ],
        "is_answered": true,
        "view_count": 64,
        "favorite_count": 0,
        "score": 1,
        "last_activity_date": 1626222979,
        "creation_date": 1623889135,
        "last_edit_date": 1626222557,
        "question_id": 68011428,
        "link": "https://stackoverflow.com/questions/68011428/aws-mqtt-python-awsiotsdk-and-awscrt-packages-fail-sporadically-with-repeating-m",
        "title": "AWS MQTT Python awsiotsdk and awscrt packages fail sporadically with repeating messages in trace logs",
        "body": "<p>I'm following reasonably close to the <a href=\"https://github.com/aws/aws-iot-device-sdk-python-v2/blob/main/samples/pubsub.py\" rel=\"nofollow noreferrer\">pub/sub example</a> in the awsiotsdk package. My basic unittests sometimes succeed and sometimes fail.</p>\n<p>I enabled trace logging with <code>awscrt.io.init_logging(6, 'stderr')</code></p>\n<p>When I look through the trace logs they look relatively similar up to this line:</p>\n<pre><code>[TRACE] [2021-06-16T23:56:36Z] [00007f5fcfbbc640] [mqtt-topic-tree] - tree=0x5565ac073898: Publishing on topic test/unittest\n</code></pre>\n<p>After that point a run that failed starts producing the following output in a loop until my unittest times out after 30 seconds:</p>\n<pre><code>[DEBUG] [2021-06-16T23:52:26Z] [00007fd7ab15b640] [dns] - static: resolving host #############-ats.iot.us-west-2.amazonaws.com\n[DEBUG] [2021-06-16T23:52:26Z] [00007fd7ab15b640] [dns] - static: resolved record: 34.213.168.191\n[DEBUG] [2021-06-16T23:52:26Z] [00007fd7ab15b640] [dns] - static: resolved record: 52.35.137.184\n[DEBUG] [2021-06-16T23:52:26Z] [00007fd7ab15b640] [dns] - static: resolved record: 54.148.88.142\n[DEBUG] [2021-06-16T23:52:26Z] [00007fd7ab15b640] [dns] - static: resolved record: 34.214.249.117\n[DEBUG] [2021-06-16T23:52:26Z] [00007fd7ab15b640] [dns] - static: resolved record: 54.186.43.162\n[DEBUG] [2021-06-16T23:52:26Z] [00007fd7ab15b640] [dns] - static: resolved record: 52.38.221.226\n[DEBUG] [2021-06-16T23:52:26Z] [00007fd7ab15b640] [dns] - static: resolved record: 54.244.33.231\n[DEBUG] [2021-06-16T23:52:26Z] [00007fd7ab15b640] [dns] - static: resolved record: 34.218.88.107\n[DEBUG] [2021-06-16T23:52:26Z] [00007fd7ab15b640] [dns] - static: resolved record: 2620:108:700f::23a6:36ae\n[DEBUG] [2021-06-16T23:52:26Z] [00007fd7ab15b640] [dns] - static: resolved record: 2620:108:700f::3424:419e\n[DEBUG] [2021-06-16T23:52:26Z] [00007fd7ab15b640] [dns] - static: resolved record: 2620:108:700f::22d2:b01f\n[DEBUG] [2021-06-16T23:52:26Z] [00007fd7ab15b640] [dns] - static: resolved record: 2620:108:700f::22d7:fa17\n[DEBUG] [2021-06-16T23:52:26Z] [00007fd7ab15b640] [dns] - static: resolved record: 2620:108:700f::6415:4c4c\n[DEBUG] [2021-06-16T23:52:26Z] [00007fd7ab15b640] [dns] - static: resolved record: 2620:108:700f::2351:30a6\n[DEBUG] [2021-06-16T23:52:26Z] [00007fd7ab15b640] [dns] - static: resolved record: 2620:108:700f::3421:1d4e\n[DEBUG] [2021-06-16T23:52:26Z] [00007fd7ab15b640] [dns] - static: resolved record: 2620:108:700f::342b:929\n[DEBUG] [2021-06-16T23:52:26Z] [00007fd7ab15b640] [dns] - static, resolving host #############-ats.iot.us-west-2.amazonaws.com successful, returned 16 addresses\n[TRACE] [2021-06-16T23:52:26Z] [00007fd7ab15b640] [dns] - static: updating expiry for 34.213.168.191 for host #############-ats.iot.us-west-2.amazonaws.com to 1623887576445112777\n[TRACE] [2021-06-16T23:52:26Z] [00007fd7ab15b640] [dns] - static: updating expiry for 52.35.137.184 for host #############-ats.iot.us-west-2.amazonaws.com to 1623887576445112777\n[TRACE] [2021-06-16T23:52:26Z] [00007fd7ab15b640] [dns] - static: updating expiry for 54.148.88.142 for host #############-ats.iot.us-west-2.amazonaws.com to 1623887576445112777\n[TRACE] [2021-06-16T23:52:26Z] [00007fd7ab15b640] [dns] - static: updating expiry for 34.214.249.117 for host #############-ats.iot.us-west-2.amazonaws.com to 1623887576445112777\n[TRACE] [2021-06-16T23:52:26Z] [00007fd7ab15b640] [dns] - static: updating expiry for 54.186.43.162 for host #############-ats.iot.us-west-2.amazonaws.com to 1623887576445112777\n[TRACE] [2021-06-16T23:52:26Z] [00007fd7ab15b640] [dns] - static: updating expiry for 52.38.221.226 for host #############-ats.iot.us-west-2.amazonaws.com to 1623887576445112777\n[TRACE] [2021-06-16T23:52:26Z] [00007fd7ab15b640] [dns] - static: updating expiry for 54.244.33.231 for host #############-ats.iot.us-west-2.amazonaws.com to 1623887576445112777\n[TRACE] [2021-06-16T23:52:26Z] [00007fd7ab15b640] [dns] - static: updating expiry for 34.218.88.107 for host #############-ats.iot.us-west-2.amazonaws.com to 1623887576445112777\n[TRACE] [2021-06-16T23:52:26Z] [00007fd7ab15b640] [dns] - static: updating expiry for 2620:108:700f::23a6:36ae for host #############-ats.iot.us-west-2.amazonaws.com to 1623887576445112777\n[TRACE] [2021-06-16T23:52:26Z] [00007fd7ab15b640] [dns] - static: updating expiry for 2620:108:700f::3424:419e for host #############-ats.iot.us-west-2.amazonaws.com to 1623887576445112777\n[TRACE] [2021-06-16T23:52:26Z] [00007fd7ab15b640] [dns] - static: updating expiry for 2620:108:700f::22d2:b01f for host #############-ats.iot.us-west-2.amazonaws.com to 1623887576445112777\n[TRACE] [2021-06-16T23:52:26Z] [00007fd7ab15b640] [dns] - static: updating expiry for 2620:108:700f::22d7:fa17 for host #############-ats.iot.us-west-2.amazonaws.com to 1623887576445112777\n[TRACE] [2021-06-16T23:52:26Z] [00007fd7ab15b640] [dns] - static: updating expiry for 2620:108:700f::6415:4c4c for host #############-ats.iot.us-west-2.amazonaws.com to 1623887576445112777\n[TRACE] [2021-06-16T23:52:26Z] [00007fd7ab15b640] [dns] - static: updating expiry for 2620:108:700f::2351:30a6 for host #############-ats.iot.us-west-2.amazonaws.com to 1623887576445112777\n[TRACE] [2021-06-16T23:52:26Z] [00007fd7ab15b640] [dns] - static: updating expiry for 2620:108:700f::3421:1d4e for host #############-ats.iot.us-west-2.amazonaws.com to 1623887576445112777\n[TRACE] [2021-06-16T23:52:26Z] [00007fd7ab15b640] [dns] - static: updating expiry for 2620:108:700f::342b:929 for host #############-ats.iot.us-west-2.amazonaws.com to 1623887576445112777\n[TRACE] [2021-06-16T23:52:26Z] [00007fd7ab15b640] [dns] - static: remaining record count for host 7\n[TRACE] [2021-06-16T23:52:26Z] [00007fd7ab15b640] [dns] - static: remaining record count for host 8\n</code></pre>\n<p>A run that succeeded continues on from the <code>Publishing on topic test/unittest</code> message with:</p>\n<pre><code>[TRACE] [2021-06-16T23:56:36Z] [00007f5fcfbbc640] [mqtt-client] - id=0x5565ac073640: publish received with msg id=1 dup=0 qos=1 retain=0 payload-size=16 topic=test/unittest\n[TRACE] [2021-06-16T23:56:36Z] [00007f5fcfbbc640] [mqtt-client] - id=0x5565ac073640: received publish QOS is 1, sending puback\n&lt;&lt;&lt;output continues until normal termination&gt;&gt;&gt;\n</code></pre>\n<p>Versions:</p>\n<pre><code>  boto3==1.17.96\n  awscrt==0.11.22\n  awsiotsdk==1.6.0\n</code></pre>\n<p>I created my mqtt connection using:</p>\n<pre><code>mqtt_connection_builder.websockets_with_default_aws_signing(\n                    endpoint='#############-ats.iot.us-west-2.amazonaws.com',\n                    client_bootstrap=client_bootstrap,\n                    region=AWS_REGION,\n                    credentials_provider=credentials_provider,\n                    ca_filepath=f'{self.certs_temp_dir.name}/AmazonRootCA1.pem',\n                    on_connection_interrupted=self._on_connection_interrupted,\n                    on_connection_resumed=self._on_connection_resumed,\n                    client_id=f'test-{uuid.uuid4()}',\n                    clean_session=False,\n                    keep_alive_secs=6\n                )\n</code></pre>\n"
    }, {
        "tags": [
            "arduino",
            "iot",
            "lora",
            "lorawan"
        ],
        "is_answered": true,
        "view_count": 59,
        "favorite_count": 0,
        "score": 0,
        "last_activity_date": 1625954571,
        "creation_date": 1605106275,
        "last_edit_date": 1605211412,
        "question_id": 64788703,
        "link": "https://stackoverflow.com/questions/64788703/how-to-send-a-message-from-end-device-to-multiple-application-server-in-lorawan",
        "title": "How to send a message from end device to multiple Application server in loRaWAN?",
        "body": "<p>I am trying to understand in LoRaWAN, how can send a message from an end-device to more than one Application server? Do messages reach the application servers by addressing AppEUI? If so, can we set more than one APPEUI as destination for LoRa end-device?</p>\n"
    }, {
        "tags": [
            "amazon-web-services",
            "mqtt",
            "iot"
        ],
        "is_answered": false,
        "view_count": 10,
        "favorite_count": 0,
        "score": 0,
        "last_activity_date": 1625692670,
        "creation_date": 1625692670,
        "question_id": 68293086,
        "link": "https://stackoverflow.com/questions/68293086/aws-mqtt-topics-where-saved-to",
        "title": "AWS MQTT Topics - where saved to",
        "body": "<p>Im using AWS MQTT to subscribe to a topic, but I am just wondering where do these topics save to?\nAs I know if a topic doesn't exist that it is automatically created then</p>\n"
    }, {
        "tags": [
            "mqtt",
            "iot",
            "mosquitto"
        ],
        "is_answered": true,
        "view_count": 50,
        "favorite_count": 0,
        "score": 0,
        "last_activity_date": 1625484341,
        "creation_date": 1625323155,
        "last_edit_date": 1625484341,
        "question_id": 68237217,
        "link": "https://stackoverflow.com/questions/68237217/how-can-i-understand-which-version-my-mosquitto-broker-uses-of-mqtt",
        "title": "How can I understand which version my Mosquitto Broker uses of MQTT?",
        "body": "<p>I'm a beginner in MQTT, and I'm trying to use Eclipse Mosquitto's broker. I know it has a support for MQTT v5.0 but I can't figure out which version I use while publishing/receiving messages. I want to use MQTT 5.0.</p>\n<p>How can I understand which version my Mosquitto Broker uses of MQTT?</p>\n"
    }, {
        "tags": [
            "ibm-cloud",
            "mqtt",
            "iot",
            "node-red"
        ],
        "is_answered": true,
        "view_count": 348,
        "favorite_count": 0,
        "score": 2,
        "last_activity_date": 1624686513,
        "creation_date": 1442859786,
        "question_id": 32702099,
        "link": "https://stackoverflow.com/questions/32702099/do-node-red-applications-using-bluemix-iot-foundation-require-separate-topics-fo",
        "title": "Do Node-RED applications using Bluemix IoT Foundation require separate topics for devices and applications?",
        "body": "<p>For a Node-RED application, I am using MQTT to talk with the device. Do I need to use two \"topics\"?:</p>\n\n<ul>\n<li>One topic for the device to publish information to be subscribed by the Node-Red application.</li>\n<li>One topic for the Node-RED application to publish (and the device to subscribe to).</li>\n</ul>\n\n<p>Alternatively, can both the device and Node-RED application post different information (both publishing and subscribing) to the same topic? </p>\n\n<p>For example: If the device is both publishing temperature data and also subscribing to the same topic to get information from Node-RED in Bluemix, will that cause issues?  There are two types of data I want to exchange:</p>\n\n<ul>\n<li>The Device would be publishing temperatures.</li>\n<li>The Node-RED application would be publishing \"user request\" information that would tell the device when to report temperatures.</li>\n</ul>\n"
    }, {
        "tags": [
            "amazon-web-services",
            "mqtt",
            "iot"
        ],
        "is_answered": false,
        "view_count": 535,
        "favorite_count": 0,
        "score": -1,
        "last_activity_date": 1624618913,
        "creation_date": 1528404345,
        "question_id": 50749920,
        "link": "https://stackoverflow.com/questions/50749920/where-is-aws-iot-mqtt-topic",
        "title": "Where is AWS IOT MQTT Topic",
        "body": "<p>I have a question in context of the previous question asked on this URL (<a href=\"https://stackoverflow.com/questions/46766686/dynamically-create-aws-iot-topic/50748904#50748904\">Dynamically create AWS IoT topic</a>).... I understand that AWS IoT (MQTT) creates topic automatically, if it doesn't exist. But where will I be able to see all existing MQTT topics created by AWS IOT? These topics are not showing up under list of SNS topics? I'm using AWS IoT SDK for Python and created a topic named 'Temperature' through my python script and posted some message on it. My subscriber program is able to get messages from Temperature topic but I'm not able to see this Temperature topic in AWS console, not even in SNS topic list. \nAlso, is AWS SNS Topic is same as AWS IoT MQTT topic?\nThanks</p>\n"
    }, {
        "tags": [
            "python",
            "linux",
            "google-cloud-platform",
            "iot",
            "google-cloud-pubsub"
        ],
        "is_answered": true,
        "view_count": 70,
        "favorite_count": 0,
        "score": 0,
        "last_activity_date": 1623859207,
        "creation_date": 1623744123,
        "last_edit_date": 1623858745,
        "question_id": 67982319,
        "link": "https://stackoverflow.com/questions/67982319/python-application-using-google-pubsub-getting-killed-by-linux-kernel-out-of-me",
        "title": "Python application using google pubsub getting killed by linux kernel, Out of memory",
        "body": "<p>I am using pub/sub to publish logs from an IoT device to the cloud, where they're stored in cloud logging by a cloud function. This had been working fine, but now I am running into issues where the messages are not being delivered and eventually the application gets killed. This is the error message:</p>\n<pre><code>google.api_core.exceptions.RetryError: Deadline of 60.0s exceeded while calling functools.partial(&lt;function _wrap_unary_errors.&lt;locals&gt;.error_remapped_callable at 0x7487bd20&gt;, topic: &quot;projects/projectid/topics/iot_device_logs&quot;\nmessages {\n  data: &quot;20210612T04:09:22.116Z - ERROR - Failed to create objects on main &quot;\n  attributes {\n    key: &quot;device_num_id&quot;\n    value: &quot;devincenumid&quot;\n  }\n  attributes {\n    key: &quot;logger_name&quot;\n    value: &quot;iotXX&quot;\n  }\n}\n, metadata=[('x-goog-request-params', 'topic=projects/projectid/topics/iot_device_logs'), ('x-goog-api-client', 'gl-python/3.7.3 grpc/1.33.2 gax/1.23.0 gccl/2.5.0')]), last exception: 503 Transport closed\n20210612T04:21:08.211Z - INFO - QueryDevice object created\n20210612T04:38:30.880Z - DEBUG - Analyzer failure counts\n20210612T04:42:40.760Z - INFO - Attempting to query device \n20210612T04:48:05.126Z - DEBUG - Attempting to publish 'info' log on iotXX\nbash: line 1:   609 Killed                  python3.7 path/to/file.py\n</code></pre>\n<p>The code in question is something like this:</p>\n<pre><code>def get_callback(self, f, log):\n        def callback(f):\n            try:\n                self.debug(f&quot;Successfully published log: {f.result()}&quot;)\n            except Exception as e:\n                self.debug(f&quot;Failed to publish log: {e}&quot;)\n\n        return callback\n\n    def publish_log(self, log, severity):\n        # data must be in bytestring\n        data = log.encode(&quot;utf-8&quot;)\n\n        try:\n            self.debug(f&quot;Attempting to publish '{severity}' log on {self.name}&quot;)\n            # add two attributes to distinguish the log once in the cloud\n            future = PUBLISHER.publish(\n                TOPIC_PATH, data=data, logger_name=self.name, device_num_id=self.deviceid)\n            futures[log] = future  \n            # publish failures shall be handled in the callback function\n            future.add_done_callback(self.get_callback(future, log))\n\n        except Exception as e:\n            self.debug(f&quot;Error on publish_log: {e}&quot;)\n</code></pre>\n<p>I believe this is happening during a connection outage, which I can understand it might not be able to send the messages. However, I don't understand why the application is being killed.</p>\n<p>So far, I am trying to change the retry settings to see if it improves. But I am concerned that the application will continue to get killed.</p>\n<p>Any idea on how to determine why it is being killed instead of simply failing to send and continue on?</p>\n"
    }, {
        "tags": [
            "websocket",
            "server",
            "iot",
            "esp8266",
            "stm32f0"
        ],
        "is_answered": false,
        "view_count": 180,
        "favorite_count": 1,
        "score": 0,
        "last_activity_date": 1621760968,
        "creation_date": 1621405229,
        "last_edit_date": 1621760968,
        "question_id": 67597912,
        "link": "https://stackoverflow.com/questions/67597912/stm32-esp8266-websocket-client-get-http-1-1-400-bad-request-from-server",
        "title": "STM32 + ESP8266 Websocket Client get HTTP/1.1 400 Bad Request from server",
        "body": "<p>I'm working on a small IoT project on STM32F070 Micro controller interfaced with ESP8266 Wifi module. I have developed a Websocket client application on STM32F070 controller which will communicate to remote Websocket Server and will Exchange data over connection.</p>\n<p>I make TCP connection with Server from Websocket Client but after sending Websocket request Headers, I'm receiving HTTP/1.1 400 Bad Request from server and connection gets CLOSED.</p>\n<p>Here are logs from ESP8266 UART line:</p>\n<pre><code>ready\nWIFI CONNECTED\nWIFI GOT IP\nAT\n\nOK\nATE0\n\nOK\n\nOK\nWIFI DISCONNECT\nWIFI CONNECTED\nWIFI GOT IP\n\nOK\n+CIFSR:STAIP,&quot;192.168.43.194&quot;\n+CIFSR:STAMAC,&quot;48:3f:da:66:cf:2c&quot;\n\nOK\n\nOK\n\nERROR\nCLOSED\n\nERROR\nCLOSED\nCONNECT\n\nOK\n\nOK\n&gt;\nRecv 227 bytes\n\nSEND OK\n\n+IPD,103:HTTP/1.1 400 Bad Request\nConnection: close\nContent-Type: text/html\nContent-Length: 11\n\nBad RequestCLOSED\n</code></pre>\n<p>Here are the headers I'm sending to Remote Websocket server</p>\n<pre><code>AT+RST\nAT\nATE0\nAT+CWMODE=1\nAT+CWJAP=&quot;Txxxxx&quot;,&quot;08080808&quot;\nAT+CIFSR\nAT+CIPMUX=0\nAT+CIPSTART=&quot;TCP&quot;,&quot;192.168.43.69&quot;,8080\nAT+CIPSEND=227\nGET / HTTP/1.1\nHost: 192.168.43.69:8080\nConnection: Upgrade\nUpgrade: websocket\nSec-WebSocket-Version: 13\nSec-WebSocket-Key: NhEEf0jUzTLT3ZC2jSW1PnsX\nSec-WebSocket-Extensions: permessage-deflate; client_max_window_bits\n</code></pre>\n<p>EDIT: STM32F070 Source Code to send Websocket Headers to server over ESP8266</p>\n<pre><code>    // 1) Generating WebSocket Header:\n\n//Generate a random key.\nBase64_GetRandomKey( webSock.LocalKey );\n\n//Reset the flag so we can check in response.\nwebSock.ServerKeyOK = 0;\n\n//Host IP:\nip3 = ( dev.NetServerIP_Addr &gt;&gt; 24 ) &amp; 0xFF;\nip2 = ( dev.NetServerIP_Addr &gt;&gt; 16 ) &amp; 0xFF;\nip1 = ( dev.NetServerIP_Addr &gt;&gt; 8 ) &amp; 0xFF;\nip0 = ( dev.NetServerIP_Addr ) &amp; 0xFF;\n\n//Make the HTML headers.\nlen += snprintf( &amp;buf[len], HTTP_BUFFER_LEN_MAX - len, ( HTTP_PAGE_QUERY_REM_SRV_GET_HDR ), ip3, ip2, ip1, ip0, dev.NetServerPort );\n\nlen += snprintf( &amp;buf[len], HTTP_BUFFER_LEN_MAX - len, ( HTTP_PAGE_QUERY_REM_SRV_GET_BODY ), webSock.LocalKey );\n\n////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n// 2) Send Data Header to ESP8266, send Data Length with AT+CIPSEND AT Command\n\n//Send the IP data header during data send.\nstatic void ESP8266_SendDataHeader( ESP_Con *connection )\n{\n    char buf[64];\n    sprintf( buf, &quot;AT+CIPSEND=%d\\r\\n&quot;, connection-&gt;IPD_Len );\n    Esp8266TransmitWith( buf );\n}\n\n////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n// 3) Send Data after getting '&gt;' char from ESP8266\n\n//Wait for the data prompt.\nlen = FIFO2_GetCharsUntil( &amp;espUsart.rxFIFO, esp.buffer, ESP_DATA_BUFFER_LEN, '&gt;' );\nif( len &gt; 0 &amp;&amp; strstr( esp.buffer, ( &quot;&gt;&quot; ) ) != NULL )      //Got the prompt to send data.\n{\n    esp.timeout = EspConnectionTimeOutMed;\n    FIFO2_Flush(&amp;espUsart.rxFIFO, 0 );\n    esp.state = EspStateSendDataReady;\n}\nelse if( esp.timeout &gt; ESP_TASK_INTERVAL )\n{\n    esp.timeout -= ESP_TASK_INTERVAL;\n}\nelse if( esp.retry &gt; ESP_SEND_DATA_RETRY_MAX )\n{\n    esp.state = EspStateIpClose;\n}\nelse\n{\n    esp.state = EspStateSendData;\n    // Sending Header Data to ESP8266 from Here\n}\n</code></pre>\n<p>HTTP Headers from Source Code:</p>\n<pre><code>&quot;GET / HTTP/1.1\\r\\nHost: %d.%d.%d.%d:%d\\r\\n&quot;\n&quot;Connection: Upgrade\\r\\n&quot;\\\n&quot;Upgrade: websocket\\r\\n&quot;\\\n&quot;Sec-WebSocket-Version: 13\\r\\n&quot;\\\n&quot;Sec-WebSocket-Key: %s\\r\\n&quot;\\\n&quot;Sec-WebSocket-Extensions: permessage-deflate; client_max_window_bits\\r\\n\\r\\n&quot;\n</code></pre>\n<p>Here is WebSocket Server Code in Node Js.</p>\n<pre><code>var bodyParser = require(&quot;body-parser&quot;);\nconst express = require('express'); //express framework to have a higher level of methods\nconst app = express(); //assign app variable the express class/method\nvar http = require('http');\nvar path = require(&quot;path&quot;);\napp.use(bodyParser.urlencoded({ extended: false }));\napp.use(bodyParser.json());\nconst server = http.createServer(app);//create a server\n\n\n//***************this snippet gets the local ip of the node.js server. copy this ip to the client side code and add ':3000' *****\n//****************exmpl. 192.168.56.1---&gt; var sock =new WebSocket(&quot;ws://192.168.56.1:3000&quot;);*************************************\nrequire('dns').lookup(require('os').hostname(), function (err, add, fam) {\n  console.log('addr: '+add);\n})\n\n/**********************websocket setup**************************************************************************************/\n//var expressWs = require('express-ws')(app,server);\nconst WebSocket = require('ws');\nconst s = new WebSocket.Server({ server });\n\ns.on('connection', function(ws, req) {\n  console.log(req.headers);\n  console.log(req.params);\n});\n\n//when browser sends get request, send html file to browser\n// viewed at http://localhost:30000\napp.get('/', function(req, res) {\nres.sendFile(path.join(__dirname + '/index.html'));\n});\n\n\n//*************************************************************************************************************************\n//***************************ws chat server********************************************************************************\n\n//app.ws('/echo', function(ws, req) {\ns.on('connection',function(ws,req){\n\n/******* when server receives messsage from client trigger function with argument message *****/\nws.on('message',function(message){\nconsole.log(&quot;Received: &quot;+message);\ns.clients.forEach(function(client){ //broadcast incoming message to all clients (s.clients)\nif(client!=ws &amp;&amp; client.readyState ){ //except to the same client (ws) that sent this message\nclient.send(&quot;broadcast: &quot; +message);\n}\n});\n// ws.send(&quot;From Server only to sender: &quot;+ message); //send to client where message is from\n});\nws.on('close', function(){\nconsole.log(&quot;lost one client&quot;);\n});\n//ws.send(&quot;new client connected&quot;);\nconsole.log(&quot;new client connected&quot;);\n});\nserver.listen(8080);\n</code></pre>\n<p>NodeJs WebSocket Server is tested with Mobile WebsocketClient Tester <a href=\"https://play.google.com/store/apps/details?id=com.sss.rryma.myapplication&amp;hl=en_IN&amp;gl=US\" rel=\"nofollow noreferrer\">Android Application</a>. Its working fine</p>\n<p>EDIT 2:</p>\n<p>I have tried connecting <a href=\"http://echo.websocket.org/\" rel=\"nofollow noreferrer\">http://echo.websocket.org/</a>, I have modified code to connect with <a href=\"http://echo.websocket.org/\" rel=\"nofollow noreferrer\">http://echo.websocket.org/</a>. I can successfully connect with <a href=\"http://echo.websocket.org/\" rel=\"nofollow noreferrer\">http://echo.websocket.org/</a>. Received response from <a href=\"http://echo.websocket.org/\" rel=\"nofollow noreferrer\">http://echo.websocket.org/</a></p>\n<p>here is logs for reference.</p>\n<p>to <a href=\"http://echo.websocket.org/\" rel=\"nofollow noreferrer\">http://echo.websocket.org/</a></p>\n<pre><code>GET / HTTP/1.1\nHost: echo.websocket.org\nConnection: Upgrade\nUpgrade: websocket\nSec-WebSocket-Version: 13\nSec-WebSocket-Key: Dh6EV0ZUpTBTtZ42ZSM1FniX\nSec-WebSocket-Extensions: permessage-deflate; client_max_window_bits\n</code></pre>\n<p>from <a href=\"http://echo.websocket.org/\" rel=\"nofollow noreferrer\">http://echo.websocket.org/</a></p>\n<pre><code>+IPD,201:HTTP/1.1 101 Web Socket Protocol Handshake\nConnection: Upgrade\nDate: Sun, 23 May 2021 08:54:52 GMT\nSec-WebSocket-Accept: TaHsjyffJhTaBluq4Bmksq0NPWo=\nServer: Kaazing Gateway\nUpgrade: websocket\n</code></pre>\n"
    }, {
        "tags": [
            "python",
            "iot",
            "gpio"
        ],
        "is_answered": false,
        "view_count": 41,
        "favorite_count": 0,
        "score": -4,
        "last_activity_date": 1620054089,
        "creation_date": 1620053122,
        "last_edit_date": 1620053596,
        "question_id": 67370936,
        "link": "https://stackoverflow.com/questions/67370936/microgear-client-is-stuck-on-connection",
        "title": "microgear client is stuck on connection",
        "body": "<p>Using <a href=\"https://github.com/netpieio/microgear-python\" rel=\"nofollow noreferrer\">https://github.com/netpieio/microgear-python</a></p>\n<p>My code:</p>\n<pre class=\"lang-py prettyprint-override\"><code>import microgear.client as microgear\nimport RPi.GPIO as gpio\nimport time\nimport logging\n\nDT=27\nSCK=17\nm1=12\nm2=16\nHIGHT=1\nLOW=0\nsample=0\nval=0\n\nappid='Locacell'\ngearkey='xxx'\ngearsecret='xxx'\n\nmicrogear.create(gearkey,gearsecret,appid,{&quot;debugmode&quot;:True})\n\ndef connection():\n    logging.debug(&quot;connect&quot;)\ndef subscription(topic,message):\n    logging.debug(topic+&quot; &quot;+message)\ndef disconnect():\n    logging.debug(&quot;disconnect&quot;)\nmicrogear.setalias(&quot;can&quot;)\nmicrogear.on_connect= connection\nmicrogear.on_message= subscription\nmicrogear.on_disconnect= disconnect\nmicrogear.subscribe(&quot;/can&quot;)\nmicrogear.connect(True)\n\ngpio.setwarning(True)\ngpio.setmode(gpio.BCM)\ngpio.setup(m1, gpio.OUT)\ngpio.setup(m2, gpio.OUT)\ngpio.setup(SCK, gpio.OUT)\ngpio.output(m1, 0)\ngpio.output(m2, 0)\n\ndef readCount():\n    i=0\n    Count=0\nprint Count\ntime.sleep(1)\n</code></pre>\n<p>Output is:</p>\n<p><a href=\"https://i.stack.imgur.com/eQ4Qa.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/eQ4Qa.png\" alt=\"program output\" /></a></p>\n<p>... but then it stopped.</p>\n"
    }, {
        "tags": [
            "amazon-web-services",
            "mqtt",
            "iot",
            "mosquitto",
            "aws-iot"
        ],
        "is_answered": false,
        "view_count": 46,
        "favorite_count": 0,
        "score": 1,
        "last_activity_date": 1619687134,
        "creation_date": 1619682043,
        "last_edit_date": 1619687134,
        "question_id": 67313040,
        "link": "https://stackoverflow.com/questions/67313040/cannot-get-mosquitto-aws-iot-bridge-to-stay-connected",
        "title": "Cannot get Mosquitto &lt;-&gt; AWS IoT -bridge to stay connected",
        "body": "<p>I am running Mosquitto Broker on AWS Ubuntu 20.04.2 LTS server. I have 2 MQTT bridges, from my laptop to the broker on the server and from the server to AWS IoT.</p>\n<p>My broker configuration on the server is as follows:</p>\n<pre><code>listener 1883\nprotocol mqtt\n\nlistener 9001\nprotocol websockets\n\nallow_anonymous false\npassword_file /etc/mosquitto/conf.d/passwd.txt\n\nconnection awsiot\naddress xxxxxxxxxx-ats.iot.eu-north-1.amazonaws.com:8883\n\ntopic iotethernet/switch/count out 1\ntopic iotethernet/ledblock/states in 1\n\nbridge_protocol_version mqttv311\nbridge_insecure false\nbridge_outgoing_retain false\n\ncleansession true\nclientid bridgeawsiot\nstart_type automatic\nnotifications true\nlog_type all\n\nbridge_cafile /etc/mosquitto/certs/rootCA.pem\nbridge_certfile /etc/mosquitto/certs/cert.crt\nbridge_keyfile /etc/mosquitto/certs/private.key\n</code></pre>\n<p>The problem is that when I am running the server, the bridge client constantly connects and immediately disconnects without an error message.</p>\n<p><img src=\"https://i.stack.imgur.com/obAcR.png\" alt=\"Picture of mosquitto broker after bridge client disconnects\" /></p>\n<p>I have made sure that the bridge doesn't work by testing with the AWS IoT -test feature.</p>\n<p>The bridge from laptop to server works fine.</p>\n"
    }, {
        "tags": [
            "amazon-web-services",
            "mqtt",
            "iot"
        ],
        "is_answered": false,
        "view_count": 134,
        "favorite_count": 0,
        "score": 0,
        "last_activity_date": 1619516306,
        "creation_date": 1619507138,
        "last_edit_date": 1619516306,
        "question_id": 67278378,
        "link": "https://stackoverflow.com/questions/67278378/how-can-i-connect-to-aws-iot-by-using-mqtt-js",
        "title": "How can I connect to AWS IoT by using mqtt.js",
        "body": "<p>The following code reports handshake timeout error. I didn't put exact data on the code but with my own understanding of those params. Is there anything wrong with my understanding?</p>\n<pre class=\"lang-js prettyprint-override\"><code>var options = {\n    clientId: a random String,\n    endpoint: the endpoint of AWS IoT Core,\n    accessKey: I generate this from IAM - &gt; Dashboard - &gt; My access Key - &gt; Access key,\n    secretKey: I generate this from IAM - &gt; Dashboard - &gt; My access Key - &gt; Access key,\n    regionName: i find this from endpoint,\n    debug: true\n};\n\n\nvar client = mqtt.connect('ws://' + endpoint, options);\n//var client  = mqtt.connect('mqtt://test.mosquitto.org');\nclient.on('connect', function() {\n    alert(&quot;MQTT connected&quot;);\n    client.subscribe('topic_1')\n    client.publish('topic_1', 'Hello mqtt2')\n})\n\nclient.on('message', function(topic, message) {\n    // message is Buffer\n    alert(message.toString())\n    client.end()\n})\n</code></pre>\n<p>I wonder if I misunderstand the first param of connect function but I don't know how to change.</p>\n<p>My policy is shown as below.</p>\n<pre><code>{\n  &quot;Version&quot;: &quot;2012-10-17&quot;,\n  &quot;Statement&quot;: [\n    {\n      &quot;Effect&quot;: &quot;Allow&quot;,\n      &quot;Action&quot;: &quot;iot:*&quot;,\n      &quot;Resource&quot;: &quot;*&quot;\n    }\n  ]\n}\n</code></pre>\n<p>And I am sure that I have attached this policy to my certificate.</p>\n"
    }, {
        "tags": [
            "c#",
            "amazon-web-services",
            "iot"
        ],
        "is_answered": false,
        "view_count": 13,
        "favorite_count": 0,
        "score": 0,
        "last_activity_date": 1618261654,
        "creation_date": 1617894531,
        "last_edit_date": 1618261654,
        "question_id": 67006864,
        "link": "https://stackoverflow.com/questions/67006864/connection-problem-iot-aws-mqttclient-net-c",
        "title": "Connection problem iot aws mqttclient .net c#",
        "body": "<p>I have a connection problem with client <a href=\"https://github.com/eclipse/paho.mqtt.m2mqtt\" rel=\"nofollow noreferrer\">M2Mqtt</a>. I try to connect to my IoT things in this way:</p>\n<pre><code>var caCert = X509Certificate.CreateFromCertFile(@&quot;C:\\DiscoD\\MqttRuleDefault\\root.crt&quot;);\nvar clientCert = new X509Certificate2(@&quot;C:\\DiscoD\\MqttRuleDefault\\xxxx-certificate.crt&quot;);\n\nstring path = @&quot;C:\\DiscoD\\MqttRuleDefault\\xxxxx-private.pem.key&quot;;\nstring privateKey = this.GetStringFromFile(path);\nbyte[] keyBuffer = Helpers.GetBytesFromPEM(privateKey, PemStringType.RsaPrivateKey);    \n\nRSACryptoServiceProvider prov = Crypto.DecodeRsaPrivateKey(keyBuffer);\nclientCert.PrivateKey = prov;\n\nConsole.WriteLine(clientCert.HasPrivateKey);\n\nConsole.WriteLine(clientCert.Issuer);\nConsole.WriteLine(clientCert.Verify());\n\nRemoteCertificateValidationCallback cb = new RemoteCertificateValidationCallback(Pippo);\nLocalCertificateSelectionCallback lcb = new LocalCertificateSelectionCallback(Pippo1);\n\nvar client = new MqttClient(&quot;yyyyy-ats.iot.us-west-2.amazonaws.com&quot;\n                            ,443\n                            ,true\n                            ,caCert\n                            ,clientCert\n                            ,MqttSslProtocols.TLSv1_2\n                            ,cb\n                            ,lcb\n                            ,new List&lt;string&gt;() { &quot;x-amzn-mqtt-ca&quot; });\n\nstring clientId = Guid.NewGuid().ToString();\nclient.ConnectionClosed += Client_ConnectionClosed;\nclient.MqttMsgPublished += Client_MqttMsgPublished;\nclient.MqttMsgPublishReceived += Client_MqttMsgPublishReceived;\nclient.MqttMsgSubscribed += Client_MqttMsgSubscribed;\nclient.MqttMsgUnsubscribed += Client_MqttMsgUnsubscribed; \n\nclient.Connect(clientId);\n</code></pre>\n<p>But message of Connax does not arrive.\nThe strange thing is that a Python script setting with the same field connects correctly, and the same for  awsIotClient.</p>\n"
    }, {
        "tags": [
            "xamarin",
            "iot",
            "esp8266",
            "android-wifi"
        ],
        "is_answered": false,
        "view_count": 26,
        "favorite_count": 0,
        "score": 1,
        "last_activity_date": 1617887429,
        "creation_date": 1617887429,
        "question_id": 67004709,
        "link": "https://stackoverflow.com/questions/67004709/xamarin-multiple-request-network-pop-ups-in-android-10-when-try-to-connect-to",
        "title": "Xamarin: multiple request network pop ups in android 10, when try to connect to wifi in IOT module",
        "body": "<p>I am working on an IOT module with wifi connection,I am testing using a samsung with android 10.\nThe chip is a ESP8266.The Wi-Fi signal, does not have an internet connection.\nthe project is developed in xamarin.</p>\n<p>The problem, is when I try to connect to the device's signal. When I'm making the connection request, multiple pop ups appear in the device, requesting the connection, and it does not wait until it is connected, immediately the device launches the connection requests again and again, finally crash.</p>\n<p>when i'm debugging, the NetworkAvailable runs, but even the phone does not finish connecting to the signal, the phone lunch a new request network again, don't wait until you are actually connected, and I don't know why multiple requests are launched.</p>\n<p>Here is my code.</p>\n<pre><code> public async Task&lt;bool&gt; Connect(string WiFiName, string WifiPassword)\n        {\n            bool result = false;\n            var formattedSsid = $&quot;\\&quot;{WiFiName}\\&quot;&quot;;\n            var formattedPassword = $&quot;\\&quot;{WifiPassword}\\&quot;&quot;;\n    \n            try\n            {\n               \n                    AutoResetEvent autoResetEvent = new AutoResetEvent(false);\n    \n                    var wifiNetworkSpecifier = new WifiNetworkSpecifier.Builder()\n                    .SetSsid(WiFiName)\n                    .SetWpa2Passphrase(WifiPassword)\n                    .Build();\n    \n                    var networkRequest = new NetworkRequest.Builder()\n                    .AddTransportType(TransportType.Wifi) // we want WiFi\n                    .SetNetworkSpecifier(wifiNetworkSpecifier) // we want _our_ network\n                    .Build();\n    \n                    UnregisterNetworkCallback(_networkCallback);\n    \n                    _networkCallback = new NetworkCallback()\n                    {\n                        NetworkAvailable = network =&gt;\n                        {\n                            result = true;\n                            autoResetEvent.Set(); //signal\n                        },\n                        NetworkUnavailable = () =&gt;\n                        {\n                            result = false;\n                            autoResetEvent.Set(); //signal\n                        },\n                    };\n    \n                    connectivityManager.RequestNetwork(networkRequest, _networkCallback);\n    \n                    autoResetEvent.WaitOne();\n    \n               \n            }\n            catch (Exception e)\n            {\n                Crashes.TrackError(e);\n               \n            }\n            finally\n            {\n            }\n    \n            return result;\n        }\n    \n        private void UnregisterNetworkCallback(NetworkCallback _networkCallback)\n        {\n            if (_networkCallback != null)\n            {\n                try\n                {\n                    _connectivityManager.UnregisterNetworkCallback(_networkCallback);\n    \n                }\n                catch (Exception) {\n                } finally\n                {\n                    _networkCallback = null;\n                }\n            }\n        }\n    \n    \n    public class NetworkCallback : ConnectivityManager.NetworkCallback\n    {\n        public Action&lt;Network&gt; NetworkAvailable { get; set; }\n        public Action NetworkUnavailable { get; set; }\n    \n        public NetworkCallback()\n        {\n         \n        }\n    \n        public override void OnAvailable(Network network)\n        {\n            try\n            {\n                WiFiAndroid.connectivityManager.BindProcessToNetwork(null);\n                WiFiAndroid.connectivityManager.BindProcessToNetwork(network);\n            }\n            catch (Exception ex)\n            {\n                var error = ex;\n            }\n        }\n    \n        public override void OnUnavailable()\n        {\n            base.OnUnavailable();\n            NetworkUnavailable?.Invoke();\n        }\n    }\n</code></pre>\n<p><a href=\"https://i.stack.imgur.com/XERhY.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/XERhY.jpg\" alt=\"enter image description here\" /></a></p>\n<p>the image, is the request that is throw over and over again.</p>\n"
    }, {
        "tags": [
            "kotlin",
            "raspberry-pi",
            "mqtt",
            "iot",
            "mosquitto"
        ],
        "is_answered": false,
        "view_count": 123,
        "favorite_count": 0,
        "score": 0,
        "last_activity_date": 1617467793,
        "creation_date": 1617467793,
        "question_id": 66933533,
        "link": "https://stackoverflow.com/questions/66933533/cant-connect-to-mqtt-server-using-raspberrypi-hostname-on-android",
        "title": "Can&#39;t connect to MQTT server using raspberrypi hostname on Android",
        "body": "<p>I'm new to using MQTT and I've started a Mosquitto broker on my Raspberry Pi.\nWhen I try to connect to it from my Windows PC cmd it works fine, I just type <code>mosquitto_sub -h raspberrypi -t &quot;test/message&quot;</code> and it subscribes to the topic and sees what I publish in it.</p>\n<p>The problem is with connecting my phone to it- I've tried using multiple apps including this one: <a href=\"https://github.com/leonardocavagnis/MQTTClientSample_Android\" rel=\"nofollow noreferrer\">https://github.com/leonardocavagnis/MQTTClientSample_Android</a> and I can connect to the Raspberry Pi broker only by IP address: <code>tcp://&lt;ip_address&gt;:1883</code> works okay, but the IP changes in my local network, so I wanted to use <code>tcp://raspberrypi:1883</code> instead to have no problems with connection but it doesn't connect then. What could be the issue?</p>\n"
    }, {
        "tags": [
            "node.js",
            "amazon-web-services",
            "mqtt",
            "iot",
            "aws-iot"
        ],
        "is_answered": false,
        "view_count": 70,
        "favorite_count": 0,
        "score": 0,
        "last_activity_date": 1616516359,
        "creation_date": 1616469591,
        "question_id": 66756809,
        "link": "https://stackoverflow.com/questions/66756809/using-aws-iots-thingshadow-with-a-websocket-connection",
        "title": "Using AWS IoT&#39;s ThingShadow with a Websocket Connection",
        "body": "<p>When I first started learning how to use aws, I connected my device/thingShadow to the IoT core by going to the AWS IoT management console and creating &quot;Things.&quot; Each thing came with a private, public, and certificate keys that you would use to connect to IoT by doing the following:</p>\n<pre><code>var awsIot = require('aws-iot-device-sdk');\n\nconst keyPath = `./260b380cc2-private.pem.key`\nconst certPath = `./260b380cc2-certificate.pem.crt`\nconst caPath = './rootCA.pem'\nconst clientId = 'client'\nconst host = 'XXXXXXXXXXXXXXXX.iot.us-east-2.amazonaws.com'\n\nvar thingShadow = awsIot.thingShadow({\n    keyPath: keyPath,\n   certPath: certPath,\n     caPath: caPath,\n   clientId: clientId,\n       host: host\n });\n\n var shadowName = 'testShadow'\n \n thingShadow.on(&quot;connect&quot;, () =&gt; {\n    thingShadow.register(shadowName, {}, () =&gt; {\n\n        console.log(&quot;Conneced. Getting shadow&quot;)        \n        thingShadow.get(shadowName)\n    })\n})\n\nthingShadow.on('status',\n    function(thingName, stat, clientToken, stateObject) {\n\n       console.log('received '+stat+' on '+thingName+': '+\n                   JSON.stringify(stateObject))})\n\n</code></pre>\n<p>Now, instead of connecting to the IoT Core using the RSA keys, I'm connecting a device through a websocket protocol using Amazon's Cognito identity pool:</p>\n<pre><code>Aws = require('aws-sdk/dist/aws-sdk-react-native');\nawsIot = require('aws-iot-device-sdk');\n\nconst AWS_REGION = 'us-east-2';\nconst AWS_COGNITO_IDENTITY_POOL = 'us-east-2:XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX';\nconst AWS_IOT_ENDPOINT = 'XXXXXXXXXXXXXX.iot.us-east-2.amazonaws.com';\n\nAws.config.region = AWS_REGION\nAws.config.credentials = new Aws.CognitoIdentityCredentials({\n    IdentityPoolId: AWS_COGNITO_IDENTITY_POOL\n})\n\nAws.config.credentials.get(() =&gt; {\n    const config = {}\n    let client\n    \n    config.host = AWS_IOT_ENDPOINT\n    config.protocol = 'wss'\n    config.clientId = `client-${Math.floor((Math.random() * 100000) + 1)}`\n    config.accessKeyId = 'XXXXXXXXXXXXXX';\n    config.secretKey = 'XXXXXXXXXXXXXXXXXXXXXX';\n    \n    //client = awsIot.device(config)\n    client = awsIot.thingShadow(config);\n    \n    client.on('connect', (success) =&gt; {\n        if (success) {\n            console.log(&quot;Connected.&quot;)\n            client.register('testShadow')\n            client.get('testShadow')\n\n        } else {\n            console.log(&quot;Could not connect.&quot;)\n        }\n       \n    })\n\n    client.on('close', () =&gt; {\n        console.log(&quot;Connection closed.&quot;)\n    })\n    \n    client.on('message', (topic, message) =&gt; {\n        console.log(topic, message)\n    })\n\n    client.on(&quot;status&quot;, (shadow, stat, id, state) =&gt; {\n        console.log(JSON.stringify(state))\n    })\n    \n    client.on('error', error =&gt; {\n        console.log(error)\n    })\n})\n\n</code></pre>\n<p>The problem with the second code block is that when I use <code>client = awsIoT.thingShadow(config)</code>, the client fails to connect and prints <code>Could not connect.</code> But when I use <code>client = awsIot.device(config)</code>, the client connects and prints out <code>Connected</code> (when I used <code>aws.Iot.device</code>, I don't include the <code>client.register</code> and <code>client.get</code> code lines). Other than that, I don't get any errors of any kind, so I'm not sure why it's failing to connect or what I should be doing so that I can get a thingShadow to connect through a cognito identity pool. Is it even possible? If it is, how can I get that kind of functionality?</p>\n"
    }, {
        "tags": [
            "python",
            "logging",
            "google-cloud-platform",
            "iot",
            "google-cloud-logging"
        ],
        "is_answered": false,
        "view_count": 107,
        "favorite_count": 0,
        "score": 0,
        "last_activity_date": 1616418583,
        "creation_date": 1616154258,
        "last_edit_date": 1616161312,
        "question_id": 66707542,
        "link": "https://stackoverflow.com/questions/66707542/typeerror-writing-a-structured-log-to-google-cloud-logging-from-a-cloud-function",
        "title": "TypeError writing a structured log to google cloud logging from a cloud function",
        "body": "<p>I am trying to write a log from a cloud function into cloud logging, but I am having trouble doing this. My code is the following, where the message is a log like this: &quot;20210319-11:39:58-CET - INFO - this is an info message&quot; and the atttributes are simply strings.</p>\n<pre class=\"lang-py prettyprint-override\"><code>import base64\nimport json\nimport os\nimport pytz\nfrom datetime import datetime\nfrom google.cloud import logging\nfrom google.cloud.logging_v2.resource import Resource\n\nRESOURCE_TYPE = &quot;cloudiot_devices&quot;\nPROJECT = os.environ.get(&quot;GCP_PROJECT&quot;)\nDEVICE_REGISTRY = REGISTRY_ID\nLOCATION = LOCATION\nDATEFORMAT = &quot;%Y%m%d-%H:%M:%S&quot;\n\ndef iot_logger(event, context):\n    &quot;&quot;&quot;Triggered from a message on a Cloud Pub/Sub topic.\n    Args:\n         event (dict): Event payload.\n         context (google.cloud.functions.Context): Metadata for the event.\n    &quot;&quot;&quot;\n    log = base64.b64decode(event['data']).decode('utf-8')\n    attributes = event['attributes']\n\n    print(log)\n    print(json.dumps(attributes))\n\n    print(&quot;preparing timestamp&quot;)\n    # Extract elements from log\n    date_str,severity,message = log.split(&quot; - &quot;)\n\n    # This is the main content for the log\n    log_content = {&quot;message&quot;:message}\n\n    # turn log timestamp str to an aware datetime object for our timestamp\n    tzname = date_str.split(&quot;-&quot;)[-1]\n    # remove time zone to avoid tripping up the datetime module\n    date_str = date_str[:-4]\n    date_unaware = datetime.strptime(date_str,DATEFORMAT)\n    date_aware = date_unaware.astimezone(pytz.timezone(tzname))\n\n    print(f&quot;done preparing timestamp: {date_aware}&quot;)\n\n    # extract attributes\n    logger_name = attributes[&quot;logger_name&quot;]\n    device_num_id = attributes[&quot;device_num_id&quot;]\n\n    print(&quot;creating resource&quot;)\n    # create resource \n    resource_labels = {\n        'project_id':PROJECT,\n        'device_num_id':device_num_id,\n        'device_registry_id':DEVICE_REGISTRY,\n        'location':LOCATION\n    }\n    log_resource = Resource(type=RESOURCE_TYPE,labels=resource_labels)\n\n    print(&quot;initiating client&quot;)\n    # initiate logging client\n    log_client = logging.Client()\n\n    logger = log_client.logger(logger_name)\n\n    print(&quot;creating structured log&quot;)\n    logger.log_struct(log_content,severity=severity,resource=log_resource,timestamp=date_aware)\n</code></pre>\n<p>However, I keep facing issues with the log_struct command and I haven't been able to figure out what is the problem. Initially I was passing a string to the timestamp and it wouldn't work, so now I am passing a date object. But now the error is different:\nEDIT: There's more than one:</p>\n<pre><code>Traceback (most recent call last):\n  File &quot;/layers/google.python.pip/pip/lib/python3.8/site-packages/google/protobuf/json_format.py&quot;, line 589, in _ConvertFieldValuePair\n    self.ConvertMessage(value, sub_message)\n  File &quot;/layers/google.python.pip/pip/lib/python3.8/site-packages/google/protobuf/json_format.py&quot;, line 485, in ConvertMessage\n    self._ConvertFieldValuePair(value, message)\n  File &quot;/layers/google.python.pip/pip/lib/python3.8/site-packages/google/protobuf/json_format.py&quot;, line 603, in _ConvertFieldValuePair\n    raise ParseError('Failed to parse {0} field: {1}.'.format(name, e))\ngoogle.protobuf.json_format.ParseError: Failed to parse labels field: expected string or bytes-like object. \n</code></pre>\n<pre><code>Traceback (most recent call last):\n  File &quot;/layers/google.python.pip/pip/lib/python3.8/site-packages/google/protobuf/json_format.py&quot;, line 589, in _ConvertFieldValuePair\n    self.ConvertMessage(value, sub_message)\n  File &quot;/layers/google.python.pip/pip/lib/python3.8/site-packages/google/protobuf/json_format.py&quot;, line 485, in ConvertMessage\n    self._ConvertFieldValuePair(value, message)\n  File &quot;/layers/google.python.pip/pip/lib/python3.8/site-packages/google/protobuf/json_format.py&quot;, line 603, in _ConvertFieldValuePair\n    raise ParseError('Failed to parse {0} field: {1}.'.format(name, e))\ngoogle.protobuf.json_format.ParseError: Failed to parse labels field: expected string or bytes-like object. \n</code></pre>\n<pre><code>&quot;Traceback (most recent call last):\n  File &quot;/layers/google.python.pip/pip/lib/python3.8/site-packages/flask/app.py&quot;, line 2447, in wsgi_app\n    response = self.full_dispatch_request()\n  File &quot;/layers/google.python.pip/pip/lib/python3.8/site-packages/flask/app.py&quot;, line 1952, in full_dispatch_request\n    rv = self.handle_user_exception(e)\n  File &quot;/layers/google.python.pip/pip/lib/python3.8/site-packages/flask/app.py&quot;, line 1821, in handle_user_exception\n    reraise(exc_type, exc_value, tb)\n  File &quot;/layers/google.python.pip/pip/lib/python3.8/site-packages/flask/_compat.py&quot;, line 39, in reraise\n    raise value\n  File &quot;/layers/google.python.pip/pip/lib/python3.8/site-packages/flask/app.py&quot;, line 1950, in full_dispatch_request\n    rv = self.dispatch_request()\n  File &quot;/layers/google.python.pip/pip/lib/python3.8/site-packages/flask/app.py&quot;, line 1936, in dispatch_request\n    return self.view_functions[rule.endpoint](**req.view_args)\n  File &quot;/layers/google.python.pip/pip/lib/python3.8/site-packages/functions_framework/__init__.py&quot;, line 149, in view_func\n    function(data, context)\n  File &quot;/workspace/main.py&quot;, line 64, in iot_logger\n    logger.log_struct(log_content,severity=severity,resource=log_resource,timestamp=date_aware)\n  File &quot;/layers/google.python.pip/pip/lib/python3.8/site-packages/google/cloud/logging_v2/logger.py&quot;, line 180, in log_struct\n    self._do_log(client, StructEntry, info, **kw)\n  File &quot;/layers/google.python.pip/pip/lib/python3.8/site-packages/google/cloud/logging_v2/logger.py&quot;, line 133, in _do_log\n    client.logging_api.write_entries([api_repr])\n  File &quot;/layers/google.python.pip/pip/lib/python3.8/site-packages/google/cloud/logging_v2/_gapic.py&quot;, line 140, in write_entries\n    log_entry_pbs = [_log_entry_mapping_to_pb(entry) for entry in entries]\n  File &quot;/layers/google.python.pip/pip/lib/python3.8/site-packages/google/cloud/logging_v2/_gapic.py&quot;, line 140, in &lt;listcomp&gt;\n    log_entry_pbs = [_log_entry_mapping_to_pb(entry) for entry in entries]\n  File &quot;/layers/google.python.pip/pip/lib/python3.8/site-packages/google/cloud/logging_v2/_gapic.py&quot;, line 507, in _log_entry_mapping_to_pb\n    ParseDict(mapping, entry_pb)\n  File &quot;/layers/google.python.pip/pip/lib/python3.8/site-packages/google/protobuf/json_format.py&quot;, line 454, in ParseDict\n    parser.ConvertMessage(js_dict, message)\n  File &quot;/layers/google.python.pip/pip/lib/python3.8/site-packages/google/protobuf/json_format.py&quot;, line 485, in ConvertMessage\n    self._ConvertFieldValuePair(value, message)\n  File &quot;/layers/google.python.pip/pip/lib/python3.8/site-packages/google/protobuf/json_format.py&quot;, line 597, in _ConvertFieldValuePair\n    raise ParseError('Failed to parse {0} field: {1}.'.format(name, e))\ngoogle.protobuf.json_format.ParseError: Failed to parse resource field: Failed to parse labels field: expected string or bytes-like object..&quot;\n</code></pre>\n<p>It says it needs a string or bytes-like object, but I am not sure where. I imagine it's not related to the date, as it was giving me an error when it was a string. Also the resource I believe should work, I am looking at a very similar example on this stackoverflow question, but it doesn't work for me:</p>\n<p><a href=\"https://stackoverflow.com/questions/54147483/google-cloud-functions-python-logging-issue\">Google Cloud Functions Python Logging issue</a></p>\n<p>What am I doing wrong?</p>\n"
    }, {
        "tags": [
            "python",
            "iot",
            "azure-iot-hub",
            "paho"
        ],
        "is_answered": true,
        "view_count": 923,
        "favorite_count": 0,
        "score": 0,
        "last_activity_date": 1616398785,
        "creation_date": 1564335625,
        "question_id": 57243449,
        "link": "https://stackoverflow.com/questions/57243449/connecting-with-m2mqtt-paho-python-client-to-azure-iot-hub",
        "title": "Connecting with M2MQTT Paho Python client to Azure IoT Hub",
        "body": "<p>I am using the following code in attempt to connect to Azure IoT Hub. It uses SAS, therefore no security certificates are needed. I am successfully connecting to Azure IoT Hub using the same M2MQTT library in C# but this code fails with:\nFailed to connect.Connection refused, not authorized. Error Code= 5</p>\n\n<p>I tried any possible combos of security parameters but at no avail. The SAS token is generated by DeviceExplorer.</p>\n\n<pre><code>#! /usr/bin/python3.5\nimport serial\nimport time\nimport datetime\nimport os\nimport socket\nimport ssl\nimport logging\nimport paho.mqtt.client as mqtt\nimport sys\nprint(sys.executable)\n\ndef on_disconnect(client, userdata, rc):\n    if rc==0:\n        print(\"client disconnected OK\")\n        client.connected_flag=False\n\ndef on_connect(client, userdata, flags, rc):\n    if rc==0:\n        print(\"Connected OK\")\n        mqtt.Client.connected_flag=True\n        mqtt.Client.bad_connection_params=False\n    else:\n        mqtt.Client.bad_connection_params=True\n\n        if rc==1:\n            print(\"Failed to connect. Connection refused, unacceptable \nprotocol version. Error Code=\", rc)\n        elif rc==2:\n            print(\"Failed to connect.Connection refused, identifier \nrejected. Error Code=\", rc)\n        elif rc==3:\n            print(\"Failed to connect.Connection refused, server unavailable. Error Code=\", rc)\n        elif rc==4:\n        print(\"Failed to connect.Connection refused, bad user name or password. Error Code=\", rc)\n        elif rc==5:\n        print(\"Failed to connect.Connection refused, not authorized. Error Code=\", rc)\n\n\ndef on_publish(client, userdata, mid):\n    if rc==0:\n        print(\"Data published OK: \", userdata)\n    else:\n        print(\"Failed to publish data. MessageID=\", mid)\n    pass\n\nbroker=\"myIoTHubName.azure-devices.net\"\nport=8883\nDeviceID=\"MasterTag\"\nDeviceKey=\"myDeviceKey\"\nIoTHubName=\"myIoTHubName\"\nSasToken=\"SharedAccessSignature sr=myIoTHubName.azure-devices.net&amp;sig=...\"\n\n# Create client object\n# 4 stands for MQTTv311\nrpiclient = mqtt.Client(\"PahoClient-on-RPi-Gateway2\", clean_session=True, userdata=None, protocol=4, transport=\"tcp\") \n\nusernameFormat=\"{}, {}, {}\"\nusername=usernameFormat.format(IoTHubName, \".azure-devices.net/\", DeviceID)\npassword=SasToken\n\nrpiclient.username_pw_set(username, password)\nrpiclient.tls_set(tls_version=ssl.PROTOCOL_TLSv1_2)\nrpiclient.tls_insecure_set(True)\n\n# connection flag indicates that connection was made or not\nmqtt.Client.connected_flag = False\n\n# connection parameters are incorrect: ip address, port, authentication, etc\nmqtt.Client.bad_connection_params=False\n\n#assign function to callback\nrpiclient.on_connect = on_connect\n\n#assign function to callback\nrpiclient.on_publish = on_publish\n\n# bind the disconnect callback   \nrpiclient.on_disconnect = on_disconnect\n\nrpiclient.loop_start()\n\nrpiclient.will_set(\"dwm/position\", \"Client PahoClient-on-RPi2 had unexpectedly disconnected\", 1, True)\n\ntry:\n    print(\"Connecting to MQTT broker \",broker)\n    # Connect to the MQTT Broker\n    rpiclient.connect(broker, port)\n    time.sleep(1)\n\n    # Wait in a loop until we are connected\n    print(\"mqtt.Client.connected_flag={}, \n</code></pre>\n\n<p>mqtt.Client.bad_connection_params={}\".format(mqtt.Client.connected_flag, mqtt.Client.bad_connection_params))\n        while mqtt.Client.connected_flag == False and mqtt.Client.bad_connection_params == False:\n            print(\"Waiting for connection...\");\n            time.sleep(1)\n        if mqtt.Client.bad_connection_params == True:\n            rpiclient.loop_stop()\n            sys.exit()</p>\n\n<pre><code>except Exception as ex:\n    print(\"Connection to MQTT Broker failed: \", ex)\n\nrpiclient.loop_stop()\n\n# Disconnect MQTT Client\nrpiclient.disconnect()\n</code></pre>\n\n<p>Any advice is appreciated.</p>\n"
    }, {
        "tags": [
            "arduino",
            "sms",
            "iot",
            "at-command",
            "sim800l"
        ],
        "is_answered": true,
        "view_count": 1049,
        "favorite_count": 0,
        "score": 1,
        "last_activity_date": 1616187408,
        "creation_date": 1612569938,
        "last_edit_date": 1612711185,
        "question_id": 66072234,
        "link": "https://stackoverflow.com/questions/66072234/how-to-delete-all-sms-from-sim800l",
        "title": "How to delete all SMS from SIM800l?",
        "body": "<p>I used to have an <strong>SIM800l</strong> module that I do not know exactly how I set up, but every time I deleted a SMS from the first memory location, the other SMS were moved up to the position of the first SMS, always occupying the position number one in storage.</p>\n<p><strong>Does anyone know how to set up my new module like that?</strong></p>\n<p>With such setup, in order to delete all SMS, I just repeatedly sent the command <code>AT+CMGD=1</code> so that I didn't need to change the indices.</p>\n"
    }, {
        "tags": [
            "javascript",
            "react-native",
            "iot",
            "aws-iot"
        ],
        "is_answered": true,
        "view_count": 1167,
        "favorite_count": 1,
        "score": 4,
        "last_activity_date": 1615544374,
        "creation_date": 1549606654,
        "question_id": 54586953,
        "link": "https://stackoverflow.com/questions/54586953/can-not-connect-to-aws-iot-device-with-react-native",
        "title": "can not connect to aws iot device with react native",
        "body": "<p>i am building IoT app with react native.\nused this package </p>\n\n<p><a href=\"https://github.com/aws/aws-iot-device-sdk-js\" rel=\"nofollow noreferrer\">https://github.com/aws/aws-iot-device-sdk-js</a></p>\n\n<p>but got error while running app</p>\n\n<p><a href=\"https://i.stack.imgur.com/1gvrT.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/1gvrT.png\" alt=\"enter image description here\"></a></p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-js lang-js prettyprint-override\"><code>import React, {Component} from 'react';\r\nimport {Platform, \r\n  StyleSheet, \r\n  Text, \r\n  View,\r\n  TextInput,\r\n  TouchableOpacity,\r\n  StatusBar,\r\n} from 'react-native';\r\nimport AwsIot from 'aws-iot-device-sdk'\r\nexport default class App extends Component {\r\n  constructor(props){\r\n    super(props)\r\n    this.connectToIoT()\r\n  }\r\n  connectToIoT(){\r\n    var device = AwsIot.device({\r\n       keyPath:'1d8bea736f-private.pem.key',\r\n       certPath: '1d8bea736f-certificate.pem.crt',\r\n       caPath:   'AmazonRootCA1.pem',\r\n       clientId: 'IoTcloud',\r\n       host: 'a3ckca0x6pesml.iot.ap-northeast-2.amazonaws.com'\r\n   });\r\n   console.log(device)\r\n   device\r\n    .on('connect', function() {\r\n      console.log('connect');\r\n    });\r\n    device\r\n    .on('message', function(topic, payload) {\r\n      console.log('message', topic, payload.toString());\r\n    });\r\n    }\r\n}</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p>here i called this function connectToIoT when app is opened..\nkeyPath,certPath,caPath files are stored in root of the project</p>\n\n<p>how to get rid of this error and connect my device to aws-iot???</p>\n\n<p>already followed this solution from stack <a href=\"https://stackoverflow.com/questions/53633042/how-to-implement-aws-iotdevice-in-react-native\">How to implement AWS IoT(device) in React-Native?</a></p>\n\n<p>but still stuck at this error</p>\n"
    }, {
        "tags": [
            "python",
            "logging",
            "google-cloud-platform",
            "raspberry-pi",
            "iot"
        ],
        "is_answered": false,
        "view_count": 60,
        "favorite_count": 0,
        "score": 0,
        "last_activity_date": 1615452367,
        "creation_date": 1615452367,
        "question_id": 66579064,
        "link": "https://stackoverflow.com/questions/66579064/gcp-logging-to-both-local-and-cloud-logging-on-iot-device",
        "title": "GCP logging to both local and cloud logging on IoT device?",
        "body": "<p>I have some python scripts running on IoT devices (raspberry pis) which I want to keep track of using GCP logging. Originally, my scripts were simply logging to a local file, but now I want to be able to look at my device's logs from the GCP console. I have tried the following:</p>\n<pre class=\"lang-py prettyprint-override\"><code># Import the Cloud logging library\nimport google.cloud.logging\nfrom google.cloud.logging.handlers import CloudLoggingHandler\nfrom google.cloud.logging_v2.resource import Resource\n\nLOG_PROJECT = 'project_id'\nRESOURCE_TYPE = 'cloudiot_device'\nDEVICE_NUM_ID = 'iot_device_num'\nDEVICE_REGISTRY = 'registry_id'\nLOCATION = 'location'\nLOGGER_NAME = 'rpi1-script-logger'\n\nLOG_LABELS = {'project_id':LOG_PROJECT,\n              'device_num_id':DEVICE_NUM_ID,\n              'device_registry_id':DEVICE_REGISTRY,\n              'location':LOCATION}\nLOG_RESOURCE = Resource(type=RESOURCE_TYPE, labels=LOG_LABELS)\n\n# prepare a client with the google cloud logging library\nclient = google.cloud.logging.Client()\n\n# prepare a handler and attach the client and the resource\nhandler = CloudLoggingHandler(client, resource=LOG_RESOURCE)\nformatter = logging.Formatter(&quot;%(asctime)s - %(levelname)s - %(message)s&quot;,'%Y%m%d-%H:%M:%S')\nhandler.setFormatter(formatter)\n\n# initiate standard python logger and set it up\nlogger = logging.getLogger(LOGGER_NAME)\nlogger.setLevel(logging.INFO)\n# attach the handler so logs are uploaded to the cloud\nlogger.addHandler(handler)\n</code></pre>\n<p>At first I thought this solution would work, but then eventually I stopped getting logs on gcp even though the script was running. After I stopped it, it said something along the lines of &quot;trying to push X pending logs&quot; but immediately failed. It looks like it got stuck and wasn't uploading the logs, so I lost them completely as I also don't have them locally from changing the logger.</p>\n<p>As I understand it, the default cloud logging handler is background threaded transport, and I could change it to sync transport as the docs indicate so it uploads the log directly: <a href=\"https://googleapis.dev/python/logging/latest/stdlib-usage.html\" rel=\"nofollow noreferrer\">https://googleapis.dev/python/logging/latest/stdlib-usage.html</a></p>\n<p>However, I\u00b4m not sure how to change the transport. Also, I don't want the script to get stuck on trying to upload a log if the connection is lost, ad my script can continue without connection. Is there a better way to upload my device's logs to GCP? or at the very least have my logger save them both to a local file and try to upload them, this way if it gets stuck I can potentially go through my log file and upload them. I even considered saving logs locally as I always had, and have another script trying to upload them separately, but this doesn't sound like a good idea.</p>\n<p>Any ideas would be appreciated, I feel like this is an already solved problem but I don't know what that solution might be.</p>\n"
    }, {
        "tags": [
            "python",
            "set",
            "iot"
        ],
        "is_answered": false,
        "view_count": 53,
        "favorite_count": 0,
        "score": 0,
        "last_activity_date": 1615178193,
        "creation_date": 1615003129,
        "last_edit_date": 1615092501,
        "question_id": 66502225,
        "link": "https://stackoverflow.com/questions/66502225/how-can-i-create-multiple-sets-from-a-set-of-tuples",
        "title": "How can i create multiple sets from a set of tuples",
        "body": "<p>I am very new to <code>python</code> and am taking an <code>IoT</code> course this semester. Currently, we are learning about <code>sets</code>, <code>tuples</code>, and <code>dictionaries</code>.</p>\n<p>My homework assignment right now is I am given a <code>.json</code> data file with one GIANT <code>set</code> of <code>tuples</code>.</p>\n<p>Each tuple has 6 elements</p>\n<pre><code>[nodeID, dateData, temperature, humidity, pressure, precipitation] \n</code></pre>\n<p>there are 15 different <code>nodes</code> (0-14) and each node has its own <strong>^^^^^^^data^^^^^^^</strong>. I want to create a separate list for each node and make a new tuple with only <code>[nodeID, temperature, dateData]</code></p>\n<p>After the sets are made for each <code>node</code> value. I want to print the <code>max/min</code> values of each node with their corresponding dates.</p>\n<p>I don't know if I am being unclear, any help is appreciated. My code is included.</p>\n<pre><code>import json\nfrom datetime import date, timedelta, datetime\n\n\n#open .json file as &quot;weatherData&quot;\nwith open('DenverData.json', 'r') as infile:\nweatherData = json.load(infile)\n\ndataSummary = dict()\ndataSummary['number_nodes'] = 0\ndataSummary['start_date']  = 0\ndataSummary['end_date'] = 0\ndataSummary['number_days'] = 0\ndataSummary['node_temperature'] = 0\ndataSummary['node_humidity'] = 0\ndataSummary['node_pressure'] = 0\ndataSummary['node_precipitation'] = 0\ndataSummary['temperature_range'] = 0\ndataSummary['humidity_range'] = 0\ndataSummary['pressure_range'] = 0\ndataSummary['precipitation_range']  = 0\ndataSummary['extreme_dates'] = 0\n\n\n#LISTS\n\nnode_list = [nodeID for [nodeID, dateData, temperature, humidity, pressure, precipitation] in \nweatherData]\ndate_list = sorted(list(set(date_list)))\ntemp_list = [temperature for [nodeID, dateData, temperature, humidity, pressure, precipitation] in \nweatherData]\nhumidity_list = [humidity for [nodeID, dateData, temperature, humidity, pressure, precipitation] in \nweatherData]\nprecipitation_list = [precipitation for [nodeID, dateData, temperature, humidity, pressure, \nprecipitation] in weatherData]\npressure_list = [pressure for [nodeID, dateData, temperature, humidity, pressure, precipitation] in \nweatherData]\n\n#EXTREMES \nearliestDay = date_list[0]\nlatestDay = date_list[-1]\n\nmax_temp = max(temp_list)\nmin_temp = min(temp_list)\n\nmax_pressure = max(pressure_list)\nmin_pressure = min(pressure_list)\n\nmax_humidity = max(humidity_list)\nmin_humidity = min(humidity_list)\n\nmax_precipitation = max(precipitation_list)\nmin_precipitation = min(precipitation_list)\n\n\n#PRINTS\n\nprint(&quot;\\nNumber of different nodes:                              &quot;, len(set(node_list)), &quot;\\n&quot;) \n#number of sets\n\nprint(&quot;Amount of days data collected:                          &quot;, len(set(date_list))) #number of \ndays\nprint(&quot;Earliest date of Data collected:                        &quot;, earliestDay) #the earliest date\nprint(&quot;Latest date of data collected:                          &quot;, latestDay, &quot;\\n&quot;) #the latest date\n\nprint(&quot;Amount of different temperature readings:               &quot;, len(set(temp_list)))\nprint(&quot;Maximum temperature:                                    &quot;, max(temp_list), &quot;[C]&quot;) \nprint(&quot;Minimum temperature:                                   &quot;, min(temp_list), &quot;[C]\\n&quot;)\n\nprint(&quot;Amount of humidity readings:                            &quot;, len(set(humidity_list)))\nprint(&quot;Maximum Humidity:                                       &quot;, max(humidity_list), &quot;[%RH]&quot;) \nprint(&quot;Minimum Humidity:                                       &quot;, min(humidity_list), &quot;[%RH]\\n&quot;)\n\nprint(&quot;The number of different precipitation readings are:     &quot;,len(set(precipitation_list)))\nprint(&quot;Maximum Precipitation:                                  &quot;, max(precipitation_list), &quot;[in]&quot;)\nprint(&quot;Minimum Precipitation:                                  &quot;, min(precipitation_list), &quot; [in]&quot;)\n\nprint(&quot;The number of different pressure readings are:          &quot;,len(set(pressure_list)))\nprint(&quot;Maximum Pressure:                                       &quot;, max(humidity_list), &quot;[ATM]&quot;)\nprint(&quot;Minimum Pressure:                                       &quot;, min(humidity_list), &quot;[ATM]\\n&quot;)\n\n#FULL DATA PRINTS\n\nprint(&quot;Tuple syntax:\\n [NodeID, 'Date', Temperature, Humidity, Pressure[mB], Precipitation]\\n&quot;, \nweatherData[0], &quot;\\n&quot;) \nprint(&quot;The different nodes are labeled as one of the following: \\n&quot;, set(node_list), &quot;\\n&quot;) \nprint(&quot;Dates that data were collected:\\n&quot;, sorted(set(date_list)), &quot;\\n&quot;) \nprint(&quot;Temperatures that were recorded:\\n&quot;, sorted(list(set(temp_list)))) \nprint(&quot;Precipitation measurements:\\n&quot;, sorted(set(precipitation_list)))\nprint(&quot;Pressure values:\\n&quot;, sorted(set(pressure_list)))\n\n#Summary Report to json file\ndataSummary['number_nodes'] = len(set(node_list))\ndataSummary['start_date'] = date_list[-1]\ndataSummary['end_date'] = date_list[0]\ndataSummary['number_days'] = len(set(date_list))\ndataSummary['node_humidity'] = range(set(humidity_list))\ndataSummary['node_temperature'] = len(set(temp_list))\ndataSummary['node_pressure'] = len(set(pressure_list)) \ndataSummary['node_precipitation'] = len(set(precipitation_list)) \ndataSummary['temperature_range'] = max_temp, min_temp\ndataSummary['humidity_range'] = max_humidity, min_humidity\ndataSummary['pressure_range'] = max_pressure, min_pressure\ndataSummary['precipitation_range'] = max_precipitation, min_precipitation\n\n\n#PREVIEW\nprint(dataSummary)\n\n#DUMP\nwith open('denver_summary.json', 'w') as outfile:\njson.dump(dataSummary, outfile)\n</code></pre>\n"
    }, {
        "tags": [
            "lambda",
            "boto3",
            "mqtt",
            "iot"
        ],
        "is_answered": true,
        "view_count": 281,
        "favorite_count": 0,
        "score": 2,
        "last_activity_date": 1614131230,
        "creation_date": 1608301283,
        "question_id": 65358673,
        "link": "https://stackoverflow.com/questions/65358673/publish-to-topic-from-aws-lambda-stop-working",
        "title": "Publish to topic from AWS Lambda stop working",
        "body": "<p>I have a Lambda function that has been working without issue for several months.  Starting a couple of days ago, now a publish to an MQTT client always times out.  Here's the publish code:</p>\n<pre><code>    client = boto3.client('iot-data', region_name='us-east-1')\n    client.publish(topic= 'sdk/test/Python',qos=1,payload=mypayload)\n</code></pre>\n<p>From the log file:</p>\n<p><em>2020-12-18T13:57:35.652Z 6660d942-766d-419e-88d2-c09c11dd33cc Task timed out after 3.00 seconds</em></p>\n<p>The client is running on a raspberrypi.  I can publish to the topic from the Iot test console and the client running on the rpi that subscribed to the topic receives the test messages.</p>\n<p>If I subscribe to the topic using the Iot test console, messages are NOT received</p>\n<p>There's an inline policy for the lambda function for the publish:</p>\n<pre><code>{\n    &quot;Version&quot;: &quot;2012-10-17&quot;,\n    &quot;Statement&quot;: [\n        {\n            &quot;Effect&quot;: &quot;Allow&quot;,\n            &quot;Action&quot;: [\n                &quot;iot:Publish&quot;\n            ],\n            &quot;Resource&quot;: [\n                &quot;*&quot;\n            ]\n        }\n    ]\n}\n</code></pre>\n<p>How do I fix or debug this?  The 3 second timeout should be plenty long enough, so I haven't tried making it long.</p>\n"
    }, {
        "tags": [
            "embedded",
            "protocols",
            "iot",
            "paho"
        ],
        "is_answered": true,
        "view_count": 1791,
        "favorite_count": 1,
        "score": 1,
        "last_activity_date": 1613714021,
        "creation_date": 1423737977,
        "last_edit_date": 1444714185,
        "question_id": 28475437,
        "link": "https://stackoverflow.com/questions/28475437/what-is-the-difference-between-iot-and-m2m",
        "title": "What is the difference between IoT and M2M?",
        "body": "<p>There is a sentence in Eclipse Paho Project website such as;\n\"The Paho project provides scalable open-source client implementations of open and standard messaging protocols aimed at new, existing, and emerging applications for <strong>Machine\u2011to\u2011Machine (M2M)</strong> and <strong>Internet of Things (IoT)</strong>.\"</p>\n\n<p>I am confused a little bit. What is the difference between IoT and M2M?</p>\n"
    }, {
        "tags": [
            "amazon-web-services",
            "authentication",
            "authorization",
            "iot",
            "pem"
        ],
        "is_answered": false,
        "view_count": 12,
        "favorite_count": 0,
        "score": 0,
        "last_activity_date": 1613502573,
        "creation_date": 1613502573,
        "question_id": 66230686,
        "link": "https://stackoverflow.com/questions/66230686/pem-file-for-every-aws-iot-device",
        "title": "PEM file for every AWS IoT device?",
        "body": "<p>I have a policy which allows connections and pub / sub for specific topics. I then create a Certificate and attach the policy.</p>\n<p>I can successfully connect, publish, and subscribe to the MQTT endpoint using the Node SDK.</p>\n<p>Now, I have 1,000,000 + devices that will get the appropriate SDK and start sending data. How do I scale the auth model? Does each device need it's own PEM file?</p>\n"
    }, {
        "tags": [
            "node.js",
            "reactjs",
            "mqtt",
            "iot"
        ],
        "is_answered": true,
        "view_count": 109,
        "favorite_count": 0,
        "score": -1,
        "last_activity_date": 1612799972,
        "creation_date": 1607851590,
        "last_edit_date": 1607851851,
        "question_id": 65274093,
        "link": "https://stackoverflow.com/questions/65274093/connecting-reactjs-to-myqtthub",
        "title": "Connecting Reactjs to Myqtthub",
        "body": "<p>Hello I'm new to all this IOT thing and I want to be able to send and receive data from an Arduino via mqtt using <a href=\"https://myqtthub.com\" rel=\"nofollow noreferrer\">https://myqtthub.com</a> as our broker.  I used the following code in order to connect:</p>\n<pre><code>import React, { Component } from 'react';\n\nvar mqtt = require('mqtt');\n\nvar options={\n    clientId:&quot;mqttjs01&quot;,\n    username:&quot;user&quot;,\n    password:&quot;password&quot;,\n    clean:true};\n    var client = mqtt.connect(&quot;mqtt://node02.myqtthub.com&quot;,options)\n\nclient.on('connect', () =&gt; {\n    alert('Connected!');\n   \n    console.log('Connected');\n});\n\n\n\n\nclass Garage extends Component {\n   \n   \n    render() {\n        return (\n            &lt;div&gt;\n                &lt;h1&gt;HEllooo&lt;/h1&gt;\n            &lt;/div&gt;\n        );\n    }\n}\n\nexport default Garage;\n</code></pre>\n<p>I'm having the error:\n&quot;WebSocket connection to 'ws://node02.myqtthub.com/' failed: Error during WebSocket handshake: Unexpected response code: 301&quot;</p>\n<p>Any help will be appreciated.</p>\n"
    }, {
        "tags": [
            "json",
            "mqtt",
            "iot",
            "fiware",
            "lora"
        ],
        "is_answered": true,
        "view_count": 665,
        "favorite_count": 0,
        "score": 0,
        "last_activity_date": 1612556634,
        "creation_date": 1517907237,
        "last_edit_date": 1517909714,
        "question_id": 48638932,
        "link": "https://stackoverflow.com/questions/48638932/send-lora-measures-to-fiware-iot-agent-via-mqtt",
        "title": "Send LoRa measures to Fiware IOT agent via MQTT",
        "body": "<p>I have LoRa sensors which send measures with Cayenne LPP format payload.\nMy Gateway(LOrank8v1) catches these packets and converts them to UDP.\nIn the gateway there is a service(lora-gateway-bridge) which converts the packets from UDP to TCP/MQTT.</p>\n\n<p>Then the MQTT packets are published to the mosquitto MQTT broker in the cloud.\nThen i run lora-server and lora-app-server services in order to decrypt,decode and deduplicate the packets.</p>\n\n<p>Then i publish the decrypted information to the MQTT broker again.\nHere is an example of a publication after all these operations:\napplication/1/node/0000000000000000/rx </p>\n\n<pre><code>{\n \"applicationID\":\"1\",\n  \"applicationName\":\"Temperature-Humidity\",\n  \"deviceName\":\"Temperature-Humidity\",\n  \"devEUI\":\"0000000000000  000\",\n  \"rxInfo\":[\n    {\n      \"mac\":\"1dee18c14948a955\",\n      \"rssi\":-27,\n      \"loRaSNR\":9.5,\n      \"name\":\"1dee18  c14948a955\",\n      \"latitude\":0,\n      \"longitude\":0,\n      \"altitude\":0\n    }\n  ],\n  \"txInfo\": {\n    \"frequency\":8685  00000,\n    \"dataRate\": {\n      \"modulation\":\"LORA\",\n      \"bandwidth\":125,\n      \"spreadFactor\":9\n    },\n    \"adr\":false,\n    \"codeRate\":\"4/5\"\n  },\n  \"fCnt\":2,\n  \"fPort\":1,\n  \"data\":\"AGcAxQFojA==\",\n  \"object\": {\n    \"temperatureSensor\": {\n      \"0\":19.7\n    },\n    \"humiditySensor\": {\n      \"1\":70\n    }\n  }\n}\n</code></pre>\n\n<p>Now i want to use Fiware's JSON/MQTT IOT agent to convert MQTT to NGSI in order to publish data to the Context Broker. </p>\n\n<p>The data should be publised like this to be readable :</p>\n\n<pre><code>$ mosquitto_pub -h $HOST_IOTAGENT_MQTT -u theUser -P thePassword -t /myapikey/mydevicemqtt/attrs -m '{ \"t\": 19,7, \"h\": 70}'\n</code></pre>\n\n<p>Has anyone the same problem?\nShould i make a JSON parser and republish the data to another format into the MQTT Broker?\nHow could i deal with this problem?</p>\n"
    }, {
        "tags": [
            "javascript",
            "reactjs",
            "mqtt",
            "iot"
        ],
        "is_answered": false,
        "view_count": 166,
        "favorite_count": 0,
        "score": 1,
        "last_activity_date": 1612523015,
        "creation_date": 1612520754,
        "question_id": 66061547,
        "link": "https://stackoverflow.com/questions/66061547/connecting-reactjs-project-to-mqtt-using-myqtthub",
        "title": "Connecting Reactjs project to mqtt using MyQttHub",
        "body": "<p>I need some help in connecting my react project to myqtt hub to publish and receive data. this is the code I'm using:</p>\n<pre><code>import React, { Component } from 'react';\n\nvar mqtt = require('mqtt');\n\nvar options={\n    clientId:&quot;id&quot;,\n    username:&quot;ArduinoProject&quot;,\n    password:&quot;ssssss&quot;,\n    protocolId: &quot;MQTT&quot;,\n    protocolVersion: 4,\n  \n     port : 1883 ,\n    clean:true};\n    var client = mqtt.connect(&quot;mqtt://node02.myqtthub.com/&quot;,options)\n\nclient.on('connect', () =&gt; {\n    alert('Connected!');\n   \n    console.log('Connected');\n});\n\nclient.publish('testingfromnode','Dou You see mee?');\n\nconsole.log(client.clientId);\nconsole.log(JSON.stringify(client.options));\n\n\nclass Garage extends Component {\n   \n   \n    render() {\n        return (\n            &lt;div&gt;\n                &lt;h1&gt;HEllooo&lt;/h1&gt;\n            &lt;/div&gt;\n        );\n    }\n}\n\nexport default Garage;\n\n</code></pre>\n<p>For some reason I'm having an error saying: <em>WebSocket connection to 'ws://node02.myqtthub.com:1883/' failed: Connection closed before receiving a handshake response.</em></p>\n<p>The HTML I wrote is appearing however I'm not able to connect to the mqtt broker.</p>\n"
    }, {
        "tags": [
            "mqtt",
            "iot"
        ],
        "is_answered": false,
        "view_count": 39,
        "favorite_count": 0,
        "score": 0,
        "last_activity_date": 1611416295,
        "creation_date": 1611414050,
        "question_id": 65860686,
        "link": "https://stackoverflow.com/questions/65860686/how-to-manipulate-modify-mqtt-msgs",
        "title": "How to manipulate/modify MQTT msgs?",
        "body": "<p>MQTT is a very well known standard protocol, however there is no standard for the payload structure of the msgs.</p>\n<p>I have a MQTT broker works with payload in a format like that: <strong>{&quot;value&quot;: &quot;ON&quot;}</strong>\nThe Device works with payload in a different format like that <strong>{&quot;ON&quot;}</strong></p>\n<p>I need a way to add    the &quot;value:&quot; on the msgs coming from the device.\nI need a way to remove the &quot;value:&quot; on the msgs coming from the broker.</p>\n<p>How could I manipulate or edit the msgs from the device to make them understandable by the broker?\nI would need an &quot;intermediary broker&quot; doing this manipulation I imagine</p>\n<p>Which options would you recommend? Thanks.</p>\n"
    }, {
        "tags": [
            "ssl",
            "iot",
            "esp8266",
            "client-certificates",
            "aws-iot"
        ],
        "is_answered": false,
        "view_count": 115,
        "favorite_count": 0,
        "score": 1,
        "last_activity_date": 1610996158,
        "creation_date": 1610996158,
        "question_id": 65780493,
        "link": "https://stackoverflow.com/questions/65780493/how-long-do-the-certificates-generated-on-aws-iot-core-last",
        "title": "How long do the certificates generated on AWS IoT Core last?",
        "body": "<p>I was working on my project using esp8266 and AWS IoT Core, but while running the program it shows the following error related to the certificate in the serial monitor...</p>\n<pre><code>Attempting MQTT connection...failed, rc=-2 try again in 5 seconds\nWiFiClientSecure SSL error: Chain could not be linked to a trust anchor.\n\nAttempting MQTT connection...failed, rc=-2 try again in 5 seconds\nWiFiClientSecure SSL error: Chain could not be linked to a trust anchor.\n\nAttempting MQTT connection...failed, rc=-2 try again in 5 seconds\nWiFiClientSecure SSL error: Chain could not be linked to a trust anchor.\n\nAttempting MQTT connection...failed, rc=-2 try again in 5 seconds\nWiFiClientSecure SSL error: Chain could not be linked to a trust anchor.\n\nAttempting MQTT connection...failed, rc=-2 try again in 5 seconds\nWiFiClientSecure SSL error: Chain could not be linked to a trust anchor.\n\nAttempting MQTT connection...failed, rc=-2 try again in 5 seconds\nWiFiClientSecure SSL error: Chain could not be linked to a trust anchor.\n\nAttempting MQTT connection...failed, rc=-2 try again in 5 seconds\nWiFiClientSecure SSL error: Chain could not be linked to a trust anchor.\n\nAttempting MQTT connection...failed, rc=-2 try again in 5 seconds\nWiFiClientSecure SSL error: Chain could not be linked to a trust anchor.\n</code></pre>\n<p>At times it also shows that the certificate has expired for some reason, and I end up making a new one every 2 months. Can someone pls help solve this issue?</p>\n<p>Is there a limit to when the certificates last?</p>\n"
    }, {
        "tags": [
            "javascript",
            "websocket",
            "iot"
        ],
        "is_answered": true,
        "view_count": 127,
        "favorite_count": 1,
        "score": 0,
        "last_activity_date": 1610032491,
        "creation_date": 1608908118,
        "question_id": 65449143,
        "link": "https://stackoverflow.com/questions/65449143/sending-data-as-binary-via-websockets-encodes-numbers-as-text",
        "title": "Sending data as binary via websockets encodes numbers as text",
        "body": "<p>I'm working on a project where I'll be sending binary data across a websocket connection to an LED matrix. I want to send the binary data in the form of a byte array, e.g. drawing a diagonal line from right to left on the matrix would look like this:</p>\n<pre><code>0b00000001\n0b00000010\n0b00000100\n0b00001000\n0b00010000\n0b00100000\n0b01000000\n0b10000000\n</code></pre>\n<p>The problem that I run into when I try to do this is that when I try to send this data, regardless of the websocket client tester I use, the numbers get encoded as strings.</p>\n<p>That is, when I try to send the binary number <code>1</code>, instead of sending a <code>0x01</code>, the socket client sends a <code>49</code> in decimal/<code>0x31</code> in hex which is the character code for the string <code>'1'</code> in ascii or unicode.</p>\n<p><a href=\"https://i.stack.imgur.com/rd21B.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/rd21B.png\" alt=\"enter image description here\" /></a>\n<a href=\"https://i.stack.imgur.com/gsfJB.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/gsfJB.png\" alt=\"enter image description here\" /></a></p>\n<p>At first I thought this issue was on the arduino side in the code that's driving the matrix, but then I traced it back through the websocket server and all of the way to the testing clients. If I pop up wireshark and look at the data in flight from the client to the server, the encoding happens at the client, i.e. the first part of the websocket transmission.</p>\n<p><a href=\"https://i.stack.imgur.com/HJESD.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/HJESD.jpg\" alt=\"wireshark analysis\" /></a></p>\n<p>I thought this may be me just using Firecamp wrong, but the same thing happens when using a different client, in this case <code>websocat</code>:</p>\n<p><a href=\"https://i.stack.imgur.com/w16Eu.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/w16Eu.jpg\" alt=\"websocat test\" /></a></p>\n<p>So, my question is: what is the proper way of sending binary numbers via websockets? Am I just misunderstanding how the binary feature is supposed to work, like is it expected that I send my numbers as strings and convert them back to numbers on the other side?</p>\n"
    }, {
        "tags": [
            "mqtt",
            "iot",
            "influxdb",
            "telegraf"
        ],
        "is_answered": true,
        "view_count": 2907,
        "favorite_count": 0,
        "score": 1,
        "last_activity_date": 1609428380,
        "creation_date": 1593293508,
        "last_edit_date": 1593333245,
        "question_id": 62615769,
        "link": "https://stackoverflow.com/questions/62615769/can-we-nicely-convert-mqtt-topic-descriptions-into-influxdb-tags-using-the-mqtt",
        "title": "Can we nicely convert MQTT topic descriptions into InfluxDB tags, using the mqtt_consumer Telegraf input plugin?",
        "body": "<p>I am publishing data to MQTT topics with the Mosquitto broker, and am trying to pipe the data points through to my InfluxDB database. Currently I am trying to do this using the <a href=\"https://github.com/influxdata/telegraf/tree/master/plugins/inputs/mqtt_consumer\" rel=\"nofollow noreferrer\">mqtt_consumer</a> input plugin for Telegraf.</p>\n<p>A simplified version of my telegraf.conf file looks like this:</p>\n<pre><code># Global Agent Configuration\n[agent]\n  interval = &quot;1m&quot;\n\n# Input Plugins \n[[inputs.mqtt_consumer]]\n  name_prefix = &quot;sensors_&quot;\n  servers = [&quot;localhost:1883&quot;]\n  qos = 0\n  connection_timeout = &quot;30s&quot;\n  topics = [\n    &quot;/inside/kitchen/temperature&quot;\n  ]\n  persistent_session = false\n  data_format = &quot;value&quot;\n  data_type = &quot;float&quot;\n\n# Output Plugins\n[[outputs.influxdb]]\n  database = &quot;telegraf&quot;\n  urls = [ &quot;http://localhost:8086&quot; ]\n</code></pre>\n<p>Now, I can manually publish a data point using MQTT via the following:</p>\n<p><code> ~ $ mosquitto_pub -d -t /inside/kitchen/temperature -m 23.5</code></p>\n<p>where I have used the MQTT topic /inside/kitchen/temperature and a value of 23.5.</p>\n<p>Examining my InfluxDB database, I see the following data points:</p>\n<pre><code>name: sensors_mqtt_consumer\ntime                 topic                        value\n----                 -----                        -----\n2020-06-27T20:08:50  /inside/kitchen/temperature  23.5\n2020-06-27T20:08:40  /inside/kitchen/temperature  23.5\n</code></pre>\n<p>Is there any way that I can use the MQTT topic name description to properly allocate Influx tags? For example, I would like something like:</p>\n<pre><code>name: temperature\ntime                location  room     value\n----                -----     -----    -----\n2020-06-27T20:08:50 inside    kitchen  23.5\n2020-06-27T20:08:40 inside    kitchen  23.5\n</code></pre>\n<p>Is there a way to do this with the InfluxDB/Mosquitto/Telegraf configurations? Later I will be adding more topics (locations, etc) and measurements (humidity, voltage, etc), so the solution should allow for this.</p>\n<p>(I know that this can be done by by choosing <code>data_format = &quot;influx&quot;</code> as described <a href=\"https://github.com/influxdata/telegraf/tree/master/plugins/parsers/influx\" rel=\"nofollow noreferrer\">here</a>, where Telegraf interprets the message as InfluxDB line protocol and passes it through directly. However, then I would have to publish to the topic in this way:</p>\n<p><code>mosquitto_pub -d -t /inside/kitchen/temperature -m &quot;temperature,location=inside,room=kitchen value=23.5&quot;</code></p>\n<p>where you can see that most of the information has been input twice, even though it already existed. The same can be said for the data_format=&quot;json&quot; option. What I need is more of a mapping).</p>\n"
    }, {
        "tags": [
            "python",
            "django",
            "mqtt",
            "iot",
            "paho"
        ],
        "is_answered": false,
        "view_count": 58,
        "favorite_count": 1,
        "score": 0,
        "last_activity_date": 1609176297,
        "creation_date": 1609176297,
        "question_id": 65481500,
        "link": "https://stackoverflow.com/questions/65481500/mqtt-inside-django-application-vs-mqtt-as-script-in-django-application",
        "title": "MQTT inside django application vs MQTT as script in django application?",
        "body": "<p>i want to initialize a mqtt client in a django application and i just want to have one client that will subscribe on more than one topic and each topic will have it's own callback.then i will put this application in the INSTALLED_APPS settings in django application.\n<strong>my question :</strong>\nIs the above scenario applicable ? as django run on multiple threads in production , and i'm afraid that the mqtt client will be loaded more than one time and the callbacks will be done more than one time? or it's better to put the mqtt as a script outside the django application and just load the django environment ?</p>\n"
    }, {
        "tags": [
            "python-3.x",
            "ssl-certificate",
            "mqtt",
            "iot",
            "paho"
        ],
        "is_answered": true,
        "view_count": 24647,
        "favorite_count": 1,
        "score": 1,
        "last_activity_date": 1609118827,
        "creation_date": 1534832992,
        "last_edit_date": 1609118827,
        "question_id": 51942821,
        "link": "https://stackoverflow.com/questions/51942821/how-to-use-ssl-tls-in-paho-mqtt-using-python-i-got-certificate-verify-failed",
        "title": "How to use ssl/tls in paho mqtt using python? I got certificate verify failed",
        "body": "<p>I am working on an IOT project. I am using paho MQTT, and I need to use SSL. I wrote publish code using python, but I got an error in &quot;certificate  verify failed&quot;.</p>\n<p>MY PUBLISHING CODE</p>\n<pre><code>import time\nimport paho.mqtt.client as paho\nimport ssl\nimport certifi\n#define callback\ndef on_message(client, userdata, message):\n  time.sleep(1)\n  print(&quot;received message =&quot;,str(message.payload.decode(&quot;utf-8&quot;)))\n\nclient= paho.Client(&quot;client-001&quot;) \nclient.on_message=on_message\nprint(&quot;connecting to broker &quot;,)\nclient.tls_set(&quot;C:/Windows/system32/config/systemprofile/Desktop/attachments/server iot.crt&quot;, tls_version=ssl.PROTOCOL_TLSv1_2)\nclient.tls_insecure_set(True)\nclient.connect(&quot;iot.eclipse.org&quot;, 8883, 60)\ndef on_log(client, userdata, level, buf):\n  print(&quot;log: &quot;,buf)#connect\nclient.loop_start() #start loop to process received messages\nprint(&quot;publishing &quot;)\nclient.publish(&quot;$SYS/muthu&quot;,&quot;muthupavithran&quot;,)#publish\nclient.on_log=on_log\nclient.loop_forever()\n#client.loop(100)\n</code></pre>\n<p>MY ERROR IS</p>\n<pre><code>connecting to broker \nTraceback (most recent call last):\n  File &quot;C:\\Windows\\system32\\config\\systemprofile\\Desktop\\attachments\\publishTEST WITH LOG.py&quot;, line 14, in &lt;module&gt;\nclient.connect(&quot;iot.eclipse.org&quot;, 8883, 60)\nFile &quot;C:\\Python34\\lib\\site-packages\\paho\\mqtt\\client.py&quot;, line 768, in connect\nreturn self.reconnect()\nFile &quot;C:\\Python34\\lib\\site-packages\\paho\\mqtt\\client.py&quot;, line 927, in reconnect\nsock.do_handshake()\nFile &quot;C:\\Python34\\lib\\ssl.py&quot;, line 810, in do_handshake\nself._sslobj.do_handshake()\nssl.SSLError: [SSL: CERTIFICATE_VERIFY_FAILED] certificate verify failed (_ssl.c:600)\n</code></pre>\n<p>MY CERTIFICATE IS</p>\n<pre><code>OpenSSL&gt; s_client -showcerts -connect iot.eclipse.org:8883\nCONNECTED(00000108)\ndepth=1 C = US, O = Let's Encrypt, CN = Let's Encrypt Authority X3\nverify error:num=20:unable to get local issuer certificate\n---\nCertificate chain\n0 s:/CN=iot.eclipse.org\ni:/C=US/O=Let's Encrypt/CN=Let's Encrypt Authority X3\n-----BEGIN CERTIFICATE-----\nMIIGCjCCBPKgAwIBAgISBMZjyLzHsZWasgIDta0fSCB+MA0GCSqGSIb3DQEBCwUA\nMEoxCzAJBgNVBAYTAlVTMRYwFAYDVQQKEw1MZXQncyBFbmNyeXB0MSMwIQYDVQQD\nExpMZXQncyBFbmNyeXB0IEF1dGhvcml0eSBYMzAeFw0xODA3MDIxMzQzMDJaFw0x\nODA5MzAxMzQzMDJaMBoxGDAWBgNVBAMTD2lvdC5lY2xpcHNlLm9yZzCCASIwDQYJ\nKoZIhvcNAQEBBQADggEPADCCAQoCggEBAJceipGv0SJrWNG5cLQMjDpCWFi57bw1\nDRM57lbt+g4o/CPOYQJsJxJCDzWBK1kTYzA7udIt6M5LyQikyiMTLBAqkxfGgbul\nErmMfVXtZbqIda1L5L0SYNoVrMsBeqzyXJoC6Hf7nxidzkZkX99JBQBXWnMFycwk\na1uobIKR/RDbsIun62WYXD4q7H8oH4zKvbOGKCZCoBrQIIhKYhxL+UFJuQyUEm4R\n9JNyMAetCQglerohRkzvDTVhjSLiOWGDkjDBg9HWEwB1talaQ7fLb7WxfZTmSDTv\nCPpI1aGdPwbifvzJS+zX9nbcQavGea/onW8KIAFXxwH6tsyiTwvFzj8CAwEAAaOC\nAxgwggMUMA4GA1UdDwEB/wQEAwIFoDAdBgNVHSUEFjAUBggrBgEFBQcDAQYIKwYB\nBQUHAwIwDAYDVR0TAQH/BAIwADAdBgNVHQ4EFgQUOuN0Niv8dMef7kpmZSdN2sn0\nsnUwHwYDVR0jBBgwFoAUqEpqYwR93brm0Tm3pkVl7/Oo7KEwbwYIKwYBBQUHAQEE\nYzBhMC4GCCsGAQUFBzABhiJodHRwOi8vb2NzcC5pbnQteDMubGV0c2VuY3J5cHQu\nb3JnMC8GCCsGAQUFBzAChiNodHRwOi8vY2VydC5pbnQteDMubGV0c2VuY3J5cHQu\nb3JnLzAaBgNVHREEEzARgg9pb3QuZWNsaXBzZS5vcmcwgf4GA1UdIASB9jCB8zAI\nBgZngQwBAgEwgeYGCysGAQQBgt8TAQEBMIHWMCYGCCsGAQUFBwIBFhpodHRwOi8v\nY3BzLmxldHNlbmNyeXB0Lm9yZzCBqwYIKwYBBQUHAgIwgZ4MgZtUaGlzIENlcnRp\nZmljYXRlIG1heSBvbmx5IGJlIHJlbGllZCB1cG9uIGJ5IFJlbHlpbmcgUGFydGll\ncyBhbmQgb25seSBpbiBhY2NvcmRhbmNlIHdpdGggdGhlIENlcnRpZmljYXRlIFBv\nbGljeSBmb3VuZCBhdCBodHRwczovL2xldHNlbmNyeXB0Lm9yZy9yZXBvc2l0b3J5\nLzCCAQUGCisGAQQB1nkCBAIEgfYEgfMA8QB2ACk8UZZUyDlluqpQ/FgH1Ldvv1h6\nKXLcpMMM9OVFR/R4AAABZFtya8kAAAQDAEcwRQIhALOwNsLvVmEUlXCZP2IcTemC\nuktD+IbcCi9Ndkui59GTAiBuA4iy90SfNeyt/1eHardV7rxMe8DxwCYtBdRrzmh0\nsgB3AFWB1MIWkDYBSuoLm1c8U/DA5Dh4cCUIFy+jqh0HE9MMAAABZFtybAQAAAQD\nAEgwRgIhAK5rIXo4d8L2muH8pt5V51aLhbs15RzYWdqVxGwcpG/DAiEAmagg9e/c\nO2Jsbdz7ZBeEwogOYZvRij2U3VOJA42VADkwDQYJKoZIhvcNAQELBQADggEBAIvc\nKIllapMu9oXqZZ1iKo9fMyxVsuLP5Lo6hjJFsZMFoVZQSguGoT9CsFvuw0QeqObg\nxbk1y+ZeEaSYI5Gf8iHlGHq4M9zGLLUvPBbCpzy4grQTjFBQvPzH0c7qrWKPYge2\nWcCox2ofvBaJ9LSOzc82vqLnkAWwnaLelk3+SlOYcrZP2me6JCQWpSRFec4p/42t\n94Yvojgj5RKY6jhA6aNG3AFBSJiwgU36UZ1H3c82L0X/djOQbFGKWFaQ956s2AoY\nDmf+tdtj2AFCM7Ht8YdN6VxWlI/1hctK0TaF/4UrTEJ4n2ChTe9F8EP2exO/VcC7\nV/jDTid21vBdhF2mQis=\n-----END CERTIFICATE-----\n 1 s:/C=US/O=Let's Encrypt/CN=Let's Encrypt Authority X3\n   i:/O=Digital Signature Trust Co./CN=DST Root CA X3\n-----BEGIN CERTIFICATE-----\nMIIEkjCCA3qgAwIBAgIQCgFBQgAAAVOFc2oLheynCDANBgkqhkiG9w0BAQsFADA/\nMSQwIgYDVQQKExtEaWdpdGFsIFNpZ25hdHVyZSBUcnVzdCBDby4xFzAVBgNVBAMT\nDkRTVCBSb290IENBIFgzMB4XDTE2MDMxNzE2NDA0NloXDTIxMDMxNzE2NDA0Nlow\nSjELMAkGA1UEBhMCVVMxFjAUBgNVBAoTDUxldCdzIEVuY3J5cHQxIzAhBgNVBAMT\nGkxldCdzIEVuY3J5cHQgQXV0aG9yaXR5IFgzMIIBIjANBgkqhkiG9w0BAQEFAAOC\nAQ8AMIIBCgKCAQEAnNMM8FrlLke3cl03g7NoYzDq1zUmGSXhvb418XCSL7e4S0EF\nq6meNQhY7LEqxGiHC6PjdeTm86dicbp5gWAf15Gan/PQeGdxyGkOlZHP/uaZ6WA8\nSMx+yk13EiSdRxta67nsHjcAHJyse6cF6s5K671B5TaYucv9bTyWaN8jKkKQDIZ0\nZ8h/pZq4UmEUEz9l6YKHy9v6Dlb2honzhT+Xhq+w3Brvaw2VFn3EK6BlspkENnWA\na6xK8xuQSXgvopZPKiAlKQTGdMDQMc2PMTiVFrqoM7hD8bEfwzB/onkxEz0tNvjj\n/PIzark5McWvxI0NHWQWM6r6hCm21AvA2H3DkwIDAQABo4IBfTCCAXkwEgYDVR0T\nAQH/BAgwBgEB/wIBADAOBgNVHQ8BAf8EBAMCAYYwfwYIKwYBBQUHAQEEczBxMDIG\nCCsGAQUFBzABhiZodHRwOi8vaXNyZy50cnVzdGlkLm9jc3AuaWRlbnRydXN0LmNv\nbTA7BggrBgEFBQcwAoYvaHR0cDovL2FwcHMuaWRlbnRydXN0LmNvbS9yb290cy9k\nc3Ryb290Y2F4My5wN2MwHwYDVR0jBBgwFoAUxKexpHsscfrb4UuQdf/EFWCFiRAw\nVAYDVR0gBE0wSzAIBgZngQwBAgEwPwYLKwYBBAGC3xMBAQEwMDAuBggrBgEFBQcC\nARYiaHR0cDovL2Nwcy5yb290LXgxLmxldHNlbmNyeXB0Lm9yZzA8BgNVHR8ENTAz\nMDGgL6AthitodHRwOi8vY3JsLmlkZW50cnVzdC5jb20vRFNUUk9PVENBWDNDUkwu\nY3JsMB0GA1UdDgQWBBSoSmpjBH3duubRObemRWXv86jsoTANBgkqhkiG9w0BAQsF\nAAOCAQEA3TPXEfNjWDjdGBX7CVW+dla5cEilaUcne8IkCJLxWh9KEik3JHRRHGJo\nuM2VcGfl96S8TihRzZvoroed6ti6WqEBmtzw3Wodatg+VyOeph4EYpr/1wXKtx8/\nwApIvJSwtmVi4MFU5aMqrSDE6ea73Mj2tcMyo5jMd6jmeWUHK8so/joWUoHOUgwu\nX4Po1QYz+3dszkDqMp4fklxBwXRsW10KXzPMTZ+sOPAveyxindmjkW8lGy+QsRlG\nPfZ+G6Z6h7mjem0Y+iWlkYcV4PIWL1iwBi8saCbGS5jN2p8M+X+Q7UNKEkROb3N6\nKOqkqm57TH2H3eDJAkSnh6/DNFu0Qg==\n-----END CERTIFICATE-----\n---\nServer certificate\nsubject=/CN=iot.eclipse.org\nissuer=/C=US/O=Let's Encrypt/CN=Let's Encrypt Authority X3\n---\nNo client certificate CA names sent\nPeer signing digest: SHA512\nServer Temp Key: ECDH, P-256, 256 bits\n---\nSSL handshake has read 3397 bytes and written 302 bytes\nVerification error: unable to get local issuer certificate\n---\nNew, TLSv1.2, Cipher is ECDHE-RSA-AES256-GCM-SHA384\nServer public key is 2048 bit\nSecure Renegotiation IS supported\nCompression: NONE\nExpansion: NONE\nNo ALPN negotiated\nSSL-Session:\nProtocol  : TLSv1.2\nCipher    : ECDHE-RSA-AES256-GCM-SHA384\nSession-ID: 8B1F036E44D23BD9F8CB52355705726639BE769B681154D1448EB4B264EE2F43\n\nSession-ID-ctx:\nMaster-Key: 538D0967D0732F7A758317E764D2550E3C1330C1192353A89E99C3E66F4B5A51\n485BB4ABF8434D23398CF84615DF54CF\n    PSK identity: None\n    PSK identity hint: None\n    SRP username: None\n    TLS session ticket lifetime hint: 300 (seconds)\n    TLS session ticket:\n    0000 - d7 03 bf d1 ff 2b f7 6c-1a b3 56 ec 3a dc 8b 19   \n.....+.l..V.:...\n    0010 - 9d 73 05 08 66 15 f3 bd-46 55 30 a0 1a e1 ca 07   .s..f...FU0.....\n    0020 - 06 14 08 43 41 8e 64 1e-55 97 17 be 24 a3 a1 10   ...CA.d.U...$...\n    0030 - 51 9b be c0 05 67 81 b9-e2 12 4c 80 bc 42 ed 9d   Q....g....L..B..\n    0040 - 89 7a bf 9a 02 1a d6 35-07 39 6d ce 9c 8c dd cf   .z.....5.9m.....\n   0050 - e2 0f f4 0f 3b e5 83 ec-2c 8d 54 bc 60 97 a1 c6   ....;...,.T.`...\n   0060 - 9c c0 78 e1 1c 28 9f 38-c7 0b d9 7b ad 2a 9e 69   ..x..(.8...{.*.i\n0070 - af ef 2f 1b 2d e2 f9 8a-04 7a 6c 88 c8 28 14 8c   ../.-....zl..(..\n0080 - ac 7a 11 11 fa 94 0a 63-45 70 e8 a9 3f fb 8d be   .z.....cEp..?...\n0090 - df 9e 3c 15 20 6d 48 fe-40 d2 4f 28 58 49 a9 1b   ..&lt;. mH.@.O(XI..\n00a0 - e7 1d de 1e ae f3 bc 57-79 0d e6 f5 5d 93 62 17   .......Wy...].b.\n\nStart Time: 1534843470\nTimeout   : 7200 (sec)\nVerify return code: 20 (unable to get local issuer certificate)\nExtended master secret: no\n---\n</code></pre>\n<p>I got this certificate and I tried to install certifi also into python, but still the same error is showing.</p>\n"
    }, {
        "tags": [
            "java",
            "amazon-web-services",
            "iot",
            "aws-iot",
            "disconnect"
        ],
        "is_answered": false,
        "view_count": 433,
        "favorite_count": 0,
        "score": 0,
        "last_activity_date": 1608813273,
        "creation_date": 1608295371,
        "last_edit_date": 1608813273,
        "question_id": 65357282,
        "link": "https://stackoverflow.com/questions/65357282/aws-java-iot-client-reconnections-and-timeouts",
        "title": "AWS JAVA IoT client reconnections and timeouts",
        "body": "<p>I use IoT Rules on CONNECTED/DISCONNECTED topic (from <a href=\"https://docs.aws.amazon.com/iot/latest/developerguide/iot-lambda-rule.html\" rel=\"nofollow noreferrer\">here</a>). So I want to get email when a device is connected or disconnected. On my device I run next code on startup (only on startup):</p>\n<pre><code>iotClient = new AWSIotMqttClient(Configuration.IOT_CLIENT_ENDPOINT,\n                    deviceId,\n                    keyStore,\n                    keystorePass);\n            \niotClient.setKeepAliveInterval(1200000); //20 minutes (maximum)\niotClient.connect();\n</code></pre>\n<p>But I get very strange behavior. I have 3 devices, and on each device I get this stacktrace but due to different reasons:</p>\n<pre><code>[pool-8-thread-1] com.amazonaws.services.iot.client.core.AwsIotConnection.onConnectionSuccess Connection successfully established\n[pool-8-thread-1] com.amazonaws.services.iot.client.core.AbstractAwsIotClient.onConnectionSuccess Client connection active: &lt;client ID&gt;\n[pool-8-thread-1] com.amazonaws.services.iot.client.core.AwsIotConnection.onConnectionFailure Connection temporarily lost\n[pool-8-thread-1] com.amazonaws.services.iot.client.core.AbstractAwsIotClient.onConnectionFailure Client connection lost: &lt;client ID&gt;\n[pool-8-thread-1] com.amazonaws.services.iot.client.core.AwsIotConnection$1.run Connection is being retried\n[pool-8-thread-1] com.amazonaws.services.iot.client.core.AwsIotConnection.onConnectionSuccess Connection successfully established\n[pool-8-thread-1] com.amazonaws.services.iot.client.core.AbstractAwsIotClient.onConnectionSuccess Client connection active: &lt;client ID&gt;\n</code></pre>\n<p>Sometimes I get this stacktrace due to DUPLICATE_CLIENTID disconnection reason, or sometimes due to MQTT_KEEP_ALIVE_TIMEOUT disconnection reason (MQTT_KEEP_ALIVE_TIMEOUT happens every 30-35 minutes, DUPLICATE_CLIENTID happens every 10 minutes)</p>\n<p>So, I don't understand why do I need to deal with DUPLICATE_CLIENTID if <strong>each client has a unique ID</strong>, and to deal with MQTT_KEEP_ALIVE_TIMEOUT if <strong>there no an intermittent connectivity issue</strong> (I get logs every minute to my server, so it isn't WIFI/internet issue). I use the latest AWS IoT SDK from here - <a href=\"https://github.com/aws/aws-iot-device-sdk-java\" rel=\"nofollow noreferrer\">https://github.com/aws/aws-iot-device-sdk-java</a>.</p>\n<p>How can I solve these issues?</p>\n<p><strong>MY TRICKY SOLUTION:</strong></p>\n<p>I added a scheduled thread that sends empty messages to topic - ${iot:Connection.Thing.ThingName}/ping every 20 minutes:</p>\n<pre><code>scheduledExecutor.scheduleAtFixedRate(() -&gt; {\n    try {\n        iotClient.publish(String.format(Configuration.PING_TOPIC, deviceId), AWSIotQos.QOS0, &quot;&quot;);\n    } catch (AWSIotException e) {\n        LOGGER.error(&quot;Failed to send ping&quot;, e);\n    }\n}, Configuration.PING_INITIAL_DELAY_IN_MINUTES, Configuration.PING_PERIOD_IN_MINUTES, TimeUnit.MINUTES);\n</code></pre>\n<p>So this solution solves inactive issue, but I still want to find a more elegant solution...</p>\n"
    }, {
        "tags": [
            "c#",
            "azure",
            "iot",
            "azure-iot-hub"
        ],
        "is_answered": true,
        "view_count": 126,
        "favorite_count": 1,
        "score": 1,
        "last_activity_date": 1608792114,
        "creation_date": 1608735684,
        "question_id": 65426390,
        "link": "https://stackoverflow.com/questions/65426390/how-do-i-check-the-status-enabled-or-disabled-of-an-iot-device-in-azure-iot-hu",
        "title": "How do I check the status (enabled or disabled) of an IoT device in Azure IoT hub portal through C# code?",
        "body": "<p>I am writing a c# code where I need to check if an IoT device is disabled from the Azure Hub. Please help me with the c# code snippet how can I check it in the code if the device is enabled and disabled. Currently I am testing with 10 devices. Please help.</p>\n"
    }, {
        "tags": [
            "ssl",
            "iot",
            "gateway",
            "mitmproxy",
            "kali-linux"
        ],
        "is_answered": true,
        "view_count": 1004,
        "favorite_count": 0,
        "closed_date": 1609824647,
        "score": 0,
        "last_activity_date": 1608634404,
        "creation_date": 1608630456,
        "question_id": 65406451,
        "link": "https://stackoverflow.com/questions/65406451/client-may-not-trust-proxy-certificate-although-add-upstream-certs-to-client-cha",
        "title": "Client may not trust proxy certificate although add_upstream_certs_to_client_chain is set to True",
        "body": "<p>I'm trying to perform MITM between a remote server and IoT internet bridge device but even though I set add_upstream_certs_to_client_chain=true, I'm still getting 'The client may not trust the proxy's certificate' error so basically it means proxy does not use upstream certificate against client.</p>\n<p>This is how I run mitmproxy:</p>\n<p>--mode transparent --ssl-insecure --set add_upstream_certs_to_client_chain=true</p>\n<p>what am I doing wrong?</p>\n"
    }, {
        "tags": [
            "amazon-web-services",
            "iot",
            "node-red",
            "aws-iot"
        ],
        "is_answered": false,
        "view_count": 402,
        "favorite_count": 0,
        "score": 0,
        "last_activity_date": 1608118236,
        "creation_date": 1608117612,
        "last_edit_date": 1608118236,
        "question_id": 65322240,
        "link": "https://stackoverflow.com/questions/65322240/connecting-with-aws-iot-core-using-websocket-protocol",
        "title": "Connecting with AWS IoT Core Using WebSocket Protocol",
        "body": "<p>I'm trying to connect to AWS IoT Core using MQTT, WebSocket and HTTPS communication protocols.</p>\n<p>Here I'm using Node-Red as an IoT Device simulator. While doing this I'm able to successfully connect using both MQTT and HTTPS protocol but WebSocket connection is not working.</p>\n<p><em><strong>MQTT EndPoint:</strong></em> xxxx..amazonaws.com:8883</p>\n<p><em><strong>HTTPS EndPoint:</strong></em> https://xxxx..amazonaws.com:8443/topics/iot%2Ftelemetry?qos=1</p>\n<p><em><strong>WebSocket EndPoint:</strong></em> wss://xxxx..amazonaws.com:443/mqtt</p>\n<p><strong>Error in Node-Red Console when I try to publish a message to AWS IoT Core using WebSocket protocol</strong></p>\n<p><code>&quot;An error occurred while sending:  Error: WebSocket is not open: readyState 3 (CLOSED)&quot;</code></p>\n<p>The above error clearly states that Node-Red is not able to establish the WebSocket connection due to incorrect configuration.</p>\n<p>Can anyone who has connected to AWS IoT Core using WebSocket protocol share some pointers here?</p>\n"
    }, {
        "tags": [
            "android",
            "mqtt",
            "iot",
            "android-10.0"
        ],
        "is_answered": false,
        "view_count": 288,
        "favorite_count": 0,
        "score": 0,
        "last_activity_date": 1607582803,
        "creation_date": 1607488984,
        "last_edit_date": 1607582803,
        "question_id": 65210765,
        "link": "https://stackoverflow.com/questions/65210765/mqtt-broker-not-connecting-after-internet-disconnect-and-reconnect-in-android-10",
        "title": "MQTT broker not connecting after internet disconnect and reconnect in Android 10",
        "body": "<p>In my application i connect to IOT Device at that internet got disconnect and connection with MQTT Broker also disconnect then i send wifi to my IOT Device through TCP client and closing the socket i reconnect my internet connection after internet is connected again when i hit to re-establish connection with MQTT broker i got this ERROR:</p>\n<pre><code>MqttException (0) - java.net.SocketException: socket failed: ENONET (Machine is not on the network)\n</code></pre>\n<pre><code> private fun initMQTTConnector() {\n        clientID = Installation.id(context)\n        client = MqttAndroidClient(\n            context, String.format(\n                &quot;%s:%s&quot;,\n                BuildConfig.mqtt_server_url,\n                BuildConfig.mqtt_server_port\n            ),\n            clientID, MemoryPersistence()\n        )\n\n        client!!.setCallback(listener)\n        Timber.e(\n            &quot;qq - &quot; + String.format(\n                &quot;%s:%s&quot;,\n                BuildConfig.mqtt_server_url, //&quot;tcp://192.168.1.164&quot;\n                BuildConfig.mqtt_server_port\n            ) + &quot; -- &quot; + clientID\n        )\n\n            \n        connectToMQTTServer()\n    }\n\n\n    fun connectToMQTTServer() {\n        try {\n            if(client == null){\n                Timber.e(&quot;qq - client&quot;)\n                initMQTTConnector()\n            }else{\n                Timber.e(&quot;qq - Retrying the MQTT connection...!&quot;)\n                val options = MqttConnectOptions()\n                options.setCleanSession(false) // change for mqtt connection issue\n                options.setAutomaticReconnect(true)\n                options.userName = BuildConfig.mqtt_server_user_name\n                options.password = BuildConfig.mqtt_server_password.toCharArray()\n                options.setKeepAliveInterval(90) //seconds\n\n                token = client!!.connect(options)\n\n                eventBusManager?.post(\n                    EventBusManager.MessageEvent(\n                        EventBusConstants.MQTT_CONNECTING\n                    )\n                )\n\n                token?.actionCallback = object : IMqttActionListener {\n                    override fun onSuccess(asyncActionToken: IMqttToken) {\n                        // We are connected\n                        Timber.e(&quot;qq - onSuccess for connection :: token.actionCallback&quot;)\n                        //  Timber.d(&quot;onSuccess for connection&quot;)\n                        eventBusManager?.post(\n                            EventBusManager.MessageEvent(\n                                EventBusConstants.MQTT_CONNECTED\n                            )\n                        )\n                        subscribeToReportedTopic()\n                        subscribeToLoadedDevicesReportedChannel()\n                    }\n\n                    override fun onFailure(asyncActionToken: IMqttToken, exception: Throwable?) {\n                        // Something went wrong e.g. connection timeout or firewall problems\n                        Timber.e(&quot;qq - onFailure for connection :: token.actionCallback - &quot; + exception.toString())\n                        eventBusManager?.post(\n                            EventBusManager.MessageEvent(\n                                EventBusConstants.MQTT_NOT_CONNECTED\n                            )\n                        )\n                        exception?.printStackTrace()\n//                    connectToMQTTServer()\n                    }\n                }\n\n            }\n\n        } catch (e: Exception) {\n            eventBusManager?.post(\n                EventBusManager.MessageEvent(\n                    EventBusConstants.MQTT_NOT_CONNECTED\n                )\n            )\n            Timber.e(&quot;qq - Error occurred while connecting MQTT Client, Error = &quot; + e.toString())\n            e.printStackTrace()\n        }\n    }\n\n</code></pre>\n"
    }, {
        "tags": [
            "c",
            "ibm-cloud",
            "iot",
            "watson-iot"
        ],
        "is_answered": false,
        "view_count": 43,
        "favorite_count": 0,
        "score": 0,
        "last_activity_date": 1607501125,
        "creation_date": 1606398966,
        "question_id": 65023443,
        "link": "https://stackoverflow.com/questions/65023443/callback-not-found-for-topic-using-c-sdk-for-ibm-watson",
        "title": "Callback not found for topic using C SDK for IBM Watson",
        "body": "<p>I start from example found at <a href=\"https://ibm-watson-iot.github.io/iot-c/application/#sample\" rel=\"nofollow noreferrer\">ibm-watson-iot.github.io</a><p></p>\n<ol>\n<li>I define my device on Watson IOT<p></li>\n<li>I create my C-device snippet using deviceSample.c and it send an event\n{&quot;d&quot;: {&quot;SensorID&quot;:&quot;Test&quot;,&quot;Reading&quot;: 99}}<p></li>\n<li>I see the event in Watson IoT platform correctly <p></li>\n</ol>\n<p>But when I try to manage the event from my C application I catch the following error</p>\n<p><i><b>iotp_async.c iotp_client_messageArrived 1320: ERROR: Callback not found for topic. topic: iot-2/type/semaforo/id/1002/evt/status/fmt/json</b></i></p>\n<p>from my client log I take the following msg</p>\n<p><i>iotp_client_setHandler 1176: INFO: Handler (type=AppEvent) is added. Topic=iot-2/type/+/id/+/evt/+/fmt/+</i></p>\n<p>Does this msg means that my code is subscribed to the event ?\nIn my C code I define a CallBack event func using</p>\n<pre><code>IoTPApplication_setEventHandler\n               (application, applicationEventCallback, \n                        devType, devId, eventName, format\n               );\n</code></pre>\n<p>where my applicationEventCallback is</p>\n<pre><code>void  applicationEventCallback (char* type, char* id, \n           char* eventName, char *format, void* payload, size_t payloadSize);\n</code></pre>\n<p>Why my client does not mange correctly the incoming event ?</p>\n"
    }, {
        "tags": [
            "python",
            "ssl",
            "raspberry-pi",
            "mqtt",
            "iot"
        ],
        "is_answered": true,
        "view_count": 631,
        "favorite_count": 0,
        "score": 0,
        "last_activity_date": 1607041629,
        "creation_date": 1576202190,
        "last_edit_date": 1576214531,
        "question_id": 59315119,
        "link": "https://stackoverflow.com/questions/59315119/mqtt-problem-with-raspberry-pi-ssl-unsupported-protocol-unsupported-protocol",
        "title": "MQTT problem with raspberry pi, SSL: UNSUPPORTED_PROTOCOL] unsupported protocol (_ssl.c:1056)",
        "body": "<p>I am running an MQTT broker on an AWS server which functions as normal on mac and windows devices does not function as expected on my raspberry pi. My subscriber and publisher code works and has been tested on multiple operating systems. I believe the issue is with my raspberry pi settings however I am unable to resolve this.</p>\n\n<p>The error I am receiving (with python3):</p>\n\n<pre><code>pi@raspberrypi:~/MQTT $ sudo python3 subscriber.py \nTraceback (most recent call last):\n  File \"subscriber.py\", line 42, in &lt;module&gt;\n    client.connect(brokerAddress,port,60)\n  File \"/usr/local/lib/python3.7/dist-packages/paho/mqtt/client.py\", line 937, in connect\n    return self.reconnect()\n  File \"/usr/local/lib/python3.7/dist-packages/paho/mqtt/client.py\", line 1100, in reconnect\n    sock.do_handshake()\n  File \"/usr/lib/python3.7/ssl.py\", line 1117, in do_handshake\n    self._sslobj.do_handshake()\nssl.SSLError: [SSL: UNSUPPORTED_PROTOCOL] unsupported protocol (_ssl.c:1056)\n</code></pre>\n\n<p>The error I am receiving with python,</p>\n\n<pre class=\"lang-py prettyprint-override\"><code>pi@raspberrypi:~/MQTT $ python subscriber.py \nTraceback (most recent call last):\n  File \"subscriber.py\", line 42, in &lt;module&gt;\n    client.connect(brokerAddress,port,60)\n  File \"/home/pi/.local/lib/python2.7/site-packages/paho/mqtt/client.py\", line 937, in connect\n    return self.reconnect()\n  File \"/home/pi/.local/lib/python2.7/site-packages/paho/mqtt/client.py\", line 1100, in reconnect\n    sock.do_handshake()\n  File \"/usr/lib/python2.7/ssl.py\", line 828, in do_handshake\n    self._sslobj.do_handshake()\nssl.SSLError: [SSL: UNSUPPORTED_PROTOCOL] unsupported protocol (_ssl.c:727)\n</code></pre>\n\n<p>I have tried several things including using python vs python3, ensuring latest versions of paho is installed, rebooting, running the raspberry pi on another network, running as sudo, and some other things too.</p>\n\n<p>This may be unrelated but I have had issues trying to run git clone before on this raspberry pi, and i think it may be related to ssl issues.</p>\n\n<p>Other potentially useful things</p>\n\n<pre><code>pi@raspberrypi:~/MQTT $ openssl version\nOpenSSL 1.1.1d  10 Sep 2019\n</code></pre>\n\n<p>the code, subscriber.py:</p>\n\n<pre class=\"lang-py prettyprint-override\"><code>import paho.mqtt.client as mqtt\nimport sys\nimport time\nimport ssl\n\n# The callback for when the client receives a conack response from the server.\ndef on_connect(client, userdata, flags, rc):\n    print(\"Connected with result code \"+str(rc))\n    client.subscribe(\"test\")\n    printf(\"subscribed to test\")\n\n# When a message is received\ndef on_message(client, userdata, msg):\n    print(\"INCOMING\") #begin message\n    print(\"TOPIC: \\t\\t\"+msg.topic+\"\\nMESSAGE:\\t\"+str(msg.payload.decode()))\n\nclient = mqtt.Client(\"C1\")\n#declare loc of tls certificate\nclient.tls_set('/home/pi/MQTT/ca.crt',cert_reqs=ssl.CERT_NONE)\n\nclient.tls_insecure_set(True)\nclient.on_connect = on_connect\nclient.on_message = on_message\n\n#plain text credentials\nclient.username_pw_set(\"myusername\",\"mypassword\")\n\n#declare address and port\nbrokerAddress=\"my-ipv4-ip-address\"\nport=8883\nclient.connect(brokerAddress,port,60)\n#continuous loop\nclient.loop_forever()\n</code></pre>\n\n<p>This exact code when run on my mac works, I can publish this message from my desktop (windows) and it displays as expected.<a href=\"https://i.stack.imgur.com/Q2Iqq.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Q2Iqq.png\" alt=\"screenshot from mac\"></a></p>\n\n<p>Please do let me know if there is any other information you need from me to help troubleshoot.</p>\n"
    }, {
        "tags": [
            "amazon-web-services",
            "iot",
            "aws-iot",
            "aws-iot-greengrass"
        ],
        "is_answered": true,
        "view_count": 392,
        "favorite_count": 0,
        "score": 0,
        "last_activity_date": 1606405665,
        "creation_date": 1606405351,
        "question_id": 65025165,
        "link": "https://stackoverflow.com/questions/65025165/subscribe-from-a-python-server-to-an-aws-iot-topic",
        "title": "Subscribe from a python server to an aws-iot topic",
        "body": "<p>I basically need to send a command to a device from a python server and the device will publish the reply to a topic and I need to catch the reply server side.\nTo publish from the server to the device I'm using the boto3 iot-data module. But how can I subscribe to another topic to get the reply from the device? It seems there is no way by using the aws python libraries. Do I need to use a genetic MQTT client like paho?</p>\n<p>Thank you.</p>\n"
    }, {
        "tags": [
            "iot",
            "contiki",
            "cooja",
            "contiki-ng"
        ],
        "is_answered": true,
        "view_count": 80,
        "favorite_count": 0,
        "score": 1,
        "last_activity_date": 1606396016,
        "creation_date": 1592414581,
        "last_edit_date": 1606396016,
        "question_id": 62434824,
        "link": "https://stackoverflow.com/questions/62434824/more-than-one-parent-in-the-rpl-protcol",
        "title": "More than one parent in the RPL protcol",
        "body": "<p>Does Contiki-NG support more than one parent in the RPL implementation? If yes how I can enable it?</p>\n"
    }, {
        "tags": [
            "python",
            "iot",
            "aws-iot"
        ],
        "is_answered": false,
        "view_count": 80,
        "favorite_count": 0,
        "score": 0,
        "last_activity_date": 1606040263,
        "creation_date": 1605712690,
        "question_id": 64895970,
        "link": "https://stackoverflow.com/questions/64895970/is-there-any-way-to-stop-logger-in-the-aws-iot-python-sdk",
        "title": "Is there any way to stop logger in the AWS Iot Python SDK?",
        "body": "<p>In the AWSIoTPythonSDK, in MqttCore.py, there is logger define '''class MqttCore(object):\n_logger = logging.getLogger(<strong>name</strong>)'''\nEverytime &quot;subscribe timed out&quot; is getting printed in the console, is there any way to forcefully stop the logger of the IoT SDK. I know it is not recommended but i badly needed to stop it forcefully.</p>\n"
    }, {
        "tags": [
            "queue",
            "mqtt",
            "iot",
            "mosquitto"
        ],
        "is_answered": true,
        "view_count": 844,
        "favorite_count": 0,
        "score": 1,
        "last_activity_date": 1605957808,
        "creation_date": 1605949657,
        "question_id": 64941441,
        "link": "https://stackoverflow.com/questions/64941441/how-can-i-queue-messages-in-mqtt",
        "title": "How can I queue messages in MQTT?",
        "body": "<p>I am using MQTT in an IoT application. For that purpose each IoT device will publish data to the IoT broker under their Topic and the processing server would subscribe to some wildcards topic to access the data. This processing server needs to save this data in database. Now the thing is that at one time, thousands or millions of devices will be publishing to the broker. If the processing server accesses the data, before it can finish processing it, it is swarmed by the next data. How can I solve it? I was hoping there could be some queue like mechanism at the client or broker side. If so, how can this be done? Or should I use some other protocol instead of MQTT?</p>\n"
    }, {
        "tags": [
            "python",
            "iot",
            "aws-iot"
        ],
        "is_answered": false,
        "view_count": 16,
        "favorite_count": 0,
        "score": 0,
        "last_activity_date": 1605767349,
        "creation_date": 1605767349,
        "question_id": 64906459,
        "link": "https://stackoverflow.com/questions/64906459/is-there-any-way-to-change-default-timeout-of-subscribe-in-awsiotpythonsdk",
        "title": "Is there any way to change default timeout of subscribe in AWSIoTPythonSDK?",
        "body": "<p>Like in AWSIoTPythonSDK, the default timeout set for subscribing a topic is 5seconds. How can I change the default timeout of subscribe method in the SDK. I need a way to change it from my code level.</p>\n"
    }, {
        "tags": [
            "amazon-web-services",
            "mqtt",
            "iot",
            "mbedtls",
            "legato"
        ],
        "is_answered": false,
        "view_count": 490,
        "favorite_count": 0,
        "score": 0,
        "last_activity_date": 1605051490,
        "creation_date": 1597207389,
        "last_edit_date": 1597376887,
        "question_id": 63369895,
        "link": "https://stackoverflow.com/questions/63369895/mqtt-cant-connect-to-backend-aws-iot-core",
        "title": "MQTT can`t connect to backend AWS IoT core",
        "body": "<p>UPDATED:\nI am trying to connect to a backend (AWS IoT Core) as I am using a small wp77 with a busybox image running.\nWhen using the 8883 port the connection times out, so I have changed to port 443 and I can connect to the backend, still, the socket gets closed after three attempts.\nThis is the log readout from my app:</p>\n<p>Aug 14 03:29:13 fx30s user.info Legato:  INFO | mqttMain[2717] |\nDSC connected... starting MQTT connection</p>\n<p>Aug 14 03:29:13 fx30s user.info Legato:  INFO | mqttMain[2717] |</p>\n<p>Aug 14 03:29:13 fx30s user.info Legato:  INFO | mqttMain[2717] |</p>\n<p>Aug 14 03:29:13 fx30s user.info Legato:  INFO | mqttMain[2717]/mqttCliSvrComponent T=main | mqttCliSvr.c DcsStateHandler() 317 | rmnet_data0 connected! Starting MQTT session</p>\n<p>Aug 14 03:29:13 fx30s user.info Legato:  INFO | mqttClient[1120]/mqttClientApiComponent T=main | mqttClientApi.c mqttClient_StartSession() 452 | StartSession called</p>\n<p>Aug 14 03:29:13 fx30s user.info Legato:  INFO | mqttClient[1120]/mqttClientApiComponent T=main | mqttClientApi.c mqttClient_StartSession() 455 | mqttClientPts NOT NULL</p>\n<p>Aug 14 03:29:13 fx30s user.info Legato:  INFO | mqttClient[1120] | mqtt_StartSession... connecting...</p>\n<p>Aug 14 03:29:13 fx30s user.info Legato:  INFO | mqttClient[1120] |   . Seeding the random number generator... ok</p>\n<p>Aug 14 03:29:13 fx30s user.info Legato:  INFO | mqttClient[1120] |   . Loading the CA root certificate ... load certs from certs ok (0 skipped)</p>\n<p>Aug 14 03:29:13 fx30s user.info Legato:  INFO | mqttClient[1120] |   . Loading the client certificate... /home/root/aws-iot/xxxxxx-certificate.pem.crt ok</p>\n<p>Aug 14 03:29:13 fx30s user.info Legato:  INFO | mqttClient[1120] |   . Loading the client private key... /home/root/aws-iot/xxxxxx-private.pem.key ok</p>\n<p>Aug 14 03:29:13 fx30s user.info Legato:  INFO | mqttClient[1120] |   . Connecting to tcp/xxxxxx-ats.iot.ap-southeast-1.amazonaws.com/443...</p>\n<p>Aug 14 03:29:13 fx30s user.info Legato:  INFO | mqttClient[1120] |  ok</p>\n<p>Aug 14 03:29:13 fx30s user.info Legato:  INFO | mqttClient[1120] |   . Setting up the TLS structure... ok</p>\n<p>Aug 14 03:29:15 fx30s user.info Legato:  INFO | mqttClient[1120] |   . Performing the TLS handshake... ok</p>\n<p>Aug 14 03:29:15 fx30s user.info Legato:  INFO | mqttClient[1120] | [ Protocol is TLSv1.2 ]</p>\n<p>Aug 14 03:29:15 fx30s user.info Legato:  INFO | mqttClient[1120] | [ Ciphersuite is TLS-ECDHE-RSA-WITH-AES-128-GCM-SHA256 ]</p>\n<p>Aug 14 03:29:15 fx30s user.info Legato:  INFO | mqttClient[1120] |   . Verifying peer X.509 certificate... ok</p>\n<p>Aug 14 03:29:15 fx30s user.info Legato:  INFO | mqttClient[1120] |   clientId : FX30S</p>\n<p>Aug 14 03:29:15 fx30s user.info Legato:  INFO | mqttClient[1120] |   username :</p>\n<p>Aug 14 03:29:15 fx30s user.info Legato:  INFO | mqttClient[1120] | Attempting (1/3) to connect to tcp://xxxxxx-ats.iot.ap-southeast-1.amazonaws.com:443...</p>\n<p>Aug 14 03:29:15 fx30s user.info Legato:  INFO | mqttClient[1120] |\nCheck connection options.</p>\n<p>Aug 14 03:29:15 fx30s user.info Legato:  INFO | mqttClient[1120] |\nMQTT serialize connection.</p>\n<p>Aug 14 03:29:15 fx30s user.info Legato:  INFO | mqttClient[1120] |\nMQTT send packet.</p>\n<p>Aug 14 03:29:15 fx30s user.info Legato:  INFO | mqttClient[1120] |\nbytes sent: 31</p>\n<p>Aug 14 03:29:15 fx30s user.info Legato:  INFO | mqttClient[1120] |\ntotal bytes sent: 31 of 31</p>\n<p>Aug 14 03:29:15 fx30s user.info Legato:  INFO | mqttClient[1120] |\nMQTT waiting for CONNACK</p>\n<p>Aug 14 03:29:20 fx30s user.info Legato:  INFO | mqttClient[1120] |\nMQTT is now exiting with -1</p>\n<p>Aug 14 03:29:20 fx30s user.info Legato:  INFO | mqttClient[1120] | Failed</p>\n<p>Aug 14 03:29:20 fx30s user.info Legato:  INFO | mqttClient[1120] | tlsSocket_close 1</p>\n<p>And this is the code, something I have taken from github and just testing on my device...</p>\n<pre><code>int MQTTConnect(Client* c, MQTTPacket_connectData* options)\n{\n    Timer connect_timer;\n    int rc = FAILURE;\n    MQTTPacket_connectData default_options = MQTTPacket_connectData_initializer;\n    int len = 0;\n    \n    InitTimer(&amp;connect_timer);\n    countdown_ms(&amp;connect_timer, c-&gt;command_timeout_ms);\n\n    if (c-&gt;isconnected) // don't send connect packet again if we are already connected\n        goto exit;\n\n    fprintf(stdout, &quot;Check connection options.&quot;);\n    fflush(stdout);\n\n    if (options == 0)\n    {\n        fprintf(stdout, &quot;MQTTConnect Set default options...&quot;);\n        fflush(stdout);\n        options = &amp;default_options; // set default options if none were supplied\n    }\n    \n    c-&gt;keepAliveInterval = options-&gt;keepAliveInterval;\n    countdown(&amp;c-&gt;ping_timer, c-&gt;keepAliveInterval);\n    fprintf(stdout, &quot;MQTT serialize connection.&quot;);\n    fflush(stdout);\n    if ((len = MQTTSerialize_connect(c-&gt;buf, c-&gt;buf_size, options)) &lt;= )\n        goto exit;\n\n    #if 0\n    {\n        int i;\n        for (i=0; i&lt;len; i++)\n        {\n            fprintf(stdout, &quot;%.2x&quot;, c-&gt;buf[i]);\n        }\n        fprintf(stdout, &quot;\\n&quot;);\n        fflush(stdout);\n\n        fprintf(stdout, &quot;\\n%.*s\\n&quot;, len, c-&gt;buf);\n        fflush(stdout);\n    }\n    #endif\n\n    fprintf(stdout, &quot;MQTT send packet.&quot;);\n    fflush(stdout);\n    if ((rc = sendPacket(c, len, &amp;connect_timer)) != SUCCESS)  // send the connect packet\n        goto exit; // there was a problem\n    \n    // this will be a blocking call, wait for the connack\n    fprintf(stdout, &quot;MQTT waiting for CONNACK&quot;);\n    fflush(stdout);\n    if (waitfor(c, CONNACK, &amp;connect_timer) == CONNACK)\n    {\n        unsigned char connack_rc = 255;\n        char sessionPresent = 0;\n        if (MQTTDeserialize_connack((unsigned char*)&amp;sessionPresent, &amp;connack_rc, c-&gt;readbuf, c-&gt;readbuf_size) == 1)\n            rc = connack_rc;\n        else\n            rc = FAILURE;\n    }\n    else\n        rc = FAILURE;\nexit:\n    fprintf(stdout, &quot;MQTT is now exiting with %d&quot;, rc );\n    fflush(stdout);  \n    if (rc == SUCCESS)\n    //if (SUCCESS == SUCCESS)\n        c-&gt;isconnected = 1;\n    return rc;\n    //return SUCCESS;\n}\n</code></pre>\n<p>For some reason the backend doesn`t confirm the connection with a CONNACK and this is the reason why this fails.\nAWS specify to use APLN when connecting to the backend through port 443 so I was wondering if this is the problem and how I can specify this protocol for tls on paho.mqtt.c (I know there is a solution for python!!).</p>\n<p>Thank you for your help.</p>\n"
    }, {
        "tags": [
            "google-cloud-platform",
            "mqtt",
            "iot",
            "paho"
        ],
        "is_answered": true,
        "view_count": 44,
        "favorite_count": 0,
        "score": 0,
        "last_activity_date": 1604945734,
        "creation_date": 1604931057,
        "last_edit_date": 1604936713,
        "question_id": 64753242,
        "link": "https://stackoverflow.com/questions/64753242/google-cloud-iot-single-mqtt-client-instance-for-all-devices-in-a-registry",
        "title": "Google Cloud IoT - Single MQTT client instance for all devices in a registry",
        "body": "<p>I am able to publish events to a device in my Cloud IOT Registry via an MQTT client created this way (using paho python):</p>\n<pre><code>self.__client = mqtt.Client(client_id='projects/{}/locations/{}/registries/{}/devices/{}'.format(project_id,\n                                                                                                 cloud_region,\n                                                                                                 registry_id,\n                                                                                                 device_id))\n</code></pre>\n<p>Now I'm wondering if I can create an MQTT client being able to publish events to multiple devices by setting the client id at registry level (i.e. not specifying the device id):</p>\n<pre><code>        self.__client = mqtt.Client(client_id='projects/{}/locations/{}/registries/{}'.format(project_id,\n                                                                                                     cloud_region,\n                                                                                                     registry_id))\n</code></pre>\n<p>This client is not able to connect even if I've added a CA Certificate to the registry.</p>\n<p>My question is: can a single MQTT Client instance publish events to a set of devices defined in a registry?\nShould I use a gateway instead?</p>\n"
    }, {
        "tags": [
            "python",
            "mqtt",
            "iot",
            "paho"
        ],
        "is_answered": false,
        "view_count": 215,
        "favorite_count": 0,
        "score": 0,
        "last_activity_date": 1604915038,
        "creation_date": 1604915038,
        "question_id": 64749190,
        "link": "https://stackoverflow.com/questions/64749190/how-to-handle-when-mqtt-client-tries-to-connect-without-internet",
        "title": "How to handle when MQTT client tries to connect without internet?",
        "body": "<p>I am using the paho mqtt library for python on an iot device. And for the most part the setup I have is working properly. However, I have found that if I try to connect when there is no internet connection, the scipt will throw a socket error (socket.gaierror: [Errno -3] Temporary failure in name resolution) and because of it, it'll get stuck and not try to connect again.</p>\n<p>I am trying to find out how to deal with this case, and I am wondering if you have any advice. <a href=\"https://github.com/GoogleCloudPlatform/python-docs-samples/blob/master/iot/api-client/mqtt_example/cloudiot_mqtt_example.py\" rel=\"nofollow noreferrer\">I am basing my code off of this example.</a></p>\n<p>In summary, this is what I have for main function and connext/disconnect ones:</p>\n<pre><code>def on_connect(unused_client, unused_userdata, unused_flags, rc):\n    &quot;&quot;&quot;Callback for when a device connects.&quot;&quot;&quot;\n    print('on_connect', mqtt.connack_string(rc))\n    print(&quot;connection time: &quot;, datetime.datetime.utcnow())\n\n    # After a successful connect, reset backoff time and stop backing off.\n    global should_backoff\n    global minimum_backoff_time\n    should_backoff = False\n    minimum_backoff_time = 1\n\n\ndef on_disconnect(unused_client, unused_userdata, rc):\n    &quot;&quot;&quot;Paho callback for when a device disconnects.&quot;&quot;&quot;\n    print('on_disconnect', error_str(rc))\n    print(&quot;disconnection time: &quot;, datetime.datetime.utcnow())\n\n    # Since a disconnect occurred, the next loop iteration will wait with\n    # exponential backoff.\n    global should_backoff\n    should_backoff = True\n\ndef main():\n\n    # global JWT_EXPIRES_MINUTES\n    global minimum_backoff_time\n\n    jwt_iat = datetime.datetime.utcnow()\n    jwt_exp_mins = JWT_EXPIRES_MINUTES\n    # Use gateway to connect to server\n    client = get_client(\n        project_id, cloud_region, registry_id, device_id,\n        private_key_file, algorithm, ca_certs, mqtt_bridge_hostname,\n        mqtt_bridge_port)\n\n    while True:\n        client.loop()\n\n        if should_backoff:\n            # If backoff time is too large, give up.\n            if minimum_backoff_time &gt; MAXIMUM_BACKOFF_TIME:\n                print('Exceeded maximum backoff time. Giving up.')\n                break\n\n            delay = minimum_backoff_time + random.randint(0, 1000) / 1000.0\n            time.sleep(delay)\n            minimum_backoff_time *= 2\n            client.connect(mqtt_bridge_hostname, mqtt_bridge_port)\n\n        seconds_since_issue = (datetime.datetime.utcnow() - jwt_iat).seconds\n        # print(f&quot;seconds since issue: {seconds_since_issue}&quot;)\n        if seconds_since_issue &gt; 60 * jwt_exp_mins:\n            print('Refreshing token after {}s'.format(seconds_since_issue))\n            jwt_iat = datetime.datetime.utcnow()\n            client.loop()\n            client.disconnect()\n            # Wait a short time, so the cloud function has some buffer to react to the disconnection,\n            # before reacting to the connection.\n            time.sleep(5)\n            client = get_client(\n                project_id, cloud_region, registry_id, device_id,\n                private_key_file, algorithm, ca_certs, mqtt_bridge_hostname,\n                mqtt_bridge_port)\n\n        time.sleep(1)\n</code></pre>\n<p>When I googled for it, <a href=\"https://stackoverflow.com/questions/41378490/python-mqtt-client-which-tries-to-connect-to-broker-when-no-internet\">I found this SO answer which looked promising</a>. I have implemented it just around the client.loop() line after while True, but it doesn't work quite right, I believe it's because I am using client.loop() and not client.loop_forever().</p>\n<p>I am writing the state of the connection (which I get from GCP logs) to a database and what I see is the following: Initially it connects as I would expect, but almost immediately I get a message of &quot;deadline exceeded&quot; and the status changes from &quot;connect&quot; to &quot;publish&quot; (but I am not publishing anything at the moment), shortly after I get a &quot;disconnect&quot; with the description &quot;SUBSCRIBE: The connection was closed because the device did not acknowledge QoS 1 messages within the required time period.&quot;.</p>\n<p>I am not sure what is the best way to implement this. Basically, I want to catch this socket error happening when there is no connection and continue to try until it won't be a problem. After that, I want it to continue working the same way as the code above. Does this make sense, or should I go about it some other way?</p>\n"
    }, {
        "tags": [
            "ssl",
            "architecture",
            "iot"
        ],
        "is_answered": true,
        "view_count": 120,
        "favorite_count": 1,
        "score": 1,
        "last_activity_date": 1604585494,
        "creation_date": 1604519629,
        "question_id": 64686840,
        "link": "https://stackoverflow.com/questions/64686840/self-signed-certificate-or-ca-certificate-for-iot-device",
        "title": "Self signed certificate or CA certificate for IoT device",
        "body": "<p>I can't understand which is the real benefit of using a CA certificate when it comes to secure communications between servers and IoT devices.</p>\n<p>I'm working at an IoT device that uses Ubuntu as OS and I was planning to use CA certificate. But what happen if my users are not updating their devices firmware?\nnow that certificates expires after 1 year and considering that some users are not updating their IoT devices for a long time... the risk I'll run into is that those devices could not be updated after the cert expires since they can't communicate with my servers.</p>\n<p>With a self signed cert I can set an expiration of 45 years and anyway I'll be to authority and I can revoke or decide when it is time to release a new cert or even cross signing certificate.</p>\n<p>I'm obviously talking only about the communication between the device and servers... the rest api for users will use a default CA cert.</p>\n<hr />\n<p>Another option that I'm considering is to use a CA cert for device and servers communication but also adding a self signed certificate that I can use as backup in case the the main certificate expires and the device needs to download new software (that will contain the new certificate) is this a viable solution?</p>\n<p>Should I handle certificates in this way?! or maybe should I just use the OS root store and ensure that it is updated somehow? (in this case ... how?... the only way is to release an update of the device firmare I suppose)</p>\n"
    }, {
        "tags": [
            "java",
            "amazon-web-services",
            "iot",
            "aws-iot"
        ],
        "is_answered": false,
        "view_count": 31,
        "favorite_count": 0,
        "score": 0,
        "last_activity_date": 1602857662,
        "creation_date": 1602857662,
        "question_id": 64390893,
        "link": "https://stackoverflow.com/questions/64390893/how-to-implement-awsiotqos-qos1-to-receive-confirmation-puback",
        "title": "How to implement AWSIotQos.QOS1 to receive confirmation PUBACK",
        "body": "<p>I am using AWSIotMqttClient to connect to the server and publish some data. I am able to do this with the below code (using AWSIoT SDK for java).</p>\n<pre><code>//Get keyStorePair from certificate and key\nSampleUtil.KeyStorePasswordPair pair = SampleUtil.getKeyStorePasswordPair(certificateFile, privateKeyFile);\n//Create an AWSMqtt client object\nclient = new AWSIotMqttClient(clientEndpoint, clientID, pair.keyStore, pair.keyPassword);\n//Connect the client with the AWS IoT\nclient.connect();\n//Update connected flag\nisConnected = true;\n//Update the status\npDialog.setMessage(&quot;Connected to server...&quot;);\n//Publish the data\nclient.publish(outboundTopic, AWSIotQos.QOS0, payloadData);\n</code></pre>\n<p>However I'm unable to confirm that the data has been published successfully and received by the server. The documentation mentioned that I can use <code>AWSIotQos.QOS1</code> to receive the <code>PUBACK</code> response but I cannot find any implementation for this.\nCan anyone please help me with this.</p>\n<p>Thank you</p>\n"
    }, {
        "tags": [
            "mqtt",
            "raspberry-pi3",
            "iot",
            "paho",
            "aws-iot"
        ],
        "is_answered": true,
        "view_count": 1531,
        "favorite_count": 0,
        "score": 1,
        "last_activity_date": 1602336053,
        "creation_date": 1519685638,
        "last_edit_date": 1519686251,
        "question_id": 48998420,
        "link": "https://stackoverflow.com/questions/48998420/aws-iot-use-mqtt-on-port-443",
        "title": "AWS IoT: Use MQTT on port 443",
        "body": "<p>I am trying to setup AWS IoT in Pi on port 443 using Paho MQTT .</p>\n\n<p>As AWS document (<a href=\"https://docs.aws.amazon.com/iot/latest/developerguide/protocols.html\" rel=\"nofollow noreferrer\">https://docs.aws.amazon.com/iot/latest/developerguide/protocols.html</a>) mentioned that </p>\n\n<blockquote>\n  <p>Clients wishing to connect using MQTT with X.509 Client Certificate authentication on port 443 must implement the Application Layer Protocol Negotiation (ALPN) TLS extension and pass x-amzn-mqtt-ca as the ProtocolName in the ProtocolNameList.</p>\n</blockquote>\n\n<p>I actually don't know how to achieve it properly in Paho MQTT (<a href=\"https://github.com/eclipse/paho.mqtt.python\" rel=\"nofollow noreferrer\">https://github.com/eclipse/paho.mqtt.python</a>)</p>\n\n<p>What I tried to do (mqtt_apln.py)</p>\n\n<pre><code>import sys\nimport ssl\nimport time\nimport datetime\nimport logging, traceback\nimport paho.mqtt.client as mqtt\n\n\nMQTT_TOPIC = \"topictest\"\nMQTT_MSG = \"hello MQTT\"\n\n\nIoT_protocol_name = \"x-amzn-mqtt-ca\"\naws_iot_endpoint = \"xxxxxxx.iot.eu-west-1.amazonaws.com\"\nurl = \"https://{}\".format(aws_iot_endpoint)\n\nca = \".xxxxx/rootCA.pem\"\ncert = \".xxxxx/xxxxx-certificate.pem.crt\"\nprivate = \".xxxxx/xxxxxx-private.pem.key\"\n\nlogger = logging.getLogger()\nlogger.setLevel(logging.DEBUG)\nhandler = logging.StreamHandler(sys.stdout)\nlog_format = logging.Formatter('%(asctime)s - %(name)s - %(levelname)s - %(message)s')\nhandler.setFormatter(log_format)\nlogger.addHandler(handler)\n\n# Define on connect event function\n# We shall subscribe to our Topic in this function\ndef on_connect(mosq, obj, rc):\n    mqttc.subscribe(MQTT_TOPIC, 0)\n\n# Define on_message event function. \n# This function will be invoked every time,\n# a new message arrives for the subscribed topic \ndef on_message(mosq, obj, msg):\n        print \"Topic: \" + str(msg.topic)\n        print \"QoS: \" + str(msg.qos)\n        print \"Payload: \" + str(msg.payload)\n\ndef on_subscribe(mosq, obj, mid, granted_qos):\n    print(\"Subscribed to Topic: \" +\n        MQTT_MSG + \" with QoS: \" + str(granted_qos))\n\ndef ssl_alpn():\n    try:\n        #debug print opnessl version\n        logger.info(\"open ssl version:{}\".format(ssl.OPENSSL_VERSION))\n        ssl_context = ssl.create_default_context()\n        ssl_context.set_alpn_protocols([IoT_protocol_name])\n        ssl_context.load_verify_locations(cafile=ca)\n        ssl_context.load_cert_chain(certfile=cert, keyfile=private)\n\n        return  ssl_context\n    except Exception as e:\n        print(\"exception ssl_alpn()\")\n        raise e\n\n\nmqttc = mqtt.Client()\n\n# Assign event callbacks\nmqttc.on_message = on_message\nmqttc.on_connect = on_connect\nmqttc.on_subscribe = on_subscribe\n\nssl_context= ssl_alpn()\nmqttc.tls_set_context(context=ssl_context)\nlogger.info(\"start connect\")\nmqttc.connect(aws_iot_endpoint, port=443)\nlogger.info(\"connect success\")\nmqttc.loop_start()\n</code></pre>\n\n<p>In Pi, I installed python 2.7.14 and paho-mqtt</p>\n\n<p>But When I run python mqtt_apln.py, it shows error: ImportError: No module named paho.mqtt.client</p>\n\n<p>Any suggestion is appreciated</p>\n"
    }, {
        "tags": [
            "proxy",
            "iot",
            "transparentproxy",
            "tls-psk"
        ],
        "is_answered": false,
        "view_count": 94,
        "favorite_count": 2,
        "score": 2,
        "last_activity_date": 1601667904,
        "creation_date": 1589480287,
        "question_id": 61804548,
        "link": "https://stackoverflow.com/questions/61804548/transparent-proxy-that-supports-tls-psk",
        "title": "Transparent proxy that supports TLS-PSK",
        "body": "<p>I'm trying to research a device that uses TLS-PSK as its cipher suite for server authentication. However, mitmproxy nor Burp Suite support the TLS-PSK ciphers. For Burp, this is the underlying Java/BouncyCastle implementation that does not support it. </p>\n\n<p>Can anyone recommend an option to proxy traffic from a device that utilizes TLS-PSK?</p>\n"
    }, {
        "tags": [
            "python",
            "google-cloud-platform",
            "mqtt",
            "iot"
        ],
        "is_answered": true,
        "view_count": 223,
        "favorite_count": 0,
        "score": 0,
        "last_activity_date": 1600780677,
        "creation_date": 1600776741,
        "question_id": 64009481,
        "link": "https://stackoverflow.com/questions/64009481/how-can-i-use-mqtt-long-term-in-iot-core",
        "title": "How can I use MQTT long term in IoT Core?",
        "body": "<p>So first of all, what I really want to achieve: I want to know when an IoT device has stopped working (i.e. lost connection, shut down, basically it's not longer talking to IoT Core). I can't seem to find an implementation for this on GCP.</p>\n<p>I have a raspberry pi as my IoT device, I have configured it on IoT core and somewhere I read that since this is not implemented a way to solve it is to create a logging sink which activates a cloud function whenever there is a CONNECT/DISCONNECT log. This would serve my purpose and I have implemented this sink and cloud function to alert me.</p>\n<p>I have been following <a href=\"https://cloud.google.com/iot/docs/how-tos/mqtt-bridge\" rel=\"nofollow noreferrer\">this guide</a> on connecting to MQTT. However, the way the explain it, they set it up such that whenever the expiration time on the JWT is exceeded, they disconnect the client and create a new one to re-new the JWT. This would make it such that I am going to be alerted of connection/disconnection whenever this client needs to be renewed. So I won't be able to differentiate of a real issue from renewals of the MQTT client.</p>\n<p>In the same guide, I see that they mention MQTT long term or LTS, and they claim that this way you can set up the client once and communicate continuously through it for the supported time which it says its until 2030. This seems to be what I really want, but I have not been able to connect this way and they don't explain it other than saying the hostname should be <code>mqtt.2030.ltsapis.goog</code> and to use a primary and backup certificates which are different from the complete root CA from the first method.</p>\n<p>I tried using basically the same process for setting up the client:</p>\n<pre><code>    client = mqtt.Client(client_id=client_id)\n\n    # With Google Cloud IoT Core, the username field is ignored, and the\n    # password field is used to transmit a JWT to authorize the device.\n    client.username_pw_set(\n        username='unused',\n        password=create_jwt(project_id, private_key_file, algorithm))\n\n    # Enable SSL/TLS support.\n    client.tls_set(ca_certs=ca_certs, tls_version=ssl.PROTOCOL_TLSv1_2) \n</code></pre>\n<p>but changing the hostname and giving it the primary cert where I would give it the complete ca_certs, but it won't accept it and I am not sure how to do it otherwise with primary and backup certifications. I am looking at the documentation on tls_set, but I don't see where these would go or how they differ from the complete ca certs. I haven't seen any other examples outside of this guide.</p>\n<p>I am hoping to be able to connect to this MQTT LTS so that I can maintain the connection without having to constantly renew the client.</p>\n"
    }, {
        "tags": [
            "mqtt",
            "iot",
            "esp32",
            "thingsboard"
        ],
        "is_answered": false,
        "view_count": 157,
        "favorite_count": 0,
        "score": 1,
        "last_activity_date": 1598380523,
        "creation_date": 1598380523,
        "question_id": 63585127,
        "link": "https://stackoverflow.com/questions/63585127/thingsboard-disconnectes-mqtt-clients",
        "title": "Thingsboard disconnectes MQTT clients",
        "body": "<p>I try to connect a few ESP32s with <strong>Thingsbaord via MQTT</strong> using the PubSubClient library.\nUnfortunately it seems I am not able to connect multiple devices subscribing the same topic.</p>\n<ul>\n<li>using the same client-id --&gt; one client kicks out the other client</li>\n<li>using different client-id but same username (token) --&gt; one clientkicks out the other client</li>\n<li>using different client-ids and different usernames --&gt; more devices can connect to Thingsboard at the same time, but after subscribing to <code>v1/devices/me/attributes</code> and <code>v1/gateway/attributes</code> they kick each other out and have to reconnect. In the Thingsboard-log disconnect, connect, disconnect... is shown.\nUsing a different MQTT-broker everything works, so I think it has to be the configuration of Thingsboard-MQTT or the fact that two devices try to subscribe to the same topic.</li>\n</ul>\n<p>The same problem occurs using an Andorid MQTT-client so its not the ESP or the liraray.</p>\n<p>Does anyone has similar issues and found a workaround?</p>\n<p>Thanks</p>\n"
    }, {
        "tags": [
            "cloud",
            "mqtt",
            "iot",
            "publish-subscribe"
        ],
        "is_answered": true,
        "view_count": 435,
        "favorite_count": 0,
        "score": 0,
        "last_activity_date": 1596224924,
        "creation_date": 1596144555,
        "question_id": 63181647,
        "link": "https://stackoverflow.com/questions/63181647/google-cloud-iot-mqtt-pubsub-sending-and-receiving",
        "title": "google cloud Iot / MQTT / pubsub sending and receiving",
        "body": "<p>In my application, messages are received (and sent) from a device to GC over MQTT.\nI want to retrieve (and send) messages from Pubsub (and later put that data in a Firebase RTDB) but I don't know which topic I have to susbcribe to: my device sends to /devices/[deviceID]/state but impossible to create a Sub for this topic in GC Console.</p>\n<p>Thanks.\nJ</p>\n"
    }, {
        "tags": [
            "iot",
            "azure-iot-hub"
        ],
        "is_answered": true,
        "view_count": 863,
        "favorite_count": 0,
        "score": 1,
        "last_activity_date": 1594743304,
        "creation_date": 1594633111,
        "question_id": 62873148,
        "link": "https://stackoverflow.com/questions/62873148/how-i-can-subscribe-to-topics-in-azure-iot-hub-device-to-device-communication",
        "title": "how i can subscribe to topics in azure iot hub device to device communication",
        "body": "<p>I set up an architect for my solution think that iot hub does the work of an mqtt broker, but when I started the implementation , I found that you cannot subscribe to a specific subject to retrieve messages published by another mqtt client, the notion of topic does not exist on iot hub.</p>\n<p>I have read several articles about this subject but I have not found an appropriate alternative.\nIot hub has only two topics, and event hub endpoints are limited to 10 endpoints\nCan you guide me or suggest a solution with a broker?\nHow can I subscribe to a specific topic?</p>\n<p>I want a device to device communication with pub / sub</p>\n<p>Example: a device publishes on a topic / home / room\nanother device subscribes to / home / room\nusing iot hub</p>\n<p>I am open to all proposals</p>\n<p>Thank you</p>\n"
    }, {
        "tags": [
            "amazon-web-services",
            "mqtt",
            "iot",
            "node-red",
            "aws-iot"
        ],
        "is_answered": true,
        "view_count": 92,
        "favorite_count": 0,
        "score": 0,
        "last_activity_date": 1594292639,
        "creation_date": 1594288108,
        "last_edit_date": 1594292639,
        "question_id": 62812132,
        "link": "https://stackoverflow.com/questions/62812132/aws-automatically-rebublishing-mqtt-data-to-node-red",
        "title": "AWS automatically rebublishing MQTT data to Node-RED?",
        "body": "<p>In Node-RED i'm using the mqtt out node to send data to aws. Then aws has a rule which specifies to send the data to a lambda function. I then have an mqtt in node which is subscribed to messages from aws.</p>\n<p>Now when I send data to aws over a test topic, I'm getting the data sent back to me with the mqtt in node. I'm not publishing anything from the AWS side and this happens regardless of what the topic is (even when it doesn't match what I've specified in the rule. Why is this automatically being sent back to me? Does AWS just automatically republish the data on the same topic?</p>\n<p>edit:</p>\n<p>I have a mqtt out with the topic test and then in a different flow, an mqtt in with the topic test.</p>\n<p>I am publishing a message to AWS with the topic test. And then in another flow I am susbcribed to the topic test. When I publish a message to AWS with the topic test, even though AWS is not subscribed to the topic 'test', I still get the data on the mqtt in flow. How can this be if AWS isn't publishing anything to the test topic.</p>\n<p>Is it just because they are both connected to the same server and since I am publishing to a topic, anything subscribed to that topic will receive the data. Does AWS not have to actually do anything?</p>\n"
    }, {
        "tags": [
            "raspberry-pi",
            "iot",
            "node-red",
            "opc-ua",
            "raspberry-pi4"
        ],
        "is_answered": false,
        "view_count": 862,
        "favorite_count": 0,
        "score": 1,
        "last_activity_date": 1592829425,
        "creation_date": 1592827047,
        "last_edit_date": 1592829425,
        "question_id": 62513891,
        "link": "https://stackoverflow.com/questions/62513891/opc-ua-client-certificate-connection-problem",
        "title": "OPC-UA client certificate connection problem",
        "body": "<p>Im running node-red OPC-UA Client on my Raspberry pi 4 and OPC-UA server on Omron PLC NJ501-1400. Running without any security policy. But my client cannot connect to server, on debugbar it pops this message.</p>\n<pre><code>OPC UA connection error: The connection has been rejected by server,\nPlease check that client certificate is trusted by server.\nErr = (connect ENETUNREACH 10.xxx.xxx.x:4840)\n</code></pre>\n<p>Any idea how to handle certificates. Or do I have something wrong with server settings?</p>\n"
    }, {
        "tags": [
            "aws-sdk",
            "iot",
            "policy",
            "aws-iot",
            "policies"
        ],
        "is_answered": true,
        "view_count": 454,
        "favorite_count": 0,
        "score": 0,
        "last_activity_date": 1592490175,
        "creation_date": 1521038607,
        "last_edit_date": 1521472795,
        "question_id": 49280665,
        "link": "https://stackoverflow.com/questions/49280665/aws-iot-sdk-main-l206-error-subscribing-28-c-code",
        "title": "AWS IoT SDK - main L#206 Error subscribing : -28 (C code)",
        "body": "<p>I am trying to run the example in <a href=\"https://docs.aws.amazon.com/iot/latest/developerguide/iot-embedded-c-sdk.html\" rel=\"nofollow noreferrer\">this tutorial</a> from AWS IoT (AWS IoT Embedded C SDK). </p>\n\n<p>My <code>aws_iot_config.h</code> file has the following configuration:</p>\n\n<pre><code>#define AWS_IOT_MQTT_HOST              \"XXXXXXX.iot.us-east-2.amazonaws.com\" ///&lt; Customer specific MQTT HOST. The same will be used for Thing Shadow\n#define AWS_IOT_MQTT_PORT              8883 ///&lt; default port for MQTT/S\n#define AWS_IOT_MQTT_CLIENT_ID         \"c-sdk-client-id\" ///&lt; MQTT client ID should be unique for every device\n#define AWS_IOT_MY_THING_NAME          \"SM1\" ///&lt; Thing Name of the Shadow this device is associated with\n#define AWS_IOT_ROOT_CA_FILENAME       \"iotRootCA.pem\" ///&lt; Root CA file name\n#define AWS_IOT_CERTIFICATE_FILENAME   \"deviceCert.crt\" ///&lt; device signed certificate file name\n#define AWS_IOT_PRIVATE_KEY_FILENAME   \"deviceCert.key\" ///&lt; Device private key filename\n</code></pre>\n\n<p>This is how my policies are:</p>\n\n<pre><code>{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": \"iot:Connect\",\n      \"Resource\": \"*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": \"iot:Publish\",\n      \"Resource\": \"arn:aws:iot:us-east-2:338639570104:topic/sm1\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": \"iot:Subscribe\",\n      \"Resource\": \"arn:aws:iot:us-east-2:338639570104:topic/sm1\"\n    }\n  ]\n}\n</code></pre>\n\n<p>When I run the <code>subscribe_publish_sample</code> example, I am getting the following error:</p>\n\n<blockquote>\n  <p>DEBUG:   iot_tls_connect L#236  ok<br>\n      [ Protocol is TLSv1.2 ]<br>\n      [ Ciphersuite is TLS-ECDHE-ECDSA-WITH-AES-256-GCM-SHA384 ]  </p>\n  \n  <p>DEBUG:   iot_tls_connect L#238     [ Record expansion is 29 ]  </p>\n  \n  <p>DEBUG:   iot_tls_connect L#243   . Verifying peer X.509 certificate...<br>\n  DEBUG:   iot_tls_connect L#252  ok</p>\n  \n  <p>DEBUG:   iot_tls_connect L#262   . Peer certificate information    ...</p>\n  \n  <p>DEBUG:   iot_tls_connect L#264       cert. version     : 3<br>\n        serial number     : 3C:75:FE:30:01:DD:A3:B9:EF:72:DC:F6:7A:5C:A2:54<br>\n        issuer name       : C=US, O=Symantec Corporation, OU=Symantec Trust Network, CN=Symantec Class 3 ECC 256 bit SSL CA - G2\n        subject name      : C=US, ST=Washington, L=Seattle, O=Amazon.com, Inc., CN=*.iot.us-east-2.amazonaws.com<br>\n        issued  on        : 2017-10-12 00:00:00<br>\n        expires on        : 2018-10-13 23:59:59<br>\n        signed using      : ECDSA with SHA256<br>\n        EC key size       : 256 bits<br>\n        basic constraints : CA=false<br>\n        subject alt name  : iot.us-east-2.amazonaws.com, *.iot.us-east-2.amazonaws.com<br>\n        key usage         : Digital Signature<br>\n        ext key usage     : TLS Web Server Authentication, TLS Web Client Authentication  </p>\n  \n  <p>Subscribing...<br>\n  ERROR: main L#206 Error subscribing : -28 </p>\n</blockquote>\n\n<p>Can anyone show me what is happening? Am I missing something?</p>\n"
    }, {
        "tags": [
            "http",
            "python-requests",
            "iot",
            "server-sent-events",
            "lwm2m"
        ],
        "is_answered": false,
        "view_count": 232,
        "favorite_count": 0,
        "score": 0,
        "last_activity_date": 1592401696,
        "creation_date": 1591963483,
        "last_edit_date": 1591963701,
        "question_id": 62343940,
        "link": "https://stackoverflow.com/questions/62343940/sse-with-leshan-lwm2m-demo-server",
        "title": "SSE with Leshan LWM2M Demo Server",
        "body": "<p>I am trying to do an http api that interact with a Leshan Demo Server.\nI was trying to handle the OBSERVE in LWM2M, but I need to handle the notification with http.\nI discovered that leshan notify using SSE. So I was trying to implement the sse client in python using requests and sseclient.</p>\n\n<p>This is my code:</p>\n\n<pre><code>    response= requests.post(url_request , \"format=TLV\" , stream= True)    \n    client = sseclient.SSEClient(response)\n    for event in client.events():\n        print(json.loads(event.data))\n</code></pre>\n\n<p>I tried to run my script but it seems like the stream is not opening and it close immediately without waiting for the answer of the server, even if requests by default implement keep_alive for TCP connection under HTTP and the stream is True.</p>\n\n<p>Does someone know why?</p>\n"
    }, {
        "tags": [
            "mqtt",
            "embedded-linux",
            "iot",
            "mosquitto"
        ],
        "is_answered": false,
        "view_count": 87,
        "favorite_count": 0,
        "score": 0,
        "last_activity_date": 1591887513,
        "creation_date": 1591802527,
        "last_edit_date": 1591887513,
        "question_id": 62307185,
        "link": "https://stackoverflow.com/questions/62307185/mosquitto-bridge-publish-causing-oom-crashes",
        "title": "mosquitto bridge publish causing OOM crashes",
        "body": "<p>We are developing and IoT Edge application where we need to run mosquitto broker in a embedded linux gateway device. The edge broker is bridged to a cloud MQTT broker. Other devices in the edge network publishes to the edge mosquitto broker and mosquitto will publish it to the cloud. The edge gateway is located at a site where network connectivity is very constrained. </p>\n\n<p>An edge device is sending 28KB payload to the mosquitto broker at 1 message per 5 seconds frequency. We could see that the internal queue of the mosquitto goes on increasing ('$SYS/broker/messages/stored'). It increases to fully utilize the gateway memory and then mosquitto crashes.</p>\n\n<p>When we enabled logging in mosquitto and checked, we could see that </p>\n\n<ol>\n<li>The time duration between PUBLISH and PUBACKs are huge </li>\n<li>Because of this huge delay mosquitto is resending the messages multiple times</li>\n</ol>\n\n<p>See logs below for a specific message:</p>\n\n<pre><code>1591704254: Sending PUBLISH to local.clientid (d0, q1, r0, m572, 'toCLOUD/Basic', ... (32768 bytes))\n1591704275: Sending PUBLISH to local.clientid (d1, q1, r0, m572, 'toCLOUD/Basic', ... (32768 bytes))\n1591704296: Sending PUBLISH to local.clientid (d1, q1, r0, m572, 'toCLOUD/Basic', ... (32768 bytes))\n1591704317: Sending PUBLISH to local.clientid (d1, q1, r0, m572, 'toCLOUD/Basic', ... (32768 bytes))\n1591704338: Sending PUBLISH to local.clientid (d1, q1, r0, m572, 'toCLOUD/Basic', ... (32768 bytes))\n1591704359: Sending PUBLISH to local.clientid (d1, q1, r0, m572, 'toCLOUD/Basic', ... (32768 bytes))\n1591704380: Sending PUBLISH to local.clientid (d1, q1, r0, m572, 'toCLOUD/Basic', ... (32768 bytes))\n1591704401: Sending PUBLISH to local.clientid (d1, q1, r0, m572, 'toCLOUD/Basic', ... (32768 bytes))\n1591704422: Sending PUBLISH to local.clientid (d1, q1, r0, m572, 'toCLOUD/Basic', ... (32768 bytes))\n1591704526: Received PUBACK from local.clientid (Mid: 572)\n1591704597: Received PUBACK from local.clientid (Mid: 572)\n1591704680: Received PUBACK from local.clientid (Mid: 572)\n1591704750: Received PUBACK from local.clientid (Mid: 572)\n1591704838: Received PUBACK from local.clientid (Mid: 572)\n1591704901: Received PUBACK from local.clientid (Mid: 572)\n1591704975: Received PUBACK from local.clientid (Mid: 572)\n1591705039: Received PUBACK from local.clientid (Mid: 572)\n1591705120: Received PUBACK from local.clientid (Mid: 572)\n</code></pre>\n\n<p>To recreate this issue I tried using \"mosquitto_pub\" command in the geteway with same connection information like this:</p>\n\n<pre><code>for i in `seq 1 1000`\ndo\n    echo $JSON\ndone | mosquitto_pub -h broker.cloud.com  -t 'toCLOUD/TEST' -l -q 1\n</code></pre>\n\n<p>But I was not able see the same delay or duplication in the \"mosquitto_pub\"</p>\n\n<p>What would be the best solution for this? Can I increase the publish timeout for mosquitto bridge? Any other alternative solution?</p>\n\n<p>Mosquitto version: 1.4.14</p>\n\n<p>Mosquitto Bridge config:</p>\n\n<pre><code>connection MQTT_Bridge\naddress cloud.broker.com:8883\ntopic ToCloud/# out 2 \"\" \"\"\nremote_clientid abcd\nkeepalive_interval 60\nbridge_cafile /certs/ca\n</code></pre>\n\n<p>Backhaul: Satellite (200kbps not sure )</p>\n\n<p>Cloud broker : eMQTT</p>\n"
    }, {
        "tags": [
            "python-3.x",
            "mqtt",
            "iot",
            "mosquitto",
            "paho"
        ],
        "is_answered": false,
        "view_count": 54,
        "favorite_count": 0,
        "score": -1,
        "last_activity_date": 1590779013,
        "creation_date": 1590766396,
        "last_edit_date": 1590779013,
        "question_id": 62089541,
        "link": "https://stackoverflow.com/questions/62089541/simulated-iot-with-mqtt",
        "title": "Simulated IoT with MQTT",
        "body": "<p>so I am having some issues with the publishing / subscribing part of my code. Completely new, so forgive the ignorance. :)\nI am using Mosquitto. </p>\n\n<p>THIS PART SIMPLY GENERATES SOME RANDOM TEMPERATURES:</p>\n\n<pre><code>from random import random\nclass TemperatureSensor:\n    sensor_type='temperature'\n    units='celcius'\n    instance_id='SN123'\n\ndef __init__(self, average_temperature, temperature_variation, min_temperature, max_temperature):\n    self.average_temperature=average_temperature\n    self.temperature_variation=temperature_variation\n    self.min_temperature=min_temperature\n    self.max_temperature=max_temperature\n    self.value=0.0\n\ndef sense(self):\n    self.value= self.simple_random()\n    return self.value\n\ndef simple_random(self):\n    value = self.min_temperature + (random() * (self.max_temperature - self.min_temperature))\n    return value\n\n\n\nts = TemperatureSensor(20,20, 16, 35)\n</code></pre>\n\n<p>THIS IS THE PUBLISHER:</p>\n\n<pre><code>    import paho.mqtt.client as mqtt\nimport datetime\nfrom datetime import datetime\nfrom Script1 import TemperatureSensor\nimport json\n\n\nclass Simulator:\n    def __init__(self, interval):\n        self.interval = interval\n\n    def start(self):\n        ts= TemperatureSensor(20,10,16,35)\n\n        mqtt_publisher = mqtt.Client('Temperature publisher')\n        mqtt_publisher.connect('127.0.0.1',1883,60)\n        mqtt_publisher.loop_start()\n\n\n        while True: \n          dt = datetime.now().strftime(\"%d-%m-%YT%H:%M:%S\")\n          message = {\n             \"type-id\": \"de.uni-stuttgart.iaas.sc.\" + ts.sensor_type,\n             \"instance-id\": ts.instance_id,\n             \"timestamp\": dt,\n             \"value\":{\n             ts.units: ts.sense()\n             }\n\n          }\n\n          jmsg = json.dumps(message, indent=4)\n          mqtt_publisher.publish('TopicID', ts.sensor_type + '/' + ts.instance_id, jmsg, 2)\n\n          print(ts.sensor_type , ts.sense())\n          time.sleep(self.interval)\n\n\ns = Simulator(5)\ns.start()\n</code></pre>\n\n<p>FINALLY, HERE IS THE SUBSCRIBER:</p>\n\n<pre><code>import paho.mqtt.client as mqtt\nimport json\n\ndef on_message(client, userdata, message):\n    print('Message topic{}'.format(message.topic))\n    print('Message payload:')\n    print(json.message.payload.decode())\n\nmqtt_subscriber = mqtt.Client('Temperature subscriber')\nmqtt_subscriber.on_message = on_message\nmqtt_subscriber.connect('127.0.0.1',1883,60)\nmqtt_subscriber.subscribe('TopicID', qos=2)\n\nmqtt_subscriber.loop_forever()\n</code></pre>\n\n<p>When runnning the publisher, I get an error as follows:</p>\n\n<pre><code>Traceback (most recent call last):\n  File \"Script2.py\", line 40, in &lt;module&gt;\n    s.start()\n  File \"Script2.py\", line 33, in start\n    mqtt_publisher.publish('TopicID', ts.sensor_type + '/' + ts.instance_id, 2, jmsg)\n  File \"/Library/Python/2.7/site-packages/paho_mqtt-1.5.0.dev0-py2.7.egg/paho/mqtt/client.py\", line 1300, in publish\n    message.dup, message.info, message.properties)\n  File \"/Library/Python/2.7/site-packages/paho_mqtt-1.5.0.dev0-py2.7.egg/paho/mqtt/client.py\", line 2523, in _send_publish\n    command = PUBLISH | ((dup &amp; 0x1) &lt;&lt; 3) | (qos &lt;&lt; 1) | retain\nTypeError: unsupported operand type(s) for |: 'int' and 'str'\n</code></pre>\n"
    }, {
        "tags": [
            "mqtt",
            "iot"
        ],
        "is_answered": true,
        "view_count": 1094,
        "favorite_count": 2,
        "score": 1,
        "last_activity_date": 1590745730,
        "creation_date": 1479448316,
        "last_edit_date": 1479457032,
        "question_id": 40670208,
        "link": "https://stackoverflow.com/questions/40670208/emqtt-how-to-implement-acl-for-huge-no-of-clients",
        "title": "Emqtt - How to implement ACL for huge no. of clients",
        "body": "<p>I am using Emqtt (emqtt.io) broker for my next application. The scene is - \nI\u2019ll have multiple clients(10,000s) and each of them will be publishing or subscribing to topics. But i want to restrict every client to publish and subscribe only on topics congaing there own client id - For ex- \nTopics will be- </p>\n\n<p>my_device/<strong>12345</strong>/update</p>\n\n<p>my_device/<strong>99998</strong>/update</p>\n\n<p>my_device/<strong>88888</strong>/update</p>\n\n<p>If the middle attribute is the client ID, how can i restrict clients to do a pubs only on that particular topic and no one should be able to subscribe to \n<strong>my_device/#</strong>  and hence receiving all my messages. </p>\n\n<p>I saw ACL plugin, saw this code ( <strong>{allow, {user, \"dashboard\"}, subscribe, [\"$SYS/#\"]}</strong>. ) but there i have to define every client manually ? and what if a new user is added, how will i add one more rule automatically ? because with my understanding, this file is loaded on starting up of the broker, right ?. <strong>I want to use ACL based on some database.</strong> Can You help me with that ? </p>\n"
    }, {
        "tags": [
            "activemq",
            "mqtt",
            "iot"
        ],
        "is_answered": true,
        "view_count": 58,
        "favorite_count": 0,
        "score": 0,
        "last_activity_date": 1590071944,
        "creation_date": 1590065339,
        "last_edit_date": 1590070987,
        "question_id": 61934892,
        "link": "https://stackoverflow.com/questions/61934892/as-an-activemq-subscriber-how-can-i-get-the-message-publisher-username-or-any-ot",
        "title": "As an ActiveMQ subscriber how can I get the message publisher username or any other identifier to be used later?",
        "body": "<p>As an ActiveMQ subscriber I want to know the user name of the message publisher or any identifier on receiving the message. I'm using the MQTT protocol and the flow of message received from ActiveMQ broker will be saved according to provided identifier.</p>\n\n<p>I have another constraints. The authorized publisher will just publish only the data on specified topic and will not provide any extra identifier value with the data.</p>\n"
    }, {
        "tags": [
            "java",
            "amazon-web-services",
            "mqtt",
            "iot",
            "aws-iot"
        ],
        "is_answered": false,
        "view_count": 233,
        "favorite_count": 0,
        "score": 0,
        "last_activity_date": 1589977935,
        "creation_date": 1589875121,
        "last_edit_date": 1589977935,
        "question_id": 61885985,
        "link": "https://stackoverflow.com/questions/61885985/aws-iot-java-sdk-broker-disconnects-after-message-publish",
        "title": "AWS IoT Java SDK - broker disconnects after message publish",
        "body": "<p>There is an established connection to the IoT broker endpoint through the Java SDK, I can see 3 related threads in the JVM: MQTT Rec:, MQTT Snd: and MQTT Call.\nAs I call client.publish(...) using the AWSIotMqttClient, the client immediately disconnects from the broker with the following log messages:</p>\n\n<p><strong><em>May 16, 2020 12:15:52 AM com.amazonaws.services.iot.client.core.AwsIotConnection onConnectionFailure\nINFO: Connection temporarily lost</em></strong></p>\n\n<p>The disconnection reason (captured by a presence change event with Lambda): <strong><em>CONNECTION_LOST</em></strong></p>\n\n<p>I'm establishing connection in an init method as follows:</p>\n\n<pre><code>public void init() {\n  client = new AWSIotMqttClient(MQTT_CLIENT_ENDPOINT, MQTT_CLIENT_ID + new BigInteger(64, new SecureRandom()).toString(32), readStore(), KEYPASS);\n  client.setPort(8883);\n\n  try {\n    client.connect(5000, false);\n\n  } catch (AWSIotException e) {\n    ...\n  }\n}\n</code></pre>\n\n<p>The connection is successfully established.</p>\n\n<p>I'm trying to publish in a different method (running as a webservice endpoint code, in another thread):</p>\n\n<pre><code>try {\n  AWSIotMessage message = new AWSIotMessage(topic, AWSIotQos.QOS0, commandString);\n  client.publish(message, 3000);\n} catch (AWSIotException e) {\n  ...\n}\n</code></pre>\n\n<p>The <code>commandString</code> is published to the topic, however the MQTT connection immediately disconnects and reconnects.</p>\n\n<p>Here is the policy attached to the certificate:</p>\n\n<pre><code>{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"*\"\n      ],\n      \"Resource\": [\n        \"*\"\n      ]\n    }\n  ]\n}\n</code></pre>\n\n<p>The topic I want to publish: 'topictest'</p>\n\n<p>Please advise.</p>\n"
    }, {
        "tags": [
            "c",
            "mqtt",
            "iot",
            "libmosquitto"
        ],
        "is_answered": true,
        "view_count": 4430,
        "favorite_count": 0,
        "score": 1,
        "last_activity_date": 1589893475,
        "creation_date": 1496214294,
        "last_edit_date": 1496215572,
        "question_id": 44277880,
        "link": "https://stackoverflow.com/questions/44277880/mosquitto-subscribe-to-one-broker-and-push-to-another-using-c",
        "title": "Mosquitto - subscribe to one broker and push to another using C",
        "body": "<p>Is it possible and if so how to archive it that one application using libmosquitto get messages from one broker and publish it to another?</p>\n\n<p><img src=\"https://i.stack.imgur.com/9Wl1N.png\" alt=\"Schematics\"></p>\n\n<p>Its pretty simple to just change topic in mosquito_publish function, but set of broker takes place in </p>\n\n<pre><code>mosquitto_connect(mosq, \"localhost\",1883 , 60); \n</code></pre>\n\n<p>Running mosquitto_connet second time\ne.g.</p>\n\n<pre><code> mosquitto_connect(mosq, \"mqtt.example.io\",1883 , 60); \n</code></pre>\n\n<p>ends up connecting to last one.</p>\n\n<p>I tried to create two mosquitto structs but I dont know how to inform second one about message form subbed channel in order to get info from it, change it and push to proper broker. </p>\n"
    }, {
        "tags": [
            "iot",
            "publish-subscribe",
            "coap"
        ],
        "is_answered": true,
        "view_count": 201,
        "favorite_count": 0,
        "score": 0,
        "last_activity_date": 1589179269,
        "creation_date": 1589021762,
        "question_id": 61695591,
        "link": "https://stackoverflow.com/questions/61695591/coap-pub-sub-transmision-reliability",
        "title": "CoAP pub/sub transmision reliability",
        "body": "<p>I\u00b4m making a work about CoAP extension that allows it to use the Publish/Subscribe Broker model and I\u00b4m currently analyzing how is the Transmision Reliabilty gets done here. In CoAP are used CONFIRMABLE and NON-CONFIRMABLE messages, to guarantee that a message arrived to destination. My cuestion is if this extension of CoAP relies on this CoAP messages to guarantee transmision reliability, because i can\u00b4t find anything that talks about this. Thank you. </p>\n"
    }, {
        "tags": [
            "amazon-web-services",
            "aws-lambda",
            "iot",
            "core",
            "greengrass"
        ],
        "is_answered": true,
        "view_count": 419,
        "favorite_count": 0,
        "score": 0,
        "last_activity_date": 1588879708,
        "creation_date": 1569716462,
        "last_edit_date": 1570587715,
        "question_id": 58151236,
        "link": "https://stackoverflow.com/questions/58151236/greengrass-helloworld-lambda-doesnt-publish-to-amazon-iot-console",
        "title": "Greengrass_HelloWorld lambda doesn&#39;t publish to Amazon IoT console",
        "body": "<p>I have been following the documentation in every step, and I didn't face any errors. Configured, deployed and made a subscription to hello/world topic just as the documentation detailed. However,  when I arrived at the testing step here: <a href=\"https://docs.aws.amazon.com/greengrass/latest/developerguide/lambda-check.html\" rel=\"nofollow noreferrer\">https://docs.aws.amazon.com/greengrass/latest/developerguide/lambda-check.html</a></p>\n\n<p>No messages were showing up on the IoT console (subscription view hello/world)! I am using Greengrass core daemon which runs on my Ubuntu machine, it is active and listens to port 8000. I don't think there is anything wrong with my local device because the group was deployed successfully and because I see the communications going both ways on Wireshark.</p>\n\n<p>I have these logs on my machine: /home/##/Desktop/greengrass/ggc/var/log/system/runtime.log:</p>\n\n<pre><code>[2019-09-28T06:57:42.492-07:00][INFO]-===========================================\n[2019-09-28T06:57:42.492-07:00][INFO]-Greengrass Version: 1.9.3-RC3\n[2019-09-28T06:57:42.492-07:00][INFO]-Greengrass Root: /home/##/Desktop/greengrass\n[2019-09-28T06:57:42.492-07:00][INFO]-Greengrass Write Directory: /home/##/Desktop/greengrass/ggc\n[2019-09-28T06:57:42.492-07:00][INFO]-Group File Directory: /home/##/Desktop/greengrass/ggc/deployment/group\n[2019-09-28T06:57:42.492-07:00][INFO]-Default Lambda UID: 122\n[2019-09-28T06:57:42.492-07:00][INFO]-Default Lambda GID: 127\n[2019-09-28T06:57:42.492-07:00][INFO]-===========================================\n[2019-09-28T06:57:42.492-07:00][INFO]-The current core is using the AWS IoT certificates with fingerprint.  {\"fingerprint\": \"90##4d\"}\n[2019-09-28T06:57:42.492-07:00][INFO]-Will persist worker process info. {\"dir\": \"/home/##/Desktop/greengrass/ggc/ggc/core/var/worker/processes\"}\n[2019-09-28T06:57:42.493-07:00][INFO]-Will persist worker process info. {\"dir\": \"/home/##/Desktop/greengrass/ggc/ggc/core/var/worker/processes\"} \n[2019-09-28T06:57:42.494-07:00][INFO]-No proxy URL found.\n[2019-09-28T06:57:42.495-07:00][INFO]-Started Deployment Agent to listen for updates. [2019-09-28T06:57:42.495-07:00][INFO]-Connecting with MQTT.   {\"endpoint\": \"a6##ws-ats.iot.us-east-2.amazonaws.com:8883\", \"clientId\": \"simulators_gg_Core\"}\n[2019-09-28T06:57:42.497-07:00][INFO]-The current core is using the AWS IoT certificates with fingerprint.  {\"fingerprint\": \"90##4d\"}\n[2019-09-28T06:57:42.685-07:00][INFO]-MQTT connection successful.   {\"attemptId\": \"GVko\", \"clientId\": \"simulators_gg_Core\"}\n[2019-09-28T06:57:42.685-07:00][INFO]-MQTT connection established.  {\"endpoint\": \"a6##ws-ats.iot.us-east-2.amazonaws.com:8883\", \"clientId\": \"simulators_gg_Core\"} \n[2019-09-28T06:57:42.685-07:00][INFO]-MQTT connection connected. Start subscribing. {\"clientId\": \"simulators_gg_Core\"} \n[2019-09-28T06:57:42.685-07:00][INFO]-Deployment agent connected to cloud. \n[2019-09-28T06:57:42.685-07:00][INFO]-Start subscribing.    {\"numOfTopics\": 2, \"clientId\": \"simulators_gg_Core\"}\n[2019-09-28T06:57:42.685-07:00][INFO]-Trying to subscribe to topic $aws/things/simulators_gg_Core-gda/shadow/update/delta\n[2019-09-28T06:57:42.727-07:00][INFO]-Trying to subscribe to topic $aws/things/simulators_gg_Core-gda/shadow/get/accepted\n[2019-09-28T06:57:42.814-07:00][INFO]-All topics subscribed.    {\"clientId\": \"simulators_gg_Core\"}\n[2019-09-28T06:58:57.888-07:00][INFO]-Daemon received signal: terminated. [2019-09-28T06:58:57.888-07:00][INFO]-Shutting down daemon. \n[2019-09-28T06:58:57.888-07:00][INFO]-Stopping all workers.\n[2019-09-28T06:58:57.888-07:00][INFO]-Lifecycle manager is stopped.\n[2019-09-28T06:58:57.888-07:00][INFO]-IPC server stopped.\n</code></pre>\n\n<hr>\n\n<p>/home/##/Desktop/greengrass/ggc/var/log/system/localwatch/localwatch.log:</p>\n\n<pre><code>[2019-09-28T06:57:42.491-07:00][DEBUG]-will keep the log files for the following lambdas    {\"readingPath\": \"/home/##/Desktop/greengrass/ggc/var/log/user\", \"lambdas\": \"map[]\"}   \n[2019-09-28T06:57:42.492-07:00][WARN]-failed to list the user log directory {\"path\": \"/home/##/Desktop/greengrass/ggc/var/log/user\"}\n</code></pre>\n\n<p>Thanks in advance.</p>\n"
    }, {
        "tags": [
            "c#",
            "user-interface",
            "automation",
            "mqtt",
            "iot"
        ],
        "is_answered": false,
        "view_count": 830,
        "favorite_count": 0,
        "score": -2,
        "last_activity_date": 1588613171,
        "creation_date": 1588611412,
        "last_edit_date": 1588613171,
        "question_id": 61597552,
        "link": "https://stackoverflow.com/questions/61597552/is-there-a-complete-admin-panel-interface-for-mqtt-net-or-or-any-other-private-m",
        "title": "Is there a complete admin panel/interface for MQTT net or or any other private MQTT Servers/Broker?",
        "body": "<p>I'm making a simple automation system for someone and require a MQTT admin panel for server/broker. I want it such that the admin who runs the server, is able to see and change the password of the server or client. Also the admin would be able to see the all the topics and remove the subscription of of any client if they want. Admin will also be able to see all the messages sent and received.</p>\n\n<p>I was currently looking at C# MQTTnet and mosquitto but all the servers require manipulation in config files through CLI(there own set of commands on CLI). Isnt there something I can use so that all is done in clean code with WPF form for interface? Is there a solution for this problem? I want a user interface for admin. </p>\n\n<p>Also can a MQTT sever run by a novice user? who has no technical knowledge?</p>\n\n<p>Any reply is much appreciated. </p>\n"
    }, {
        "tags": [
            "iot",
            "esp32"
        ],
        "is_answered": true,
        "view_count": 76,
        "favorite_count": 0,
        "score": 0,
        "last_activity_date": 1587282765,
        "creation_date": 1587227892,
        "question_id": 61292664,
        "link": "https://stackoverflow.com/questions/61292664/is-there-a-way-to-secure-an-iot-device-e-g-esp32-that-is-physically-accessibl",
        "title": "Is there a way to secure an IOT device (e.g. ESP32) that is physically accessible?",
        "body": "<p>How do you secure IOT devices (e.g. ESP32) out in the field that is physically accessible, given that their SSL client certificate can be copied and used for impersonation and/or publishing wrong data to the server/broker? Alternatively, is there a way of knowing if the IoT client has been compromised?  </p>\n"
    }, {
        "tags": [
            "amazon-web-services",
            "amazon-cloudformation",
            "iot",
            "aws-iot"
        ],
        "is_answered": true,
        "view_count": 122,
        "favorite_count": 0,
        "score": 0,
        "last_activity_date": 1587116578,
        "creation_date": 1587047982,
        "last_edit_date": 1587048582,
        "question_id": 61253010,
        "link": "https://stackoverflow.com/questions/61253010/aws-iot-policy-still-allow-other-topics-to-access-via-mqtt",
        "title": "AWS iot policy still allow other topics to access via mqtt",
        "body": "<p>I am trying to allow only those topics to be used during subscribe and publish via mqtt in aws iot core which are specified in aws inline iot policy. But it looks like it allows other topics as well.</p>\n\n<p>For e.g this shouldn't work\nmytopic/test/test-123/publish123 (but its working) as publish123 is not specified</p>\n\n<p>Below is an inline policy</p>\n\n<pre><code>{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"iot:Connect\"\n      ],\n      \"Resource\": \"arn:aws:iot:eu-central-1:123456789:client/${iot:Certificate.Subject.CommonName}\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"iot:Subscribe\"\n      ],\n      \"Resource\": [\n        \"arn:aws:iot:eu-central-1:123456789:topicfilter/mytopic/test/${iot:Certificate.Subject.CommonName}/subsricption\",\n        \"arn:aws:iot:eu-central-1:123456789:topicfilter/mytopic/test/+/+/+/subsricption\"\n      ]\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"iot:Receive\"\n      ],\n      \"Resource\": \"arn:aws:iot:eu-central-1:123456789:topic/io/ksb/m2c/${iot:Certificate.Subject.CommonName}/*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"iot:Publish\"\n      ],\n      \"Resource\": [\n        \"arn:aws:iot:eu-central-1:123456789:topic/mytopic/test/${iot:Certificate.Subject.CommonName}/publish1\",\n        \"arn:aws:iot:eu-central-1:123456789:topic/mytopic/test/${iot:Certificate.Subject.CommonName}/publish2\",\n        \"arn:aws:iot:eu-central-1:123456789:topic/mytopic/test/+/+/+/publish2\",\n        \"arn:aws:iot:eu-central-1:123456789:topic/mytopic/test/${iot:Certificate.Subject.CommonName}/subsricption\",\n        \"arn:aws:iot:eu-central-1:123456789:topic/mytopic/test/+/+/+/subsricption\"\n      ]\n    }\n  ]\n}\n</code></pre>\n"
    }, {
        "tags": [
            "google-cloud-platform",
            "iot",
            "google-cloud-iot"
        ],
        "is_answered": false,
        "view_count": 168,
        "favorite_count": 0,
        "score": 0,
        "last_activity_date": 1586244471,
        "creation_date": 1586244471,
        "question_id": 61074829,
        "link": "https://stackoverflow.com/questions/61074829/gcp-iot-stops-processing-messages",
        "title": "GCP IoT stops processing messages",
        "body": "<p>We have multiple devices (rpi2) connected to IoT core with our self-engineered \"firmware\" that uses Python and Paho-mqtt client. Our steps to reproduce error:</p>\n\n<ol>\n<li>Log into Google Cloud</li>\n<li>Set device to DEBUG logging level.</li>\n<li>Attempt to send command using Google's IoT website (e.g., remote firmware update or just anything other)</li>\n<li>Observe immediate error responses (two cases below) from the Google control panel.</li>\n<li>Observe the logs on the device; no record of contact from GCP.</li>\n</ol>\n\n<p>And the two cases are:</p>\n\n<ol>\n<li><p>Message couldn\u2019t be sent because the device is not connected\nThis is true and not true, because we are seeing that our device gets disconnected from time to time without particular reason. We do have JWT token refreshing mechanism and it's working fine, but sometimes GCP just... disconnects device!</p></li>\n<li><p>The command couldn't be sent because the device is not subscribed to the MQTT wildcard topic.\nThis is not true, all devices are subscribed (but if they are not connected then maybe they are not subscribed...)</p></li>\n</ol>\n\n<p>Here are the things that we already checked:\n1. The JWT are refreshed 10 minutes faster than one hour (the expiry is set to 3600, but we refresh every 3000 seconds)\n2. Explicitly set MQTTv311 as the protocol to speak in Python Paho-mqtt client\n3. Implemented an on_log() handler.\n4. Implemented PINGREQ as IoT core documentation stated.\n5. Checked devices' internet connection and it's just fine.</p>\n\n<p>Here are some logs:</p>\n\n<ol>\n<li>From device:</li>\n</ol>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>[2020-04-05 21:20:58,624] root - INFO - Trying to set date and time to: 2020-04-05 21:20:58.624278\r\n[2020-04-05 21:20:59,239] root - INFO - Starting collecting device state\r\n[2020-04-05 21:20:59,256] root - INFO - Connecting to the cloud\r\n[2020-04-05 21:20:59,262] root - INFO - Device client_id is 'projects/XXX/locations/us-central1/registries/iot-registry/devices/XXX-000003'\r\n[2020-04-05 21:20:59,549] root - INFO - Starting pusher service\r\n[2020-04-05 21:21:00,050] root - INFO - on_connect: Connection Accepted.\r\n[2020-04-05 21:21:00,051] root - INFO - Subscribing to /devices/XXX-000003/commands/#\r\n[2020-04-05 21:22:04,827] root - INFO - Since 2020-04-05T21:20:59.549934, pusher sent: 469 messages, received confirmation for 469 messages, recorded 0 errors\r\n[2020-04-05 21:23:07,426] root - INFO - Since 2020-04-05T21:22:04.828064, pusher sent: 6 messages, received confirmation for 6 messages, recorded 0 errors\r\n[2020-04-05 21:24:09,815] root - INFO - Since 2020-04-05T21:23:07.427720, pusher sent: 6 messages, received confirmation for 6 messages, recorded 0 errors\r\n[2020-04-05 21:25:12,036] root - INFO - Since 2020-04-05T21:24:09.816221, pusher sent: 6 messages, received confirmation for 6 messages, recorded 0 errors\r\n[2020-04-05 21:26:14,099] root - INFO - Since 2020-04-05T21:25:12.037507, pusher sent: 6 messages, received confirmation for 6 messages, recorded 0 errors\r\n[2020-04-05 21:27:16,052] root - INFO - Since 2020-04-05T21:26:14.100430, pusher sent: 6 messages, received confirmation for 6 messages, recorded 0 errors\r\n[2020-04-05 21:28:17,807] root - INFO - Since 2020-04-05T21:27:16.053253, pusher sent: 6 messages, received confirmation for 6 messages, recorded 0 errors\r\n[2020-04-05 21:29:19,416] root - INFO - Since 2020-04-05T21:28:17.808075, pusher sent: 6 messages, received confirmation for 6 messages, recorded 0 errors</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<ol start=\"2\">\n<li>From GCP:\n<a href=\"https://i.stack.imgur.com/lowe5.png\" rel=\"nofollow noreferrer\">GCP logs</a></li>\n</ol>\n"
    }, {
        "tags": [
            "iot",
            "hue",
            "bridge",
            "shodan"
        ],
        "is_answered": false,
        "view_count": 33,
        "favorite_count": 0,
        "score": 0,
        "last_activity_date": 1585789992,
        "creation_date": 1585773998,
        "question_id": 60980012,
        "link": "https://stackoverflow.com/questions/60980012/how-to-add-hue-bridge-in-shodan-io-search-engine",
        "title": "How to Add Hue bridge in Shodan.io Search Engine",
        "body": "<p>I am working on a special project in the Philips Hue bridge and I want to add the bridge to the search engine Shodan, I want to know how to add the IoT device in order to appear in the search engine Shodan and how to add the banner to the bridge.\nFor more information, you can ask questions here</p>\n"
    }, {
        "tags": [
            "c",
            "ssl",
            "mqtt",
            "iot",
            "paho"
        ],
        "is_answered": true,
        "view_count": 1040,
        "favorite_count": 1,
        "score": 1,
        "last_activity_date": 1585666806,
        "creation_date": 1585582505,
        "question_id": 60934066,
        "link": "https://stackoverflow.com/questions/60934066/mqtt-over-ssl-with-paho-c",
        "title": "MQTT over SSL with PAHO C",
        "body": "<p>I'm trying to figure out how paho works with SSL. \nI've tested a simple pub (without SSL) using mosquitto as broker (with default mosquitto.conf) and all works well. Now I've modified the code below (using the ADDRESS define instead of ADDRESSTEST) for testing SSL. I've used the certified provided by the section \"<a href=\"https://github.com/eclipse/paho.mqtt.c/tree/master/test/ssl\" rel=\"nofollow noreferrer\">test</a>\" of paho.</p>\n\n<pre><code>#include &lt;string.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;MQTTClient.h&gt;\n\n\n#define ADDRESS     \"ssl://localhost:18885\"\n#define ADDRESSTEST     \"tcp://localhost:1883\"\n#define CLIENTID    \"ExampleClientPub\"\n#define TOPIC       \"MQTTExamples\"\n#define PAYLOAD     \"Hello World!\"\n#define QOS         1\n#define TIMEOUT     10000L\n\n\nint main() {\n\nMQTTClient client;\n\nMQTTClient_connectOptions conn_opts = MQTTClient_connectOptions_initializer;\nMQTTClient_SSLOptions ssl_opts = MQTTClient_SSLOptions_initializer;;\n\nMQTTClient_message pubmsg = MQTTClient_message_initializer;\nMQTTClient_deliveryToken token;\nint rc;\n\nMQTTClient_create(&amp;client, ADDRESS, CLIENTID,\n    MQTTCLIENT_PERSISTENCE_DEFAULT, NULL);\n\nconn_opts.keepAliveInterval = 20;\nconn_opts.cleansession = 1;\n\nconn_opts.ssl = &amp;ssl_opts;\nconn_opts.ssl-&gt;trustStore = \"../../validpath/test-root-ca.crt\";\nconn_opts.ssl-&gt;keyStore = \"../../validpath/client.pem\";\n\nconn_opts.serverURIcount = 0;\nconn_opts.serverURIs = NULL;\n\nif ((rc = MQTTClient_connect(client, &amp;conn_opts)) != MQTTCLIENT_SUCCESS)\n{\n    printf(\"Failed to connect, return code %d\\n\", rc);\n    exit(EXIT_FAILURE);\n}\n\npubmsg.payload = PAYLOAD;\npubmsg.payloadlen = (int)strlen(PAYLOAD);\npubmsg.qos = QOS;\npubmsg.retained = 0;\n\n\nMQTTClient_publishMessage(client, TOPIC, &amp;pubmsg, &amp;token);\nprintf(\"Waiting for up to %d seconds for publication of %s\\n\"\n        \"on topic %s for client with ClientID: %s\\n\",\n        (int)(TIMEOUT/1000), PAYLOAD, TOPIC, CLIENTID);\nrc = MQTTClient_waitForCompletion(client, token, TIMEOUT);\nprintf(\"Message with delivery token %d delivered\\n\", token);\nMQTTClient_disconnect(client, 10000);\nMQTTClient_destroy(&amp;client);\n\nreturn 0;\n}\n</code></pre>\n\n<p>The problem is that when i run the software with this configuration, the MQTTClient_connect return me the code <a href=\"https://www.eclipse.org/paho/files/mqttdoc/MQTTClient/html/_m_q_t_t_client_8h.html#ae9070d21de569f999a9575049cdd6da1\" rel=\"nofollow noreferrer\">MQTTCLIENT_WRONG_MQTT_VERSION</a>. Mosquitto runs in localhost and I've modified the mosquitto.conf in this way:</p>\n\n<pre><code># server authentication - no client authentication\nlistener 18885\ncafile validpath/all-ca.crt\ncertfile validpath/server.crt\nkeyfile validpath/server.key\nrequire_certificate false\n#tls_version tlsv1\n</code></pre>\n"
    }, {
        "tags": [
            "java",
            "mqtt",
            "iot",
            "hivemq",
            "tls1.3"
        ],
        "is_answered": true,
        "view_count": 1462,
        "favorite_count": 0,
        "score": 1,
        "last_activity_date": 1584739346,
        "creation_date": 1562335854,
        "last_edit_date": 1562521857,
        "question_id": 56904682,
        "link": "https://stackoverflow.com/questions/56904682/how-to-properly-use-tls-1-3-cipher-suites-in-hivemq-getting-a-ssl-exception-c",
        "title": "How to properly use TLS 1.3 cipher suites in HiveMQ? (Getting a SSL exception: closing inbound before receiving peer&#39;s close_notify)",
        "body": "<p>I want to use TLS 1.3 for my secure communication with HiveMQ. I've configured the HiveMQ community edition server <code>config.xml</code> file to specify to use TLS 1.3 cipher suites and I pointed it to the keystore containing a key pair for a 256-bit Elliptic curve key (EC NOT DSA) using the curve: <code>secp256r1</code> (which is one of the few curves supported by TLS 1.3). The 256-bit key pair is for this TLS 1.3 cipher suite I want to use: <code>TLS_AES_128_GCM_SHA256</code>. I'm also generated a 384-bit elliptic curve key for <code>TLS_AES_256_GCM_SHA384</code> but I'm just focusing on <code>TLS_AES_128_GCM_SHA256</code> as the AES 256 suite will work if I get the AES 128 to work. I already generated certificates for both of the key pairs and put them both in the <code>cacerts</code> file in the <code>JAVA HOME Folder</code>. I'm still getting a  javax.net.ssl.SSLHandshakeException: </p>\n\n<p><code>javax.net.ssl.SSLException: closing inbound before receiving peer's close_notify</code></p>\n\n<p>I've tried using this TLS 1.2 cipher suite: <code>TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256</code> (with the appropriate certificate) and it worked without any issues so it appears this issue is specifically with TLS 1.3. My project is in <code>Java 12.0.1</code>. I noticed that while the HiveMQ server recognized TLSv1.3 it enabled TLSv1.2 protocols, but didn't say it enabled any TLSv1.3 cipher suites. Do I need to manually enable TLSv1.3 cipher suites in HiveMQ somehow because it doesn't look like they are on even when specifying the specific protocol? I left a copy of the servers console output below along with Java code and the exception. </p>\n\n<hr>\n\n<p><strong>Update</strong>: I've specified the client to use TLS1.3 with the <code>.protocols()</code> method in <code>sslConfig</code>. I've tried manually adding the cipher suite: <code>TLS_AES_128_GCM_SHA256</code> to the config.xml file but I get an SSL exception error this time. The updated outputs and exceptions are below. I suspect that HiveMQ is filtering out the cipher suite that I'm trying to use. I tried creating an SSL engine as a test and used <code>.getEnabledCipherSuites()</code> and <code>getSupportedCipherSuites()</code> and it says that the TLS 1.3 cipher suites above supported by my JVM and also the TLS1.3 protocol itself. </p>\n\n<p>HiveMQ Server Console Output (From <code>run.sh</code> file with DEBUG enabled in <code>logback.xml</code>):</p>\n\n<pre><code>2019-07-06 12:06:42,394 INFO  - Starting HiveMQ Community Edition Server\n2019-07-06 12:06:42,398 INFO  - HiveMQ version: 2019.1\n2019-07-06 12:06:42,398 INFO  - HiveMQ home directory: /Users/chigozieasikaburu/git/IoT-HiveMqtt-Community-Edition/build/zip/hivemq-ce-2019.1\n2019-07-06 12:06:42,508 INFO  - Log Configuration was overridden by /Users/someuser/git/IoT-HiveMqtt-Community-Edition/build/zip/hivemq-ce-2019.1/conf/logback.xml\n2019-07-06 12:06:42,619 DEBUG - Reading configuration file /Users/someuser/git/IoT-HiveMqtt-Community-Edition/build/zip/hivemq-ce-2019.1/conf/config.xml\n2019-07-06 12:06:42,838 DEBUG - Adding TCP Listener with TLS of type TlsTcpListener on bind address 0.0.0.0 and port 8883.\n2019-07-06 12:06:42,839 DEBUG - Setting retained messages enabled to true\n2019-07-06 12:06:42,839 DEBUG - Setting wildcard subscriptions enabled to true\n2019-07-06 12:06:42,839 DEBUG - Setting subscription identifier enabled to true\n2019-07-06 12:06:42,839 DEBUG - Setting shared subscriptions enabled to true\n2019-07-06 12:06:42,839 DEBUG - Setting maximum qos to EXACTLY_ONCE \n2019-07-06 12:06:42,840 DEBUG - Setting topic alias enabled to true\n2019-07-06 12:06:42,840 DEBUG - Setting topic alias maximum per client to 5\n2019-07-06 12:06:42,840 DEBUG - Setting the number of max queued messages  per client to 1000 entries\n2019-07-06 12:06:42,841 DEBUG - Setting queued messages strategy for each client to DISCARD\n2019-07-06 12:06:42,841 DEBUG - Setting the expiry interval for client sessions to 4294967295 seconds\n2019-07-06 12:06:42,841 DEBUG - Setting the expiry interval for publish messages to 4294967296 seconds\n2019-07-06 12:06:42,841 DEBUG - Setting the server receive maximum to 10\n2019-07-06 12:06:42,841 DEBUG - Setting keep alive maximum to 65535 seconds\n2019-07-06 12:06:42,841 DEBUG - Setting keep alive allow zero to true\n2019-07-06 12:06:42,842 DEBUG - Setting the maximum packet size for mqtt messages 268435460 bytes\n2019-07-06 12:06:42,842 DEBUG - Setting global maximum allowed connections to -1\n2019-07-06 12:06:42,842 DEBUG - Setting the maximum client id length to 65535\n2019-07-06 12:06:42,842 DEBUG - Setting the timeout for disconnecting idle tcp connections before a connect message was received to 10000 milliseconds\n2019-07-06 12:06:42,842 DEBUG - Throttling the global incoming traffic limit 0 bytes/second\n2019-07-06 12:06:42,842 DEBUG - Setting the maximum topic length to 65535\n2019-07-06 12:06:42,843 DEBUG - Setting allow server assigned client identifier to true\n2019-07-06 12:06:42,843 DEBUG - Setting validate UTF-8 to true\n2019-07-06 12:06:42,843 DEBUG - Setting payload format validation to false\n2019-07-06 12:06:42,843 DEBUG - Setting allow-problem-information to true\n2019-07-06 12:06:42,843 DEBUG - Setting anonymous usage statistics enabled to false \n2019-07-06 12:06:42,845 INFO  - This HiveMQ ID is JAzWT\n2019-07-06 12:06:43,237 DEBUG - Using disk-based Publish Payload Persistence\n2019-07-06 12:06:43,259 DEBUG - 1024.00 MB allocated for qos 0 inflight messages\n2019-07-06 12:06:45,268 DEBUG - Initializing payload reference count and queue sizes for client_queue persistence.\n2019-07-06 12:06:45,690 DEBUG - Diagnostic mode is disabled\n2019-07-06 12:06:46,276 DEBUG - Throttling incoming traffic to 0 B/s\n2019-07-06 12:06:46,277 DEBUG - Throttling outgoing traffic to 0 B/s\n2019-07-06 12:06:46,321 DEBUG - Set extension executor thread pool size to 4\n2019-07-06 12:06:46,321 DEBUG - Set extension executor thread pool keep-alive to 30 seconds\n2019-07-06 12:06:46,336 DEBUG - Building initial topic tree\n2019-07-06 12:06:46,395 DEBUG - Started JMX Metrics Reporting.\n2019-07-06 12:06:46,491 INFO  - Starting HiveMQ extension system.\n2019-07-06 12:06:46,536 DEBUG - Starting extension with id \"hivemq-file-rbac-extension\" at /Users/someuser/git/IoT-HiveMqtt-Community-Edition/build/zip/hivemq-ce-2019.1/extensions/hivemq-file-rbac-extension\n2019-07-06 12:06:46,558 INFO  - Starting File RBAC extension.\n2019-07-06 12:06:46,795 INFO  - Extension \"File Role Based Access Control Extension\" version 4.0.0 started successfully.\n2019-07-06 12:06:46,818 INFO  - Enabled protocols for TCP Listener with TLS at address 0.0.0.0 and port 8883: [TLSv1.3]\n2019-07-06 12:06:46,819 INFO  - Enabled cipher suites for TCP Listener with TLS at address 0.0.0.0 and port 8883: []\n2019-07-06 12:06:46,823 WARN  - Unknown cipher suites for TCP Listener with TLS at address 0.0.0.0 and port 8883: [TLS_AES_128_GCM_SHA256, TLS_AES_256_GCM_SHA384]\n2019-07-06 12:06:46,827 INFO  - Starting TLS TCP listener on address 0.0.0.0 and port 8883\n2019-07-06 12:06:46,881 INFO  - Started TCP Listener with TLS on address 0.0.0.0 and on port 8883\n2019-07-06 12:06:46,882 INFO  - Started HiveMQ in 4500ms\n2019-07-06 12:10:32,396 DEBUG - SSL Handshake failed for client with IP UNKNOWN: No appropriate protocol (protocol is disabled or cipher suites are inappropriate)\n2019-07-06 12:10:38,967 DEBUG - SSL Handshake failed for client with IP UNKNOWN: No appropriate protocol (protocol is disabled or cipher suites are inappropriate)\n2019-07-06 12:23:29,721 DEBUG - SSL Handshake failed for client with IP UNKNOWN: No appropriate protocol (protocol is disabled or cipher suites are inappropriate)\n2019-07-06 12:23:35,990 DEBUG - SSL Handshake failed for client with IP UNKNOWN: No appropriate protocol (protocol is disabled or cipher suites are inappropriate)\n2019-07-06 12:24:17,436 DEBUG - SSL Handshake failed for client with IP UNKNOWN: No appropriate protocol (protocol is disabled or cipher suites are inappropriate)\n2019-07-06 12:24:29,160 DEBUG - SSL Handshake failed for client with IP UNKNOWN: No appropriate protocol (protocol is disabled or cipher suites are inappropriate)\n</code></pre>\n\n<p>Java Code: </p>\n\n<pre><code>Mqtt5BlockingClient subscriber = Mqtt5Client.builder()\n        .identifier(UUID.randomUUID().toString()) // the unique identifier of the MQTT client. The ID is randomly generated between \n        .serverHost(\"localhost\")  // the host name or IP address of the MQTT server. Kept it localhost for testing. localhost is default if not specified.\n        .serverPort(8883)  // specifies the port of the server\n        .addConnectedListener(context -&gt; ClientConnectionRetreiver.printConnected(\"Subscriber1\"))        // prints a string that the client is connected\n        .addDisconnectedListener(context -&gt; ClientConnectionRetreiver.printDisconnected(\"Subscriber1\"))  // prints a string that the client is disconnected\n        .sslConfig()\n            .cipherSuites(Arrays.asList(\"TLS_AES_128_GCM_SHA256\"))\n            .applySslConfig()\n        .buildBlocking();  // creates the client builder                \n         subscriber.connectWith() // connects the client\n            .simpleAuth()\n                .username(\"user1\")                                                                                                                      \n                .password(\"somepassword\".getBytes())\n                .applySimpleAuth()\n            .send();\n</code></pre>\n\n<p>Exception (using Ssl debugging tool: -Djavax.net.debug=ssl):</p>\n\n<pre><code>SubThread1 is running.\njavax.net.ssl|DEBUG|0F|nioEventLoopGroup-2-1|2019-07-05 15:29:47.379 EDT|SSLCipher.java:463|jdk.tls.keyLimits:  entry = AES/GCM/NoPadding KeyUpdate 2^37. AES/GCM/NOPADDING:KEYUPDATE = 137438953472\njavax.net.ssl|ALL|0F|nioEventLoopGroup-2-1|2019-07-05 15:29:47.761 EDT|SSLEngineImpl.java:752|Closing outbound of SSLEngine\njavax.net.ssl|ALL|0F|nioEventLoopGroup-2-1|2019-07-05 15:29:47.762 EDT|SSLEngineImpl.java:724|Closing inbound of SSLEngine\njavax.net.ssl|ERROR|0F|nioEventLoopGroup-2-1|2019-07-05 15:29:47.765 EDT|TransportContext.java:312|Fatal (INTERNAL_ERROR): closing inbound before receiving peer's close_notify (\n\"throwable\" : {\n  javax.net.ssl.SSLException: closing inbound before receiving peer's close_notify\n    at java.base/sun.security.ssl.Alert.createSSLException(Alert.java:133)\n    at java.base/sun.security.ssl.Alert.createSSLException(Alert.java:117)\n    at java.base/sun.security.ssl.TransportContext.fatal(TransportContext.java:307)\n    at java.base/sun.security.ssl.TransportContext.fatal(TransportContext.java:263)\n    at java.base/sun.security.ssl.TransportContext.fatal(TransportContext.java:254)\n    at \n\njava.base/sun.security.ssl.SSLEngineImpl.closeInbound(SSLEngineImpl.java:733)\n        at io.netty.handler.ssl.SslHandler.setHandshakeFailure(SslHandler.java:1565)\n\n    at io.netty.handler.ssl.SslHandler.channelInactive(SslHandler.java:1049)\n    at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:245)\n    at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:231)\n    at io.netty.channel.AbstractChannelHandlerContext.fireChannelInactive(AbstractChannelHandlerContext.java:224)\n    at io.netty.channel.DefaultChannelPipeline$HeadContext.channelInactive(DefaultChannelPipeline.java:1429)\n    at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:245)\n    at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:231)\n    at io.netty.channel.DefaultChannelPipeline.fireChannelInactive(De\n\nfaultChannelPipeline.java:947)\n        at io.netty.channel.AbstractChannel$AbstractUnsafe$8.run(AbstractChannel.java:826)\n        at io.netty.util.concurrent.AbstractEventExecutor.safeExecute(AbstractEventExecutor.java:163)\n        at io.netty.util.concurrent.SingleThreadEventExecutor.runAllTasks(SingleThreadEventExecutor.java:404)\n        at io.nett\n\ny.channel.nio.NioEventLoop.run(NioEventLoop.java:474)\n    at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:909)\n    at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)\n    at java.base/java.lang.Thread.run(Thread.java:835)}\n\n    )\n    Subscriber1 disconnected.\n    Exception in thread \"SubThread1\" com.hivemq.client.mqtt.exceptions.ConnectionClosedException: Server closed connection without DISCONNECT.\n        at com.hivemq.client.internal.mqtt.MqttBlockingClient.connect(MqttBlockingClient.java:91)\n        at \n\ncom.hivemq.client.internal.mqtt.message.connect.MqttConnectBuilder$Send.send(MqttConnectBuilder.java:196)\n    at com.main.SubThread.run(SubThread.java:90)\n    at java.base/java.lang.Thread.run(Thread.java:835)\n</code></pre>\n"
    }, {
        "tags": [
            "ssl",
            "google-cloud-platform",
            "timeout",
            "iot",
            "google-cloud-iot"
        ],
        "is_answered": true,
        "view_count": 589,
        "favorite_count": 0,
        "score": 0,
        "last_activity_date": 1584721580,
        "creation_date": 1571739793,
        "last_edit_date": 1572268820,
        "question_id": 58502140,
        "link": "https://stackoverflow.com/questions/58502140/google-cloud-connection-timout-tls-handshake",
        "title": "Google Cloud - Connection timout, TLS - handshake",
        "body": "<p>I am developing a project based on the <code>Google Cloud IoT Core platform</code>. I want to <strong>publish</strong> telemetry data using the <strong>GSM module (SIM7020 - NB-IoT)</strong>. </p>\n\n<p>However, the connection time <code>(TLS handshake)</code> takes <strong>a lot of time</strong> (> 10 seconds) and the connection is broken by the Google server.</p>\n\n<p>What is the timeout handshake? </p>\n\n<p>Can I <strong>extend</strong> this timeout in <code>IoT Core settings</code>?. Anyone have an idea how to work around this problem with slow connections?</p>\n\n<p>best regards</p>\n"
    }, {
        "tags": [
            "python",
            "amazon-web-services",
            "iot",
            "policy",
            "aws-iot"
        ],
        "is_answered": true,
        "view_count": 298,
        "favorite_count": 0,
        "score": 0,
        "last_activity_date": 1584328419,
        "creation_date": 1582994376,
        "last_edit_date": 1583130634,
        "question_id": 60467366,
        "link": "https://stackoverflow.com/questions/60467366/aws-iot-resource-in-policy-cause-aws-iot-publishin-status-authorization-error",
        "title": "AWS IoT: Resource in policy cause AWS IoT PublishIn Status: AUTHORIZATION_ERROR",
        "body": "<p>I am publishing messages from temperature sensor to AWS IoT Core using AWSIoTPythonSDK. When I am explicitly specifying topics as Resource in certificate policy I am getting AUTHORIZATION_ERROR in Cloudwatch</p>\n\n<p>Note: PrincipleID (Certificate Name) changed for security</p>\n\n<pre><code>2020-02-22T20:03:48.371-07:00\n2020-02-23 03:03:48.371 TRACEID:2a0de6c8-dd28-586e-671f-119de983b5d5 PRINCIPALID:9ec115f5665XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX0d7d6b7 /ERROR/ EVENT:PublishEvent TOPICNAME:topic/tSensor01/tempmon MESSAGE:PublishIn Status: AUTHORIZATION_ERROR Failure reason:AUTHORIZATION_FAILURE\n@ingestionTime\n1582427034767\n@log\n549210374177:AWSIotLogs\n@logStream\na2d5c94d-f908-4e76-bd9e-3627976e8b72_549210374177_0\n@message\n2020-02-23 03:03:48.371 TRACEID:2a0de6c8-dd28-586e-671f-119de983b5d5 PRINCIPALID:9ec115f5665XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX0d7d6b7 /ERROR/ EVENT:PublishEvent TOPICNAME:topic/tSensor01/tempmon MESSAGE:PublishIn Status: AUTHORIZATION_ERROR Failure reason:AUTHORIZATION_FAILURE\n</code></pre>\n\n<p>Here is my certificate policy (showing only the iot:Publish) which is causing AUTHORIZATION_ERROR </p>\n\n<pre><code>\"Statement\": [\n{\n\"Effect\": \"Allow\",\n\"Action\": [\n\"iot:Publish\",\n\"iot:Receive\"\n],\n\"Resource\": [\n\"arn:aws:iot:&lt;region&gt;:&lt;account id&gt;:topic/${iot:Connection.Thing.ThingName}/*\",\n\"arn:aws:iot:&lt;region&gt;:&lt;account id&gt;:topic/${iot:ClientId}/*\",\n\"arn:aws:iot:&lt;region&gt;:&lt;account id&gt;:topic/tSensor01/*\",\n\"arn:aws:iot:&lt;region&gt;:&lt;account id&gt;:topic/tSensor01/tempmon\"\n]\n},\n</code></pre>\n\n<p>However to isolate the problem I used brute force method (not acceptable) by adding following line arn:aws:iot:::* into the policy and messages from device are getting published.</p>\n\n<pre><code>{\n\"Effect\": \"Allow\",\n\"Action\": [\n\"iot:Publish\",\n\"iot:Receive\"\n],\n\"Resource\": [\n\"arn:aws:iot:&lt;region&gt;:&lt;account id&gt;:topic/${iot:Connection.Thing.ThingName}/*\",\n\"arn:aws:iot:&lt;region&gt;:&lt;account id&gt;:topic/${iot:ClientId}/*\",\n\"arn:aws:iot:&lt;region&gt;:&lt;account id&gt;:topic/tSensor01/*\",\n\"arn:aws:iot:&lt;region&gt;:&lt;account id&gt;:topic/tSensor01/tempmon\",\n\"arn:aws:iot:&lt;region&gt;:&lt;account id&gt;:*\"\n]\n},\n</code></pre>\n\n<p>Such brute force method is unaccptable and I would like to know the root cause.</p>\n\n<p>Device connection works fine. So it is safe to assume that my credential information is not an issue</p>\n\n<p>Following shows connection trace in Cloudwatch log</p>\n\n<pre><code>2020-02-22T20:03:48.314-07:00\n2020-02-23 03:03:48.314 TRACEID:f801f2bb-147f-5c94-2e2e-7d63d7cacd26 PRINCIPALID:9ec115f5665XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX0d7d6b7 /INFO/ EVENT:MQTT Client Connect MESSAGE:Connect Status: SUCCESS\n@ingestionTime\n1582427034767\n@log\n549210374177:AWSIotLogs\n@logStream\na2d5c94d-f908-4e76-bd9e-3627976e8b72_549210374177_0\n@message\n2020-02-23 03:03:48.314 TRACEID:f801f2bb-147f-5c94-2e2e-7d63d7cacd26 PRINCIPALID:9ec115f5665XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX0d7d6b7 /INFO/ EVENT:MQTT Client Connect MESSAGE:Connect Status: SUCCESS\n</code></pre>\n\n<p>Thanks</p>\n"
    }, {
        "tags": [
            "amazon-web-services",
            "openssl",
            "certificate",
            "iot",
            "aws-iot"
        ],
        "is_answered": true,
        "view_count": 10474,
        "favorite_count": 4,
        "score": 11,
        "last_activity_date": 1583387315,
        "creation_date": 1526656092,
        "last_edit_date": 1526714598,
        "question_id": 50414315,
        "link": "https://stackoverflow.com/questions/50414315/the-ca-certificate-does-not-have-the-basicconstraints-extension-as-true",
        "title": "The CA certificate does not have the basicConstraints extension as true",
        "body": "<p>I am following this <a href=\"https://aws.amazon.com/premiumsupport/knowledge-center/iot-self-signed-certificates/\" rel=\"noreferrer\">AWS GUIDE</a> on creating self-signed certificates.\nBut after creating my CA, I try to upload it to AWS IOT I get this error:</p>\n\n<p>Command:</p>\n\n<p><code>aws iot register-ca-certificate --ca-certificate file://CA_cert.pem --verification-cert file://verificationCert.crt</code></p>\n\n<p>Error:</p>\n\n<p><code>An error occurred (CertificateValidationException) when calling the RegisterCACertificate operation: CA certificate is not valid. The CA certificate does not have the basicConstraints extension as true</code></p>\n\n<p>Any help appreciated!</p>\n"
    }, {
        "tags": [
            "python",
            "mqtt",
            "iot",
            "paho"
        ],
        "is_answered": false,
        "view_count": 74,
        "favorite_count": 0,
        "score": 0,
        "last_activity_date": 1583335996,
        "creation_date": 1583307175,
        "last_edit_date": 1583335996,
        "question_id": 60521031,
        "link": "https://stackoverflow.com/questions/60521031/modifying-variables-based-on-mqtt-payloads-for-raspberry-pi-3b",
        "title": "Modifying variables based on MQTT payloads for Raspberry Pi 3B+",
        "body": "<p>So, I'm trying to modify a PWM signal based on message payloads sent from an MQTT broker.\nMy client code looks like this:</p>\n\n<pre><code>import paho.mqtt.client as mqtt #import the client1\nimport RPi.GPIO as g\n############\n\ng.setmode(g.BCM)  \ng.setup(24, g.OUT)\np= g.PWM(24, 1)\np.start(10)\n\n#Recibimos esta confirmacion cuando recibimos respuesta de conexion con el servidor\nfreq=1\nduty=10\n\ndef on_connect(client, userdata, flags, rc):  ##Creamos la funcion 'on_connect'\n    print(\"Connected with result code \" +str(rc))\n#Una vez conectados, nos suscribimos a los topicos\n    client.subscribe(\"CoreElectronics/test\")  #suscripcion a test\n#Cada uno de estos topics debe mandarnos un mensaje, en este caso\n    #'test' nos devuelve 'Hello'\n    #'topic' nos devuelve 'World!'\n\n##Recibimos esta confirmacion cuando nos llega un mensaje del servidor\n\ndef on_message(client, userdata, msg):     #Creamos la funcion 'on_message'\n    msg.payload=msg.payload.decode(\"utf-8\")\n    print(msg.topic+ \" \" +str(msg.payload))\n\n    if msg.payload == \"f\":  #Respuesta del primer topic\n        freq= freq+2\n        p.ChangeFrequency(freq)\n        print(\"Recieved Frequency increment, LED frequency is now: \", freq)\n\n\n    if msg.payload == \"d\": #Respuesta del segundo topic\n        if freq==1:\n            freq=freq\n            print('The frequency is minimal!')\n        else:\n            freq= freq-2\n            print(\"Recieved Frequency decrement, LED frequency is now: \", freq)\n            p.ChangeFrequency(freq)\n\n    if msg.payload == \"l\": #Respuesta del segundo topic\n        if duty==100:\n            duty=duty\n            print('The Duty Cycle is maximum!')\n        else:\n            duty= duty+10\n            p.ChangeDutyCycle(duty)\n            print(\"Recieved Duty Cycle increment, LED duty is now: \", duty)\n\n\n    if msg.payload == \"k\": #Respuesta del segundo topic\n        if duty==1:\n            duty=duty\n            duty()\n            print('The Duty Cycle is minimal!')\n        else:\n            duty=duty-10\n            duty()\n            p.ChangeDutyCycle(duty)\n            print(\"Recieved Duty Cycle decrement, LED duty is now: \", duty)\n\n#Creamos un cliente MQTT y le adjuntamos rutinas\n\nclient = mqtt.Client()  #Aqui creamos un cliente de mqtt, llamado 'client'\nfreq=freq\nduty=duty\nclient.on_connect = on_connect\nclient.on_message = on_message\nclient.connect(\"mqtt.eclipse.org\", 1883,60) # Nos conectamos a esta direccion\nclient.loop_forever()  #El cliente se ejecutara indefinidamente\n</code></pre>\n\n<p>And my publisher looks like this:</p>\n\n<pre><code>import paho.mqtt.publish as publish\nwhile 1: publish.single(\"CoreElectronics/test\", input(), hostname= \"mqtt.eclipse.org\")\n</code></pre>\n\n<p>The gist of these programs is for me to send character inputs from the Broker to the Client in order to change the values of 'freq' and 'duty' to control the PWM that feeds an LED. Sadly, to no avail. The Client program only prints:</p>\n\n<pre><code>CoreElectronics/test f #this last character changing depending on the broker input. Be it: f, d, l or k\n</code></pre>\n"
    }, {
        "tags": [
            "node.js",
            "tcp",
            "mqtt",
            "microcontroller",
            "iot"
        ],
        "is_answered": false,
        "view_count": 71,
        "favorite_count": 0,
        "score": 1,
        "last_activity_date": 1582654410,
        "creation_date": 1582654091,
        "last_edit_date": 1582654410,
        "question_id": 60400785,
        "link": "https://stackoverflow.com/questions/60400785/esp8266-module-publishes-messages-but-the-subscriber-doesnt-get-anything-via-mq",
        "title": "ESP8266 module publishes messages but the subscriber doesn&#39;t get anything via MQTT",
        "body": "<p>I am a newbie in IoT and MQTT. I have a ESP8266 module that wants to connect to a web app and publish messages to it, for doing this I am using pubsub client library for the module and NodeJs MQTT for the server-side and HiveMQ.com as a broker.\nThe module can publish messages randomly successfully but the subscriber(server-side) can't get any messages. What's the problem?</p>\n\n<p><strong>Module</strong></p>\n\n<pre><code>const char* ssid = \"Knight\";\nconst char* password = \"0520298926\";\nconst char* mqtt_server = \"broker.hivemq.com\";\n\nWiFiClient espClient;\nPubSubClient client(espClient);\nunsigned long lastMsg = 0;\n#define MSG_BUFFER_SIZE  (50)\nchar msg[MSG_BUFFER_SIZE];\nint value = 0;\n\nvoid setup_wifi() {\n\n  delay(10);\n  // We start by connecting to a WiFi network\n  Serial.println();\n  Serial.print(\"Connecting to \");\n  Serial.println(ssid);\n\n  WiFi.begin(ssid, password);\n\n  while (WiFi.status() != WL_CONNECTED) {\n    delay(500);\n    Serial.print(\".\");\n  }\n\n  randomSeed(micros());\n\n  Serial.println(\"\");\n  Serial.println(\"WiFi connected\");\n  Serial.println(\"IP address: \");\n  Serial.println(WiFi.localIP());\n}\n\nvoid callback(char* topic, byte* payload, unsigned int length) {\n  Serial.print(\"Message arrived [\");\n  Serial.print(topic);\n  Serial.print(\"] \");\n  for (int i = 0; i &lt; length; i++) {\n    Serial.print((char)payload[i]);\n  }\n  Serial.println();\n\n  // Switch on the LED if an 1 was received as first character\n  if ((char)payload[0] == '1') {\n    digitalWrite(BUILTIN_LED, LOW);   // Turn the LED on (Note that LOW is the voltage level\n    // but actually the LED is on; this is because\n    // it is active low on the ESP-01)\n  } else {\n    digitalWrite(BUILTIN_LED, HIGH);  // Turn the LED off by making the voltage HIGH\n  }\n\n}\n\nvoid reconnect() {\n  // Loop until we're reconnected\n  while (!client.connected()) {\n    Serial.print(\"Attempting MQTT connection...\");\n    // Create a random client ID\n    String clientId = \"clientId-xnHbRALbr5\";\n    // Attempt to connect\n    if (client.connect(clientId.c_str())) {\n      Serial.println(\"connected\");\n      // Once connected, publish an announcement...\n      client.publish(\"doorphone/connected\", \"true\");\n      // ... and resubscribe\n      client.subscribe(\"doorphone/close\");\n    } else {\n      Serial.print(\"failed, rc=\");\n      Serial.print(client.state());\n      Serial.println(\" try again in 5 seconds\");\n      // Wait 5 seconds before retrying\n      delay(5000);\n    }\n  }\n}\n\nvoid setup() {\n  pinMode(BUILTIN_LED, OUTPUT);     // Initialize the BUILTIN_LED pin as an output\n  Serial.begin(115200);\n  setup_wifi();\n  client.setServer(mqtt_server, 1883);\n  client.setCallback(callback);\n}\n\nvoid loop() {\n\n  if (!client.connected()) {\n    reconnect();\n  }\n  client.loop();\n\n//  unsigned long now = millis();\n// \n//    lastMsg = now;\n    ++value;\n    snprintf (msg, MSG_BUFFER_SIZE, \"hello world #%ld\", value);\n    Serial.print(\"Publish message: \");\n    Serial.println(msg);\n    client.publish(\"doorphone/open\", msg);\n\n}\n</code></pre>\n\n<p><strong>Server-Side</strong></p>\n\n<pre><code>const mqtt = require('mqtt')\nvar options = [{\n    port: 1883,\n    host: 'mqtt://broker.hivemq.com',\n    clientId: '',\n}];\nconst client = mqtt.connect('mqtt://broker.hivemq.com', options)\n\n/**\n* The state of the doorphone, defaults to closed\n* Possible states : closed, opening, open, closing\n*/\n\n\nclient.on('connect', () =&gt; {\n  client.subscribe('doorphone/open')\n  client.subscribe('doorphone/close')\n\n  // Inform controllers that doorphone is connected\n  client.subscribe('doorphone/connected', 'true')\n})\n\nclient.on('message', (topic, message) =&gt; {\n    console.log('received message %s %s', topic, message)\n    switch (topic) {\n        case 'doorphone/open':\n          return handleOpenRequest(message)\n        case 'doorphone/close':\n          return handleCloseRequest(message)\n        case 'doorphone/connected':\n            console.log(message)\n      }\n})\n\n\nfunction handleOpenRequest (message) {\n    console.log('opening doorphone door %s', message)\n}\n\n\nfunction handleCloseRequest (message) {\n    console.log('closing doorphone door %s', message)\n}\n</code></pre>\n"
    }, {
        "tags": [
            "java",
            "logging",
            "mqtt",
            "iot"
        ],
        "is_answered": false,
        "view_count": 168,
        "favorite_count": 0,
        "score": 0,
        "last_activity_date": 1581968108,
        "creation_date": 1581020531,
        "last_edit_date": 1581968108,
        "question_id": 60102919,
        "link": "https://stackoverflow.com/questions/60102919/how-do-i-redirect-the-java-logger-output-mqtt-to-a-topic-on-a-specific-mqtt-brok",
        "title": "How do I redirect the java logger output MQTT to a topic on a specific MQTT broker",
        "body": "<p>I have a java program collecting energy data on an IOT device which it sends over MQTT to Node-RED for storage on InFlux and presentation via Grafana. I also send simple log messages over MQTT on a separate topic to Node-RED for debugging purposes. I can get the console on my IOT device (an RPi Zero W) via SSH but it is very slow and unreliable. I would like to use the java system logger for logging, but I want the output formatted as a readable string or json and sent to a topic I specify on my MQTT broker.\nSo is there a logging handler available to do this or how would I go about writing one?</p>\n\n<p>My current logger is shown below, and picks up log messages from a shared queue of strings</p>\n\n<pre><code>public class PMLogger extends Thread\n{\n    String msg;\n    LinkedBlockingQueue&lt;String&gt; loggingQ;\n\n    public PMLogger(LinkedBlockingQueue&lt;String&gt; logQ)\n    {\n        this.loggingQ = logQ;\n    }\n\n    //\n    // Runnable implementation\n    //\n    @Override\n    public void run()\n    {\n        try {\n            Thread.sleep(1000); // wait for publisher to be set up\n        } catch (InterruptedException e) {\n            e.printStackTrace();\n        }\n        MQTTHandler publisher = Main.getMqttHandler();\n        String json;\n        boolean exit = false;\n        try {\n            while (!(interrupted() || exit)) {\n                msg = loggingQ.take();\n                if (msg.equalsIgnoreCase(\"exit\")) {\n                    exit = true;\n                } //poison pill\n                json = \"{\\\"Time\\\":\" +\n                        \"\\\"\" + Instant.now().toString() + \"\\\",\" +\n                        \"\\\"LogMsg\\\":\" +\n                        \"\\\"\" + msg + \"\\\"}\";\n                publisher.logToBroker(json);\n                Thread.sleep(10);\n            }\n        } catch (InterruptedException | NullPointerException e) {\n            e.printStackTrace();\n            exit = true;\n        }\n    }\n}\n</code></pre>\n\n<p>I found <a href=\"https://www.loggly.com/ultimate-guide/java-logging-basics/\" rel=\"nofollow noreferrer\">loggly.com</a> useful in explaining the terminology, having read through that, I believe I am looking for an appender that works with MQTT</p>\n"
    }, {
        "tags": [
            "mqtt",
            "iot",
            "mosquitto"
        ],
        "is_answered": false,
        "view_count": 21,
        "favorite_count": 0,
        "score": 0,
        "last_activity_date": 1581957911,
        "creation_date": 1581957911,
        "question_id": 60266975,
        "link": "https://stackoverflow.com/questions/60266975/tell-moquitto-server-broker-to-retain-certain-topics",
        "title": "tell moquitto server/broker to retain certain topics?",
        "body": "<p>Some IoT devices are sending me messages concerning their power switches which I would like to 'retain', in order to allow new MQTT connections to immediately know if the other device is turned on or off. Sadly, the IoT device doesn't set the 'retain' option on these topics, so I have to wait til their next periodic call-in to ascertain their current status.</p>\n\n<p>Is there a way to tell de mosquitto server/broker to retain certain incoming messages, or do only the clients have that option?</p>\n\n<p>A workaround would be to have a constant process re-publish the messages with the retain option set, but that seems like a kludge.</p>\n"
    }, {
        "tags": [
            "client",
            "mqtt",
            "iot",
            "publish-subscribe",
            "broker"
        ],
        "is_answered": false,
        "view_count": 225,
        "favorite_count": 0,
        "score": 0,
        "last_activity_date": 1581518002,
        "creation_date": 1580969303,
        "question_id": 60088657,
        "link": "https://stackoverflow.com/questions/60088657/google-cloud-platform-google-iot-mqtt-client-subscribing-to-an-external-mqtt-b",
        "title": "google-cloud-platform Google IoT MQTT client , subscribing to an external MQTT broker",
        "body": "<p>I have an external MQTT broker and I would like Google IoT cloud platform to subscribe to the broker.\nMost of  Google IoT examples are written around the Google IoT platform broker, but my broker is external on another platform.</p>\n\n<p>What Google  Iot code, methods can you suggest.</p>\n\n<p>I can already verify with MQTT FX program the external broker is working.</p>\n"
    }, {
        "tags": [
            "rabbitmq",
            "mqtt",
            "iot",
            "paho",
            "pika"
        ],
        "is_answered": false,
        "view_count": 498,
        "favorite_count": 0,
        "score": 0,
        "last_activity_date": 1581421913,
        "creation_date": 1581320643,
        "last_edit_date": 1581421913,
        "question_id": 60146027,
        "link": "https://stackoverflow.com/questions/60146027/set-a-message-limit-to-the-rabbitmq-queue",
        "title": "Set a message limit to the RabbitMQ queue",
        "body": "<p>I use both AMQP and MQTT protocols in RabbitMQ. I use the pica library for AMQP and the paho library for MQTT. I can give a message limit when I define the tail with Pika (x-max-length). But when I use paho for MQTT, I cannot limit the message. If I give the queue 50 message limit in the AMQP, the number of messages in the queue will never exceed 50. Why can't I do this on MQTT, is there another way I can set a message limit?</p>\n\n<p><a href=\"https://www.youtube.com/watch?v=xcpxGJuOyBQ\" rel=\"nofollow noreferrer\">https://www.youtube.com/watch?v=xcpxGJuOyBQ</a> </p>\n\n<p>There is a sample video. The broadcaster sends the message fast, but because the receiver is slow, too many messages accumulate in the broker. I always want to receive the last message.</p>\n"
    }, {
        "tags": [
            "iot",
            "intel-xdk",
            "plc",
            "intel-iot"
        ],
        "is_answered": true,
        "view_count": 259,
        "favorite_count": 0,
        "closed_date": 1581077383,
        "score": -1,
        "last_activity_date": 1580864220,
        "creation_date": 1487156655,
        "last_edit_date": 1580864220,
        "question_id": 42247570,
        "link": "https://stackoverflow.com/questions/42247570/intel-iot-with-plc",
        "title": "Intel IOT with PLC",
        "body": "<p>just wondering if anyone has successfully used the <a href=\"https://software.intel.com/en-us/iot/home\" rel=\"nofollow noreferrer\">Intel IoT kit</a> to collect data from a PLC without an Arduino board? I.e. is OPC or similar supported. Thanks. </p>\n"
    }, {
        "tags": [
            "mqtt",
            "iot",
            "mosquitto"
        ],
        "is_answered": true,
        "view_count": 554,
        "favorite_count": 0,
        "score": 0,
        "last_activity_date": 1579900250,
        "creation_date": 1579898273,
        "question_id": 59903369,
        "link": "https://stackoverflow.com/questions/59903369/mqtt-broker-does-not-receive-any-messages",
        "title": "MQTT Broker does not receive any messages",
        "body": "<p>I'm trying to connect my Tasmota switch over mqtt. i have installed mosquitto on a virtual machine, heres the configuration:</p>\n\n<p>/etc/mosquitto/mosquitto.conf</p>\n\n<pre><code># Place your local configuration in /etc/mosquitto/conf.d/\n#\n# A full description of the configuration file is at\n# /usr/share/doc/mosquitto/examples/mosquitto.conf.example\n\npid_file /var/run/mosquitto.pid\n\npersistence true\npersistence_location /var/lib/mosquitto/\n\nlog_dest file /var/log/mosquitto/mosquitto.log\n\ninclude_dir /etc/mosquitto/conf.d\n\n</code></pre>\n\n<p>/etc/mosquitto/acl</p>\n\n<pre><code># weewx readwrite to the loop\nuser tasmota \n#topic weather/#\n\n</code></pre>\n\n<p>/etc/mosquitto/conf.d/myconfig.conf </p>\n\n<pre><code>allow_anonymous true\npassword_file /etc/mosquitto/passwd\npersistence false \nprotocol mqtt\nacl_file /etc/mosquitto/acl\n</code></pre>\n\n<p>the service is running, and the port is up</p>\n\n<p>this is the configuration of my switch</p>\n\n<p><a href=\"https://i.stack.imgur.com/O31iQ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/O31iQ.png\" alt=\"enter image description here\"></a></p>\n\n<p>im trying to take a look at messages with </p>\n\n<pre><code>mosquitto_sub  -h 10.11.0.106 -t '#'\n</code></pre>\n\n<p>also tried to add user and password, but i dont get any output</p>\n\n<p>i can see in the log, that the connection is established</p>\n\n<pre><code>1579896351: Config loaded from /etc/mosquitto/mosquitto.conf.\n1579896351: Opening ipv4 listen socket on port 1883.\n1579896351: Opening ipv6 listen socket on port 1883.\n1579896351: New connection from 10.10.0.137 on port 1883.\n1579896351: New client connected from 10.10.0.137 as mosqsub|19705-warmachin (c1, k60).\n1579896358: Socket error on client mosqsub|19705-warmachin, disconnecting.\n1579896358: New connection from 10.10.0.137 on port 1883.\n1579896358: New client connected from 10.10.0.137 as mosqsub|19775-warmachin (c1, k60).\n1579896361: New connection from 10.11.1.51 on port 1883.\n1579896361: New client connected from 10.11.1.51 as DVES_6CA231 (c1, k30, u'tasmota').\n1579896361: New connection from 10.11.1.52 on port 1883.\n1579896361: New client connected from 10.11.1.52 as DVES_301DDC (c1, k30, u'tasmota').\n1579896362: New connection from 10.11.1.54 on port 1883.\n1579896362: New client connected from 10.11.1.54 as DVES_350992 (c1, k30, u'tasmota').\n\n</code></pre>\n\n<p>did i miss something or am i missunderstanding something completely wrong?</p>\n\n<p>please help</p>\n"
    }, {
        "tags": [
            "amazon-web-services",
            "iot",
            "aws-iot"
        ],
        "is_answered": true,
        "view_count": 110,
        "favorite_count": 0,
        "score": 0,
        "last_activity_date": 1579621172,
        "creation_date": 1579593288,
        "question_id": 59836449,
        "link": "https://stackoverflow.com/questions/59836449/how-to-connect-multiple-real-devices-to-a-single-shadow-in-aws-iot",
        "title": "How to connect multiple real devices to a single shadow in AWS IoT",
        "body": "<p>I've multiple thermometers(100+). I want them to connect to a single shadow using the same set of certificates, and publish data to the same topic. The data contains a unique identifier to distinguish between thermometers.</p>\n\n<p>Found a similar <a href=\"https://stackoverflow.com/a/43924728/5265359\">stackoverflow question</a> and the answers there suggest that it is, although discouraged, possible. But they're far from clarity.</p>\n\n<p>I'm new to AWS and IoT and have been struggling for 3 days straight. Are there any steps that can be followed so that I can receive data from multiple thermometers via a single topic using a single set of certificates?</p>\n"
    }, {
        "tags": [
            "amazon-web-services",
            "iot",
            "greengrass"
        ],
        "is_answered": false,
        "view_count": 556,
        "favorite_count": 0,
        "score": 0,
        "last_activity_date": 1579359853,
        "creation_date": 1579354863,
        "last_edit_date": 1579359853,
        "question_id": 59801162,
        "link": "https://stackoverflow.com/questions/59801162/aws-iot-greengrass-x509-certificate-signed-by-unknown-authority-mqttclient-fa",
        "title": "AWS IOT Greengrass x509: certificate signed by unknown authority MQTT[client] Failed to connect to a broker",
        "body": "<p>I am trying to deploy a greengrass group but the deployment goes on (in progress). The errors which im facing are:</p>\n\n<ol>\n<li>\"MQTT client is failed to connect to a broker\"</li>\n<li>MQTT[client]   x509: certificate signed by unknown authority</li>\n<li>Requested certificate load [file:///greengrass/certs/a9029bd10f.cert.pem] with error: []</li>\n<li>[INFO]-No proxy URL found.</li>\n<li>Requested certificate load [file:///greengrass/certs/root.ca.pem] with error: []\nI think these are which is creating a problem in deployment. Below is the <code>runtime.log</code>. I am using AWS IOT Greengrass on Windows 10. Please help me.</li>\n</ol>\n\n<pre><code>[2020-01-18T04:49:58.036Z][DEBUG]-[3]Requested certificate load [file:///greengrass/certs/root.ca.pem] with error: [&lt;nil&gt;]\n[2020-01-18T04:49:58.037Z][DEBUG]-[3]Requested key load [file:///greengrass/certs/a9029bd10f.private.key] with error: [&lt;nil&gt;]\n[2020-01-18T04:49:58.038Z][DEBUG]-[3]Requested certificate load \n[file:///greengrass/certs/a9029bd10f.cert.pem] with error: [&lt;nil&gt;]\n[2020-01-18T04:49:58.038Z][INFO]-Started Deployment Agent to listen for updates.\n[2020-01-18T04:49:58.038Z][INFO]-Connecting with MQTT.  {\"endpoint\": \"a2fhwgkt3lz1ij-ats.iot.us-east-1.amazonaws.com:8883\", \"clientId\": \"myproject_Core\"}\n[2020-01-18T04:49:58.038Z][DEBUG]-MQTT connection attempt.      {\"attemptId\": \"YNTA\", \"clientId\": \"myproject_Core\"}\n[2020-01-18T04:49:58.038Z][DEBUG]-New MQTT connection attempt\n[2020-01-18T04:49:58.038Z][DEBUG]-Acquired lock for connection attempt\n[2020-01-18T04:49:58.038Z][DEBUG]-Disconnect client     {\"force\": false}\n[2020-01-18T04:49:58.648Z][WARN]-MQTT[client]   x509: certificate signed by unknown authority\n[2020-01-18T04:49:58.648Z][WARN]-MQTT[client]   Failed to connect to a broker\n</code></pre>\n"
    }, {
        "tags": [
            "amazon-web-services",
            "iot",
            "aws-iot"
        ],
        "is_answered": true,
        "view_count": 361,
        "favorite_count": 0,
        "score": 2,
        "last_activity_date": 1578532319,
        "creation_date": 1559377865,
        "last_edit_date": 1560235858,
        "question_id": 56405089,
        "link": "https://stackoverflow.com/questions/56405089/aws-iot-policy-document",
        "title": "AWS IOT policy document",
        "body": "<p>I have an application where each client has its own thing, for each thing I am creating a certificate and attaching it to the thing, I am also attaching the following policy to the certificate.</p>\n\n<pre><code>{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": \"iot:*\",\n    \"Resource\": [\"arn:aws:iot:us-east-1:*********:topic/${iot:Connection.Thing.ThingName}\"]\n    }\n  ]\n}\n</code></pre>\n\n<p>What I want to do is limit a client from accessing other clients' things, and each client can have full access to its thing topic.</p>\n\n<p>The above policy isn't working, clients aren't able to connect at all.\nHowever the following is working (in terms of functionality), but clients are able to publish to all topics.</p>\n\n<pre><code>{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": \"iot:*\",\n      \"Resource\": \"*\"\n    }\n  ]\n}\n</code></pre>\n\n<p>Also the following connects successfully but fails to publish:</p>\n\n<pre><code>{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": \"iot:Connect\",\n      \"Resource\": \"*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": \"iot:Publish\",\n      \"Resource\": [\n        \"arn:aws:iot:us-east-1:******:topic/${iot:Connection.Thing.ThingName}\"\n      ]\n    }\n  ]\n}\n</code></pre>\n\n<p>Finally the following connects and publishes successfully.</p>\n\n<pre><code>{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": \"iot:Connect\",\n      \"Resource\": \"*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": \"iot:Publish\",\n      \"Resource\": [\n        \"arn:aws:iot:us-east-1:******:topic/*\"\n      ]\n    }\n  ]\n}\n</code></pre>\n\n<p>MQTTBox client configs:\n<a href=\"https://i.stack.imgur.com/xu4St.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/xu4St.png\" alt=\"client configs\"></a></p>\n\n<p>Publisher:\n<a href=\"https://i.stack.imgur.com/rFFXR.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/rFFXR.png\" alt=\"publisher settings\"></a></p>\n\n<p>What am I doing wrong?</p>\n"
    }, {
        "tags": [
            "c++",
            "c",
            "iot",
            "aws-iot",
            "esp32"
        ],
        "is_answered": true,
        "view_count": 96,
        "favorite_count": 0,
        "score": 0,
        "last_activity_date": 1578202732,
        "creation_date": 1578188722,
        "last_edit_date": 1578188836,
        "question_id": 59596384,
        "link": "https://stackoverflow.com/questions/59596384/aws-iot-with-esp32-receives-messages-from-some-topics-but-not-others",
        "title": "AWS iot with esp32 receives messages from some topics but not others?",
        "body": "<p>I'm using <a href=\"https://github.com/ExploreEmbedded/Hornbill-Examples\" rel=\"nofollow noreferrer\">this aws-iot library for esp32</a> and i'm having trouble receiving messages from a certain topic.</p>\n\n<p>My Code: </p>\n\n<pre><code>if (device.connect(HOST_ADDRESS, const_cast&lt;char*&gt;(client_id.c_str())) == 0) {\n    Serial.println(\"Connected To AWS\");\n    delay(1000);\n\n    char getAcceptedTopic[60];\n    strcpy(getAcceptedTopic, \"Lamps/\"); //these ones need to be strcpy to get it started\n    strcat(getAcceptedTopic, const_cast&lt;char*&gt;(myLampCred.username.c_str()));\n    strcat(getAcceptedTopic, \"/rga\");\n\n    Serial.print(\"\\ngetAcceptedTopic: \");\n    Serial.print(getAcceptedTopic);\n\n\n    char republishedShadowTopic[60];\n    strcpy(republishedShadowTopic, \"Lamp/\");\n    strcat(republishedShadowTopic, const_cast&lt;char*&gt;(myLampCred.username.c_str()));\n    strcat(republishedShadowTopic, \"/rs\");\n\n\n\n    if (0==device.subscribe(getAcceptedTopic, mySubCallBackHandler)) {\n    //if (0==device.subscribe(\"Lamps/SamHang/rs\", mySubCallBackHandler)) { //try just doing it with the string? \n    Serial.print(\"Subscribe Successful\");\n    } else {\n    Serial.println(\"Subscribe Failed, Check The Thing Name and Certificates\");\n    while(1);\n    } \n\n    if (0==device.subscribe(\"testchannel\", mySubCallBackHandler)) {\n    Serial.println(\"Subscribe Successful\");\n    } else {\n    Serial.println(\"Subscribe Failed, Check The Thing Name and Certificates\");\n    while(1);\n    } \n    //will need to add in effects/channel topic at some point, but since none of the effects code is set up yet anyways, theres no point in adding a topic now\n\n    Serial.println(republishedShadowTopic);\n    if (0 == device.subscribe(republishedShadowTopic, mySubCallBackHandler)){\n        Serial.println(\"Subscribe Successful\");\n    } else {\n        Serial.println(\"Subscribe Failed, Check The THing Name and Certificates\");\n        while(1);\n    }\n\n    delay(500);\n    //send get request\n    gettingShadow = true;\n    std::string shadowGetTopic = \"$aws/things/\" + myLampCred.username + \"Lamp/shadow/get\";\n    publishFunc(shadowGetTopic.c_str(), \"\");\n} else {\n    //could add error for this but unless the host address changes and EVERYTHING breaks or wifi isn't connected, then there shouldn't be a problem\n    Serial.println(\"AWS connection failed, check the HOST address\");\n    while(1);\n}\n</code></pre>\n\n<p>I have three topics that I am subscribed to, testchannel, Lamps/user/rga (in variable getAcceptedTopic), and Lamp/user/rs (in variable republishedShadowTopic). </p>\n\n<p>In these topics user can change based on what device the code is uploaded to and the username is retrieved using myLampCred.username (which returns a std::string). So if myLampCred.username = actualUsername, then the getAccepted topic name that it should subscribe to is \"Lamps/actualUsername/rga\"</p>\n\n<p>I am able to receive messages on my getAccepted topic and my testchannel topic always but don't receive messages on the republishedShadow topic. If i replace the republishedShadowTopic variable with \"Lamp/actualUsername/rs\" then it works and receives messages like it should. I would think that the issue is something with how I'm declaring/building the variable but I make the getAccepted topic variable in the same way and that one works fine? </p>\n\n<p>I also sent messages of various lengths through each topic and each message got the same result relative to it's topic so I don't think it has to do with the content of the messages. \nI also checked the configuration file and I don't think that anything there would be restricting this?\nI am pretty sure that any issue is in the segment of code that I shared, since any message that is received is announced when it arrives.</p>\n\n<p>My current theory is that there is a data type problem somewhere? but the device.subscribe() method is asking for a char* and as far as I know that is what I'm giving it (I am still not 100% on all of the char[] vs char* and const, I understand <em>what</em> each one is but not how to use them I suppose). I have tried various forms of chars and std::string conversions but none seem to work unless based on a string literal.</p>\n\n<p>I'm very confused on this and any help would be greatly appreciated, Thanks! :D</p>\n"
    }, {
        "tags": [
            "arduino",
            "mqtt",
            "iot",
            "esp8266"
        ],
        "is_answered": true,
        "view_count": 395,
        "favorite_count": 0,
        "score": 0,
        "last_activity_date": 1577998784,
        "creation_date": 1577996593,
        "last_edit_date": 1577998784,
        "question_id": 59569561,
        "link": "https://stackoverflow.com/questions/59569561/arduino-mqtt-publish-to-topic-issues",
        "title": "Arduino MQTT publish to topic issues",
        "body": "<p>I am trying to get my ESP8266 to publish to a topic with its mac address as a sub to differentiate between many devices, However when I create a Topic string with the mac in it the client.publish(Topic, String) breaks...\nI am getting this error</p>\n\n<pre><code>error: no matching function for call to 'PubSubClient::publish(&lt;unresolved overloaded function type&gt;, const char*)'\n   if (client.publish(Topic.c_str, msg.c_str())){\n                                              ^\n</code></pre>\n\n<pre><code>void loop() {\n      val = ( 100.00 - ( (analogRead(analogPin)/1023.00) * 100.00 ) );  // read the input pin\n     // Serial.println(val);   \n      client.loop();\n      //client.publish(\"esp/test\" val);\n      String mac = WiFi.macAddress();\n\n      String Topic = String(\"esp/test/moisture/\" + mac);\n\n      String msg = String(\"{Moisture:\") + String(val) + String(\", mac:\") + String(mac) + String(\"}\");\n      if (client.publish(Topic.c_str, msg.c_str())){\n          Serial.println(\"Message Sent!\");\n         // Serial.println(msg);\n          Serial.println(msg.c_str());\n      delay(10000);\n    }\n}\n</code></pre>\n"
    }, {
        "tags": [
            "android",
            "amazon-web-services",
            "iot"
        ],
        "is_answered": false,
        "view_count": 325,
        "favorite_count": 0,
        "score": 1,
        "last_activity_date": 1577733969,
        "creation_date": 1557399680,
        "last_edit_date": 1557405332,
        "question_id": 56057935,
        "link": "https://stackoverflow.com/questions/56057935/subscribing-to-iot-topic-in-android",
        "title": "Subscribing to IOT topic in Android",
        "body": "<p>I'm trying to subscribe to a topic via my Android application. Even though it connects successfully subscription fails. As soon as I perform subscription call, IOT connectivity fails and gives an error log as stated below. Want to Know where have I done any wrong coding ?\nAll the resources of IOT policy is given due to testing purposes to find a clue.</p>\n\n<pre><code>{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n   {\n      \"Effect\": \"Allow\",\n      \"Action\": \"iot:*\",\n      \"Resource\": \"*\"\n   }\n ]\n}\n</code></pre>\n\n<p>I referred AWS-amplify for my development.\n<a href=\"https://aws-amplify.github.io/docs/android/pubsub\" rel=\"nofollow noreferrer\">https://aws-amplify.github.io/docs/android/pubsub</a></p>\n\n<p>1 .Connecting to IOT</p>\n\n<pre><code>    private var mAWSMobileClient : AWSMobileClient = AWSMobileClient.getInstance()\n    private lateinit var mIotDataManager: AWSIotMqttManager\n    private lateinit var mAttachedPolicyReq: AttachPolicyRequest\n    private lateinit var mAwsIOTClient: AWSIotClient\n    private lateinit var mAwsCredentials: AWSCredentials\n\n private fun connectToIOT() {\n        Thread(Runnable {\n            var mDeviceIdentity = Settings.Secure.getString(this.contentResolver, Settings.Secure.ANDROID_ID)\n\n            mIotDataManager = AWSIotMqttManager(mDeviceIdentity, &lt;iot endpoint&gt;)\n            mIotDataManager.keepAlive = 50\n            mIotDataManager.isAutoReconnect = false\n            mIotDataManager.connectionStabilityTime = 100\n\n            mAwsCredentials = mAWSMobileClient.awsCredentials\n            mAwsIOTClient = AWSIotClient(mAWSMobileClient)\n            mAwsIOTClient.setRegion(Region.getRegion(Regions.AP_SOUTHEAST_2))\n\n            mAttachedPolicyReq = AttachPolicyRequest()\n            mAttachedPolicyReq.policyName = \"test_policy\"\n            mAttachedPolicyReq.target = mAWSMobileClient.identityId\n            mAwsIOTClient.attachPolicy(mAttachedPolicyReq)\n\n            try {\n                mIotDataManager.connect(mAWSMobileClient, object : AWSIotMqttClientStatusCallback {\n                    override fun onStatusChanged(\n                        status: AWSIotMqttClientStatusCallback.AWSIotMqttClientStatus?,\n                        throwable: Throwable?\n                    ) {\n                        when (status) {\n                            AWSIotMqttClientStatusCallback.AWSIotMqttClientStatus.ConnectionLost -&gt; {}\n\n                            AWSIotMqttClientStatusCallback.AWSIotMqttClientStatus.Connected -&gt; {}\n\n                            AWSIotMqttClientStatusCallback.AWSIotMqttClientStatus.Connecting -&gt; {}\n\n                            AWSIotMqttClientStatusCallback.AWSIotMqttClientStatus.Reconnecting -&gt; {}\n\n                        else -&gt; {\n\n                        }\n                    }\n                }\n            })\n        } catch (e: Exception) {\n            Log.d(\"IOT Data Manager Connection Errror : $e\")\n        }\n    }).start()\n}\n</code></pre>\n\n<ol start=\"2\">\n<li><p>Subscription Method</p>\n\n<pre><code>fun subscribeToThing() {\n        if(mConnected) {\n            Thread(Runnable {\n                mThingsName = \"$mThingsName/shadow/get/accepted\"\n                var message: String? = null\n                try {\n                    mIotDataManager.subscribeToTopic(\n                        mThingsName,\n                        AWSIotMqttQos.QOS1,\n                        object : AWSIotMqttNewMessageCallback {\n                            override fun onMessageArrived(topic: String?, data: ByteArray?) {\n\n                                try {\n                                    message = String(data!!, Charsets.UTF_8)\n                                } catch (e: UnsupportedEncodingException) {\n                                    Log.d(\"Unsupported Encoding error :$e\")\n                                }\n                            }\n                        })\n                } catch (e: Exception) {\n                    Log.d(\"Subscription error :$e\")\n                }\n        }).start()\n    } else {\n        Log.d(\"IOT Not Connected\")\n        }\n}\n</code></pre></li>\n</ol>\n\n<p>Result Log :</p>\n\n<blockquote>\n  <p>W/AWSIotMqttManager: connection is Lost</p>\n  \n  <p>Subscription error :com.amazonaws.AmazonClientException: Client error\n  when subscribing.</p>\n</blockquote>\n"
    }, {
        "tags": [
            "azure",
            "iot",
            "azure-iot-sdk"
        ],
        "is_answered": false,
        "view_count": 520,
        "favorite_count": 1,
        "score": 1,
        "last_activity_date": 1577491656,
        "creation_date": 1576192511,
        "question_id": 59314041,
        "link": "https://stackoverflow.com/questions/59314041/how-to-display-log-messages-from-azure-iot-device-client-code",
        "title": "How to display log messages from azure iot device client code",
        "body": "<p>I see log messages in azure iot device client source code like this:\nlog.debug(\"Connection already opened by TransportClient.\");  or\nlog.info(\"Device client opened successfully\");</p>\n\n<p>My question is where these log messages going? how to get that messages for debug purpose?\nThanks  </p>\n"
    }, {
        "tags": [
            "mqtt",
            "iot"
        ],
        "is_answered": true,
        "view_count": 1324,
        "favorite_count": 0,
        "score": 3,
        "last_activity_date": 1576685495,
        "creation_date": 1522777562,
        "last_edit_date": 1522777952,
        "question_id": 49636231,
        "link": "https://stackoverflow.com/questions/49636231/mqtt-how-to-know-when-all-retained-messages-have-been-received",
        "title": "MQTT: How to know when all retained messages have been received",
        "body": "<p>After subscribing to an MQTT topic (that may include wildcards), is there a way to know for sure that all retained messages for the subscribed topics have been received?</p>\n\n<p>(to be more accurate : all messages that were stored retained message at the broker at the moment of subscription) </p>\n\n<p>If there is no direct way, is  there any hack to know it (like sending a new retained message with specific QoS  to a subscribed topic,  that is for sure received after older messages) ?</p>\n\n<p>Background of my question is this feature request (<a href=\"https://github.com/marvinroger/homie-esp8266/issues/313\" rel=\"nofollow noreferrer\">https://github.com/marvinroger/homie-esp8266/issues/313</a>) that I want to implement.</p>\n\n<p>So this would be the reference implementation for arduino (ESP8266) with the AsyncMQTT library, but my question is valid in general for other implementations, too (eg using paho-mqtt etc.).  </p>\n"
    }, {
        "tags": [
            "flutter",
            "dart",
            "google-cloud-platform",
            "mqtt",
            "iot"
        ],
        "is_answered": true,
        "view_count": 839,
        "favorite_count": 10,
        "score": 6,
        "last_activity_date": 1575890086,
        "creation_date": 1575541698,
        "question_id": 59193094,
        "link": "https://stackoverflow.com/questions/59193094/implementing-mqtt-using-google-cloud-pub-sub-in-flutter",
        "title": "Implementing MQTT using Google cloud pub sub in flutter",
        "body": "<p>Is there any way to establish a connection with Google IoT pub-sub API in flutter?</p>\n\n<p>I tried this <a href=\"https://github.com/shamblett/mqtt_client\" rel=\"noreferrer\">library</a> but it doesn't have the configuration which I am looking for.</p>\n\n<p>I have the following data which will be used to establish the connection:</p>\n\n<pre><code>{\n  \"type\": ,\n  \"project_id\": ,\n  \"private_key_id\": ,\n  \"private_key\": \"-----BEGIN PRIVATE KEY-----\\n...\\n-----END PRIVATE KEY-----\\n\",\n  \"client_email\": ,\n  \"client_id\": ,\n  \"auth_uri\": ,\n  \"token_uri\": ,\n  \"auth_provider_x509_cert_url\": ,\n  \"client_x509_cert_url\": \n}\n</code></pre>\n"
    }, {
        "tags": [
            "mqtt",
            "iot",
            "fiware",
            "lorawan"
        ],
        "is_answered": true,
        "view_count": 223,
        "favorite_count": 0,
        "score": 2,
        "last_activity_date": 1575459207,
        "creation_date": 1573209057,
        "last_edit_date": 1574183530,
        "question_id": 58764816,
        "link": "https://stackoverflow.com/questions/58764816/how-to-send-lorawan-device-data-to-fiware-lorawan-iot-agent-from-postman-or-mqtt",
        "title": "How to send LoRaWAN device data to FIWARE LoRaWAN IoT Agent from postman or MQTT Publisher client",
        "body": "<p>I have created an application in Things Network for LoRaWAN. Also registered a device within that application. </p>\n\n<ol>\n<li>Already register a service in LoRaWAN IoT Agent and provisioned a device with provider as TTN in LoRaWAN IoT Agent. </li>\n<li>Created a HTTP integration in Things Network Stack for my IoT Agent.</li>\n<li>I also received data sent from Things Network Uplink client in my registered IoT agent. </li>\n</ol>\n\n<p>Uplink payload from Things Network \n01\u200067\u200000\u2000FF</p>\n\n<p>Now i want to send uplink message from postman or MQTT publisher client.</p>\n\n<p>I tried to create a payload for postman i.e. Url : <a href=\"http://MyMachineIP:4061/iot/json?=MyDeviceId&amp;k=APIKEY\" rel=\"nofollow noreferrer\">http://MyMachineIP:4061/iot/json?=MyDeviceId&amp;k=APIKEY</a></p>\n\n<p>JSON PAYLOAD</p>\n\n<pre><code>{\n  \"app_id\": \"MyApplicationID\",\n  \"dev_id\": \"MyDeviceId\",\n  \"hardware_serial\": \"AAAAAAAAAAAAAAAA\",\n  \"payload_raw\": \"AWcA/w==\",\n  \"metadata\": {\n    \"gateways\": [\n      {\n        \"gtw_id\": \"TEST_1\",\n        \"rssi\": 0,\n        \"snr\": 0\n      }\n    ]\n  }\n}\n</code></pre>\n\n<p>but got error Cannot POST /iot/json.</p>\n\n<p>I also tried using MQTT Publisher Client:</p>\n\n<ol>\n<li><p>Installed Eclipse Mosquitto providers a CLI to subscribe and to publish \nmessages.</p></li>\n<li><p>Start Mosquitto Service.</p></li>\n<li><p>MQTT command to publish uplink measure:</p>\n\n<pre><code>mosquitto_pub -h eu.thethings.network -p 1883 -u applicationid-P ttn-account-v2.xXXXXXXXXXXXXXXXXXXXXXXXXX -t applicationid/devices/deviceid/up -m '{\"port\":1,\"payload_raw\":\"AWcAuw==\"}' -d\n</code></pre></li>\n<li><p>MQTT command to subscribe uplink measure:</p>\n\n<pre><code>mosquitto_sub -h eu.thethings.network -p 1883 -u applicationid -P ttn-account-v2.x2Q20IXXXXX\n</code></pre></li>\n</ol>\n"
    }, {
        "tags": [
            "sockets",
            "mqtt",
            "iot",
            "esp8266"
        ],
        "is_answered": true,
        "view_count": 740,
        "favorite_count": 0,
        "score": 0,
        "last_activity_date": 1574824832,
        "creation_date": 1574712702,
        "last_edit_date": 1574823645,
        "question_id": 59039420,
        "link": "https://stackoverflow.com/questions/59039420/socket-error-on-client-disconnecting-with-paho-mqtt-sn-gateway-and-esp8266-c",
        "title": "Socket error on client &lt;&gt;, disconnecting with Paho MQTT-SN Gateway and ESP8266 CLient",
        "body": "<p>I'm trying to test MQTT-SN.</p>\n\n<p>I'm using Mosquitto Broker, Paho MQTT-SN Gateway and this library (<a href=\"https://github.com/S3ler/arduino-mqtt-sn-client\" rel=\"nofollow noreferrer\">https://github.com/S3ler/arduino-mqtt-sn-client</a>) for the clients. </p>\n\n<p>I'm using an esp8266 as a client.</p>\n\n<p>With this client, I can connect, subscribe, receive from subscribed topics but I cant publish into topics</p>\n\n<pre><code>memset(buffer, 0x0, buffer_length);\nmqttSnClient.publish(buffer, publishTopicName , qos);\n</code></pre>\n\n<p>Every time I try to publish with this client, Mosquitto gives me </p>\n\n<pre><code>Socket error on client &lt;clientid&gt;, disconnecting\n</code></pre>\n\n<p>And my client disconnects from the Broker.</p>\n\n<p>Any clues?</p>\n\n<p><strong>EDIT1</strong></p>\n\n<p>Client Code</p>\n\n<pre><code>#include &lt;ESP8266WiFi.h&gt;\n#include &lt;WiFiUdp.h&gt;\n#include \"WiFiUdpSocket.h\"\n#include \"MqttSnClient.h\"\n#include &lt;NTPClient.h&gt;\n\nconst char* ssid     = \"example\";\nconst char* password = \"example1\";\n\nlong utcOffsetInSeconds = -10800;\n\n// Define NTP Client to get time\nWiFiUDP ntpUDP;\nNTPClient timeClient(ntpUDP, \"pool.ntp.org\", utcOffsetInSeconds);\n\n#define buffer_length 10\nchar buffer[buffer_length + 1];\nuint16_t buffer_pos = 0;\n\nIPAddress gatewayIPAddress(192, 168, 0, 106);\nuint16_t localUdpPort = 10000;\n\n\nWiFiUDP udp;\nWiFiUdpSocket wiFiUdpSocket(udp, localUdpPort);\nMqttSnClient&lt;WiFiUdpSocket&gt; mqttSnClient(wiFiUdpSocket);\n\nconst char* clientId = \"hamilton12\";\nchar* subscribeTopicName = \"ESP8266/123\";\nchar* publishTopicName = \"ESP8266/123\";\n\nint8_t qos = 1;\n\nvoid mqttsn_callback(char *topic, uint8_t *payload, uint16_t length, bool retain) {\n  timeClient.update();\n  Serial.print(\"Received - Topic: \");\n  Serial.print(topic);\n  Serial.print(\" Payload: \");\n  for (uint16_t i = 0; i &lt; length; i++) {\n    char c =  (char) * (payload + i);\n    Serial.print(c);\n  }\n  Serial.print(\" Lenght: \");\n  Serial.print(length);\n\n  Serial.print(\" Received Timestamp milliseconds: \");\n  Serial.print(timeClient.getHours());\n  Serial.print(\":\");\n  Serial.print(timeClient.getMinutes());\n  Serial.print(\":\");\n  Serial.println(timeClient.getSeconds());\n}\n\nvoid setup() {\n\n  Serial.begin(115200);\n  delay(10);\n  Serial.println();\n  Serial.print(\"Connecting to \");\n  Serial.println(ssid);\n\n  /* Explicitly set the ESP8266 to be a WiFi-client, otherwise, it by default,\n     would try to act as both a client and an access-point and could cause\n     network-issues with your other WiFi-devices on your WiFi-network. */\n  WiFi.mode(WIFI_STA);\n  WiFi.begin(ssid, password);\n\n  while (WiFi.status() != WL_CONNECTED) {\n    delay(500);\n    Serial.print(\".\");\n  }\n\n  Serial.println(\"\");\n  Serial.println(\"WiFi connected\");\n  Serial.println(\"IP address: \");\n  Serial.println(WiFi.localIP());\n\n  Serial.print(\"Starting MqttSnClient - \");\n  mqttSnClient.setCallback(mqttsn_callback);\n  if  (!mqttSnClient.begin()) {\n    Serial.print(\"Could not initialize MQTT-SN Client \");\n    while (true) {\n      Serial.println(\".\");\n      delay(1000);\n    }\n  }\n  Serial.println(\" ready!\");\n}\n\nvoid convertIPAddressAndPortToDeviceAddress(IPAddress&amp; source, uint16_t port, device_address&amp; target) {\n  // IPAdress 0 - 3 bytes\n  target.bytes[0] = source[0];\n  target.bytes[1] = source[1];\n  target.bytes[2] = source[2];\n  target.bytes[3] = source[3];\n  // Port 4 - 5 bytes\n  target.bytes[4] = port &gt;&gt; 8;\n  target.bytes[5] = (uint8_t) port ;\n}\n\n\nvoid loop() {\n  if (!mqttSnClient.is_mqttsn_connected()) {\n#if defined(gatewayHostAddress)\n    IPAddress gatewayIPAddress;\n    if (!WiFi.hostByName(gatewayHostAddress, gatewayIPAddress, 20000)) {\n      Serial.println(\"Could not lookup MQTT-SN Gateway.\");\n      return;\n    }\n#endif\n    device_address gateway_device_address;\n    convertIPAddressAndPortToDeviceAddress(gatewayIPAddress, localUdpPort, gateway_device_address);\n    Serial.print(\"MQTT-SN Gateway device_address: \");\n    printDeviceAddress(&amp;gateway_device_address);\n\n\n    if (!mqttSnClient.connect(&amp;gateway_device_address, clientId, 180) ) {\n      Serial.println(\"Could not connect MQTT-SN Client.\");\n      delay(1000);\n      return;\n    }\n    Serial.println(\"MQTT-SN Client connected.\");\n    //mqttSnClient.set_mqttsn_connected();\n    if (!mqttSnClient.subscribe(subscribeTopicName, qos)){\n      Serial.println(\"Cant subscribe\");\n    }\n    Serial.println(\"Subscribed\");\n  }\n\n  //It never enters this IF\n  if (Serial.available() &gt; 0) {\n    buffer[buffer_pos++] = Serial.read();\n    if (buffer[buffer_pos - 1] == '\\n') {\n      // only qos -1, 0, 1 are supported\n      if (!mqttSnClient.publish(buffer, publishTopicName , qos)) {\n        Serial.println(\"Could not publish\");\n      }\n      Serial.println(\"Published\");\n      memset(buffer, 0x0, buffer_length);\n      buffer_pos = 0;\n    }\n  }\n\n  //Uncommenting this line will give socket error\n  //mqttSnClient.publish(buffer, publishTopicName , qos);\n\n\n  mqttSnClient.loop();\n\n}\n</code></pre>\n\n<p>etc/mosquitto/mosquitto.conf</p>\n\n<pre><code>pid_file /var/run/mosquitto.pid\n\npersistence true\npersistence_location /var/lib/mosquitto/\n\nlog_dest file /var/log/mosquitto/mosquitto.log\n\n#include_dir /etc/mosquitto/conf.d\n\nconnection_messages true\nlog_timestamp true\nlog_dest stderr\nlog_type error\nlog_type warning\nlog_type debug\n\nallow_anonymous true\n</code></pre>\n\n<p>gateway.conf</p>\n\n<pre><code>BrokerName=192.168.0.106\nBrokerPortNo=1883\nBrokerSecurePortNo=8883\n\n#\n# When AggregatingGateway=YES or ClientAuthentication=YES,\n# All clients must be specified by the ClientList File  \n#\n\nClientAuthentication=NO\nAggregatingGateway=NO\nQoS-1=NO\nForwarder=NO\n\n#ClientsList=/path/to/your_clients.conf\n\nPredefinedTopic=NO\n#PredefinedTopicList=/path/to/your_predefinedTopic.conf\n\n#RootCAfile=/etc/ssl/certs/ca-certificates.crt\n#RootCApath=/etc/ssl/certs/\n#CertsFile=/path/to/certKey.pem\n#PrivateKey=/path/to/privateKey.pem\n\nGatewayID=1\nGatewayName=PahoGateway-01\nKeepAlive=900\n#LoginID=your_ID\n#Password=your_Password\n\n\n# UDP\nGatewayPortNo=10000\nMulticastIP=225.1.1.1\nMulticastPortNo=1884\n\n# UDP6\nGatewayUDP6Bind=FFFF:FFFE::1 \nGatewayUDP6Port=10000\nGatewayUDP6Broadcast=FF02::1\nGatewayUDP6If=wpan0\n\n# XBee\nBaudrate=38400\nSerialDevice=/dev/ttyUSB0\nApiMode=2\n\n# LOG\nShearedMemory=NO;\n</code></pre>\n\n<p><strong>EDIT2</strong></p>\n\n<p>Terminal running mosquitto</p>\n\n<pre><code>hamilton@hamilton-note:~$ mosquitto\n1574806892: mosquitto version 1.4.15 (build date Tue, 18 Jun 2019 11:42:22 -0300) starting\n1574806892: Using default config.\n1574806892: Opening ipv4 listen socket on port 1883.\n1574806892: Opening ipv6 listen socket on port 1883.\n1574806900: New connection from 192.168.0.106 on port 1883.\n1574806900: New client connected from 192.168.0.106 as hamilton123 (c1, k46080).\n1574806900: Socket error on client hamilton123, disconnecting.\n^C1574806911: mosquitto version 1.4.15 terminating\n</code></pre>\n\n<p>Terminal running Paho Gateway</p>\n\n<pre><code>hamilton@hamilton-note:~/Downloads$ ./MQTT-SNGateway \n\n ***************************************************************************\n * MQTT-SN Transparent Gateway\n * Part of Project Paho in Eclipse\n * (http://git.eclipse.org/c/paho/org.eclipse.paho.mqtt-sn.embedded-c.git/)\n *\n * Author : Tomoaki YAMAGUCHI\n * Version: 1.3.1\n ***************************************************************************\n\n20191126 192134.372 PahoGateway-01 has been started.\n\n ConfigFile: ./gateway.conf\n PreDefFile: ./predefinedTopic.conf\n SensorN/W:  UDP Multicast 225.1.1.1:1884 Gateway Port 10000\n Broker:     192.168.0.106 : 1883, 8883\n RootCApath: (null)\n RootCAfile: (null)\n CertKey:    (null)\n PrivateKey: (null)\n\n\n\n20191126 192140.660   CONNECT           &lt;---  hamilton123                         12 04 04 01 B4 00 68 61 6D 69 6C 74 6F 6E 31 32 33 00\n20191126 192140.660   CONNECT           ===&gt;  hamilton123                         10 17 00 04 4D 51 54 54 04 02 B4 00 00 0B 68 61 6D 69 6C 74 6F 6E 31 32 33\n20191126 192140.874   CONNACK           &lt;===  hamilton123                         20 02 00 00\n20191126 192140.874   CONNACK           ---&gt;  hamilton123                         03 05 00\n\n20191126 192140.879   SUBSCRIBE   0200  &lt;---  hamilton123                         11 12 20 02 00 45 53 50 38 32 36 36 2F 31 32 33 00\n20191126 192140.879   SUBSCRIBE   0200  ===&gt;  hamilton123                         82 10 02 00 00 0B 45 53 50 38 32 36 36 2F 31 32 33 01\n20191126 192140.879   SUBACK      0200  &lt;===  hamilton123                         90 03 02 00 01\n20191126 192140.879   SUBACK      0200  ---&gt;  hamilton123                         08 13 20 00 01 02 00 00\n\n20191126 192140.883   PUBLISH     0300  &lt;---  hamilton123                         08 0C 22 00 01 03 00 00\n20191126 192140.884   PUBLISH     0300  ===&gt;  hamilton123                         32 07 00 02 00 01 03 00 00\n^C20191126 192149.215 BrokerSendTask   stopped.\n20191126 192149.215 PacketHandleTask stopped.\n20191126 192149.215 ClientSendTask   stopped.\n20191126 192149.386 BrokerRecvTask   stopped.\n20191126 192150.158 ClientRecvTask   stopped.\n\n20191126 192150.215 MQTT-SN Gateway  stoped\n</code></pre>\n"
    }, {
        "tags": [
            "php",
            "mqtt",
            "iot",
            "mosquitto"
        ],
        "is_answered": true,
        "view_count": 68,
        "favorite_count": 0,
        "score": 0,
        "last_activity_date": 1574413560,
        "creation_date": 1574390004,
        "question_id": 58986642,
        "link": "https://stackoverflow.com/questions/58986642/how-to-prevent-conflicts-between-publishing-and-subscribing-in-mosquitto",
        "title": "how to prevent conflicts between publishing and subscribing in mosquitto?",
        "body": "<p>The situation is,\nI created an mqtt client using Mosquitto-alpha , in PHP scripting language.\nso I have a subscribe function that runs infinitely to fetch data coming from a device every minute\ne.g</p>\n\n<p>Inside the Server I ran this\nphp /path/to/my/file/MyPHPscript subscribe &amp;</p>\n\n<p>In the client Device I have 2 services running every minute to publish data to the mqtt broker</p>\n\n<pre><code>e.g\n* * * * * php /path/to/my/file/MyPHPScript publish dataA\n* * * * * sleep 2; php /path/to/my/file/MyPHPScript publish dataB\n</code></pre>\n\n<p>if I don't put a sleep of 2 seconds to the 2nd service before running it, the supposedly two datas won't get publish together in the same minute. And then, if I add a subscribe  in the device to capture messages coming from the server, it will give intrmittent data push with the  two cron service</p>\n\n<pre><code>e.g  \n\n    * * * * * php /path/to/my/file/MyPHPScript publish dataA\n    * * * * * sleep 2; php /path/to/my/file/MyPHPScript publish dataB\n</code></pre>\n\n<p>on seperate terminal I ran this</p>\n\n<pre><code>php /path/to/my/file/MyPHPScript subscribe serverData &amp;\n</code></pre>\n\n<p>this code above disturbs the data transmission of the other two cron services...is there a way to make these 3 work every minute without conflict ?</p>\n"
    }, {
        "tags": [
            "java",
            "mqtt",
            "iot",
            "hivemq"
        ],
        "is_answered": true,
        "view_count": 221,
        "favorite_count": 0,
        "score": 0,
        "last_activity_date": 1574407440,
        "creation_date": 1563553376,
        "question_id": 57116316,
        "link": "https://stackoverflow.com/questions/57116316/how-to-get-the-qos-of-a-client-in-hivemq-client",
        "title": "How to get the QoS of a client in HiveMQ Client?",
        "body": "<p>I'm working with HiveMQ Client and I wanted to know if there was a way to get the quality of service (QoS) that a client is subscribing with (in terms of a specific topic or in general)? I would be looking for a method I could invoke on a client like so:</p>\n\n<pre><code>    Mqtt5BlockingClient subscriber = Mqtt5Client.builder()\n            .identifier(UUID.randomUUID().toString()) // the unique identifier of the MQTT client\n            .serverHost(\"localhost\") \n            .serverPort(1883) \n            .buildBlocking();\n\nsubscriber.getQoS(\"topic\") // returns the QoS of the subscriber is subscribing to the given topic \n</code></pre>\n\n<p>I would just want this information so I could print in to the console. </p>\n"
    }, {
        "tags": [
            "java",
            "android",
            "mqtt",
            "iot",
            "paho"
        ],
        "is_answered": false,
        "view_count": 25,
        "favorite_count": 0,
        "closed_date": 1574250909,
        "score": 0,
        "last_activity_date": 1574248788,
        "creation_date": 1574246128,
        "last_edit_date": 1574248788,
        "question_id": 58952260,
        "link": "https://stackoverflow.com/questions/58952260/get-messages-that-was-issued-before-mqtt-subscriber-was-started",
        "title": "Get messages that was issued before MQTT subscriber was started",
        "body": "<p>I have simple MQTT subscriber implemented in <code>MqttHelper</code> class that works fine and receives subscriptions. I found that subscriber receives only messages issued after it has has been started. Is it possible somehow ask MQTT subscriber to retrieve all messages issued when it was not started?</p>\n\n<pre><code>package com.kkk.mqtt.helpers;\n\nimport android.content.Context;\nimport android.util.Log;\n\nimport org.eclipse.paho.android.service.MqttAndroidClient;\nimport org.eclipse.paho.client.mqttv3.DisconnectedBufferOptions;\nimport org.eclipse.paho.client.mqttv3.IMqttActionListener;\nimport org.eclipse.paho.client.mqttv3.IMqttDeliveryToken;\nimport org.eclipse.paho.client.mqttv3.IMqttToken;\nimport org.eclipse.paho.client.mqttv3.MqttCallbackExtended;\nimport org.eclipse.paho.client.mqttv3.MqttConnectOptions;\nimport org.eclipse.paho.client.mqttv3.MqttException;\nimport org.eclipse.paho.client.mqttv3.MqttMessage;\n\nimport java.io.UnsupportedEncodingException;\n\npublic class MqttHelper {\n    public MqttAndroidClient mqttAndroidClient;\n\n    final String serverUri = \"tcp://tailor.cloudmqtt.com:16424\";\n\n    final String clientId = \"ExampleAndroidClient\";\n    public final String subscriptionTopic = \"sensor\";\n\n    final String username = \"xxx\";\n    final String password = \"yyy\";\n\n\n\n    public MqttHelper(Context context){\n        mqttAndroidClient = new MqttAndroidClient(context, serverUri, clientId);\n\n        mqttAndroidClient.setCallback(new MqttCallbackExtended() {\n            @Override\n            public void connectComplete(boolean b, String s) {\n                Log.w(\"mqtt\", s);\n            }\n\n            @Override\n            public void connectionLost(Throwable throwable) {\n\n            }\n\n            @Override\n            public void messageArrived(String topic, MqttMessage mqttMessage) throws Exception {\n                Log.w(\"Mqtt\", mqttMessage.toString());\n            }\n\n            @Override\n            public void deliveryComplete(IMqttDeliveryToken iMqttDeliveryToken) {\n\n            }\n        });\n        connect();\n    }\n\n    public void setCallback(MqttCallbackExtended callback) {\n        mqttAndroidClient.setCallback(callback);\n    }\n\n\n    public void publish(String topic, String info)\n    {\n\n\n        byte[] encodedInfo = new byte[0];\n        try {\n            encodedInfo = info.getBytes(\"UTF-8\");\n            MqttMessage message = new MqttMessage(encodedInfo);\n            mqttAndroidClient.publish(topic, message);\n            Log.e (\"Mqtt\", \"publish done\");\n        } catch (UnsupportedEncodingException | MqttException e) {\n            e.printStackTrace();\n            Log.e (\"Mqtt\", e.getMessage());\n        }catch (Exception e) {\n            Log.e (\"Mqtt\", \"general exception \"+e.getMessage());\n        }\n\n    }\n\n    private void connect(){\n        Log.w(\"Mqtt\", \"connect start \" );\n        MqttConnectOptions mqttConnectOptions = new MqttConnectOptions();\n        mqttConnectOptions.setAutomaticReconnect(true);\n        mqttConnectOptions.setCleanSession(false);\n        mqttConnectOptions.setUserName(username);\n        mqttConnectOptions.setPassword(password.toCharArray());\n\n        try {\n\n            mqttAndroidClient.connect(mqttConnectOptions, null, new IMqttActionListener()\n            {\n                @Override\n                public void onSuccess(IMqttToken asyncActionToken) {\n                    Log.w(\"Mqtt\", \"onSuccess \" );\n                    DisconnectedBufferOptions disconnectedBufferOptions = new DisconnectedBufferOptions();\n                    disconnectedBufferOptions.setBufferEnabled(true);\n                    disconnectedBufferOptions.setBufferSize(100);\n                    disconnectedBufferOptions.setPersistBuffer(false);\n                    disconnectedBufferOptions.setDeleteOldestMessages(false);\n                    mqttAndroidClient.setBufferOpts(disconnectedBufferOptions);\n                    subscribeToTopic();\n                    publish(MqttHelper.this.subscriptionTopic,\"information\");\n                }\n\n                @Override\n                public void onFailure(IMqttToken asyncActionToken, Throwable exception) {\n                    Log.w(\"Mqtt\", \"Failed to connect to: \" + serverUri + exception.toString());\n                }\n            });\n\n\n        } catch (MqttException ex){\n            ex.printStackTrace();\n        }\n    }\n\n\n    private void subscribeToTopic() {\n        try {\n            mqttAndroidClient.subscribe(subscriptionTopic, 0, null, new IMqttActionListener() {\n                @Override\n                public void onSuccess(IMqttToken asyncActionToken) {\n                    Log.w(\"Mqtt\",\"Subscribed!\");\n                }\n\n                @Override\n                public void onFailure(IMqttToken asyncActionToken, Throwable exception) {\n                    Log.w(\"Mqtt\", \"Subscribed fail!\");\n                }\n            });\n\n        } catch (MqttException ex) {\n            System.err.println(\"Exception whilst subscribing\");\n            ex.printStackTrace();\n        }\n    }\n}\n</code></pre>\n\n<p>Code that starts MQTT subscriber:</p>\n\n<pre><code>private void startMqtt() {\n    mqttHelper = new MqttHelper(getApplicationContext());\n    mqttHelper.setCallback(new MqttCallbackExtended()\n    {\n        @Override\n        public void connectComplete(boolean b, String s) {\n            Log.w(\"Mqtt\", \"Connect complete\"+ s );\n        }\n\n        @Override\n        public void connectionLost(Throwable throwable) {\n            Log.w(\"Mqtt\", \"Connection lost\" );\n        }\n\n        @Override\n        public void messageArrived(String topic, MqttMessage mqttMessage) throws Exception {\n            Log.w(\"Mqtt\", mqttMessage.toString());\n            dataReceived.setText(mqttMessage.toString());\n        }\n\n        @Override\n        public void deliveryComplete(IMqttDeliveryToken iMqttDeliveryToken) {\n            Log.w(\"Mqtt\", \"Delivery complete\" );\n\n        }\n    });\n    Log.w(\"Mqtt\", \"will publish\");\n\n\n}\n</code></pre>\n"
    }, {
        "tags": [
            "jmeter",
            "mqtt",
            "iot",
            "fiware",
            "lorawan"
        ],
        "is_answered": true,
        "view_count": 296,
        "favorite_count": 0,
        "score": -1,
        "last_activity_date": 1574166579,
        "creation_date": 1574158350,
        "last_edit_date": 1574166579,
        "question_id": 58931498,
        "link": "https://stackoverflow.com/questions/58931498/how-to-publish-datauplink-measures-supports-mqtt-protocol-with-mosquitto-publi",
        "title": "How to publish data(Uplink Measures) supports MQTT protocol with Mosquitto publisher client to The Things Network(TTN) as broker",
        "body": "<p>Problem: I am unable to publish uplink measures to TTN(The Things Network,MQTT Broker) through MQTT Publisher Client. Follow these steps...</p>\n\n<ol>\n<li><p>Installed Eclipse Mosquitto providers a CLI to subscribe and to publish \nmessages.</p></li>\n<li><p>Start Mosquitto Service.\n<code>start mosquitto service</code></p></li>\n<li><p>MQTT command to publish uplink measure:</p>\n\n<pre><code>mosquitto_pub -h eu.thethings.network -p 1883 -u applicationid-P ttn-account-v2.xXXXXXXXXXXXXXXXXXXXXXXXXX -t applicationid/devices/deviceid/up -m '{\"port\":1,\"payload_raw\":\"AWcAuw==\"}' -d\n</code></pre></li>\n<li><p>MQTT command to subscribe uplink measure:</p>\n\n<pre><code>mosquitto_sub -h eu.thethings.network -p 1883 -u applicationid -P ttn-account-v2.x2Q20I2hDo1XXXXXXXXXXXXXXXXX -t applicationid/devices/deviceid/up\n</code></pre></li>\n</ol>\n"
    }, {
        "tags": [
            "embedded",
            "mqtt",
            "iot",
            "paho"
        ],
        "is_answered": true,
        "view_count": 448,
        "favorite_count": 0,
        "score": 2,
        "last_activity_date": 1572804976,
        "creation_date": 1572790990,
        "question_id": 58681075,
        "link": "https://stackoverflow.com/questions/58681075/whats-the-problem-of-always-using-qos-0-in-a-mqtt-session",
        "title": "What&#39;s the problem of always using QoS 0 in a MQTT session?",
        "body": "<p>I've been developing an always-connected MQTT client on a strictly resource constraint embedded device  using Paho C library. Here's my questions:</p>\n\n<ol>\n<li><p>Apart from the broker and client crashes, Are there any other reasons for a QoS 0 message to not  arrive at the destination?</p></li>\n<li><p>In a subscription request, is it possible that broker does not accept the requested QoS?</p></li>\n<li><p>Under what circumstances could a QoS 1 message be received multiple times?</p></li>\n</ol>\n"
    }, {
        "tags": [
            "azure",
            "iot"
        ],
        "is_answered": false,
        "view_count": 132,
        "favorite_count": 0,
        "score": 0,
        "last_activity_date": 1571779608,
        "creation_date": 1571372663,
        "question_id": 58443936,
        "link": "https://stackoverflow.com/questions/58443936/azure-iot-hub-and-receiving-anything",
        "title": "Azure IoT hub and receiving anything",
        "body": "<p>I'm trying to use Azure Iot hub for publishing and subscribing messages. At the moment I'm trying to publish some simple message with following command:</p>\n\n<pre><code>mosquitto_pub \\\n-h xxxdev.azure-devices.net \\\n-u \"xxxdev.azure-devices.net/xxxdev/?api-version=2018-06-30\" \\\n-P \"SharedAccessSignature sr=xxx.azure- \ndevices.net%2Fdevices%2Fxxxdev&amp;sig=YYYYY&amp;se=1570866689&amp;skn=ZZZZZZZ\" \\\n-t \"devices/ublox1/messages/events/\" \\\n--cafile ca.pem \\\n-p 8883 \\\n-i xxxdev \\\n-V mqttv311 \\\n-d \\\n-m 'message'\n</code></pre>\n\n<p>and subscribe with this one:</p>\n\n<pre><code>mosquitto_sub \\\n-h xxxdev.azure-devices.net \\\n-u \"xxxdev.azure-devices.net/ublox1\" \\\n-P \"SharedAccessSignature sr=xxxdev.azure- \ndevices.net%2Fdevices%2Fublox1&amp;sig=YYYYY&amp;se=1607025033\"\n-t \"devices/ublox1/messages/events/\" \\\n-i xxxdev \\\n-V mqttv311 \\\n-p 8883 \\\n--cafile ca.pem  \\\n-v -d \n</code></pre>\n\n<p>but I cannot receive any of published messages. \nHere is what the output of the subscribe side:</p>\n\n<pre><code>Client xxxdev sending CONNECT\nClient xxxdev received CONNACK (0)\nClient xxxdev sending SUBSCRIBE (Mid: 1, Topic: topic/, QoS: 0, Options: 0x00)\nClient xxxdev received SUBACK\nSubscribed (mid: 1): 0\n</code></pre>\n\n<p>and that is all. No PUBLISH messages I am able to receive on subscribe side.</p>\n\n<p>My question is: what can be the reason that I cannot receive anything on subscriber side?</p>\n\n<p>For testing purpose I run Visual Studio Code and run \"Monitoring built-in event endpoint\" - and it correctly shows my published messages - so what is going on? Why Visual Studio Code is able to shows my messages but mosquitto cannot?</p>\n"
    }, {
        "tags": [
            "azure",
            "ssl",
            "iot",
            "x509certificate",
            "mosquitto"
        ],
        "is_answered": true,
        "view_count": 512,
        "favorite_count": 0,
        "score": 0,
        "last_activity_date": 1571735363,
        "creation_date": 1571733729,
        "question_id": 58500292,
        "link": "https://stackoverflow.com/questions/58500292/cannot-connect-iot-hub-using-x509-ca-certificate-by-mosquitto-paho",
        "title": "Cannot connect IoT Hub using X509 CA certificate by mosquitto, paho",
        "body": "<p>thank you for the great document. and tutorials.\nI am still stack in connecting IoT Hub using mosquitto. I guess I set all of the option written here as clientId, Username, topic name. Are there any additional option should I add? thanks for your help!</p>\n\n<pre><code>$ openssl genrsa -out rootCA.key 2048\n$ openssl req -x509 -new -nodes -key rootCA.key -sha256 -days 1024 -out rootCA.pem\n$ # Upload rootCA.pem to IoT Hub and get verification code\n$ openssl genrsa -out verificationCert.key 2048\n$ openssl req -new -key verificationCert.key -out verificationCert.csr\n# create csr with CN=[verification code]\n$ openssl x509 -req -in verificationCert.csr -CA rootCA.pem -CAkey rootCA.key -CAcreateserial -out verificationCert.pem -days 500 -sha256\n$ # upload verificationCert.pem and pass verificaton\n$ openssl genrsa -out deviceCert.key 2048\n$ openssl req -new -key deviceCert.key -out deviceCert.csr\n$ openssl x509 -req -in deviceCert.csr -CA rootCA.pem -CAkey rootCA.key -CAcreateserial -out deviceCert.pem -days 500 -sha256\n$ # create Device in IoT Hub\n$ mosquitto_pub -d -h $myhub.azure-devices.net -p 8883 --cafile /etc/ssl/certs/Baltimore_CyberTrust_Root.pem --cert ./deviceCert.pem --key ./deviceCert.key -i $mydevice -u \"$myhub.azure-devices.net/$mydevice/?api-version=2018-06-30\" -t \"/devices/$mydevice/messages/events/\" -m '{\"message\": \"Hello IoT Hub!\"}'\nClient [deviceName] sending CONNECT\nError: The connection was lost.\n</code></pre>\n\n<p>I also failed by paho.\n<a href=\"https://docs.microsoft.com/en-us/azure/iot-hub/iot-hub-mqtt-support#tlsssl-configuration\" rel=\"nofollow noreferrer\">https://docs.microsoft.com/en-us/azure/iot-hub/iot-hub-mqtt-support#tlsssl-configuration</a>\nmy code is following.</p>\n\n<pre><code>from paho.mqtt import client as mqtt\nimport ssl\n\npath_to_root_cert = \"/etc/ssl/certs/Baltimore_CyberTrust_Root.pem\"\ndevice_id = \"mydevice\"\niot_hub_name = \"myhub\"\n\n\ndef on_connect(client, userdata, flags, rc):\n    print(\"Device connected with result code: \" + str(rc))\n\n\ndef on_disconnect(client, userdata, rc):\n    print(\"Device disconnected with result code: \" + str(rc))\n\n\ndef on_publish(client, userdata, mid):\n    print(\"Device sent message\")\n\n\nclient = mqtt.Client(client_id=device_id, protocol=mqtt.MQTTv311)\n\nclient.on_connect = on_connect\nclient.on_disconnect = on_disconnect\nclient.on_publish = on_publish\n\n# Set the username but not the password on your client\nclient.username_pw_set(username=iot_hub_name+\".azure-devices.net/\" +\n                       device_id + \"/?api-version=2018-06-30\", password=None)\n\n# Set the certificate and key paths on your client\ncert_file = \"./deviceCert.pem\"\nkey_file = \"./deviceCert.key\"\nclient.tls_set(ca_certs=path_to_root_cert, certfile=cert_file, keyfile=key_file,\n               cert_reqs=ssl.CERT_REQUIRED, tls_version=ssl.PROTOCOL_TLSv1, ciphers=None)\n\n# Connect as before\nclient.connect(iot_hub_name+\".azure-devices.net\", port=8883)\n\nclient.publish(\"devices/\" + device_id + \"/messages/events/\", \"{id=123}\", qos=1)\nclient.loop_forever()\n</code></pre>\n\n<p>the result was following which means unauthorized.</p>\n\n<pre><code>Device connected with result code: 5\nDevice disconnected with result code: 5\n</code></pre>\n\n<p>JFYI, I could connect to AWS IoT using own CA cert by following step</p>\n\n<pre><code>$ openssl genrsa -out rootCA.key 2048\n$ openssl req -x509 -new -nodes -key rootCA.key -sha256 -days 1024 -out rootCA.pem\n$ openssl genrsa -out verificationCert.key 2048\n$ aws iot get-registration-code  \n$ openssl req -new -key verificationCert.key -out verificationCert.csr\n$ openssl x509 -req -in verificationCert.csr -CA rootCA.pem -CAkey rootCA.key -CAcreateserial -out verificationCert.pem -days 500 -sha256\n$ # use the registration code as CN\n$ aws iot register-ca-certificate --ca-certificate file://rootCA.pem --verification-cert file://verificationCert.pem  \n$ aws iot update-ca-certificate --certificate-id [id which got above] --new-status ACTIVE  \n$ openssl genrsa -out deviceCert.key 2048\n$ openssl req -new -key deviceCert.key -out deviceCert.csr\n$ openssl x509 -req -in deviceCert.csr -CA rootCA.pem -CAkey rootCA.key -CAcreateserial -out deviceCert.pem -days 500 -sha256\n$ aws iot register-certificate --certificate-pem file://deviceCert.pem --ca-certificate-pem file://rootCA.pem  \n$ aws iot update-certificate --certificate-id [id which got above] --new-status ACTIVE  \n$ mosquitto_pub -h [endpoint].iot.ap-northeast-1.amazonaws.com -p 8883 --cafile ./rootCA.pem --cert ./deviceCert.pem --key ./deviceCert.key -q 1 -d -t topic/test -i testdevice -m \"Hello, World\"\n$ # rootCA is the CA I've got from https://www.amazontrust.com/repository/AmazonRootCA1.pem\n</code></pre>\n"
    }, {
        "tags": [
            "ibm-cloud",
            "iot"
        ],
        "is_answered": true,
        "view_count": 32,
        "favorite_count": 0,
        "score": 0,
        "last_activity_date": 1571220526,
        "creation_date": 1570909463,
        "question_id": 58357879,
        "link": "https://stackoverflow.com/questions/58357879/how-can-i-use-tls-with-iot-ibm",
        "title": "How can i use TLS with IOT IBM?",
        "body": "<p>I have already worked with IOT MQTT protocol but now i want to work with IBM IOT MQTT with TLS and i want to publish and subscribe messages using python 3.7 and paho-mqtt library please guide me.</p>\n"
    }, {
        "tags": [
            "ibm-cloud",
            "iot"
        ],
        "is_answered": true,
        "view_count": 200,
        "favorite_count": 0,
        "score": 1,
        "last_activity_date": 1571037078,
        "creation_date": 1570901465,
        "question_id": 58356728,
        "link": "https://stackoverflow.com/questions/58356728/ibm-iot-code-for-publishing-and-subscribing-topics",
        "title": "IBM IOT code for publishing and subscribing Topics",
        "body": "<p>Hey i am new to IBM IOT but i am not getting the easy way to publish and subscribe the topic using paho-mqtt. If there is any good documentation please let me know.</p>\n"
    }, {
        "tags": [
            "ssl",
            "mqtt",
            "iot",
            "tls1.2",
            "mosquitto"
        ],
        "is_answered": true,
        "view_count": 142,
        "favorite_count": 0,
        "score": 0,
        "last_activity_date": 1570523605,
        "creation_date": 1570517527,
        "question_id": 58281425,
        "link": "https://stackoverflow.com/questions/58281425/is-it-possible-to-do-3way-handshake-only-one-time-with-mqtt-communication",
        "title": "is it possible to do 3way handshake only one time with mqtt communication?",
        "body": "<p>I am using mosquitto_pub to publish the data with TLS using a topic.\nI am using mosquitto_sub to subscribe to the topic from mosquitto_pub..</p>\n\n<p>Whenever I fire a mosquitto_pub , I noticed that the wireshark can detect a 3 way handshake each time.\nMy Question now is, is it possible for mosquitto to do only one time of a 3 way handshake? just to minimize the time of sending the data and receiving it to the other end.</p>\n\n<p>I mean like keep the handshake alive on the first firing of mosquitto_pub, then on the succeeding publishing of message, it will send only the TLS data and not do a 3 way handshake over and over again each time.</p>\n"
    }, {
        "tags": [
            "amazon-web-services",
            "certificate",
            "iot",
            "shadow",
            "policy"
        ],
        "is_answered": true,
        "view_count": 59,
        "favorite_count": 0,
        "score": 0,
        "last_activity_date": 1570393589,
        "creation_date": 1570272687,
        "question_id": 58247600,
        "link": "https://stackoverflow.com/questions/58247600/iotcertificate-subject-serialnumber-used-to-restrict-shadow-access",
        "title": "iot:Certificate.Subject.SerialNumber used to restrict shadow access",
        "body": "<p>I am having difficulty using <strong>${iot:Certificate.Subject.SerialNumber}</strong> in a policy to restrict shadow access to the device using the specified certificate.</p>\n\n<p>I have a certificate that has been issued by aws-iot with serialnumber in hex : <strong>00 FC 63 F4 3D D8 8D 92 B1 19 5E 3C 6B D4 1B 99 1E 60 7C 86 34</strong></p>\n\n<p>If I convert this to decimal string I get : <strong>1440894724465102159684825527826579699971598878260</strong></p>\n\n<p>I have attatched this certificate to a Thing with name :\n<strong>Scoot-1440894724465102159684825527826579699971598878260</strong></p>\n\n<p>My policy is :\n<code>\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": \"iot:Connect\",\n      \"Resource\": \"arn:aws:iot:eu-central-1:XXXXXXXXXX:client/*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"iot:Publish\",\n        \"iot:Subscribe\",\n        \"iot:Receive\"\n      ],\n      \"Resource\": [\n        \"arn:aws:iot:eu-central-1:XXXXXXXXXX:topic/$aws/things/Scoot-${iot:Certificate.Subject.SerialNumber}/*\",\n        \"arn:aws:iot:eu-central-1:XXXXXXXXXX:topicfilter/$aws/things/Scoot-${iot:Certificate.Subject.SerialNumber}/*\"\n      ]\n    }\n  ]\n}\n</code></p>\n\n<p>The device cannot  publish messages to the shadow topics.</p>\n\n<p>What am i doing wrong?</p>\n"
    }, {
        "tags": [
            "mqtt",
            "iot",
            "mosquitto"
        ],
        "is_answered": true,
        "view_count": 526,
        "favorite_count": 0,
        "score": 0,
        "last_activity_date": 1570021338,
        "creation_date": 1570011966,
        "last_edit_date": 1570021338,
        "question_id": 58199693,
        "link": "https://stackoverflow.com/questions/58199693/is-there-any-tips-to-get-username-and-password-inputed-by-connected-client-in-mq",
        "title": "Is there any tips to get username and password inputed by connected client in MQTT ? especially Mosquitto",
        "body": "<p>Im new in mqtt, i try to create something to authenticating publisher and subscriber only by their username password (so mqtt config for allowing anonymous is true). If both of them (publisher and subscriber) have the same username password, data form publisher will be sent to subscriber. By doing that, we didnt need to setting up new username password in our mqtt broker. </p>\n\n<p>So, i need something that help me to get username and password of publisher and subscriber input.\nIm working with linux and go languages. Help with these condition will be very helpful. Thanks</p>\n"
    }, {
        "tags": [
            "c",
            "iot",
            "contiki",
            "cooja",
            "contiki-process"
        ],
        "is_answered": false,
        "view_count": 149,
        "favorite_count": 0,
        "score": 1,
        "last_activity_date": 1569331301,
        "creation_date": 1565726821,
        "last_edit_date": 1569331301,
        "question_id": 57484641,
        "link": "https://stackoverflow.com/questions/57484641/contiki-br-not-executing-tcp-ip-event-doesnt-goes-after-process-yield",
        "title": "Contiki BR not executing tcp_ip event,, does&#39;nt goes after PROCESS_YIELD",
        "body": "<p>I'm trying to implement ECC in 6LoWPAN border router. I'm using contiki Wismote motes for all udp_sender.c as sender and the Border router (border_router.c) needs to receive some messages and also reply ECC keys. I have disabled the default server (WITH_WEBSERVER=0) in makefile and enabled debug_print.</p>\n\n<p>udp_sender.c sends messages correctly but the border router doesn't receive messages. <strong>Nothing executes after <code>PROCESS_YIELD</code> in border_router.c</strong></p>\n\n<pre><code>while(1) {\n     PROCESS_YIELD(); **//Nothing executes from this point**\n     if(ev == tcpip_event) {\n          tcpip_handler();\n     } else if (ev == sensors_event &amp;&amp; data == &amp;button_sensor) {\n          PRINTF(\"Initiaing global repair\\n\");\n          rpl_repair_root(RPL_DEFAULT_INSTANCE);\n     }\n }\n</code></pre>\n\n<p>`</p>\n\n<pre><code>#define DEBUG DEBUG_PRINT\n#include \"net/uip-debug.h\"\n\nuint16_t dag_id[] = {0x1111, 0x1100, 0, 0, 0, 0, 0, 0x0011};\nstatic uip_ipaddr_t prefix;\nstatic uint8_t prefix_set;\n\n#define UIP_IP_BUF   ((struct uip_ip_hdr *)&amp;uip_buf[UIP_LLH_LEN])\n#define UDP_CLIENT_PORT 8765\n#define UDP_SERVER_PORT 5678\nstatic struct uip_udp_conn *server_conn;\n\nPROCESS(border_router_process, \"Border router process\");\nPROCESS(startup_process, \"Startup process\");\n\n#if WEBSERVER==0\n/* No webserver */\nAUTOSTART_PROCESSES(&amp;startup_process, &amp;border_router_process);\n#elif WEBSERVER&gt;1\n/* Use an external webserver application */\n#include \"webserver-nogui.h\"\nAUTOSTART_PROCESSES(&amp;border_router_process,&amp;webserver_nogui_process);\n#else\n\n#include \"httpd-simple.h\"\n\n#define WEBSERVER_CONF_LOADTIME 0\n#define WEBSERVER_CONF_FILESTATS 0\n#define WEBSERVER_CONF_NEIGHBOR_STATUS 0\n\n#define WEBSERVER_CONF_ROUTE_LINKS 0\n#if WEBSERVER_CONF_ROUTE_LINKS\n#define BUF_USES_STACK 1\n#endif\n\nPROCESS ( startup_process, \"Statup Process\" );\nPROCESS(webserver_nogui_process, \"Web server\");\nPROCESS_THREAD(webserver_nogui_process, ev, data)\n{\n  PROCESS_BEGIN();\n  httpd_init();\n  while(1) {\n    PROCESS_WAIT_EVENT_UNTIL(ev == tcpip_event);\n    httpd_appcall(data);\n  }\n  PROCESS_END();\n}\nAUTOSTART_PROCESSES(&amp;border_router_process,&amp;webserver_nogui_process, &amp;startup_process);\n\n//webserver codes\n/*-----------------------------------------*/\nstatic void \ntcpip_handler(void)\n{\n  char *appdata;\n\n  if(uip_newdata()) {\n    appdata = (char *)uip_appdata;\n    appdata[uip_datalen()] = 0;\n    PRINTF(\"DATA recv '%s' from \", appdata);\n    PRINTF(\"%d\",\n           UIP_IP_BUF-&gt;srcipaddr.u8[sizeof(UIP_IP_BUF-&gt;srcipaddr.u8) - 1]);\n    PRINTF(\"\\n\");\n#if SERVER_REPLY\n    PRINTF(\"DATA sending reply\\n\");\n    uip_ipaddr_copy(&amp;server_conn-&gt;ripaddr, &amp;UIP_IP_BUF-&gt;srcipaddr);\n    uip_udp_packet_send(server_conn, \"Reply\", sizeof(\"Reply\"));\n    uip_create_unspecified(&amp;server_conn-&gt;ripaddr);\n#endif\n  }\n}\n\nPROCESS_THREAD ( startup_process, ev, data )\n{\n        PROCESS_BEGIN();\n    //some ECC codes here\n      process_start ( &amp;border_router_process, ev );\n        PROCESS_END();\n}\n\nPROCESS_THREAD(border_router_process, ev, data)\n{\n  static struct etimer et;\n  rpl_dag_t *dag;\n\n  PROCESS_BEGIN();\n  ....\n  .....\n  server_conn = udp_new(NULL, UIP_HTONS(UDP_CLIENT_PORT), NULL);\n  if(server_conn == NULL) {\n    PRINTF(\"No UDP connection available, exiting the process!\\n\");\n    PROCESS_EXIT();\n  }\n  udp_bind(server_conn, UIP_HTONS(UDP_SERVER_PORT));\n\n  PRINTF(\"Created a server connection with remote address \");\n  PRINT6ADDR(&amp;server_conn-&gt;ripaddr);\n  PRINTF(\" local/remote port %u/%u\\n\", UIP_HTONS(server_conn-&gt;lport),\n         UIP_HTONS(server_conn-&gt;rport));\n\n  while(1) {\n   PROCESS_YIELD();\n   //Nothing executes from this point\n    if(ev == tcpip_event) {\n      tcpip_handler();\n    } else if (ev == sensors_event &amp;&amp; data == &amp;button_sensor) {\n      PRINTF(\"Initiaing global repair\\n\");\n      rpl_repair_root(RPL_DEFAULT_INSTANCE);\n    }\n  }\n  PROCESS_END();\n}\n</code></pre>\n\n<p><strong>Here is my output</strong></p>\n\n<pre><code>08:46.163   ID:2    Rime started with address 0.0.0.0.0.0.0.2\n08:46.174   ID:2    MAC 00:00:00:00:00:00:00:02 Contiki 2.6 started. Node id is set to 2.\n08:46.183   ID:2    nullmac nullrdc, channel check rate 128 Hz, radio channel 26\n08:46.194   ID:2    Tentative link-local IPv6 address fe80:0000:0000:0000:0200:0000:0000:0002\n08:46.199   ID:2    Starting 'UDP client process'\n08:46.207   ID:2    ECC INITIALIZED: key bit len: 128 NN_DIGIT_BITS: 16\n08:46.660   ID:1    Rime started with address 0.0.0.0.0.0.0.1\n08:46.672   ID:1    MAC 00:00:00:00:00:00:00:01 Contiki 2.6 started. Node id is set to 1.\n08:46.681   ID:1    nullmac nullrdc, channel check rate 128 Hz, radio channel 26\n08:46.693   ID:1    Tentative link-local IPv6 address fe80:0000:0000:0000:0200:0000:0000:0001\n08:46.697   ID:1    Starting 'Startup process'\n08:46.701   ID:1    Inside STARTUP process\n08:46.708   ID:1    ECC INITIALIZED: key bit len: 128 NN_DIGIT_BITS: 16\n08:46.711   ID:2    # [1024 bytes, no line ending]:                     ...\n08:46.938   ID:2    # [1024 bytes, no line ending]:                     ...\n\n08:49.078   ID:1    # [1024 bytes, no line ending]:                     ...\n08:49.207   ID:2                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  UDP client process started\n08:49.213   ID:2    Client IPv6 addresses: aaaa::200:0:0:2\n08:49.215   ID:2    fe80::200:0:0:2\n08:49.224   ID:2    Created a connection with the server :: local/remote port 8765/5678\n08:49.311   ID:1    # [1024 bytes, no line ending]:                     ...\n08:49.545   ID:1    # [1024 bytes, no line ending]:                     ...\n08:49.778   ID:1    # [1024 bytes, no line ending]:                     ...\n08:50.010   ID:1    # [1024 bytes, no line ending]:                     ...\n08:50.242   ID:1    # [1024 bytes, no line ending]:                     ...\n08:50.475   ID:1    # [1024 bytes, no line ending]:                     ...\n08:50.748   ID:1    # [1024 bytes, no line ending]:                     ...\n08:50.751   ID:1    der router process\n08:50.756   ID:1    RPL-Border router started\n08:50.766   ID:1    ?PGot configuration message of type P\n08:50.769   ID:1    Setting prefix aaaa::\n08:51.758   ID:1    after PREFIX\n08:51.761   ID:1    created a new RPL dag\n08:51.765   ID:1    Server IPv6 addresses:\n08:51.768   ID:1     aaaa::200:0:0:1\n08:51.770   ID:1     fe80::200:0:0:1\n08:51.782   ID:1    Created a server connection with remote address :: local/remote port 5678/8765\n10:40.719   ID:2    DATA send to 1 'Hello 1'\n11:38.321   ID:2    DATA send to 1 'Hello 2'\n12:24.887   ID:2    DATA send to 1 'Hello 3'\n13:37.051   ID:2    DATA send to 1 'Hello 4'\n14:22.934   ID:2    DATA send to 1 'Hello 5'\n15:24.160   ID:2    DATA send to 1 'Hello 6'\n16:01.856   ID:2    DATA send to 1 'Hello 7'\n\\\\more messages like above\n\n</code></pre>\n"
    }, {
        "tags": [
            "azure",
            "iot",
            "azure-iot-hub",
            "root-certificate",
            "threadx"
        ],
        "is_answered": false,
        "view_count": 72,
        "favorite_count": 0,
        "score": 0,
        "last_activity_date": 1569240665,
        "creation_date": 1564986564,
        "question_id": 57353222,
        "link": "https://stackoverflow.com/questions/57353222/unable-to-communicate-with-azure-iothub-from-threadx-client",
        "title": "Unable to Communicate with Azure IoTHub from ThreadX client",
        "body": "<p>We are creating an application where ThreadX based client would be communicating with IOT Hub. Made appropriate adapter changes to make client work with IOT Azure C SDK. We observe \"Bad Certificate\" error thrown by client on wire shark error. From wireshark we are certain that client sends \"Hello\" on which Server (IOT Hub) responds \"Server Hello, Certificate, Certificate Request, Server Hello Done\". It is here when client tries authenticate server certificate we see \"Bad Certificate\" being thrown. We are attaching in mail the root certificate we are adding to client and the wireshark we see stating bad certificate.</p>\n\n<p><img src=\"https://afkiddeactiveevac28.blob.core.windows.net/azuredevice/BadCertError.png\" alt=\"Device Error\"></p>\n"
    }, {
        "tags": [
            "mqtt",
            "iot",
            "mqtt-vernemq"
        ],
        "is_answered": true,
        "view_count": 540,
        "favorite_count": 0,
        "score": 0,
        "last_activity_date": 1568971428,
        "creation_date": 1568964557,
        "last_edit_date": 1568970643,
        "question_id": 58023741,
        "link": "https://stackoverflow.com/questions/58023741/mqtt-vernemq-create-streaming",
        "title": "Mqtt vernemq Create streaming",
        "body": "<p>We are using MQTT protocol for publish and subscriber message over VerneMQ server</p>\n\n<p>Can anyone help with in VerneMQ can we do queue streaming like Kafka  where if a subscriber offline and later it back to online that time it will able to get all old missed messages that he missed at time offline</p>\n\n<p>if VerneMQ goes not support Streaming message then what all options we have apart from Kafka and which is good </p>\n\n<p><strong><em>User case</em></strong> </p>\n\n<p>this suppose i have 3(A, B and C) client who subscriber same topic for some reason my A client is office , In this mean time publisher publish 100 messages while A is office but B and C able to receive message so if A will be back online will he able to get those 100 message that publisher publish while he offline</p>\n"
    }, {
        "tags": [
            "iot",
            "emq"
        ],
        "is_answered": false,
        "view_count": 48,
        "favorite_count": 0,
        "score": 0,
        "last_activity_date": 1567321200,
        "creation_date": 1561024839,
        "last_edit_date": 1561039922,
        "question_id": 56683510,
        "link": "https://stackoverflow.com/questions/56683510/unable-to-test-write-and-execute-operations-in-emqx-lwm2m-plugin-in-emqx-v3-1-1",
        "title": "Unable to test write and execute operations in emqx_lwm2m plugin in emqx V3.1.1",
        "body": "<p>I am using Emqx V3.1.1 i have enabled emqx_lwm2m plugin and i installed wakaama client.I am able to connect to my lwm2m with 5783 port using wakaama client.(./lwm2mclient -n ep1 -h localhost -p 5783 -4).i am testing with different msg types like read discover,write,execute etc..,. I am getting proper response while sending read and discover commands. Now i am planning to test write,execute and another msg types. for this I don't have below parameters to test .</p>\n\n<pre><code>\"type\": {?ValueType},\"value\": {?Value},\"args\": {?Arguments},\"pmin\": {?PeriodMin},\n    \"pmax\": {?PeriodMax},\n    \"gt\": {?GreaterThan},\n    \"lt\": {?LessThan},\n    \"st\": {?Step}\n</code></pre>\n"
    }, {
        "tags": [
            "python",
            "mqtt",
            "iot",
            "broker",
            "publisher"
        ],
        "is_answered": true,
        "view_count": 7903,
        "favorite_count": 0,
        "score": 2,
        "last_activity_date": 1567170348,
        "creation_date": 1487047621,
        "last_edit_date": 1567170348,
        "question_id": 42218056,
        "link": "https://stackoverflow.com/questions/42218056/how-to-remove-a-published-topic",
        "title": "How to remove a published topic",
        "body": "<p>I am new to MQTT protocol. As I read through the document, I couldn't see any function to remove the published topic. My purpose is to allow the publisher to remove the published topic. Did I miss something in the mqtt document? Any suggestion? Thanks !</p>\n"
    }, {
        "tags": [
            "raspberry-pi",
            "mqtt",
            "iot",
            "esp32"
        ],
        "is_answered": true,
        "view_count": 77,
        "favorite_count": 0,
        "closed_date": 1565833839,
        "score": 0,
        "last_activity_date": 1565990868,
        "creation_date": 1565814907,
        "last_edit_date": 1565990868,
        "question_id": 57501697,
        "link": "https://stackoverflow.com/questions/57501697/what-request-should-i-use-from-my-esp32-to-discover-mqtt-resources-on-a-mosquitt",
        "title": "What request should I use from my ESP32 to discover MQTT resources on a mosquitto broker on raspbery pi?",
        "body": "<p>I would like to be able from a ESP32 MQTT client to discover all the resources available on a raspberry pi running mosquitto broker.</p>\n\n<p>Searched the internet and checked my ESP32 MQTT broker client for clues but found none.</p>\n\n<p>Hi, I used the ter discovery because that is the term used in CoAp to scan the server for service but what I want to achieve is to find all services available at the server.</p>\n"
    }, {
        "tags": [
            "amazon-web-services",
            "iot"
        ],
        "is_answered": false,
        "view_count": 47,
        "favorite_count": 0,
        "closed_date": 1592734783,
        "score": 1,
        "last_activity_date": 1565372974,
        "creation_date": 1541142696,
        "last_edit_date": 1565372974,
        "question_id": 53114086,
        "link": "https://stackoverflow.com/questions/53114086/i-want-to-retrieve-topic-name-by-an-aws-iot-rule",
        "title": "i want to retrieve topic name by an AWS Iot rule",
        "body": "<p>It is not working. i am using </p>\n\n<pre><code>select * as data, topic() as topic from '/IN/T/+/+/TREND',\n</code></pre>\n\n<p>either i am getting topic by </p>\n\n<pre><code>select topic() AS topic from '/IN/T/+/+/TREND'\n</code></pre>\n\n<p>or just data as </p>\n\n<pre><code>select * from '/IN/T/+/+/TREND'\n</code></pre>\n\n<p>I want both, any help?</p>\n"
    }, {
        "tags": [
            "mqtt",
            "iot",
            "aws-iot"
        ],
        "is_answered": false,
        "view_count": 757,
        "favorite_count": 0,
        "score": 2,
        "last_activity_date": 1565342582,
        "creation_date": 1462255816,
        "question_id": 36996856,
        "link": "https://stackoverflow.com/questions/36996856/aws-iot-rule-engine-is-not-working",
        "title": "AWS-IoT rule engine is not working",
        "body": "<p>I am working on simple publish/ subscribe example using node.js SDK, in which I have subscribed to topic 'sensor/alert' and same time periodically publishing topic 'sensor/temp' with payload </p>\n\n<p>{\"temp\":[no between 0-20]} (ex. {\"temp\" : 20}) </p>\n\n<p>I have configured rule engine with following rule</p>\n\n<p>\"SELECT * FROM 'sensor/temp' WHERE temp > 10\" </p>\n\n<p>which trigger</p>\n\n<p>\"AWS IOT republish action\". </p>\n\n<p>I have set proper role for this rule from AWS-IOT console. But when client code publish topic with payload {\"temp\" : 12} or any number greater than 10 in payload, rule engine should come in action and republish to topic 'sensor/alert' but unfortunately it not. \n I have checked publish and subscribe logic with AWS MQTT client. In Client code publish and subscribe logic is working properly, but rule engine is not working.\nI am using AWS free account.\nI am not able to troubleshoot the issue. Any help is appreciated. </p>\n\n<p>Thanks in advance.</p>\n"
    }, {
        "tags": [
            "python",
            "iot"
        ],
        "is_answered": true,
        "view_count": 1024,
        "favorite_count": 0,
        "score": 1,
        "last_activity_date": 1565244773,
        "creation_date": 1532443705,
        "question_id": 51501611,
        "link": "https://stackoverflow.com/questions/51501611/publishing-uplink-messages-from-python-script-to-ttn-the-things-network-simula",
        "title": "Publishing uplink messages from python script to TTN (the things network) simulating nodes",
        "body": "<p>For testing purposes I am trying to publish MQTT messages (uplink) to TTN (the things network) from a python script on my normal computer. This should simulate an uplink from a node.</p>\n\n<p>Based on examples I found on <a href=\"https://stackoverflow.com/questions/38733589/publishing-mqtt-messages-from-a-python-script-on-a-raspberry-pi\">stackoverflow</a> and on a <a href=\"http://www.steves-internet-guide.com/publishing-messages-mqtt-client/\" rel=\"nofollow noreferrer\">blog</a> I composed the following code:</p>\n\n<pre><code>#!/usr/bin/env python3\nimport paho.mqtt.client as paho\n\n#settings\napp_id = \"&lt;Application ID from the TTN console&gt;\"\naccess_key = \"ttn-account-v2.etcetcetcetcetc..\"\n\nbroker=\"eu.thethings.network\"\nport=1883\n\ndef on_publish(client,userdata,result):\n    print(\"data published \\n\")\n    print(client,userdata,result)\n    pass\n\ndef on_log(mqttc, obj, level, string):\n    print(string)\n\n#setup\nclient = paho.Client()\nclient.username_pw_set(app_id,access_key)\n\n#callbacks\nclient.on_publish = on_publish\nclient.on_log = on_log\n\n#establish connection\nclient.connect(broker,port)\nclient.loop_start()\n\n#publish\nret= client.publish(\"applicationID/bulb1\",\"on\",qos=1)\nret.wait_for_publish()\n</code></pre>\n\n<p>When being run it outputs </p>\n\n<pre><code>Received CONNACK (0, 0)\nReceived PUBACK (Mid: 1)\ndata published \n</code></pre>\n\n<p>However when I check the TTN page of my application I don't see the data.</p>\n\n<p>Anyone any suggestions why this is not working?</p>\n"
    }, {
        "tags": [
            "python-3.x",
            "mqtt",
            "iot",
            "paho"
        ],
        "is_answered": true,
        "view_count": 1023,
        "favorite_count": 0,
        "score": 2,
        "last_activity_date": 1564712053,
        "creation_date": 1564709718,
        "last_edit_date": 1564710708,
        "question_id": 57318888,
        "link": "https://stackoverflow.com/questions/57318888/how-to-speed-up-the-recovery-of-mqtt-subscription-messages-after-disconnected-ne",
        "title": "How to speed up the recovery of mqtt subscription messages after disconnected network reconnection",
        "body": "<p>I have a project code in python which need to server send mqtt message to the device, It needs to solve the problem of device and cloud server application operation and information synchronization. I found that <a href=\"https://www.eclipse.org/paho/clients/python/docs/\" rel=\"nofollow noreferrer\">paho.mqtt</a>!'s Client function has a parameter <code>Client(client_id=\"\", clean_session=True)</code> to restore the unconnected subscription to receive the message sent during the offline. But what I found in my experiments is that the longer you disconnect, the longer it takes you to recover, and the slower your message will be. </p>\n\n<p>I would very appreciate it if you guys can suggest me some advice to speed up recovery or any related references about Cloud-Device application operation and information synchronization. </p>\n\n<p>I have written test disconnection recovery</p>\n\n<p>Cloud</p>\n\n<pre><code>client = mqtt.Client(client_id='Server',clean_session=False)\nclient.enable_logger(logger)\nclient.on_connect = on_connect\nclient.on_message = on_message\nclient.connect(MQTT_IP,MQTT_PORT,60)\nclient.subscribe(topic=\"Cloud/#\",qos=2)\nclient.loop_forever()\n\ndef on_message(client, userdata, msg):\n    topic = msg.topic\n    payload = msg.payload.decode('utf-8')\n    print(topic)\n    print(payload)\n    pattern_create = 'Cloud/create'\n    pattern_delete = 'Cloud/delete'\n    pattern_modify = 'Cloud/modify'\n    pattern_connect = 'Cloud/connect'\n    if re.match(pattern_create, topic):\n        pub(\"Device/create\",\"create\",MQTT_IP,MQTT_PORT)\n    elif re.match(pattern_delete, topic):\n        pub(\"Device/delete\",\"delete\",MQTT_IP,MQTT_PORT)\n    elif re.match(pattern_modify, topic):\n        pub(\"Device/modify\",\"modify\",MQTT_IP,MQTT_PORT)\n    elif re.match(pattern_connect, topic):\n        print('connected')\n        pub(\"Device/connect\",\"connected\",MQTT_IP,MQTT_PORT)\n</code></pre>\n\n<p>Device</p>\n\n<pre><code>def on_message(client, userdata, msg):\n    info = msg.payload.decode('utf-8')\n    print(\"##################info=\",info)\n\ndef wait_to_handle(\"Device/#\", mqtt_host, mqtt_port):\n    client = mqtt.Client(client_id=\"wait_to_handle\", clean_session=False)\n    client.on_connect = on_connect\n    client.on_message = on_message\n    client.connect(mqtt_host,mqtt_port,60)\n    client.subscribe(topic=topics,qos=2)\n    client.loop_forever()\n\ndef send_data_func():\n    client = mqtt.Client('SendToCloud',clean_session=False)\n    client.on_publish = on_publish\n    client.connect(MQTT_IP, MQTT_PORT , 60)\n    client.loop_start()\n    count = 0\n    while 1:\n        print(count)\n        client.publish('Cloud/count',str(count),2)\n        count += 1\n        time.sleep(2)\n</code></pre>\n\n<p>device result</p>\n\n<pre><code>...\nmuch Device sent message\n...\nDevice sent message\nDevice sent message\nDevice sent message\nDevice sent message\nDevice sent message\nDevice sent message\n18666\n18667\n18668\nwait handle : Connected with result code 0\n##################info= create\n##################info= delete\n##################info= modify\n##################info= create\n##################info= delete\n##################info= modify\n##################info= create\n##################info= delete\n##################info= modify\n##################info= create\n##################info= delete\n##################info= modify\n18669\n18670\n18671\n18672\n18673\n18674\nDevice sent message\nDevice sent message\nDevice sent message\nDevice sent message\n...\n...\n</code></pre>\n"
    }, {
        "tags": [
            "mqtt",
            "iot",
            "publish-subscribe"
        ],
        "is_answered": false,
        "view_count": 100,
        "favorite_count": 0,
        "score": -1,
        "last_activity_date": 1564337514,
        "creation_date": 1564331211,
        "last_edit_date": 1564336694,
        "question_id": 57242823,
        "link": "https://stackoverflow.com/questions/57242823/error-during-running-this-python-code-mqtt",
        "title": "error during running this python code (mqtt)",
        "body": "<p>during running this code</p>\n\n<pre class=\"lang-py prettyprint-override\"><code>import paho.mqtt.client as pub\n\nc = pub.Client()\n\nc.connect(\"broker.hivemq.com\",1833)\n\nwhile True:\n\n    c.publish(\"room1\",\"hello!welcome to iot class\")\n</code></pre>\n\n<pre><code>Traceback (most recent call last):\n  File \"C:\\Users\\Sukreeti\\Desktop\\mqtt\\publish.py\", line 3, in &lt;module&gt;\n    c.connect(\"broker.hivemq.com\",1833)\n  File \"C:\\Users\\Sukreeti\\AppData\\Local\\Programs\\Python\\Python37-32\\lib\\site-packages\\paho\\mqtt\\client.py\", line 839, in connect\n    return self.reconnect()\n  File \"C:\\Users\\Sukreeti\\AppData\\Local\\Programs\\Python\\Python37-32\\lib\\site-packages\\paho\\mqtt\\client.py\", line 962, in reconnect\n    sock = socket.create_connection((self._host, self._port), source_address=(self._bind_address, 0))\n  File \"C:\\Users\\Sukreeti\\AppData\\Local\\Programs\\Python\\Python37-32\\lib\\socket.py\", line 727, in create_connection\n    raise err\n  File \"C:\\Users\\Sukreeti\\AppData\\Local\\Programs\\Python\\Python37-32\\lib\\socket.py\", line 716, in create_connection\n    sock.connect(sa)\nTimeoutError: [WinError 10060] A connection attempt failed because the connected party did not properly respond after a period of time, or established connection failed because connected host has failed to respond\n</code></pre>\n"
    }, {
        "tags": [
            "azure",
            "mqtt",
            "iot",
            "eclipse-ditto",
            "eclipse-iot"
        ],
        "is_answered": true,
        "view_count": 150,
        "favorite_count": 1,
        "score": 1,
        "last_activity_date": 1563890245,
        "creation_date": 1563782581,
        "last_edit_date": 1563799102,
        "question_id": 57141524,
        "link": "https://stackoverflow.com/questions/57141524/create-connection-from-eclipse-ditto-to-azure-iot-hub-using-mqtt",
        "title": "Create connection from Eclipse-ditto to Azure IoT hub using MQTT",
        "body": "<p>I'm trying to create an outgoing connection from <a href=\"https://www.eclipse.org/ditto/\" rel=\"nofollow noreferrer\">Ditto</a> to <a href=\"https://azure.microsoft.com/en-us/services/iot-hub/\" rel=\"nofollow noreferrer\">Azure IoT hub</a> using MQTT.\nWe are in charge of Ditto while somebody else (interested in the digital twin Live data) is in charge of the Azure IoT Hub.\nI'm getting following error while connecting with Azure IoT hub (in Connectivity micro service): <code>Not authorized to connect (5)</code>.\nwe also tried connecting with <a href=\"https://mosquitto.org/man/mosquitto_pub-1.html\" rel=\"nofollow noreferrer\">mosquitto_pub</a> and received the same error when we omitted the <code>-i client-id</code> option. Everything else seems ok.</p>\n\n<p>Some extra information:</p>\n\n<ul>\n<li>This is the mosquitto_pub command which currently works:<br>\n<code>mosquitto_pub -h [hostname] -p [port] -t [topic] -m \"\" -u [username] -P [password] --cafile cert.cer  -i [deviceName]</code></li>\n<li>We have been provided with the hostname, port, topic, username (which is a long string containing slaches, dashes and equality operators), password (which is also a long string containing spaces, percentage signs and equality operators) and a certificate file. I've URL encoded the username and the password and stitched them together in the connecting url as described on the ditto page (<a href=\"https://www.eclipse.org/ditto/connectivity-protocol-bindings-mqtt.html\" rel=\"nofollow noreferrer\">https://www.eclipse.org/ditto/connectivity-protocol-bindings-mqtt.html</a>): ssl://[url-encoded-username]:[url-encoded-password]@[hostname]:[port-number]. </li>\n<li>I've added the certificate and I'm not getting the certificate error (\"unable to find valid certification path to requested target\") anymore. </li>\n</ul>\n\n<p>Does anyone have experience with this?<br>\nMaybe the solution is using another protocol (amqp for example)?<br>\nHopefully I haven't missed any other relevant questions or information on the internet. If so, please show me where I can find it.</p>\n\n<p>Thanks</p>\n"
    }, {
        "tags": [
            "amazon-web-services",
            "iot",
            "aws-iot"
        ],
        "is_answered": true,
        "view_count": 851,
        "favorite_count": 0,
        "score": 6,
        "last_activity_date": 1562338925,
        "creation_date": 1562327317,
        "question_id": 56902509,
        "link": "https://stackoverflow.com/questions/56902509/aws-iot-policy-subscribe-vs-receive-actions",
        "title": "AWS IoT Policy: subscribe vs receive actions",
        "body": "<p>Most of the time I eventually create AWS IoT policies with the same content for Subscribe and Receive actions. If someone is allowed to subscribe one topic, it must be allowed to receive a message published to that topic.</p>\n\n<p>Another approach is to specify the exact topics to subscribe and use everything wildcard (*) for Receive action. If someone is allowed to subscribe a list of topics, it will never receive messages from other topics, so why bother to specify the exact topics in Receive actions too?</p>\n\n<p>The only use case when Receive should be different from Subscribe is when an already connected and subscribed thing/user must be disallowed to receive messages publish to one topic already subscribed. However this is a very particular situation.</p>\n"
    }, {
        "tags": [
            "java",
            "mqtt",
            "iot",
            "hivemq"
        ],
        "is_answered": true,
        "view_count": 175,
        "favorite_count": 0,
        "score": 1,
        "last_activity_date": 1562009847,
        "creation_date": 1561914841,
        "question_id": 56826649,
        "link": "https://stackoverflow.com/questions/56826649/how-to-get-the-cipher-suite-being-used-in-hivemq-client",
        "title": "How to get the cipher suite being used in HiveMQ Client?",
        "body": "<p>I configured the HiveMQ server to recognize TLS and created a TLS communication. I'd like to print out the cipher suites being used. I've used the getSslConfig() but I end up getting this as an output: </p>\n\n<p><code>Optional[com.hivemq.client.internal.mqtt.MqttClientSslConfigImpl@2710]</code></p>\n\n<p>I'm aware there is a <code>getCipherSuites()</code> method in <code>MqttClientSslConfig.java</code> but I haven't been able to find a way to use it. As a follow up how would I specify a particular cipher suite be used? So far I've just been using the default one like so:</p>\n\n<p>Code (How to specify a particular cipher suite?):</p>\n\n<pre><code>Mqtt5BlockingClient subscriber = Mqtt5Client.builder()\n        .identifier(UUID.randomUUID().toString()) // the unique identifier of the MQTT client. The ID is randomly generated between \n        .serverHost(\"localhost\")  // the host name or IP address of the MQTT server. Kept it localhost for testing. localhost is default if not specified.\n        .serverPort(8883)  // specifies the port of the server\n        .addConnectedListener(context -&gt; ClientConnectionRetreiver.printConnected(\"Subscriber1\"))        // prints a string that the client is connected\n        .addDisconnectedListener(context -&gt; ClientConnectionRetreiver.printDisconnected(\"Subscriber1\"))  // prints a string that the client is disconnected\n        .sslWithDefaultConfig()  // &lt;&lt; How can I specify a particular cipher suite?\n        .buildBlocking();  // creates the client builder\n</code></pre>\n\n<p>Code (How I've been trying to get the SSL config) :</p>\n\n<pre><code>Mqtt5ClientConfig clientConfig = client.getConfig();\nSystem.out.println(\" Ssl Configuration: \" + clientConfig.getSslConfig());\n</code></pre>\n"
    }, {
        "tags": [
            "raspberry-pi",
            "ibm-cloud",
            "mqtt",
            "iot",
            "publish"
        ],
        "is_answered": true,
        "view_count": 277,
        "favorite_count": 1,
        "score": 1,
        "last_activity_date": 1560855557,
        "creation_date": 1560845679,
        "question_id": 56644622,
        "link": "https://stackoverflow.com/questions/56644622/topic-does-not-match-an-authorized-rule",
        "title": "Topic does not match an authorized rule",
        "body": "<p>the following code is what i used to publish data from my r-pi sense-hat to the IBM cloud</p>\n\n<pre><code>topic = 'iot-2/evt/temperature/fmt/json'\nprint(\"Publishing data from pito cloud\",json.dumps(payload))\nclient.publish(topic,json.dumps(payload), qos=1)\n</code></pre>\n\n<p>Has the format for publishing changed on the IBM Cloud?\nIBM cloud connection log gave the message: Topic does not match authorized rule.</p>\n"
    }, {
        "tags": [
            "python",
            "mqtt",
            "iot"
        ],
        "is_answered": false,
        "view_count": 29,
        "favorite_count": 0,
        "score": 0,
        "last_activity_date": 1560322177,
        "creation_date": 1560318844,
        "question_id": 56555472,
        "link": "https://stackoverflow.com/questions/56555472/will-the-message-be-delivered-again-if-the-subscriber-gets-the-message-but-the-c",
        "title": "Will the message be delivered again if the subscriber gets the message but the connects fails midway?",
        "body": "<p>A message queue stores message until they are consumed When you use a message queue, each incoming message is stored in the queue until it is picked up by a client (often called a consumer). If no client picks up the message, the message remains stuck in the queue and waits to be consumed. In a message queue, it is not possible for a message not to be processed by any client, as it is in MQTT if nobody subscribes to a topic.\nWhat will happen if the subscriber receives the message but is unable to download it due to lack of connection? What measures can be taken to make sure the client gets the message even after this?</p>\n"
    }, {
        "tags": [
            "javascript",
            "websocket",
            "mqtt",
            "iot",
            "paho"
        ],
        "is_answered": true,
        "view_count": 2882,
        "favorite_count": 0,
        "score": 0,
        "last_activity_date": 1559380115,
        "creation_date": 1519920803,
        "last_edit_date": 1519926010,
        "question_id": 49054009,
        "link": "https://stackoverflow.com/questions/49054009/connect-webpage-through-web-socket-to-mqtt-broker",
        "title": "connect webpage through web socket to MQTT broker",
        "body": "<p>i created mqtt broker at cloudMQTT and here is the info about ports &amp; server that i got </p>\n\n<p><img src=\"https://i.stack.imgur.com/1AQyN.png\" alt=\"click to see image of ports\"></p>\n\n<p>now i wrote that code to run web page that connect to that broker and send hello world.</p>\n\n<pre><code>&lt;html&gt;\n   &lt;head&gt;\n      &lt;title&gt;JavaScript MQTT WebSocket Example&lt;/title&gt;\n      &lt;script src=\"https://cdnjs.cloudflare.com/ajax/libs/paho-mqtt/1.0.1/mqttws31.js\" type=\"text/javascript\"&gt;\n     &lt;/script&gt;\n     &lt;script type = \"text/javascript\" language = \"javascript\"&gt;\n        var mqtt;\n        var reconnectTimeout = 2000;\n        var host=\"m23.cloudmqtt.com\"; //change this\n        var port= 38788;\n\n        function onConnect() {\n      // Once a connection has been made, make a subscription and send a message.\n\n        console.log(\"Connected \");\n        //mqtt.subscribe(\"sensor1\");\n        message = new Paho.MQTT.Message(\"Hello world\");\n        message.destinationName = \"orange1\";\n        mqtt.send(message);\n      }\n      function MQTTconnect() {\n        console.log(\"connecting to \"+ host +\" \"+ port);\n        mqtt = new Paho.MQTT.Client(host,port,\"clientjs\");\n        //document.write(\"connecting to \"+ host);\n        var options = {\n            timeout: 3,\n            onSuccess: onConnect,\n\n         };\n\n        mqtt.connect(options); //connect\n        }\n\n      &lt;/script&gt;\n   &lt;/head&gt;\n     &lt;body&gt;\n   &lt;h1&gt;Main Body&lt;/h1&gt;\n    &lt;script&gt;\n    MQTTconnect();\n    &lt;/script&gt;\n   &lt;/body&gt;\n&lt;/html&gt;\n</code></pre>\n\n<p>every time i open that page and open console.js i got that problem message:</p>\n\n<p><img src=\"https://i.stack.imgur.com/P4fyA.png\" alt=\"error message that appear at console.log\"></p>\n\n<p>(here are list of errors that appears at my console.log .. to help anyone who can see images)\nWebSocket connection to 'ws://m23.cloudmqtt.com:38788/mqtt' failed: Error during WebSocket handshake: net::ERR_CONNECTION_RESET mqttws31.js:979</p>\n\n<p>Paho.MQTT.ClientImpl._doConnect @ mqttws31.js:979</p>\n\n<p>Paho.MQTT.ClientImpl.connect @ mqttws31.js:849</p>\n\n<p>Client.connect @ mqttws31.js:1799</p>\n\n<p>MQTTconnect @ websockets-1.htm:31</p>\n\n<p>(anonymous) @ websockets-1.htm:39</p>\n\n<p>WebSocket connection to 'ws://m23.cloudmqtt.com:38788/mqtt' failed: Error during WebSocket handshake: net::ERR_CONNECTION_RESET mqttws31.js:977</p>\n\n<p>Paho.MQTT.ClientImpl._doConnect @ mqttws31.js:977</p>\n\n<p>Paho.MQTT.ClientImpl._disconnected @ mqttws31.js:1459</p>\n\n<p>Paho.MQTT.ClientImpl._on_socket_error @ mqttws31.js:1347</p>\n\n<p>(anonymous) @ mqttws31.js:157</p>\n\n<p>i tried to change the ports but i got the same problem.\nhow can i fix something like that ?\nand if i tried to connect to <a href=\"https://test.mosquitto.org/\" rel=\"nofollow noreferrer\">https://test.mosquitto.org/</a>\ni got the same problem ? how can this be fixed too ?</p>\n"
    }, {
        "tags": [
            "mqtt",
            "iot",
            "google-cloud-pubsub",
            "google-cloud-iot"
        ],
        "is_answered": true,
        "view_count": 2111,
        "favorite_count": 1,
        "score": 2,
        "last_activity_date": 1558382051,
        "creation_date": 1517558447,
        "question_id": 48578216,
        "link": "https://stackoverflow.com/questions/48578216/google-iot-core-connection-status",
        "title": "Google iot core connection status",
        "body": "<p>I am using Google IOT core with mongoose os. I wanted to update device connection status to firestore. But i am unable to find event which reports mqtt connection status to pub/sub like when device disconnects or reconnect i.e if device is offline or not.</p>\n\n<p>I am stuck on this problem for days.Any help will be appreciated</p>\n"
    }, {
        "tags": [
            "amazon-web-services",
            "mqtt",
            "iot",
            "amazon-sns",
            "aws-iot"
        ],
        "is_answered": false,
        "view_count": 408,
        "favorite_count": 0,
        "score": 2,
        "last_activity_date": 1557552065,
        "creation_date": 1503011892,
        "question_id": 45746264,
        "link": "https://stackoverflow.com/questions/45746264/aws-iot-sns-email-not-sending",
        "title": "AWS IoT + SNS: Email not sending",
        "body": "<p>I'm following the AWS tutorial on how to <a href=\"http://docs.aws.amazon.com/iot/latest/developerguide/config-and-test-rules.html\" rel=\"nofollow noreferrer\">Configure and Test Rules</a>. The only thing I'm doing differently is setting up an email rule (instead of SMS). I have successfully setup and subscribed to the SNS topic.</p>\n\n<p>I've created a rule, and used the AWS IoT MQTT client to publish to a test topic that matched the rule. However no email is sent. How can I troubleshoot this?</p>\n\n<p>The odd thing is I tried this same tutorial 3 days ago and it worked fine.</p>\n"
    }, {
        "tags": [
            "java",
            "mqtt",
            "iot",
            "paho",
            "hivemq"
        ],
        "is_answered": true,
        "view_count": 1506,
        "favorite_count": 0,
        "score": 1,
        "last_activity_date": 1557319549,
        "creation_date": 1557312222,
        "last_edit_date": 1557319280,
        "question_id": 56038884,
        "link": "https://stackoverflow.com/questions/56038884/how-to-publish-mqtt-messages-concurrently-using-java-client",
        "title": "how to publish MQTT messages concurrently using java client?",
        "body": "<p>i am trying to publish MQTT messages concurrently using 5 java client, such that each java client publish 1000 messages on a particular topic concurrently to a MQTT broker(HIVEMQ)</p>\n\n<p>i have opened multiple threads, each threads create a mqtt client and connect to broker using ssl and try to publish 1000 messages concurrently,messages are being sent but all the connections are not getting successful to broker and i keep on getting exception</p>\n\n<pre><code>Client is not connected (32104)\nat org.eclipse.paho.client.mqttv3.internal.ExceptionHelper.createMqttException(ExceptionHelper.java:31)\n    at org.eclipse.paho.client.mqttv3.internal.ClientComms.sendNoWait(ClientComms.java:199)\n    at org.eclipse.paho.client.mqttv3.MqttAsyncClient.publish(MqttAsyncClient.java:1355)\n    at org.eclipse.paho.client.mqttv3.MqttClient.publish(MqttClient.java:583)\n    at org.eclipse.paho.client.mqttv3.MqttClient.publish(MqttClient.java:575)\n    at com.test.MqttPublishSample.publishMessages(MqttPublishSample.java:122)\n    at com.test.MqttPublishSample.lambda$start$0(MqttPublishSample.java:74)\n    at java.base/java.lang.Thread.run(Thread.java:834)\n</code></pre>\n\n<pre><code>public class MqttPublishSample {\n\n    public static void main(String... args) throws InterruptedException {\n\n        new MqttPublishSample().start();\n\n    }\n\n  public void start() throws InterruptedException {\n\n\n        for(int i=0;i&lt;5;i++){\n\n            new Thread(()-&gt;{\n                MqttClient client = null;\n                try {\n                    client = obtainConnection();//code to obtain connection using MqttClient\n                    publishMessages(client);//code to publish message using simple for loop \n\n                } catch (MqttException e) {\n                    e.printStackTrace();\n                }\n\n            }).start();\n        }\n    }\n</code></pre>\n\n<pre><code>public MqttClient obtainConnection() throws MqttException {\n        String clientId = \"sslTestClient\"+ThreadLocalRandom.current().nextInt(0,5);\n        MqttClient client = null;\n        try {\n            client = new MqttClient(\"ssl://localhost:8883\", clientId, new MemoryPersistence());\n        } catch (MqttException e) {\n            e.printStackTrace();\n        }\n\n        MqttConnectOptions mqttConnectOptions = new MqttConnectOptions();\n        mqttConnectOptions.setUserName(\"user1\");\n        mqttConnectOptions.setPassword(\"pass1\".toCharArray());\n        try {\n            mqttConnectOptions.setSocketFactory(getTruststoreFactory());\n        } catch (Exception e) {\n            e.printStackTrace();\n        }\n\n        System.out.println(\"connecting...\");\n        client.connect(mqttConnectOptions);\n        return client;\n    }\n</code></pre>\n\n<p>i am expecting all clients gets successfully connected to broker and publish message without the exception</p>\n"
    }, {
        "tags": [
            "azure",
            "ssl",
            "iot",
            "x509",
            "azure-iot-hub"
        ],
        "is_answered": true,
        "view_count": 131,
        "favorite_count": 0,
        "score": 0,
        "last_activity_date": 1557242701,
        "creation_date": 1556177518,
        "last_edit_date": 1556230652,
        "question_id": 55844044,
        "link": "https://stackoverflow.com/questions/55844044/iot-hub-certificate-validation",
        "title": "IoT hub certificate validation",
        "body": "<p>We have the following certificate chain:</p>\n\n<ul>\n<li>RootCA -> IntermProduction -> [leaf certificates] </li>\n<li>RootCA -> IntermTest -> [leaf test certificates]</li>\n</ul>\n\n<p>Does it make a difference if I:</p>\n\n<ul>\n<li>a) Upload to IoT hub RootCA</li>\n<li>b) Upload to IoT hub both\nIntermProduction and IntermTest (without RootCA)</li>\n</ul>\n\n<p>Will there be any differences in how leaf device certificates are validated? Our RootCA is self-signed company root.</p>\n\n<p>The background of the question is, that I uploaded our rootCA to IoT hub, following MS samples <a href=\"https://docs.microsoft.com/en-us/azure/iot-hub/iot-hub-security-x509-get-started\" rel=\"nofollow noreferrer\">here</a>. Our security specialist however refused to validate the proof of posession. Reason: Our rootCA is locked and no sub-certs should be issued. He asked me to point to the documentation where it is said, that we MUST use the rootCA. I didn't find such a point.</p>\n\n<p>As I don't know the internals of IoT Hub, I'm a bit at a loss. We are migrating from a self-made service to IoT solution. In our own service I did implement the verification of the certificate chain myself, and I did need the root certificate for this.</p>\n\n<p>Did somebody have a hands-on experience with something similar?</p>\n\n<p>Of course it's an option to just upload two intermidiates and try it out, and I have a gut feeling that this will work, so the question is more like if I'm creating a potential security breach by doing so?</p>\n"
    }, {
        "tags": [
            "testing",
            "automation",
            "automated-tests",
            "iot"
        ],
        "is_answered": false,
        "view_count": 77,
        "favorite_count": 0,
        "score": -2,
        "last_activity_date": 1556861720,
        "creation_date": 1556607140,
        "last_edit_date": 1556861592,
        "question_id": 55915400,
        "link": "https://stackoverflow.com/questions/55915400/what-types-of-tests-are-performed-on-iot-devices-and-what-are-the-best-approache",
        "title": "What types of tests are performed on IoT Devices and what are the best approaches to be taken?",
        "body": "<p>This question is related to Testing and gives some tips about IOT Testing</p>\n"
    }, {
        "tags": [
            "websocket",
            "mqtt",
            "iot",
            "openwrt",
            "mosquitto"
        ],
        "is_answered": true,
        "view_count": 1083,
        "favorite_count": 0,
        "score": 1,
        "last_activity_date": 1556791309,
        "creation_date": 1516822533,
        "last_edit_date": 1516823815,
        "question_id": 48430332,
        "link": "https://stackoverflow.com/questions/48430332/openwrt-lede-websockets-support-not-available-for-mosquitto",
        "title": "OpenWRT / LEDE: Websockets support not available for mosquitto",
        "body": "<p>I'm trying to run mosquitto with config:</p>\n\n<pre><code>listener 1884\nlistener 9001\nprotocol websockets\n</code></pre>\n\n<p>I get an error:</p>\n\n<blockquote>\n  <p>Error: Websockets support not available. </p>\n</blockquote>\n\n<p>I'm running <code>mosquitto</code> version 1.4.14, I also have a <code>libwebsockets-full</code> (2.4.1-2) installed. I thought I could get the source and compile it with <code>WITH_WEBSOCKETS:=yes</code> set in <code>confik.mk</code> (solution found in one of answers in <a href=\"https://stackoverflow.com/questions/30383753/mosquitto-1-4-2-websocket-support\">similar problem</a>) but on my router I don't have enaugh space to install gcc ;) </p>\n\n<p>I'm running LEDE Reboot (SNAPSHOT, r5392-bc50a97).</p>\n\n<p>Any ideas of how can I enable websockets for mosquitto on my device? </p>\n"
    }, {
        "tags": [
            "javascript",
            "node.js",
            "mqtt",
            "iot",
            "mosca"
        ],
        "is_answered": true,
        "view_count": 84,
        "favorite_count": 1,
        "score": 0,
        "last_activity_date": 1554707787,
        "creation_date": 1554705402,
        "last_edit_date": 1554705723,
        "question_id": 55567491,
        "link": "https://stackoverflow.com/questions/55567491/how-to-access-client-object-in-published-callback",
        "title": "How to access client object in &#39;published&#39; callback?",
        "body": "<p>I am using Mosca as embedded MQTT broker with mosquito backend. I am using Mosca primarily as an auth mechanism which can read the jwt tokens and extract some values out of it. I have created my own authorizers to read JWT token in mqtt password field and decode/verify it. After decoding I add the decoded fields to the client object like following </p>\n\n<pre><code>authenticate(client, username, password, next) {\n    try {\n        const decoded_token = jwt.verify(password.toString(), process.env.SECRET_KEY_BASE);\n        client.decoded_token = decoded_token;\n        next(null, true);\n    } catch(error) {\n        console.log('name: %s, error: %s', error.name, error.message);\n        console.log('unauthorized!');\n        next(null, false);\n    }\n}\n</code></pre>\n\n<p>I want to access the <code>decoded_token</code> value in the <code>published</code> callback like following</p>\n\n<pre><code>broker.on('published', (packet, client) =&gt; {\n    console.log(client.decoded_token);\n    console.log('Published', packet.topic, packet.payload);\n\n});\n</code></pre>\n\n<p>Somehow the above code does not work as expected. I get the following error:</p>\n\n<p>TypeError: Cannot read property 'decoded_token' of undefined</p>\n\n<p>Whereas if instead of <code>console.log(client.decoded_token)</code> I use <code>console.log(client)</code>, it works and I can see the <code>decoded_token</code> value in client object.</p>\n\n<p>I have two questions. </p>\n\n<ol>\n<li>Why does the above code not work?</li>\n<li>When I store a value in the client object, is the value passed to the client (sensor) which it can send with subsequent requests or is it only stored in local memory?</li>\n</ol>\n\n<p>I am new to MQTT so please excuse me if the questions are too naive :)</p>\n"
    }, {
        "tags": [
            "javascript",
            "java",
            "iot",
            "eclipse-ditto",
            "eclipse-iot"
        ],
        "is_answered": true,
        "view_count": 161,
        "favorite_count": 0,
        "score": 0,
        "last_activity_date": 1554188054,
        "creation_date": 1554118233,
        "last_edit_date": 1554188054,
        "question_id": 55454096,
        "link": "https://stackoverflow.com/questions/55454096/no-messagemappingprocessor-available-in-ditto",
        "title": "no MessageMappingProcessor available in Ditto",
        "body": "<p>I got a stranger error although I follow guideline in ditto example.</p>\n\n<p>Octopus can published messages to MQTT. I can see them use MQTT client.\nWebApp shows connection established and send send event works. I can change values through <code>\"my.test.octopus\"</code>panel. But when I query it using API, I can only my values from webapp, never got vales from octopus.</p>\n\n<p>I checked connectivity logs, seems mapping problem...I used the following to create mapping when creating connection:</p>\n\n<pre><code>\"incomingScript\": \"function mapToDittoProtocolMsg(\n                              headers, \n                              textPayload, \n                              bytePayload, \n                              contentType) {\n\n    const jsonString = String.fromCharCode.apply(null, new Uint8Array(bytePayload));\n    const jsonData = JSON.parse(jsonString);\n    const thingId = jsonData.thingId;\n    const value = { \n      temp_sensor: { \n        properties: { \n          value: jsonData.temp \n        }\n      },\n      altitude: { \n        properties: { \n          value: jsonData.alt \n        }\n      }\n    };\n\n    return Ditto.buildDittoProtocolMsg('my.test', thingId, 'things', 'twin', 'commands', 'modify', '/features', headers, value);\n}\"\n</code></pre>\n\n<p>Thanks for help</p>\n\n<p><strong>update</strong></p>\n\n<p>The error manifests in the following log line: </p>\n\n<p>See the following log statement:</p>\n\n<pre><code>\"The message mapper configuration failed due to: unterminated regular expression literal (incomingScript#1) - in line/column #1/472,\" -- \"\"incomingScript\": \"function mapToDittoProtocolMsg(headers, textPayload, bytePayload, contentType) {var jsonData = JSON.parse(textPayload);const thingId = jsonData.thingId;const value = {temp_sensor: { properties: { value: jsonData.temp } }, altitude: { properties: { value: jsonData.alt } } }; return Ditto.buildDittoProtocolMsg('my.test', thingId, 'things', 'twin', 'commands', 'modify', '/features', headers, value); }\"\n</code></pre>\n"
    }, {
        "tags": [
            "java",
            "open-source",
            "iot",
            "platform",
            "kaa"
        ],
        "is_answered": false,
        "view_count": 55,
        "favorite_count": 0,
        "score": 0,
        "last_activity_date": 1553280501,
        "creation_date": 1548951227,
        "last_edit_date": 1548957145,
        "question_id": 54464778,
        "link": "https://stackoverflow.com/questions/54464778/how-to-fix-kaa-errer-check-the-logs-after-startup",
        "title": "How to fix kaa errer Check the logs after startup",
        "body": "<p>I follow step by step when installing kaa single node but I have an error in  heck the logs after startup.----> cat /var/log/kaa/* | grep ERROR </p>\n\n<p>this is the error:</p>\n\n<pre><code>2019-01-31 14:14:34,956 [main] ERROR o.h.tool.hbm2ddl.SchemaUpdate - HHH000319: Could not get database metadata\n2019-01-31 14:14:34,961 [main] ERROR o.h.tool.hbm2ddl.SchemaUpdate - HHH000299: Could not complete schema update\n2019-01-31 14:14:37,769 [main] ERROR o.h.tool.hbm2ddl.SchemaUpdate - HHH000319: Could not get database metadata\n2019-01-31 14:14:37,773 [main] ERROR o.h.tool.hbm2ddl.SchemaUpdate - HHH000299: Could not complete schema update\n2019-01-31 14:14:37,897 [main] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - Cannot create PoolableConnectionFactory (No active connection found for master : Could not connect to HostAddress{host='localhost', port=3306, type='master'}.Connection refused (Connection refused))\n2019-01-31 14:14:37,910 [main] ERROR o.s.web.context.ContextLoader - Context initialization failed\n2019-01-31 14:30:23,673 [main] ERROR o.h.tool.hbm2ddl.SchemaUpdate - HHH000319: Could not get database metadata\n2019-01-31 14:30:23,678 [main] ERROR o.h.tool.hbm2ddl.SchemaUpdate - HHH000299: Could not complete schema update\n2019-01-31 14:30:27,142 [main] ERROR o.h.tool.hbm2ddl.SchemaUpdate - HHH000319: Could not get database metadata\n2019-01-31 14:30:27,146 [main] ERROR o.h.tool.hbm2ddl.SchemaUpdate - HHH000299: Could not complete schema update\n2019-01-31 14:30:27,266 [main] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - Cannot create PoolableConnectionFactory (No active connection found for master : Could not connect to HostAddress{host='localhost', port=3306, type='master'}.Connection refused (Connection refused))\n2019-01-31 14:30:27,279 [main] ERROR o.s.web.context.ContextLoader - Context initialization failed\n2019-01-31 22:34:01,662 [main] ERROR o.h.tool.hbm2ddl.SchemaUpdate - HHH000319: Could not get database metadata\n2019-01-31 22:34:01,667 [main] ERROR o.h.tool.hbm2ddl.SchemaUpdate - HHH000299: Could not complete schema update\n2019-01-31 22:34:04,979 [main] ERROR o.h.tool.hbm2ddl.SchemaUpdate - HHH000319: Could not get database metadata\n2019-01-31 22:34:04,983 [main] ERROR o.h.tool.hbm2ddl.SchemaUpdate - HHH000299: Could not complete schema update\n2019-01-31 22:34:05,115 [main] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - Cannot create PoolableConnectionFactory (No active connection found for master : Could not connect to HostAddress{host='localhost', port=3306, type='master'}.Connection refused (Connection refused))\n2019-01-31 22:34:05,128 [main] ERROR o.s.web.context.ContextLoader - Context initialization failed\n</code></pre>\n\n<p>Thanks :)</p>\n"
    }, {
        "tags": [
            "android",
            "mqtt",
            "iot",
            "adafruit"
        ],
        "is_answered": false,
        "view_count": 69,
        "favorite_count": 0,
        "score": 0,
        "last_activity_date": 1551605553,
        "creation_date": 1551395564,
        "question_id": 54935724,
        "link": "https://stackoverflow.com/questions/54935724/why-eclipse-paho-android-mqtt-client-returns-subscribtion-failed",
        "title": "Why Eclipse Paho Android MQTT Client Returns Subscribtion Failed?",
        "body": "<p>I can not subscribe to MQTT topic from my android application. \nWhen i call <code>SubscribeToTopic</code> function, I get the following Error</p>\n\n<blockquote>\n  <p>\"subscription to UserName/feeds/Topic failed: not available\"</p>\n</blockquote>\n\n<p>Here is the code to subscribe</p>\n\n<pre><code>    private void SubscribeToTopic(String TopicName, int Qos) {\n    try {\n        if (client.isConnected()) {\n            client.subscribe(TopicName, Qos, null, new IMqttActionListener() {\n                @Override\n                public void onSuccess(IMqttToken asyncActionToken) {\n                    Log.d(\"Subscribtion\", \"Succeed\");\n                }\n\n                @Override\n                public void onFailure(IMqttToken asyncActionToken, Throwable exception) {\n                    Log.d(\"Subscribtion\", \"Failed\", exception);\n                }\n            });\n        }\n    }\n    catch (MqttException exception)\n    {\n        Log.d(\"Subscribtion\",\"Failed\",exception);\n    }\n}\n</code></pre>\n\n<p><strong>NOTE:</strong> I'm using Eclipse Paho as my MQTT Client and Adafruit IO as Broker. TopicName is something like <code>UserName/feeds/Topic</code> and Qos is <code>0</code></p>\n"
    }, {
        "tags": [
            "mqtt",
            "iot"
        ],
        "is_answered": true,
        "view_count": 189,
        "favorite_count": 0,
        "score": 0,
        "last_activity_date": 1551041787,
        "creation_date": 1551017075,
        "question_id": 54852669,
        "link": "https://stackoverflow.com/questions/54852669/not-connecting-user-using-mqttjs-on-cloudmqtt",
        "title": "Not connecting user using MQTTjs on cloudmqtt",
        "body": "<p>I am having this code in my file (belong to react)</p>\n\n<pre><code>const client = mqtt.connect({\n  host: 'mqtt://m16.cloudmqtt.com',\n  port: 1883,\n  username: 'b*******k',\n  password: 'gU******S',\n});\nclient.on('connect', () =&gt; {\n  console.log('hello');\n  client.subscribe('v');\n  client.publish('v', 'chal pa');\n});\nclient.on('message', (topic, message) =&gt; {\n  if (topic === 'v') {\n    console.log('here my topic is v');\n    // var connected = (message.toString() === 'true');\n  }\n  console.log('recived message from mqtt');\n  console.log(message);\n});\nclient.on('error', er =&gt; {\n  console.log(er);\n});\n</code></pre>\n\n<p><br/>\nI am expecting to connect to mqtt broker and receive some message. \n<br/>\nBut nothing happened. When i check log file in cloudmqtt.com<br/><br/>\n<a href=\"https://i.stack.imgur.com/HVWWV.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/HVWWV.png\" alt=\"enter image description here\"></a> </p>\n\n<p>I am stuck here can anybody help. Link to any blog/video that will help will be highly appreciated.</p>\n\n<p>I am using mqttjs </p>\n"
    }, {
        "tags": [
            "java",
            "ssl",
            "mqtt",
            "iot"
        ],
        "is_answered": true,
        "view_count": 4147,
        "favorite_count": 1,
        "score": 1,
        "last_activity_date": 1550649647,
        "creation_date": 1463034293,
        "last_edit_date": 1463034644,
        "question_id": 37178807,
        "link": "https://stackoverflow.com/questions/37178807/tls-ssl-connection-for-mqtt-in-java",
        "title": "TLS/SSL Connection for MQTT in java",
        "body": "<p>i am working on MQTT protocol. i configured its server and performed the communication in java using its mosquitto library on port 1883.\nnow i want to make this communication secure.What i know is port 8883 is reserved for its tls based secure communication.\nIt requires X.509 certiicates.\nI found the following tutorial for this purpose.</p>\n\n<p><a href=\"http://www.embedded101.com/Blogs/PaoloPatierno/entryid/366/mqtt-over-ssl-tls-with-the-m2mqtt-library-and-the-mosquitto-broker\" rel=\"nofollow\">http://www.embedded101.com/Blogs/PaoloPatierno/entryid/366/mqtt-over-ssl-tls-with-the-m2mqtt-library-and-the-mosquitto-broker</a></p>\n\n<p>But my question are</p>\n\n<p>1.how can we generate these certificates in java code?</p>\n\n<p>2.how can we use multiple certificates at a time.As according to above tutorial we can specify only one set of ceritificates at a time in mosquitto.conf file of server.And then we need to restart the server.(that i dont want to do.)</p>\n\n<p>3.how can we let a running server know about these newly generated certificates. Is there anyother way to do this except to specify in conf file of server?</p>\n"
    }, {
        "tags": [
            "azure",
            "iot",
            "azure-iot-hub"
        ],
        "is_answered": true,
        "view_count": 237,
        "favorite_count": 0,
        "score": 0,
        "last_activity_date": 1550492898,
        "creation_date": 1550476362,
        "question_id": 54742613,
        "link": "https://stackoverflow.com/questions/54742613/azure-iot-hub-revoke-device-session",
        "title": "Azure Iot Hub: Revoke device session",
        "body": "<p>I am currently looking for a way to revoke the device session of a device that is connected to the Azure Iot Hub.</p>\n\n<p>For example, when a device connects using a certificate and the certificate expires, the device can still send and receive data while it has a valid token.</p>\n\n<p>Our case is if a device overloads our IoT Hub for whatever reason, we would like to be able to revoke the connection immediately.\nWe want to be able to revoke such token in order to immediately disconnect a certain device.</p>\n\n<p>Is it even possible to do so? If not, are there workarounds for that?</p>\n"
    }, {
        "tags": [
            "java",
            "mqtt",
            "iot"
        ],
        "is_answered": true,
        "view_count": 49,
        "favorite_count": 0,
        "score": 1,
        "last_activity_date": 1549774740,
        "creation_date": 1485420650,
        "last_edit_date": 1549774740,
        "question_id": 41869729,
        "link": "https://stackoverflow.com/questions/41869729/access-mqtt-asynchronous-messages",
        "title": "Access MQTT asynchronous messages",
        "body": "<p>I have a listener class(Java) that is subscribed to several topics via MQTT. I want to access the messages that are published to my listener from another class. How to do this?\nThe goal is to feed the output of the listener class into a continuously refreshing JFrame.</p>\n"
    }, {
        "tags": [
            "mqtt",
            "iot",
            "mosquitto"
        ],
        "is_answered": true,
        "view_count": 264,
        "favorite_count": 0,
        "score": 0,
        "last_activity_date": 1549743065,
        "creation_date": 1549740735,
        "question_id": 54609955,
        "link": "https://stackoverflow.com/questions/54609955/display-of-the-missed-messages-from-the-publisher-with-a-new-subscriber-connecti",
        "title": "Display of the missed messages from the publisher with a new subscriber connection (MQTT / Mosquitto)",
        "body": "<p>Publusher sends a message <code>-m \"hello\"</code> to the topic <code>-t hello</code> using the command <code>mosquitto_pub -h 172.17.*.* -t hello -m \"hello\" -d</code>. The subscriber sees the message <code>-m \"hello\"</code> only if the connection to the topic <code>-t hello</code> is active. However, if the subscriber is not subscribed to the <code>-t hello</code> topic and the publisher still sends messages on the <code>-t hello</code> topic, then when you try to subscribe to this topic <code>mosquitto_sub -h 172.17. *. * -t hello</code> subscriber does not receive sent messages from publisher. </p>\n\n<p>After reading the documentation, breaking a couple of brokers, I achieved only the fact that you can see the last message if you put the flag on the publisher <code>-r</code> like this - <code>-mosquitto_pub -h 172.17. *. * -r -t hello -m \"hello\"</code>. I configured <code>mosquitto.conf</code>, because I thought that the main changes, an example of the current problem, can only be achieved through it.</p>\n\n<p><strong>How can I solve such a problem, I would like to see all missed messages from publisher when i resubscribe to the topic?</strong></p>\n"
    }, {
        "tags": [
            "python",
            "google-cloud-platform",
            "publish-subscribe",
            "iot",
            "google-cloud-iot"
        ],
        "is_answered": true,
        "view_count": 1118,
        "favorite_count": 1,
        "score": 0,
        "last_activity_date": 1549385107,
        "creation_date": 1522784677,
        "last_edit_date": 1522958977,
        "question_id": 49638010,
        "link": "https://stackoverflow.com/questions/49638010/google-iot-right-mode-to-receive-notifications-subscribe-working",
        "title": "Google IoT - Right mode to receive notifications (subscribe working)",
        "body": "<p>I am following <a href=\"https://cloud.google.com/iot/docs/how-tos/mqtt-bridge#iot-core-mqtt-auth-run-python\" rel=\"nofollow noreferrer\">this tutorial</a> and I already have my code publishing messages to <code>/devices/sm1/events</code> topic, in which <code>sm1</code> is my device id.</p>\n\n<p>I would like to know how to subscribe to this topic since the tutorial says to use <code>/devices/sm1/config</code> but I am getting empty messages. I already tried use the same \"path\" used in publishing (<code>/devices/sm1/events</code>), but it also did not work.</p>\n\n<p>It is strange that the name I gave to the topic was <code>sm1</code> and the topic associated to my device is on GoogleIoT console is exhibited as <code>projects/myprojectname/topics/sm1</code>. So, besides to discover how to subscribe to mentioned topic, I appreciate also any explanation related to the correct way of using pub/sub topics in GoogleIoT (the documentation is not so clear).</p>\n\n<p>This is my <code>subscribe.py</code>:</p>\n\n<pre><code>mqtt_url = \"mqtt.googleapis.com\"\nmqtt_port = 8883\ntopic = \"/devices/sm1/config\"\n\ndef on_connect(client, userdata, flags, response_code):\n    print(\"Connected with status: {0}\".format(response_code))\n    client.subscribe(topic, 1)\n\ndef on_message(client, userdata, msg):\n    print(\"Topic: {0}  --  Payload: {1}\".format(msg.topic, msg.payload))\n\nif __name__ == \"__main__\":    \n    client = mqtt.Client(\"projects/{}/locations/{}/registries/{}/devices/{}\".format(\n                         project_id,\n                         cloud_region,\n                         registry_id,\n                         device_id))\n\n    client.username_pw_set(username='unused',\n                           password=jwt_maker.create_jwt(project_id,\n                                               private_key,\n                                               algorithm=\"RS256\"))\n\n    client.tls_set(root_ca,\n                   certfile = public_crt,\n                   keyfile = private_key,\n                   cert_reqs = ssl.CERT_REQUIRED,\n                   tls_version = ssl.PROTOCOL_TLSv1_2,\n                   ciphers = None)\n\n\n    client.on_connect = on_connect\n    client.on_message = on_message\n\n    print \"Connecting to Google IoT Broker...\"\n    client.connect(mqtt_url, mqtt_port, keepalive=60)\n    client.loop_forever()\n</code></pre>\n\n<p>My output:</p>\n\n<blockquote>\n  <p>Connected with status: 0<br>\n  Topic: /devices/sm1/config  --  Payload:<br>\n  Topic: /devices/sm1/config  --  Payload:</p>\n</blockquote>\n"
    }, {
        "tags": [
            "amazon-web-services",
            "mqtt",
            "iot",
            "aws-iot"
        ],
        "is_answered": true,
        "view_count": 50,
        "favorite_count": 0,
        "score": 0,
        "last_activity_date": 1548987014,
        "creation_date": 1548984952,
        "question_id": 54471721,
        "link": "https://stackoverflow.com/questions/54471721/aws-iot-rule-get-control-packet-type",
        "title": "AWS IoT Rule: Get control packet type",
        "body": "<p>I'd like to log MQTT messages to persistent storage and log their control packet type, e.g. <code>CONNECT, CONNACK, PUBLISH, SUBSCRIBE</code> etc. Specifically I would like to use IoT SQL to only apply a rule where the control packet type is something specific, e.g. <code>PUBLISH</code>. Is this possible, I didn't see a relevant function to retrieve this information in the <a href=\"https://docs.aws.amazon.com/iot/latest/developerguide/iot-sql-functions.html\" rel=\"nofollow noreferrer\">docs</a>. Something like <code>SELECT *, [control packet type] as method FROM '#' WHERE method = 'PUBLISH'</code>, where the brackets would be replaced with the value I'm looking for.</p>\n"
    }, {
        "tags": [
            "mqtt",
            "iot",
            "azure-iot-hub",
            "azure-iot-sdk",
            "azure-sphere"
        ],
        "is_answered": true,
        "view_count": 710,
        "favorite_count": 1,
        "score": 2,
        "last_activity_date": 1548962512,
        "creation_date": 1548079024,
        "question_id": 54291519,
        "link": "https://stackoverflow.com/questions/54291519/how-can-i-send-iot-hub-messages-to-mqtt-broker",
        "title": "How can I send IoT hub messages to MQTT broker?",
        "body": "<p>I am sending some messages from a Azure sphere device to IoT hub, now I want to send/route these messages to a MQTT broker from where I can get this messages and display it in third party software.\nPlease guide me I am new to this topic, any leads or suggestions would be helpful.</p>\n"
    }, {
        "tags": [
            "mqtt",
            "iot",
            "raspbian"
        ],
        "is_answered": true,
        "view_count": 368,
        "favorite_count": 0,
        "score": 1,
        "last_activity_date": 1547321697,
        "creation_date": 1545606600,
        "last_edit_date": 1547318180,
        "question_id": 53907848,
        "link": "https://stackoverflow.com/questions/53907848/mqtt-bridge-config-for-out-in-topic-filter",
        "title": "mqtt bridge config for OUT / IN topic filter",
        "body": "<p>I am trying to setup MQTT bridge to cloudmqtt.com. Local bridge running on raspbian.</p>\n\n<p>I want to push local topics (<code>UP/site1/#</code>) to cloudmqtt broker as it is &amp; pull remote topics ('Down/site1/#') to local bridge.\nTried following configs, but didn't work</p>\n\n<ol>\n<li><p><code>topic UP/site1/# out 2</code></p>\n\n<p><code>topic Down/site1/# in 2</code></p></li>\n<li><p><code>topic UP/site1/# out 2 UP/site1/ UP/site1/</code></p>\n\n<p><code>topic Down/site1/# in 2 Down/site1/ Down/site1/</code></p></li>\n<li><p><code>topic UP/site1/# out 2 \"\" \"\"</code></p>\n\n<p><code>topic Down/site1/# in 2 \"\" \"\"</code></p></li>\n</ol>\n\n<p>Here is the full config </p>\n\n<pre><code>connection cloudmqtt\naddress *****.cloudmqtt.com:1883\nbridge_protocol_version mqttv311\nremote_username ****\nremote_password ****\ntry_private false\nstart_type automatic\nnotifications false\ncleansession false\ntopic UP/site1/# out 2\ntopic Down/site1/# in 2\n</code></pre>\n\n<p>Bridge log messages :</p>\n\n<pre><code>1545695073: Received PINGREQ from 8de7c6e8-4c6a-49b0-9aaa-5816aa9504901545604132782\n1545695073: Sending PINGRESP to 8de7c6e8-4c6a-49b0-9aaa-5816aa9504901545604132782\n1545695073: Received PUBLISH from pod01 (d0, q0, r0, m0, 'UP/site01/pod01', ... (191 bytes))\n1545695076: Received PUBLISH from pod01 (d0, q0, r0, m0, 'UP/site01/pod01', ... (190 bytes))\n1545695079: Received PUBLISH from pod01 (d0, q0, r0, m0, 'UP/site01/pod01', ... (190 bytes))\n1545695082: Received PUBLISH from pod01 (d0, q0, r0, m0, 'UP/site01/pod01', ... (191 bytes))\n1545695083: Received PINGREQ from 8de7c6e8-4c6a-49b0-9aaa-5816aa9504901545604132782\n1545695083: Sending PINGRESP to 8de7c6e8-4c6a-49b0-9aaa-5816aa9504901545604132782\n1545695085: Received PUBLISH from pod01 (d0, q0, r0, m0, 'UP/site01/pod01', ... (189 bytes))\n1545695089: Bridge ff001.cloudmqtt sending CONNECT\n1545695089: Received CONNACK on connection local.ff001.cloudmqtt.\n1545695089: Bridge local.ff001.cloudmqtt sending UNSUBSCRIBE (Mid: 12, Topic: UP/site1/#)\n1545695089: Bridge local.ff001.cloudmqtt sending SUBSCRIBE (Mid: 13, Topic: Down/site1/#, QoS: 2)\n1545695089: Bridge local.ff001.cloudmqtt doing local SUBSCRIBE on topic UP/site1/#\n1545695089: Received UNSUBACK from local.ff001.cloudmqtt\n1545695089: Received SUBACK from local.ff001.cloudmqtt\n1545695090: No will message specified.\n1545695090: Sending CONNACK to pod01 (0, 0)\n1545695090: No will message specified.\n1545695090: Sending CONNACK to 8de7c6e8-4c6a-49b0-9aaa-5816aa9504901545604132782 (0, 0)\n1545695092: Received PUBLISH from pod01 (d0, q0, r0, m0, 'UP/site01/pod01', ... (190 bytes))\n1545695095: Received PUBLISH from pod01 (d0, q0, r0, m0, 'UP/site01/pod01', ... (190 bytes))\n1545695098: Received PUBLISH from pod01 (d0, q0, r0, m0, 'UP/site01/pod01', ... (191 bytes))\n1545695100: Received PINGREQ from 8de7c6e8-4c6a-49b0-9aaa-5816aa9504901545604132782\n1545695100: Sending PINGRESP to 8de7c6e8-4c6a-49b0-9aaa-5816aa9504901545604132782\n1545695101: Received PUBLISH from pod01 (d0, q0, r0, m0, 'UP/site01/pod01', ... (191 bytes))\n1545695104: Received PUBLISH from pod01 (d0, q0, r0, m0, 'UP/site01/pod01', ... (192 bytes))\n1545695107: Received PUBLISH from pod01 (d0, q0, r0, m0, 'UP/site01/pod01', ... (191 bytes))\n1545695110: Received PINGREQ from 8de7c6e8-4c6a-49b0-9aaa-5816aa9504901545604132782\n1545695110: Sending PINGRESP to 8de7c6e8-4c6a-49b0-9aaa-5816aa9504901545604132782\n1545695110: Received PUBLISH from pod01 (d0, q0, r0, m0, 'UP/site01/pod01', ... (191 bytes))\n1545695113: Received PUBLISH from pod01 (d0, q0, r0, m0, 'UP/site01/pod01', ... (192 bytes))\n</code></pre>\n\n<p>I have <code>mosquitto_1.5.5</code></p>\n\n<p>If I remove out/in wildcard and replace it with <code>topic # both 2</code> it works. But I don't want to pull all remote topics, only specific to site (<code>Down/site1/#</code>) and push all local topics to remote. in above logs from bridge, looks like its not publishing local topics to remote cloudMQTT. </p>\n\n<p>anyone know what I am missing here do I need to change anything on remote MQTT (cloudmqtt instance) ?</p>\n"
    }, {
        "tags": [
            "mqtt",
            "iot",
            "mosquitto"
        ],
        "is_answered": true,
        "view_count": 554,
        "favorite_count": 0,
        "score": 1,
        "last_activity_date": 1545679470,
        "creation_date": 1544792494,
        "question_id": 53780336,
        "link": "https://stackoverflow.com/questions/53780336/partitioning-a-mosquitto-mqtt-server",
        "title": "Partitioning a Mosquitto MQTT Server",
        "body": "<p>I want to create isolated environments on a single MQTT server. Like a database server can have multiple schemas and table names can be repeated in different sachems. I want to have a \"MQTT schema\" where topics/subscriptions in one schema are isolated from those in another \"MQTT schema\" so that the same topic can be used in different schemas. It would be even better if security can be applied on a per schema basis but that would be asking for a lot. Right now, I am just looking for a way to have isolated environments on the same server - it will probably require a separate TCP port per schema just to identify the destination schema of a connecting client, as the protocol itself does not have have any concept of schema. Or the clients can be mapped to a particular schema based on the username or client ID. </p>\n\n<p>Note: I am aware of how to use ACL to restrict topic access for each user. ACLs do not solve this problem. I don't simply want to restrict topic access, I want to create separate environment where users are free to do what the want with the topics without out me telling them which topic names they cannot use etc.</p>\n"
    }, {
        "tags": [
            "client",
            "server",
            "mqtt",
            "iot",
            "mosquitto"
        ],
        "is_answered": false,
        "view_count": 249,
        "favorite_count": 0,
        "score": 0,
        "last_activity_date": 1545222366,
        "creation_date": 1434952873,
        "question_id": 30972994,
        "link": "https://stackoverflow.com/questions/30972994/mosquitto-broker-not-validating-username-and-password-sent-by-the-publisher",
        "title": "Mosquitto broker not validating username and password sent by the publisher",
        "body": "<p>I have set \" allow_anonymous \" to false in the configuration file and have created a new password file using the mosquitto_passwd utility, but still the client is able to connect through any username and password. </p>\n\n<p>what should i do ?</p>\n"
    }, {
        "tags": [
            "sockets",
            "client",
            "mqtt",
            "iot"
        ],
        "is_answered": true,
        "view_count": 447,
        "favorite_count": 0,
        "score": -1,
        "last_activity_date": 1544783387,
        "creation_date": 1544720147,
        "last_edit_date": 1544783387,
        "question_id": 53766653,
        "link": "https://stackoverflow.com/questions/53766653/how-to-write-at-my-own-mqtt-client-code-without-using-any-api",
        "title": "How to write at my own MQTT client code without using any API",
        "body": "<p>I'd like to ask for recommendations. I want to write a client program using MQTT to publish data to the broker. I can\u00b4t use any client libraries available in the internet. I would like to ask where can I find examples that works similar to this as an inspiration for my work, or any suggestions regarding the steps I should follow is highly appreciated.</p>\n\n<p>Thank you!</p>\n"
    }, {
        "tags": [
            "amazon-web-services",
            "iot",
            "aws-iot"
        ],
        "is_answered": false,
        "view_count": 986,
        "favorite_count": 0,
        "score": 3,
        "last_activity_date": 1544485066,
        "creation_date": 1544474171,
        "question_id": 53713253,
        "link": "https://stackoverflow.com/questions/53713253/aws-iot-core-topic-filter-wildcards",
        "title": "AWS IoT Core topic filter wildcards",
        "body": "<p>According to the <a href=\"https://docs.aws.amazon.com/iot/latest/developerguide/pub-sub-policy.html\" rel=\"nofollow noreferrer\">docs</a> wildcard characters we use for topics throughout the mqtt protocol like <code>+</code> or <code>#</code> are treated as literals in policies. The docs recomend using <code>*</code> as a wildcard character instead but do not describe its effects.</p>\n\n<p>For example will the topic filter <code>:topicfilter:/foo/bar/*</code> match topic <code>foo/bar/baz/gaz</code> or only <code>foo/bar/baz</code>?</p>\n\n<p>Specifically I am trying to allow access to any topic which begins with the thing name of the policy holder. So I would like to allow access to any topic beginning with <code>${thingName}/</code> and having any number of forward slashes and url parameters following a matching <code>thingName</code>. Would <code>topicfilter:${thingName}/*</code> work or would that only work for topics with one url parameter after <code>thingName</code>?</p>\n"
    }, {
        "tags": [
            "javascript",
            "mqtt",
            "iot"
        ],
        "is_answered": false,
        "view_count": 532,
        "favorite_count": 0,
        "score": 0,
        "last_activity_date": 1543664674,
        "creation_date": 1542692007,
        "last_edit_date": 1543664674,
        "question_id": 53386808,
        "link": "https://stackoverflow.com/questions/53386808/error-while-connecting-to-mqtt-broker-using-javascript-mqtt-client-with-websocke",
        "title": "Error While connecting to MQTT Broker using JavaScript MQTT Client With Websockets",
        "body": "<p>I am working with MQTT, when I am trying to connect to mosquitto_sub I am able to connect but When I am trying to connect through JavaScript MQTT Client With Websockets then I am getting an error <code>AMQJSC0001E Connect timed out</code>.</p>\n\n<p>Here is my code : </p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-js lang-js prettyprint-override\"><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?&gt;\r\n&lt;!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.0 Transitional//EN\" \"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd\"&gt;\r\n&lt;html xmlns=\"http://www.w3.org/1999/xhtml\"&gt;\r\n  &lt;head&gt;\r\n    &lt;title&gt;Mosquitto Websockets&lt;/title&gt;\r\n    &lt;meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\"&gt;\r\n    &lt;script src=\"https://cdnjs.cloudflare.com/ajax/libs/paho-mqtt/1.0.2/mqttws31.js\" type=\"text/javascript\"&gt;&lt;/script&gt;\r\n    &lt;script src=\"https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.js\" type=\"text/javascript\"&gt;&lt;/script&gt;\r\n    \r\n\r\n    &lt;script type=\"text/javascript\"&gt;\r\n\tvar host = \"eu.thethings.network\";\r\n\tvar username = \"sr-ops-rtr-XX\";\r\n\tvar password = \"ttn-account-v2.XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX\";\r\n\tvar topic = \"/devices/+/up\";\r\n\tvar useTLS = \"sr-ops-rtr-01\";\r\n\tcleansession = \"\";\r\n\tvar port = 10;\r\n    var mqtt;\r\n    var reconnectTimeout = 2000;\r\n    function MQTTconnect() {\r\n\tif (typeof path == \"undefined\") {\r\n\t\tpath = '/devices/up';\r\n\t}\r\n\tmqtt = new Paho.MQTT.Client(\r\n\t\t\thost,\r\n\t\t\tport,\r\n\t\t\tpath,\r\n\t\t\t\"web_\" + parseInt(Math.random() * 100, 10)\r\n\t);\r\n\t\r\n        var options = {\r\n            timeout: 10,\r\n            //useSSL: useTLS,\r\n            //cleanSession: true,\r\n            onSuccess: onConnect,\r\n            onFailure: function (message) {\r\n\t\t\t\tconsole.log(message);\r\n                $('#status').val(\"Connection failed: \" + message.errorMessage + \"Retrying\");\r\n                setTimeout(MQTTconnect, reconnectTimeout);\r\n            }\r\n        };\r\n        mqtt.onConnectionLost = onConnectionLost;\r\n        mqtt.onMessageArrived = onMessageArrived;\r\n        if (username != null) {\r\n            options.userName = username;\r\n            options.password = password;\r\n        }\r\n        console.log(\"Host=\"+ host + \", port=\" + port + \", path=\" + path +  \" username=\" + username + \" password=\" + password);\r\n\t\tconsole.log(options);\r\n        mqtt.connect(options);\r\n    }\r\n    function onConnect() {\r\n\t\talert(\"connected\");\r\n        $('#status').val('Connected to ' + host + ':' + port + path);\r\n        // Connection succeeded; subscribe to our topic\r\n        mqtt.subscribe(topic, {qos: 0});\r\n        $('#topic').val(topic);\r\n    }\r\n    function onConnectionLost(response) {\r\n        setTimeout(MQTTconnect, reconnectTimeout);\r\n        $('#status').val(\"connection lost: \" + responseObject.errorMessage + \". Reconnecting\");\r\n    };\r\n    function onMessageArrived(message) {\r\n        var topic = message.destinationName;\r\n        var payload = message.payloadString;\r\n        $('#ws').prepend('&lt;li&gt;' + topic + ' = ' + payload + '&lt;/li&gt;');\r\n    };\r\n    $(document).ready(function() {\r\n        MQTTconnect();\r\n    });\r\n    &lt;/script&gt;\r\n  &lt;/head&gt;\r\n  &lt;body&gt;\r\n    &lt;h1&gt;Mosquitto Websockets&lt;/h1&gt;\r\n    &lt;div&gt;\r\n        &lt;div&gt;Subscribed to &lt;input type='text' id='topic' disabled /&gt;\r\n        Status: &lt;input type='text' id='status' size=\"80\" disabled /&gt;&lt;/div&gt;\r\n\r\n        &lt;ul id='ws' style=\"font-family: 'Courier New', Courier, monospace;\"&gt;&lt;/ul&gt;\r\n    &lt;/div&gt;\r\n  &lt;/body&gt;\r\n&lt;/html&gt;</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p>What am I doing wrong?</p>\n"
    }, {
        "tags": [
            "javascript",
            "node.js",
            "amazon-web-services",
            "swagger",
            "iot"
        ],
        "is_answered": false,
        "view_count": 564,
        "favorite_count": 0,
        "score": 1,
        "last_activity_date": 1543373355,
        "creation_date": 1501503474,
        "question_id": 45415749,
        "link": "https://stackoverflow.com/questions/45415749/aws-iot-how-to-specify-the-certificate-path-swagger-nodejs",
        "title": "AWS IoT - how to specify the certificate path (Swagger + NodeJS)",
        "body": "<p>I am working with AWS IoT, and try to publish a topic on AWS IoT.</p>\n\n<p>What I have done: </p>\n\n<ul>\n<li>Register a thing and setup policies (download 4 certificate files) from AWS IoT</li>\n<li>install sdk with npm (<a href=\"https://github.com/aws/aws-iot-device-sdk-js\" rel=\"nofollow noreferrer\">https://github.com/aws/aws-iot-device-sdk-js</a>)</li>\n<li>Copy all certificate files (4 files) to a folder \"cert\", same level with app.js</li>\n<li>In Swagger controllers, create a file js and copy sample code as link above.</li>\n<li><p>In file js, update code as below</p>\n\n<p>var device = awsIot.device({\nkeyPath: 'cert/xxxxxx-private.pem.key',\ncertPath: 'cert/xxxxxx-certificate.pem.crt',\ncaPath: 'cert/rootCA.pem',\nclientId: 'TestIoT',\nhost: 'xxxxxxxx.amazonaws.com'\n});</p></li>\n</ul>\n\n<p>What error I received :</p>\n\n<blockquote>\n  <p>Invalid \"keyPath\" option supplied.\n      at module.exports (/var/app/current/node_modules/aws-iot-device-sdk/common/lib/tls-reader.js:92:13)\n      at new DeviceClient (/var/app/current/node_modules/aws-iot-device-sdk/device/index.js:416:7)\n      at Object.DeviceClient [as device] (/var/app/current/node_modules/aws-iot-device-sdk/device/index.js:201:14)</p>\n</blockquote>\n\n<p>As I understand, the path is not specified correctly. Please give me some advices how to specify the path correctly.</p>\n"
    }, {
        "tags": [
            "amazon-web-services",
            "certificate",
            "iot",
            "aws-iot"
        ],
        "is_answered": true,
        "view_count": 133,
        "favorite_count": 0,
        "score": 1,
        "last_activity_date": 1543354168,
        "creation_date": 1542555661,
        "question_id": 53362619,
        "link": "https://stackoverflow.com/questions/53362619/aws-iot-certificate-suddenly-fails",
        "title": "AWS IoT certificate suddenly fails",
        "body": "<p>I have a 2nd generation IoT button, which worked great until suddenly it didn't anymore. Now any time I hit the button I get a blinking red light: long-short-short pattern.</p>\n\n<p>Amazon defines this error: \"Cannot establish a secure connection with the server. This error is most likely due to an unknown or inactive certificate.\"</p>\n\n<p>I generated a new certificate and verified this connects me successfully:</p>\n\n<pre><code>openssl s_client -connect &lt;button-id-here&gt;.iot.us-west-2.amazonaws.com:8443 -CAfile AmazonRootCA1.pem -cert certificate.pem.crt -key private.pem.key \n</code></pre>\n\n<p>But uploading the same certificate and private key to the button doesn't make the error go away. I still get long-short-short blinking.</p>\n\n<p>What else can I do to troubleshoot this? What else could suddenly cause this error?</p>\n\n<p>This is on my very simple home network where I have not made any changes. </p>\n"
    }, {
        "tags": [
            "google-cloud-platform",
            "iot",
            "google-cloud-iot"
        ],
        "is_answered": true,
        "view_count": 189,
        "favorite_count": 0,
        "score": 0,
        "last_activity_date": 1543277570,
        "creation_date": 1542712966,
        "last_edit_date": 1542993643,
        "question_id": 53391939,
        "link": "https://stackoverflow.com/questions/53391939/gcp-iot-core-monitoring-messages",
        "title": "GCP - IOT Core Monitoring messages",
        "body": "<p>I'm kind of new on IOT world and trying to learn a bit about GCP products.\nIve made a simples python app that uses PAHO to send a message to an IOT topic (IOT Core in GCP).\nEverything, apparently, works just fine. But I was wondering if I could see, on stackdriver, the content of a message that the device had sent. </p>\n\n<p>I already have enable debuging log for it, but the message didnt show up.</p>\n\n<p>Publish Log in stackdriver:</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-js lang-js prettyprint-override\"><code>{\r\n insertId:  \"78178yfwnl\"  \r\n jsonPayload: {\r\n  eventType:  \"PUBLISH\"   \r\n  protocol:  \"MQTT\"   \r\n  publishFromDeviceTopicType:  \"EVENTS\"   \r\n  resourceName:  \"projects/demoiot/locations/us-central1/registries/iotchicago/devices/2753540639583\"   \r\n  serviceName:  \"cloudiot.googleapis.com\"   \r\n  status: {\r\n   code:  0    \r\n  }\r\n }\r\n labels: {\r\n  device_id:  \"us_chi\"   \r\n }\r\n logName:  \"projects/demoiot/logs/cloudiot.googleapis.com%2Fdevice_activity\"  \r\n receiveTimestamp:  \"2018-11-20T11:10:01.123928203Z\"  \r\n resource: {\r\n  labels: {\r\n   device_num_id:  \"2753540639583\"    \r\n   device_registry_id:  \"iotchicago\"    \r\n   location:  \"us-central1\"    \r\n   project_id:  \"demoiot-223010\"    \r\n  }\r\n  type:  \"cloudiot_device\"   \r\n }\r\n severity:  \"DEBUG\"  \r\n timestamp:  \"2018-11-20T11:10:01.104415969Z\"  \r\n}</code></pre>\r\n</div>\r\n</div>\r\n</p>\n"
    }, {
        "tags": [
            "google-cloud-platform",
            "google-cloud-functions",
            "iot",
            "google-cloud-pubsub"
        ],
        "is_answered": true,
        "view_count": 956,
        "favorite_count": 0,
        "score": 0,
        "last_activity_date": 1543257444,
        "creation_date": 1542795717,
        "last_edit_date": 1542874387,
        "question_id": 53409910,
        "link": "https://stackoverflow.com/questions/53409910/publish-message-to-specific-subfolder",
        "title": "Publish message to specific subfolder",
        "body": "<p>I'm trying to use Google Cloud Platform to make a little IoT project.</p>\n\n<p>I've created a registry and a device in the \"IoT Core\" section and connected the registry to a default topic.\nI've also specified three subfolders for that topic: \"events\", \"config\" and \"status\".\nNow, I would like to connect a \"Cloud Function\" for the incoming messages but I can't find how to configure a single subfolder to monitor neither how to publish messages on them in the \"Cloud Pub/Sub\" section.</p>\n\n<p>All the documentation talks about single topics so.... Am I missing some base concept on how it works?</p>\n"
    }, {
        "tags": [
            "java",
            "mqtt",
            "iot",
            "mosquitto",
            "paho"
        ],
        "is_answered": false,
        "view_count": 777,
        "favorite_count": 0,
        "score": 0,
        "last_activity_date": 1542962464,
        "creation_date": 1542962464,
        "question_id": 53443192,
        "link": "https://stackoverflow.com/questions/53443192/mqtt-single-client-vs-multiple-client",
        "title": "MQTT Single Client vs Multiple Client",
        "body": "<p>Right now, we are designing and MQTT based application which deals with iot devices.</p>\n\n<p>We have the main device which connect with all other IOT devices. and any message publishes from the main device will receive by MQTT client app. \nWe have multiple main devices, </p>\n\n<p>my question is do I need to create multiple MQTT clients each per the main device of a single client for all main devices.</p>\n\n<p>if I go with a single client then if it fails, it will reconnect but facing a loss of data.</p>\n\n<p>suppose if I go with multiple clients, then if it fails it only affect on one main device but  I am afraid that multiple client may consume lots of memory. when a number of main devices growing will take a lot of memory. also, need to maintained (prevent) client from being garbage collected. </p>\n\n<p>any recommendations and any advice on this.</p>\n"
    }, {
        "tags": [
            "ibm-cloud",
            "iot",
            "cloudant"
        ],
        "is_answered": false,
        "view_count": 117,
        "favorite_count": 0,
        "score": 1,
        "last_activity_date": 1542713281,
        "creation_date": 1542050647,
        "last_edit_date": 1542280386,
        "question_id": 53268791,
        "link": "https://stackoverflow.com/questions/53268791/how-do-i-connect-cc3200launchpad-with-ibm-watson-iot-platform-with-wi-fi-connect",
        "title": "How do I connect cc3200launchpad with IBM Watson IoT Platform with Wi-Fi connection?",
        "body": "<p>I  have developed an IoT project with Energia IDE that publish JSON messages to IBM cloudant database. It works well when my launchpad is connected internet with my mobile phone's personal hotspot. However, messages are not published when launchpad connected internet with wi-fi. </p>\n\n<p>The only difference between two code is definition of ssid and password:</p>\n\n<pre><code>char ssid[] = ;\nchar password[] = ;\n</code></pre>\n\n<p>Attempt to connect to network ends up successfully then IP address is obtained after that it couldn't connect to ibm iot client. I cannot see any attempt on: IBM Watson IoT Platform -> Devices -> Logs. </p>\n\n<p>I changed connection security settings: TLS optional also I added my wifi IP to 'White List' but problem still continue. </p>\n\n<p>It looks like program can not connect to MQTT broker because it stays in loop below:</p>\n\n<pre><code>while ((rc = client.connect(connectData)) != 0)\n{\n}\n</code></pre>\n\n<p>Could you please help me. Is there any configuration that I need to do?</p>\n\n<p>Is it possible to encryption cause problem or is it irrelevant with my topic? I do not know about encryption and security methods also which encryption method is used by my modem. If it cause the problem, how can I send the JSON messages to IBM IoT Platform and what do I need to do for connecting my device to IBM IoT Platform with changing security options(TLS with Token Auth. or TLS with certificate Auth.)</p>\n\n<p>Any help will be greatly appreciated. \nThanks in advance...</p>\n"
    }, {
        "tags": [
            "iot",
            "publish-subscribe",
            "google-cloud-iot"
        ],
        "is_answered": true,
        "view_count": 903,
        "favorite_count": 0,
        "score": 2,
        "last_activity_date": 1542135471,
        "creation_date": 1524670740,
        "question_id": 50026283,
        "link": "https://stackoverflow.com/questions/50026283/google-iot-device-subscribe-to-something-else-than-devices-xxxx-config",
        "title": "Google IOT - device subscribe to something else than /devices/XXXX/config",
        "body": "<p>I am trying Google IOT and Google PubSub.\nI am sending MQTT messages from device to a pubsub queue on which I have subribed (with something I will call \"the server\").\nFrom the google cloud console, I update device setting and I get the setting message in device. </p>\n\n<p>Everything in google tutorial work fine but I wonder if it is possible to set up a messaging it the other way : i.e. \"the server\" sending message to a pubsub queue subscribed by the device using MQTT. </p>\n\n<p>The schema at the end of <a href=\"https://cloud.google.com/iot/docs/concepts/overview\" rel=\"nofollow noreferrer\">this page</a> make me think that only the \"config\" mqtt queue (/devices/XXXX/config) can be used that way.</p>\n\n<p>What I need is a 1to1 communication from \"the server\" to \"the device\" and I'm afraid that the only way is using the config </p>\n"
    }, {
        "tags": [
            "c#",
            "azure",
            "c#-4.0",
            "iot",
            "azure-iot-hub"
        ],
        "is_answered": true,
        "view_count": 1565,
        "favorite_count": 1,
        "score": 1,
        "last_activity_date": 1541644460,
        "creation_date": 1540139941,
        "question_id": 52917571,
        "link": "https://stackoverflow.com/questions/52917571/how-can-i-get-total-number-of-devices-and-total-number-of-messages-send-to-azure",
        "title": "How can I get total number of devices and total number of messages send to azure IoT hub c#",
        "body": "<p>we only have these two methods available for azure IoThub in c#.</p>\n\n<pre><code>Device device = await registryManager.GetDeviceAsync(\"deviceId\");\n</code></pre>\n\n<p>and </p>\n\n<pre><code>device = await registryManager.GetDevicesAsync(\"max count\");\n</code></pre>\n\n<p>but how to get all available device count or active device count and also a messages count using c#?</p>\n"
    }, {
        "tags": [
            "apache-kafka",
            "mqtt",
            "iot"
        ],
        "is_answered": true,
        "view_count": 1278,
        "favorite_count": 0,
        "score": 1,
        "last_activity_date": 1540916095,
        "creation_date": 1540896018,
        "last_edit_date": 1540901107,
        "question_id": 53062481,
        "link": "https://stackoverflow.com/questions/53062481/can-kafka-subscribe-on-a-mqtt-topic",
        "title": "Can kafka subscribe on a MQTT topic",
        "body": "<p>I have a MQTT broker running on a raspberry pi, i can publish and subscribe to  topics. </p>\n\n<p>But i would like it if Kafka could subscribe to one or multiple MQTT topics.\nCan somebody help me please?</p>\n"
    }, {
        "tags": [
            "elasticsearch",
            "logstash",
            "mqtt",
            "iot"
        ],
        "is_answered": false,
        "view_count": 1707,
        "favorite_count": 1,
        "score": 0,
        "last_activity_date": 1540887715,
        "creation_date": 1540816164,
        "last_edit_date": 1540826709,
        "question_id": 53045530,
        "link": "https://stackoverflow.com/questions/53045530/mqtt-input-with-logstash",
        "title": "Mqtt input with logstash",
        "body": "<p>I recently installed the mqtt logstash plugin.</p>\n\n<p>I am just using it like this on my localhost. I have a mosquito server running and i can publish topics and messages and i can subscribe to them and see the messages.</p>\n\n<p>But when i want to get these messages as input in logstash something is going wrong.\nI am just using the filter like this (the default values are all ok).</p>\n\n<pre><code>input {\n    mqtt {      \n     topic =&gt; \"Temp\"                \n}\n</code></pre>\n\n<p>But i am getting this error message every time i publish a message to the topic Temp.</p>\n\n<pre><code>    2018-10-29T13:22:37,248][ERROR][logstash.pipeline        ] A plugin had an unrecoverable error. Will restart this plugin.\n  Pipeline_id:test\n  Plugin: &lt;LogStash::Inputs::Mqtt topic=&gt;\"Temp\", id=&gt;\"2e42558ecbc14af5b8d3bbf6243a987cd9accfa6ba94d9802a86bed16bf90958\",\n  enable_metric=&gt;true, codec=&gt;&lt;LogStash::Codecs::Plain id=&gt;\"plain_1442bf51-53fb-43d1-a09c-48b29c870f66\",\n  enable_metric=&gt;true, charset=&gt;\"UTF-8\"&gt;, mqttHost=&gt;\"localhost\", port=&gt;1883, ssl=&gt;false, client_id=&gt;\"logstash-mqtt-inputd42q\", clean_session=&gt;true, qos=&gt;0&gt;\n  Error: Direct event field references (i.e. event['field']) have been disabled in favor of using event get and set methods (e.g. event.get('field')).\n  Please consult the Logstash 5.0 breaking changes documentation for more details.\n  Exception: NoMethodError\n  Stack: C:/logstash/logstash-6.4.2/logstash-core/lib/logstash/event.rb:43:in `method_missing'\nC:/logstash/logstash-6.4.2/vendor/bundle/jruby/2.3.0/gems/logstash-input-mqtt-0.0.2/lib/logstash/inputs/mqtt.rb:63:in `block in run'\nC:/logstash/logstash-6.4.2/vendor/bundle/jruby/2.3.0/gems/logstash-codec-plain-3.0.6/lib/logstash/codecs/plain.rb:35:in `decode'\nC:/logstash/logstash-6.4.2/vendor/bundle/jruby/2.3.0/gems/logstash-input-mqtt-0.0.2/lib/logstash/inputs/mqtt.rb:62:in `block in run'\nC:/logstash/logstash-6.4.2/vendor/bundle/jruby/2.3.0/gems/mqtt-0.5.0/lib/mqtt/client.rb:405:in `block in get'\nC:/logstash/logstash-6.4.2/vendor/bundle/jruby/2.3.0/gems/mqtt-0.5.0/lib/mqtt/client.rb:437:in `block in get_packet'\norg/jruby/RubyKernel.java:1292:in `loop'\nC:/logstash/logstash-6.4.2/vendor/bundle/jruby/2.3.0/gems/mqtt-0.5.0/lib/mqtt/client.rb:435:in `get_packet'\nC:/logstash/logstash-6.4.2/vendor/bundle/jruby/2.3.0/gems/mqtt-0.5.0/lib/mqtt/client.rb:404:in `get'\nC:/logstash/logstash-6.4.2/vendor/bundle/jruby/2.3.0/gems/logstash-input-mqtt-0.0.2/lib/logstash/inputs/mqtt.rb:61:in `run'\nC:/logstash/logstash-6.4.2/logstash-core/lib/logstash/pipeline.rb:409:in `inputworker'\nC:/logstash/logstash-6.4.2/logstash-core/lib/logstash/pipeline.rb:403:in `block in start_input'\n</code></pre>\n"
    }, {
        "tags": [
            "spring-integration",
            "mqtt",
            "iot"
        ],
        "is_answered": false,
        "view_count": 220,
        "favorite_count": 0,
        "score": 0,
        "last_activity_date": 1540473651,
        "creation_date": 1540458617,
        "last_edit_date": 1540460157,
        "question_id": 52985556,
        "link": "https://stackoverflow.com/questions/52985556/how-to-make-clients-dynamically-authenticate-mqtt-broker-by-using-their-own-cred",
        "title": "how to make clients dynamically authenticate mqtt broker by using their own credential",
        "body": "<p>Here is the code for  authentication to the mqtt broker by mqtt-spring integration,</p>\n\n<pre><code>public DefaultMqttPahoClientFactory clientfactory() {\n\n    DefaultMqttPahoClientFactory factory = new DefaultMqttPahoClientFactory();\n    MqttConnectOptions options = new MqttConnectOptions();\n    options.setUserName(\"username\");\n    options.setPassword(\"password\".toCharArray());\n    options.setServerURIs(new String[] { \"tcp://localhost:1883\" });\n    factory.setConnectionOptions(options);\n\n    return factory;\n}\n\n@Bean\n@ServiceActivator(inputChannel = \"mqttOutboundChannel\")\npublic MqttPahoMessageHandler mqqtMessageHandler() {\n\n    MqttPahoMessageHandler handler = new MqttPahoMessageHandler(\"clientId\", clientfactory());\n    handler.setAsync(true);\n    handler.setDefaultQos(2);\n    handler.setDefaultRetained(true);\n    return handler;\n} \n</code></pre>\n\n<p>Suppose I am using many clients for publishing data to their own set of topics.And I am supposed to assign unique authentication credentials to each client for establishing mqtt broker connection.I think the above code allows only one set of credentials, even if we use many clients.Is it possible to make dynamic ?</p>\n"
    }, {
        "tags": [
            "mqtt",
            "iot",
            "fiware",
            "fiware-orion"
        ],
        "is_answered": true,
        "view_count": 206,
        "favorite_count": 0,
        "score": 2,
        "last_activity_date": 1540471959,
        "creation_date": 1540055079,
        "last_edit_date": 1540294586,
        "question_id": 52908085,
        "link": "https://stackoverflow.com/questions/52908085/command-doesnt-forward-from-fiware-json-agent-toward-the-broker-mqtt",
        "title": "Command doesn&#39;t forward from FIWARE JSON Agent toward the Broker MQTT",
        "body": "<p>I've deployed the iot stack with docker. These are the used containers:</p>\n\n<ul>\n<li>fiware/orion:1.13.0</li>\n<li>fiware/iotagent-json:1.8.0</li>\n<li>eclipse-mosquitto:1.4.12</li>\n<li>[other containers not involved in the issue ...]</li>\n</ul>\n\n<p>I've registered the following device on the agent:</p>\n\n<pre><code>{\n     \"device_id\": \"t3\",\n     \"service\": \"lmobile\",\n     \"service_path\": \"/lmobile_Industry\",\n     \"entity_name\": \"t3\",\n     \"entity_type\": \"Device\",\n     \"endpoint\": \"tcp://&lt;mqttborker_publicip&gt;:&lt;port&gt;\",\n     \"transport\": \"MQTT\",\n     \"attributes\": [{\n                \"object_id\": \"led\",\n                \"name\": \"led\",\n                \"type\": \"text\"\n     }],\n     \"lazy\": [],\n     \"commands\": [{\n                \"object_id\": \"c\",\n                \"name\": \"c\",\n                \"type\": \"Command\"\n     }],\n     \"static_attributes\": [\n                      ....\n     ],\n     \"protocol\": \"JSON\"\n}\n</code></pre>\n\n<p>and the corresponding entity has been properly created on the OCB and when I publish a new measure on the mqttbroker, under the topic <code>/&lt;apikey&gt;/t3/attrs</code> the measure is properly forward toward the OCB.</p>\n\n<p>In order to send the command <code>c</code> to the device I send the following updateContext on OCB:</p>\n\n<pre><code>curl -s -X POST http://&lt;orionhost&gt;:1026/v1/updateContext\n       -H 'accept: application/json'\n       -H 'cache-control: no-cache' \n       -H 'content-type: application/json'\n       -H 'fiware-service: lmobile'\n       -H 'fiware-servicepath: /lmobile_Industry'\n       -d '{\n             \"contextElements\": [\n                 {\n                    \"type\": \"Device\",\n                     \"isPattern\": \"false\",\n                     \"id\": \"t3\",\n                     \"attributes\": [\n                       {\n                         \"name\":\"c\",\n                         \"type\":\"Command\",\n                         \"value\":100\n                       }\n                     ]\n                 }\n             ],\n             \"updateAction\": \"UPDATE\"\n         }'\n</code></pre>\n\n<p>and I receive the following error response:</p>\n\n<pre><code>{\n     \"errorCode\": {\n         \"code\": \"404\",\n         \"reasonPhrase\": \"No context element found\",\n         \"details\": \"invalid context provider response\"\n     }\n}\n</code></pre>\n\n<p>In the OCB Log I can see the following WARNING Message:\n<code>time=Thursday 18 Oct 08:55:54 2018.431Z | lvl=WARN | corr=N/A | trans=N/A | from=N/A | srv=N/A | subsrv=N/A | comp=Orion | op=postQueryContext.cpp[169]:queryForward | msg=Other Error (context provider response to QueryContext is empty)</code>.\nAnyway, the updateContext is properly forwarded to the Agent.</p>\n\n<p>In the Agent Log (in DEBUG) I can see the followings:</p>\n\n<pre><code>iotstack_agent-json.1.xyz@xerus-1    | time=2018-10-18T09:02:33.975Z | lvl=DEBUG | corr=8d2864ec-d2b4-11e8-b445-02420aff0161 | trans=de5680e7-0727-4577-ac44-ddeb59df1f31 | op=IoTAgentNGSI.GenericMiddlewares | srv=lmobile | subsrv=/lmobile_Industry | msg=Request for path [/updateContext] from [&lt;agent_publicip&gt;:&lt;port&gt;] | comp=IoTAgent\niotstack_agent-json.1.xyz@xerus-1    | time=2018-10-18T09:02:33.976Z | lvl=DEBUG | corr=8d2864ec-d2b4-11e8-b445-02420aff0161 | trans=de5680e7-0727-4577-ac44-ddeb59df1f31 | op=IoTAgentNGSI.GenericMiddlewares | srv=lmobile | subsrv=/lmobile_Industry | msg=Body:\niotstack_agent-json.1.xyz@xerus-1    |\niotstack_agent-json.1.xyz@xerus-1    | {\niotstack_agent-json.1.xyz@xerus-1    |     \"contextElements\": [\niotstack_agent-json.1.xyz@xerus-1    |         {\niotstack_agent-json.1.xyz@xerus-1    |             \"type\": \"Device\",\niotstack_agent-json.1.xyz@xerus-1    |             \"isPattern\": \"false\",\niotstack_agent-json.1.xyz@xerus-1    |             \"id\": \"t3\",\niotstack_agent-json.1.xyz@xerus-1    |             \"attributes\": [\niotstack_agent-json.1.xyz@xerus-1    |                 {\niotstack_agent-json.1.xyz@xerus-1    |                     \"name\": \"c\",\niotstack_agent-json.1.xyz@xerus-1    |                     \"type\": \"Command\",\niotstack_agent-json.1.xyz@xerus-1    |                     \"value\": \"100\"\niotstack_agent-json.1.xyz@xerus-1    |                 }\niotstack_agent-json.1.xyz@xerus-1    |             ]\niotstack_agent-json.1.xyz@xerus-1    |         }\niotstack_agent-json.1.xyz@xerus-1    |     ],\niotstack_agent-json.1.xyz@xerus-1    |     \"updateAction\": \"UPDATE\"\niotstack_agent-json.1.xyz@xerus-1    | }\niotstack_agent-json.1.xyz@xerus-1    |\niotstack_agent-json.1.xyz@xerus-1    |  | comp=IoTAgent\niotstack_agent-json.1.xyz@xerus-1    | time=2018-10-18T09:02:33.978Z | lvl=DEBUG | corr=8d2864ec-d2b4-11e8-b445-02420aff0161 | trans=de5680e7-0727-4577-ac44-ddeb59df1f31 | op=IoTAgentNGSI.DomainControl | srv=lmobile | subsrv=/lmobile_Industry | msg=response-time: 6 | comp=IoTAgent\n</code></pre>\n\n<p>Here I don't see warnings or errors but no commands are forwarded to the MQTT Broker on any topic (I'm subscribed both to the specific topic for commands <code>/&lt;apikey&gt;/t3/cmd</code> and to all topics by using the wildcard <code>#</code>).</p>\n"
    }, {
        "tags": [
            "mqtt",
            "iot",
            "aws-iot"
        ],
        "is_answered": false,
        "view_count": 131,
        "favorite_count": 0,
        "score": 0,
        "last_activity_date": 1539375227,
        "creation_date": 1539360706,
        "last_edit_date": 1539371435,
        "question_id": 52783360,
        "link": "https://stackoverflow.com/questions/52783360/how-to-use-mqttjs-to-publish-to-iot-shadow-topic",
        "title": "How to use mqttjs to publish to iot shadow topic?",
        "body": "<p>I am using MQTTJS client to publish and subscribe to my IoT topics from react application.</p>\n\n<p>I tried to use MQTTJS to get/update my AWS device shadow but I can't send or receive anything from my device shadow.\nhere is my code</p>\n\n<pre><code>client.publish('$aws/things/things/deviceId/shadow/get', {});\n</code></pre>\n"
    }, {
        "tags": [
            "java",
            "eclipse",
            "url",
            "iot",
            "californium"
        ],
        "is_answered": true,
        "view_count": 960,
        "favorite_count": 1,
        "score": 4,
        "last_activity_date": 1539282361,
        "creation_date": 1463608836,
        "question_id": 37310810,
        "link": "https://stackoverflow.com/questions/37310810/eclipse-californium-coap-wildcard-as-url-path",
        "title": "Eclipse Californium CoAP wildcard as url path",
        "body": "<p>I'm working on a CoAP app using Eclipse Californium that will declare explicitly only the root resource path, and the rest of the resources should be served and resolved through a wildcard <code>/root/*</code> just like on REST APIs or servlets.</p>\n\n<p>Is there any way to achieve that ?</p>\n"
    }, {
        "tags": [
            "python",
            "mqtt",
            "iot",
            "paho"
        ],
        "is_answered": true,
        "view_count": 45,
        "favorite_count": 0,
        "score": 0,
        "last_activity_date": 1538919881,
        "creation_date": 1538862315,
        "question_id": 52683596,
        "link": "https://stackoverflow.com/questions/52683596/indepth-mqtts-topic",
        "title": "Indepth MQTT&#39;s topic",
        "body": "<p>I've used MQTT Paho libraries before using Python. What actually happens when a topic was established? e.g \"home/kitchen/lights\". </p>\n\n<p>Does the program create folders based on the topic? Since it uses slash as a separator. Or does the program store the topic as a string?</p>\n"
    }, {
        "tags": [
            "mqtt",
            "iot"
        ],
        "is_answered": true,
        "view_count": 449,
        "favorite_count": 0,
        "score": 0,
        "last_activity_date": 1538134101,
        "creation_date": 1538133753,
        "last_edit_date": 1538133820,
        "question_id": 52554274,
        "link": "https://stackoverflow.com/questions/52554274/rebooting-server-with-mqtt-service",
        "title": "Rebooting server with MQTT service",
        "body": "<p>Imagine an MQTT broker with remote clients connected, which continuously send QoS 2 data - the standard situation. Clients are configured with \"cleansession false\" - they have a queue to send messages in case of a connection failure.</p>\n\n<p>On the server, local clients subscribe to topics to receive messages.</p>\n\n<p>Server load:</p>\n\n<ol>\n<li>Launch the MQTT Broker</li>\n<li>Running local clients</li>\n<li>Connecting remote clients and receiving data from the queue</li>\n</ol>\n\n<p>What if the third point occurs before the second? Are there standard solutions? How not to lose the first messages?</p>\n"
    }, {
        "tags": [
            "azure",
            "iot",
            "azure-iot-hub",
            "azure-eventgrid"
        ],
        "is_answered": false,
        "view_count": 491,
        "favorite_count": 1,
        "score": 2,
        "last_activity_date": 1537490362,
        "creation_date": 1537439159,
        "question_id": 52422932,
        "link": "https://stackoverflow.com/questions/52422932/how-to-log-devices-connections-disconnections-to-azure-iot-hub",
        "title": "How to log device&#39;s connections/disconnections to Azure IoT hub",
        "body": "<p>I need to make device's uptime statistics. I want to get information about connections/disconnections from logs, but I don't know what is the best way to log these event from IoT hub.</p>\n\n<p>I've already tried:</p>\n\n<ul>\n<li>Event grid. Not very good because: <em>\"order of events is not guaranteed\"</em> according to the documentation.</li>\n<li>Diagnostics in IoT hub: <em>\"The events emitted by the IoT Hub service using Azure Monitor diagnostic logs are not\nguaranteed to be reliable or ordered. Some events might be lost or delivered out of order.\"</em></li>\n<li>Device heartbeat: from documentation: <em>\"Only use the connectionState field during development and debugging\"</em>.</li>\n<li>Function application or Logic app: how to trigger by connecting/disconnecting?</li>\n</ul>\n\n<p>What else can I try?</p>\n"
    }, {
        "tags": [
            "c++",
            "amazon-web-services",
            "openssl",
            "iot"
        ],
        "is_answered": false,
        "view_count": 214,
        "favorite_count": 0,
        "score": 0,
        "last_activity_date": 1536830351,
        "creation_date": 1536830351,
        "question_id": 52310530,
        "link": "https://stackoverflow.com/questions/52310530/loading-certificates-from-string-buffers-into-chain-for-client-verification-usin",
        "title": "Loading certificates from string buffers into chain for client verification using OpenSSL",
        "body": "<p>I am trying to use SSL client verification to connect to a remote AWS IoT endpoint. I have three files:</p>\n\n<pre><code>- CA Root Certificate File\n- Certificate File\n- Private Key\n</code></pre>\n\n<p>The connection to the endpoint is successful if I use SSL_CTX_load_verify_locations, SSL_CTX_use_certificate_chain_file and SSL_CTX_use_PrivateKey_file.</p>\n\n<pre><code>    if (!SSL_CTX_load_verify_locations(p_ssl_context_, root_ca_location_.c_str(), NULL)) {\n        AWS_LOG_ERROR(OPENSSL_WRAPPER_LOG_TAG, \" Root CA Loading error\");\n        return ResponseCode::NETWORK_SSL_ROOT_CRT_PARSE_ERROR;\n    }\n\n    // TODO: streamline error codes for TLS\n    if (0 &lt; device_cert_location_.length() &amp;&amp; 0 &lt; device_private_key_location_.length()) {\n        AWS_LOG_DEBUG(OPENSSL_WRAPPER_LOG_TAG, \"Device crt : %s\", device_cert_location_.c_str());\n        if (!SSL_CTX_use_certificate_chain_file(p_ssl_context_, device_cert_location_.c_str())) {\n            AWS_LOG_ERROR(OPENSSL_WRAPPER_LOG_TAG, \" Device Certificate Loading error\");\n            return ResponseCode::NETWORK_SSL_DEVICE_CRT_PARSE_ERROR;\n        }\n        AWS_LOG_DEBUG(OPENSSL_WRAPPER_LOG_TAG, \"Device privkey : %s\", device_private_key_location_.c_str());\n        if (1 != SSL_CTX_use_PrivateKey_file(p_ssl_context_,\n                                             device_private_key_location_.c_str(),\n                                             SSL_FILETYPE_PEM)) {\n            AWS_LOG_ERROR(OPENSSL_WRAPPER_LOG_TAG, \" Device Private Key Loading error\");\n            return ResponseCode::NETWORK_SSL_KEY_PARSE_ERROR;\n        }\n    }\n    certificates_read_flag_ = true;\n</code></pre>\n\n<p>However, the call doesn't work if I construct the chain manually by adding the certificates using string buffers. The error returned is \"An unknown occurred while waiting for the TLS handshake to complete.\".</p>\n\n<pre><code>    X509_STORE* store = SSL_CTX_get_cert_store(p_ssl_context_);\n    X509 *rootCACertificate, *deviceCertificate;\n    RSA *privateKey;\n    BIO *bio;\n\n    std::string rootCACertificateBuffer;\n    std::string deviceCertificateBuffer;\n    std::string privateKeyBuffer;\n\n    rootCACertificateBuffer = \n    \"-----BEGIN CERTIFICATE-----\\n\"\n\n    \"-----END CERTIFICATE-----\\n\";\n\n    deviceCertificateBuffer = \n    \"-----BEGIN CERTIFICATE-----\\n\"\n\n    \"-----END CERTIFICATE-----\\n\";\n\n    privateKeyBuffer = \n    \"-----BEGIN RSA PRIVATE KEY-----\\n\"\n\n    \"-----END RSA PRIVATE KEY-----\\n\";\n\n    bio = BIO_new(BIO_s_mem());\n    BIO_puts(bio, rootCACertificateBuffer.c_str());\n    rootCACertificate = PEM_read_bio_X509(bio, NULL, 0, NULL);\n    X509_STORE_add_cert(store, rootCACertificate);\n    BIO_free(bio);\n\n    bio = BIO_new(BIO_s_mem());\n    BIO_puts(bio, deviceCertificateBuffer.c_str());\n    deviceCertificate = PEM_read_bio_X509(bio, NULL, 0, NULL);\n    X509_STORE_add_cert(store, deviceCertificate);\n    BIO_free(bio);\n\n    bio = BIO_new(BIO_s_mem());\n    BIO_puts(bio, privateKeyBuffer.c_str());\n    privateKey = PEM_read_bio_RSAPrivateKey(bio, NULL, 0, NULL);\n    SSL_CTX_use_RSAPrivateKey(p_ssl_context_, privateKey);\n    BIO_free(bio);\n\n    SSL_CTX_build_cert_chain(p_ssl_context_,SSL_BUILD_CHAIN_FLAG_CHECK );\n\n    certificates_read_flag_ = true;\n</code></pre>\n"
    }, {
        "tags": [
            "mqtt",
            "iot",
            "mosquitto"
        ],
        "is_answered": true,
        "view_count": 1218,
        "favorite_count": 1,
        "score": 0,
        "last_activity_date": 1534588486,
        "creation_date": 1533213885,
        "last_edit_date": 1533228820,
        "question_id": 51654010,
        "link": "https://stackoverflow.com/questions/51654010/mqtt-not-receiving-offline-messsages",
        "title": "MQTT: Not receiving offline messsages",
        "body": "<p>My client connects with the following parameters:</p>\n\n<ol>\n<li>Clean Session: False</li>\n<li>Client ID: Fixed (same every time) </li>\n<li>Subscribed with QoS=1</li>\n<li>Message Published with QoS=1</li>\n</ol>\n\n<p>I am trying to verify that if the broker receives messages when the client is offline, the messages are queued on the broker and sent to client when it comes online again.</p>\n\n<p>However, I find that the broker does not send anything to the client on reconnect.</p>\n\n<p>This is how I tested:\nConnect client to broker using the four parameters mentioned above.\nSubscribe to topics of interest with QoS=1\nDisconnect client</p>\n\n<p>Using another client program and another client id, connect to the broker\nPublish message to the same topic that was subscribed to by the now offline client. \nWait for a few seconds, now reconnect the offline client with the same connection settings as before.</p>\n\n<p><strong>Expected Result</strong>: As soon as connection is re-established the client will receive messages that were sent to its topic while it was offline.</p>\n\n<p><strong>Actual Result</strong>: Client gets no messages. It is able to receive any new messages that are sent AFTER it is connected, but no offline messages.**</p>\n\n<p>I have verified using <strong>Wireshark</strong> that the SUBSCRIBE and message PUBLISH packets sent to the server have QoS=1 and clean session flag is false in CONNECT packet. </p>\n\n<p>Broker: Mosquitto v1.4.11 </p>\n\n<p>MQTT Config File:</p>\n\n<pre><code>pid_file /var/run/mosquitto.pid\n\npersistence true\npersistence_location /var/lib/mosquitto/\n\nlog_dest file /var/log/mosquitto/mosquitto.log\nlog_type debug\n\nlistener 9001\nprotocol websockets\n\nlistener 1883\nprotocol mqtt\n\nallow_anonymous false\nacl_file /path/to/acl_file\npassword_file /path/to/password_file\n</code></pre>\n"
    }, {
        "tags": [
            "mqtt",
            "iot",
            "paho"
        ],
        "is_answered": true,
        "view_count": 1443,
        "favorite_count": 0,
        "score": 1,
        "last_activity_date": 1534163977,
        "creation_date": 1491795122,
        "question_id": 43314578,
        "link": "https://stackoverflow.com/questions/43314578/paho-java-client-failing-to-connect-bad-user-name-or-password-4",
        "title": "Paho java client failing to connect: Bad user name or password (4)",
        "body": "<p>Is there some issue with paho java client when connect with username &amp; password ??</p>\n\n<p>From paho JS client it works but from java client it doesn't.\nI have this code</p>\n\n<pre><code>MqttConnectOptions conOpt = new MqttConnectOptions();\nconOpt.setCleanSession(false);\nconOpt.setUserName(\"test5\");\nconOpt.setPassword(\"123\".toCharArray());\nMqttDefaultFilePersistence filePersistence = new MqttDefaultFilePersistence(\"/home/manish/Downloads/mqttPersist\");\nclient = new MqttAsyncClient(appProps.getProperty(\"mqtt.broker\"),\n        appProps.getProperty(\"mqtt.clientId\"), filePersistence);\nclient.setCallback(this);\nclient.connect(conOpt, new IMqttActionListener() {\n    @Override\n    public void onSuccess(IMqttToken imt) {\n        try {\n            client.subscribe(Constants.INTERNAL_TOPICS, Constants.INTERNAL_TOPIC_QOS);\n        } catch (MqttException ex) {\n            ex.printStackTrace();\n        }\n    }\n\n    @Override\n    public void onFailure(IMqttToken imt, Throwable thrwbl) {\n        thrwbl.printStackTrace();\n    }\n});\n</code></pre>\n\n<p>i am getting this exception</p>\n\n<pre><code>Bad user name or password (4)\nat org.eclipse.paho.client.mqttv3.internal.ExceptionHelper.createMqttException(ExceptionHelper.java:28)\nat org.eclipse.paho.client.mqttv3.internal.ClientState.notifyReceivedAck(ClientState.java:885)\nat org.eclipse.paho.client.mqttv3.internal.CommsReceiver.run(CommsReceiver.java:118)\nat java.lang.Thread.run(Thread.java:745)\nemqt console\n\n06:47:36.456 [error] Client(notification_subs_bot@127.0.0.1:50741): Username 'undefined' login failed for username_or_password_undefined\n06:47:36.463 [error] Client(notification_subs_bot@127.0.0.1:50742): Username 'undefined' login failed for username_or_password_undefined\n</code></pre>\n\n<p>According paho documentation public void setPassword(char[] password) So here i am passing char[] as paasword</p>\n\n<p>I am using <code>emqttd</code> broker</p>\n"
    }, {
        "tags": [
            "amazon-web-services",
            "raspberry-pi",
            "iot"
        ],
        "is_answered": true,
        "view_count": 270,
        "favorite_count": 0,
        "score": 1,
        "last_activity_date": 1533806706,
        "creation_date": 1533739741,
        "last_edit_date": 1533741427,
        "question_id": 51749652,
        "link": "https://stackoverflow.com/questions/51749652/raspberrypi-aws-iot-cert-problems",
        "title": "RaspberryPi AWS - IoT cert problems",
        "body": "<p>I am trying to connect from my RaspPi to AWS IoT.\nI am getting the info as below.</p>\n\n<p>\"Unable to verify the server's certificate. Either it is invalid,\n    or you didn't set ca_file or ca_path to an appropriate value.\"</p>\n\n<p>My settings are:</p>\n\n<pre><code>#define AWS_IOT_MQTT_HOST              \"xxxx.iot.us-west-2.amazonaws.com\" \n#define AWS_IOT_MQTT_PORT              443 \n#define AWS_IOT_MQTT_CLIENT_ID         \"RaspberryPi\" \n#define AWS_IOT_MY_THING_NAME          \"RaspberryPi\" \n#define AWS_IOT_ROOT_CA_FILENAME       \"AmazonRootCA2.pem\" \n#define AWS_IOT_CERTIFICATE_FILENAME   \"xxx-certificate.pem.crt\" \n#define AWS_IOT_PRIVATE_KEY_FILENAME   \"xxx-private.pem.key\" \n</code></pre>\n\n<p>I do not know which RootCA I should put and where to find it.\nWhen I create IoT certificates I have two (prv/pub) keys and \"a cert for this thing\".\nPlease let me know how to solve it.</p>\n\n<p>MW</p>\n"
    }, {
        "tags": [
            "mqtt",
            "iot",
            "google-cloud-iot"
        ],
        "is_answered": false,
        "view_count": 531,
        "favorite_count": 0,
        "score": 1,
        "last_activity_date": 1531211086,
        "creation_date": 1523447105,
        "last_edit_date": 1523504334,
        "question_id": 49774280,
        "link": "https://stackoverflow.com/questions/49774280/issue-with-google-iot-mqtt-bridge",
        "title": "Issue with Google IoT MQTT bridge",
        "body": "<p>We have an IoT based application device which is configured to communication with our Dashboard via MQTT bridge from Various service providers like Google, AWS and Azure.</p>\n\n<p>So the flow is:</p>\n\n<ol>\n<li>Device start TLS session with service provider.  </li>\n<li>Subscribe to a particular topic and wait for messages from the\nservice provider with 5 second timeout.  </li>\n<li>Dashboard publishes messages to same topic periodically.  </li>\n<li>IoT service provider broadcast it to all devices subscribed.</li>\n</ol>\n\n<p>Publish and subscribe messages are with MQTT <strong>QOS 1</strong> services.</p>\n\n<p><strong>Observation:</strong></p>\n\n<p>AWS and Azure works fine with above flow, but device stop receiving messages from Google MQTT bridge after 3-5 successful iterations even though our dashboard is publishing messages to Google IoT MQTT bridge.</p>\n\n<p>For Google, we have identified that control flow is different when compared with Azure and AWS.</p>\n\n<p>For Google, we need to subscribe and un-subscribe for a given topic every-time before waiting to receive message while for AWS and Azure we need to subscribe once during opening a MQTT connection.</p>\n\n<p><strong>Issue:</strong></p>\n\n<p>Sometime 5 sec device timeout occurs as it could not receive messages for subscribed topic from Google MQTT bridge. Adding multiple retries to overcome timeout issue was unsuccessful as issue still persist as device could not receive message from Google MQTT bridge after 45-60sec of device operation after powering on.</p>\n\n<ul>\n<li>Is there is constraint with Google MQTT bridge to receive messages periodically without subscribing it every-time?</li>\n<li>How can device receive messages without timing out (5 sec) from Google MQTT bridge?</li>\n<li>Is there any workaround to recover a device once it got timed out with establishing MQTT reconnection?</li>\n</ul>\n"
    }, {
        "tags": [
            "iot",
            "sensors",
            "zigbee"
        ],
        "is_answered": false,
        "view_count": 51,
        "favorite_count": 0,
        "score": 1,
        "last_activity_date": 1529317432,
        "creation_date": 1529317432,
        "question_id": 50907346,
        "link": "https://stackoverflow.com/questions/50907346/where-we-can-see-heart-beat-of-sensor-in-zigbee-call-fow",
        "title": "where we can see heart beat of sensor in zigbee call fow?",
        "body": "<p>The question is about zigbee network; does the nodes (routers, end devices) send some keep alive messages or Heart beat to prevent time out? Or can't a node ping out?</p>\n\n<p>Just a pointee to the correct parameters or what we call that attribute in zigbee call flow? that would be great help. I know that you can set the POLL_RATE for data request, to get queued messages.</p>\n"
    }, {
        "tags": [
            "azure",
            "iot",
            "publish-subscribe",
            "azure-iot-hub",
            "subscribe"
        ],
        "is_answered": true,
        "view_count": 1689,
        "favorite_count": 1,
        "score": 1,
        "last_activity_date": 1528866847,
        "creation_date": 1526670501,
        "last_edit_date": 1526906352,
        "question_id": 50417822,
        "link": "https://stackoverflow.com/questions/50417822/azure-iot-hub-subscribe-code-not-working-connection-was-refused",
        "title": "Azure IoT Hub - &quot;Subscribe&quot; code not working: &quot;connection was refused&quot;",
        "body": "<p>I am trying to receive \"notifications\" from IoT Hub when some data is published to the MQTT topic <code>devices/device_id/messages/events/</code>. To receive data, I am using the following topic: <code>devices/device_id/messages/devicebound/</code>. My subscribe code is below (Python):</p>\n\n<pre><code>import paho.mqtt.client as mqtt\nimport ssl, random\nfrom time import sleep\n\nroot_ca = \"./certs/digicertbaltimoreroot.pem\"\npublic_crt = './certs/rsa_cert.pem'\nprivate_key = './certs/rsa_private.pem'\n\niothub_name = \"myhub\"\ndevice_id = \"mydevice\"\nmqtt_url = \"{}.azure-devices.net\".format(iothub_name)\nmqtt_port = 8883\ntopic = \"devices/{}/messages/devicebound/#\".format(device_id)\n\ndef error_str(rc):\n    return \"Some error occurred. {}: {}\".format(rc, mqtt.error_string(rc))\n\ndef on_disconnect(unused_client, unused_userdata, rc):\n    print(\"on_disconnect\", error_str(rc))\n\ndef on_connect(client, userdata, flags, response_code):\n    print(\"Connected with status: {0}\".format(response_code))\n    client.subscribe(topic, 1)\n\ndef on_subscribe(client, userdata, mid, granted_qos):\n    print(\"Subscribed: \"+str(mid)+\" \"+str(granted_qos))\n\ndef on_message(client, userdata, msg):\n    print(\"Topic: {0} -- Payload: {1}\".format(msg.topic, str(msg.payload)))\n\nif __name__ == \"__main__\":    \n    client = mqtt.Client(device_id, protocol=mqtt.MQTTv311)\n\n    client.tls_set(root_ca,\n                   certfile = public_crt,\n                   keyfile = private_key,\n                   cert_reqs = ssl.CERT_REQUIRED,\n                   tls_version = ssl.PROTOCOL_TLSv1_2,\n                   ciphers = None)\n\n    client.on_connect = on_connect\n    client.on_message = on_message\n    client.on_disconnect = on_disconnect\n\n    print(\"Connecting to Azure IoT Hub...\")\n    client.connect(mqtt_url, mqtt_port, keepalive=60)\n    client.loop_forever()\n</code></pre>\n\n<p>When I run, I am getting the following output:</p>\n\n<blockquote>\n  <p>Connecting to Azure IoT Hub...<br>\n  Connected with status: 3<br>\n  ('on_disconnect', 'Some error occurred. 5: The connection was refused.')<br>\n  Connected with status: 3<br>\n  ('on_disconnect', 'Some error occurred. 5: The connection was refused.')  </p>\n</blockquote>\n\n<p>Can anyone suggest what I am missing?</p>\n"
    }, {
        "tags": [
            "mqtt",
            "iot",
            "mosquitto",
            "messagebroker"
        ],
        "is_answered": false,
        "view_count": 418,
        "favorite_count": 0,
        "score": 1,
        "last_activity_date": 1528349818,
        "creation_date": 1528271132,
        "last_edit_date": 1528349818,
        "question_id": 50714883,
        "link": "https://stackoverflow.com/questions/50714883/handling-backpressure-data-tranmission-in-mqtt-client",
        "title": "Handling backpressure data tranmission in mqtt client",
        "body": "<p>We have a mosquito broker installed in our cloud server. Our gateway is sending data by using an MQTT client with 2G signal. We are observing data loss in a few scenarios.</p>\n\n<p>When the gateway is disconnected from internet we queue messages in the gateway for few days. When it reaches the internet again then it starts pushing data to broker with two threads: one is for live messages, the other is for queued messages. We get a callback ACK for each and every message but we are loosing some messages on the server side.</p>\n\n<ol>\n<li><p><strong>How do we make sure that all produced messages will be processed in the broker?</strong> </p></li>\n<li><p><strong>How do we handle the burst of message in the gateway?</strong> One option is to delay the sending of each queued message by a few milliseconds (to avoid that they all try to reach the broker at once.</p></li>\n</ol>\n\n<p>We are using QoS level 1 for our publisher/subscriber and want to continued using QoS level 1.</p>\n"
    }, {
        "tags": [
            "go",
            "mqtt",
            "iot",
            "aws-iot"
        ],
        "is_answered": false,
        "view_count": 552,
        "favorite_count": 1,
        "score": 0,
        "last_activity_date": 1526659829,
        "creation_date": 1518802737,
        "question_id": 48832131,
        "link": "https://stackoverflow.com/questions/48832131/go-aws-mqtt-connection-lost-before-subscribe-completed",
        "title": "Go AWS MQTT Connection lost before Subscribe completed",
        "body": "<p>I'm having an intermittent issue with go trying to connect to AWS MQTT.  Sometimes it works fine, other times not so much.  When I connect I get this error:\nConnection lost before Subscribe completed</p>\n\n<p>I'm really not sure why it does this, at first everything seemed to work fine but now it throws this error more often than not.  Here's the code that I'm using to connect:</p>\n\n<pre><code>type ServerConnection struct {\n    Cert     tls.Certificate\n    Host     string\n    Port     int\n    Path     string\n    Topic    string\n    Qos      int\n    Messages chan MQTT.Message\n    Control  chan os.Signal\n }\n\nfunc (server *ServerConnection) Start() error {\n    cid := uuid.New().String()\n\n    connOpts := &amp;MQTT.ClientOptions{\n            ClientID:             cid,\n            CleanSession:         true,\n            AutoReconnect:        true,\n            MaxReconnectInterval: 1 * time.Second,\n            KeepAlive:            30000,\n            TLSConfig:            tls.Config{Certificates: []tls.Certificate{server.Cert}},\n    }\n    connOpts.SetConnectTimeout(30 * time.Second)\n    connOpts.SetDefaultPublishHandler(func(client MQTT.Client, msg MQTT.Message) {\n            server.Messages &lt;- msg\n    })\n    brokerURL := fmt.Sprintf(\"tcps://%s:%d%s\", server.Host, server.Port, server.Path)\n    connOpts.AddBroker(brokerURL)\n    mqttClient := MQTT.NewClient(connOpts)\n    if token := mqttClient.Connect(); token.Wait() &amp;&amp; token.Error() != nil {\n            return token.Error()\n    }\n    // Subscribe\n    go func() {\n            log.Printf(\"subscribing\")\n            if token := mqttClient.Subscribe(server.Topic, byte(server.Qos), nil); token.Wait() &amp;&amp; token.Error() != nil {\n                    fmt.Println(token.Error())\n                    os.Exit(1)\n            }\n            log.Printf(\"subscribed\")\n\n    }()\n    server.ProcessMessages()\n    log.Println(\"[MQTT] Connected\")\n    quit := make(chan struct{})\n    signal.Notify(server.Control, os.Interrupt)\n    go func() {\n            &lt;-server.Control\n            mqttClient.Disconnect(250)\n            fmt.Println(\"[MQTT] Disconnect\")\n            quit &lt;- struct{}, {}\n    }()\n    &lt;-quit\n\n    return nil\n\n   }\n</code></pre>\n"
    }, {
        "tags": [
            "mqtt",
            "iot"
        ],
        "is_answered": false,
        "view_count": 28,
        "favorite_count": 0,
        "score": 0,
        "last_activity_date": 1526626778,
        "creation_date": 1526623846,
        "question_id": 50404814,
        "link": "https://stackoverflow.com/questions/50404814/in-the-mqtt-protocol-how-does-a-client-identify-a-server",
        "title": "In the MQTT protocol, how does a client identify a server?",
        "body": "<p>I have read that the overhead is low. What does it really mean when compared to HTTP? Does it not use the ip address of the server to which a client tries to connect to? If not, how does a client connect to a server?</p>\n"
    }, {
        "tags": [
            "mqtt",
            "iot"
        ],
        "is_answered": true,
        "view_count": 90,
        "favorite_count": 0,
        "score": 0,
        "last_activity_date": 1526204680,
        "creation_date": 1526134179,
        "last_edit_date": 1526144469,
        "question_id": 50307116,
        "link": "https://stackoverflow.com/questions/50307116/how-should-subscription-topic-be-be-organized-in-mqtt-broker",
        "title": "How should subscription topic be be organized in mqtt broker?",
        "body": "<p>I am creating my own implementation of mqtt broker (I know there are few existing, but I need realy tiny one - for embeded project). I wonder how sholud  topic be organised - should I store topic list and connect clients IDs for  particular topic or should every client instance has its own list of subscribed topic? What is better aproach?</p>\n"
    }, {
        "tags": [
            "mqtt",
            "iot"
        ],
        "is_answered": true,
        "view_count": 585,
        "favorite_count": 0,
        "score": 0,
        "last_activity_date": 1526153736,
        "creation_date": 1526054159,
        "question_id": 50296047,
        "link": "https://stackoverflow.com/questions/50296047/mqtt-subscriber-missed-messages",
        "title": "MQTT subscriber missed messages",
        "body": "<p>I have a basic MQTT question. If I am publishing on a topic lets say myTopic/1 and I am publishing messages faster than the broker is delivering them to the subscriber will some messages get overwritten and not delivered? This seems to be my experience when testing using AWS IOT broker service. Also messages seem to be delivered to the subscriber on a random order. </p>\n\n<p>Im using the M2MQtt c# library for my publisher and subscriber tests.</p>\n\n<p>Many Thanks</p>\n"
    }, {
        "tags": [
            "java",
            "mqtt",
            "iot",
            "paho"
        ],
        "is_answered": false,
        "view_count": 377,
        "favorite_count": 0,
        "score": 0,
        "last_activity_date": 1525078672,
        "creation_date": 1468528997,
        "last_edit_date": 1468576054,
        "question_id": 38383924,
        "link": "https://stackoverflow.com/questions/38383924/paho-mqtt-client-publication-disconnect-sequence",
        "title": "Paho MQTT Client Publication / Disconnect Sequence",
        "body": "<p>I am confused by the programming model of mqtt.\nMy goal is to deploy a client that periodically retrieves sensor data\n and publish them on a topic via mqtt paho client.</p>\n\n<p>In the code-examples from paho after every publication they disconnects, but i have also see examples where the client published data without a disconnect message sending after each sensor data publication. \nWhat is the best approach ?</p>\n"
    }, {
        "tags": [
            "python",
            "publish-subscribe",
            "iot",
            "paho",
            "aws-iot"
        ],
        "is_answered": true,
        "view_count": 1376,
        "favorite_count": 0,
        "score": 0,
        "last_activity_date": 1524248279,
        "creation_date": 1521134925,
        "last_edit_date": 1524248279,
        "question_id": 49305730,
        "link": "https://stackoverflow.com/questions/49305730/aws-iot-no-success-with-publish-on-topic-attempt",
        "title": "AWS IoT - No success with publish on topic attempt",
        "body": "<p>I am testing the connection and publishing to a thing created in the AWS IoT console. I am using the following code:</p>\n\n<pre><code>import paho.mqtt.client as mqtt\nimport ssl, random\nfrom time import sleep\n\nmqtt_url = \"XXXXXX.iot.us-east-2.amazonaws.com\"\nroot_ca = './certs/iotRootCA.pem'\npublic_crt = './certs/deviceCert.crt'\nprivate_key = './certs/deviceCert.key'\n\nconnflag = False\n\ndef on_connect(client, userdata, flags, response_code):\n    global connflag\n    connflag = True\n    print(\"Connected with status: {0}\".format(response_code))\n\ndef on_publish(client, userdata, mid):\n    client.disconnect()\n\ndef on_message(client, userdata, msg):\n    print \"---ON MESSAGE\"\n    print(msg.topic + \" \" + str(msg.payload))\n\nif __name__ == \"__main__\":\n    print \"Loaded MQTT configuration information.\"\n    print \"Endpoint URL: \" + mqtt_url\n    print \"Root Cert: \" + root_ca\n    print \"Device Cert: \" + public_crt\n    print \"Private Key: \" + private_key\n\n    client = mqtt.Client(\"aws_connector\")\n    client.tls_set(root_ca,\n                   certfile = public_crt,\n                   keyfile = private_key,\n                   cert_reqs = ssl.CERT_REQUIRED,\n                   tls_version = ssl.PROTOCOL_TLSv1_2,\n                   ciphers = None)\n\n    client.on_connect = on_connect\n    client.on_message = on_message\n\n    print \"Connecting to AWS IoT Broker...\"\n    client.connect(mqtt_url, port = 8883)\n    client.loop_start()\n\n    while 1==1:\n        sleep(0.5)\n        if connflag == True:\n            print \"Publishing...\"\n            ap_measurement = random.uniform(25.0, 150.0)\n            client.publish(\"ActivePower\", ap_measurement, qos=1)\n        else:\n            print(\"Waiting for connection...\")\n</code></pre>\n\n<p>My policies are described as below:</p>\n\n<pre><code>{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": \"iot:Connect\",\n      \"Resource\": \"*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": \"iot:Publish\",\n      \"Resource\": \"arn:aws:iot:us-east-2:338639570104:topic/sm1\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": \"iot:Subscribe\",\n      \"Resource\": \"arn:aws:iot:us-east-2:338639570104:topic/sm1\"\n    }\n  ]\n}\n</code></pre>\n\n<p>Apparently, the connection is working and I am getting the following output:</p>\n\n<blockquote>\n  <p>Loaded MQTT configuration information.<br>\n  Endpoint URL: XXXXXX.iot.us-east-2.amazonaws.com<br>\n  Root Cert: ./certs/iotRootCA.pem   Device Cert: ./certs/deviceCert.crt   > Private Key: ./certs/deviceCert.key<br>\n  Connecting to AWS IoT Broker...<br>\n  Connected with status: 0<br>\n  Publishing...<br>\n  Publishing...<br>\n  Publishing...<br>\n  Publishing...<br>\n  Connected with status: 0<br>\n  Publishing...</p>\n</blockquote>\n\n<p>The problem is I am getting no messages from the publishing process. Am I doing something wrong? Is there something missing?</p>\n"
    }, {
        "tags": [
            "python",
            "multithreading",
            "iot"
        ],
        "is_answered": true,
        "view_count": 155,
        "favorite_count": 0,
        "score": 0,
        "last_activity_date": 1524139398,
        "creation_date": 1519817384,
        "last_edit_date": 1519823160,
        "question_id": 49028537,
        "link": "https://stackoverflow.com/questions/49028537/is-there-any-way-to-enable-unlimited-processes-threads-in-gunicorn-to-enable-sha",
        "title": "Is there any way to enable unlimited processes/threads in gunicorn to enable sharing to unlimited users?",
        "body": "<p>I implement a server in python and serve it with gunicorn. </p>\n\n<p>I have 3 shared sources (urls) with event streams SSE, to be shared to unknown amount of clients.</p>\n\n<p>Is there any way to enable unlimited processes/threads in gunicorn to enable sharing to unlimited users, according to requests ?</p>\n"
    }, {
        "tags": [
            "python",
            "json",
            "mqtt",
            "iot",
            "thingsboard"
        ],
        "is_answered": true,
        "view_count": 930,
        "favorite_count": 0,
        "score": 0,
        "last_activity_date": 1523259660,
        "creation_date": 1521193466,
        "question_id": 49317486,
        "link": "https://stackoverflow.com/questions/49317486/thingsboard-iot-gateway-timestamp-mapping-timeseries-in-release-1-4-0",
        "title": "ThingsBoard IoT Gateway - Timestamp mapping timeseries in release 1.4.0",
        "body": "<p>I've just upgraded my ThingsBoard IoT Gateway to the release 1.4.0, and I saw from the repository that it is now possible to map the published telemetry with client side timestamp. From my understanding this feature before was only possible by directly publishing to the ThingsBoard embedded MQTT broker, but not through the Gateway.\nFrom the repository I found that the previous mapping class (rep. branch 1.2) was the <a href=\"https://github.com/thingsboard/thingsboard-gateway/blob/release-1.2/src/main/java/org/thingsboard/gateway/extensions/common/conf/mapping/KVMapping.java\" rel=\"nofollow noreferrer\">following</a>:</p>\n\n<pre><code>public class KVMapping {\n    private String key;\n    private DataTypeMapping type;\n    private String value;\n}\n</code></pre>\n\n<p>While the new release (rep. branch 1.4) has the following <a href=\"https://github.com/thingsboard/thingsboard-gateway/blob/release-1.4/src/main/java/org/thingsboard/gateway/extensions/common/conf/mapping/KVMapping.java\" rel=\"nofollow noreferrer\">class</a>:</p>\n\n<pre><code>public class KVMapping {\n    private String key;\n    private DataTypeMapping type;\n    private String value;\n    private String ts;\n    private String tsFormat;\n}\n</code></pre>\n\n<p>From my understanding the timestamp feature (and the formatting style) have been added in the message mapping.\nMy problem is that I'm unable to map the timestamp in the message I publish towards ThingsBoard. The platform still receives the correct <code>key</code> and <code>value</code>, but maps the data with the server side timestamp.</p>\n\n<p>This is a code snippet of the python code I use to publish the packet to the external MQTT broker, that shows how my json packet is structured:</p>\n\n<pre><code>timeStamp = \"1488273476000\"\ndata = {\n    \"about\": \"Devices\",\n    \"properties\": [\n        {\n            \"about\": \"Device1\",\n            \"iotStateObservation\": [\n                {\n                    \"phenomenonTime\": timeStamp,\n                    \"value\": \"1\"\n                }\n            ]\n        },\n        {\n            \"about\": \"Device2\",\n            \"iotStateObservation\": [\n                {\n                    \"phenomenonTime\": timeStamp,\n                    \"value\": \"174468\"\n                }\n            ]\n        },\n        {\n            \"about\": \"Device3\",\n            \"iotStateObservation\": [\n                {\n                    \"phenomenonTime\": timeStamp,\n                    \"value\": \"12\"\n                }\n            ]\n        }\n    ]\n}\n</code></pre>\n\n<p>This is a snippet from my ThingsBoard IoT gateway mapping file (mqtt-config.json), here configured all the wanted mapping:</p>\n\n<pre><code>{\n    \"topicFilter\": \"sensors\",\n    \"converter\": {\n        \"type\": \"json\",\n        \"filterExpression\": \"$.properties[*]\",\n        \"deviceNameJsonExpression\": \"${$.about}\",\n        \"timeseries\": [\n            {\n                \"type\": \"double\",\n                \"ts\": \"${$.iotStateObservation[0].phenomenonTime}\",\n                \"key\": \"${$.about}\",\n                \"value\": \"${$.iotStateObservation[0].value}\"\n            }\n        ]\n    }\n}\n</code></pre>\n\n<p><strong>Is there some mistake I'm committing in this procedure, or simply it is still not possible to map the data with client side timestamp yet?</strong></p>\n"
    }, {
        "tags": [
            "publish-subscribe",
            "iot",
            "paho",
            "aws-iot"
        ],
        "is_answered": true,
        "view_count": 918,
        "favorite_count": 0,
        "score": 0,
        "last_activity_date": 1521642957,
        "creation_date": 1521561190,
        "question_id": 49388718,
        "link": "https://stackoverflow.com/questions/49388718/aws-iot-connection-and-publishing-operations-using-paho-mqtt-not-working",
        "title": "AWS IoT - Connection and publishing operations using paho-mqtt not working",
        "body": "<p>Trying to work with AWS IoT, I have the following code that was working yesterday:</p>\n\n<pre><code>import paho.mqtt.client as mqtt\nimport ssl, random\nfrom time import sleep\n\nmqtt_url = \"XXXXXXXX.iot.us-east-2.amazonaws.com\"\nroot_ca = './certs/iotRootCA.pem'\npublic_crt = './certs/deviceCert.crt'\nprivate_key = './certs/deviceCert.key'\n\nconnflag = False\n\ndef on_connect(client, userdata, flags, response_code):\n    global connflag\n    connflag = True\n    print(\"Connected with status: {0}\".format(response_code))\n\ndef on_publish(client, userdata, mid):\n    print userdata + \" -- \" + mid\n    #client.disconnect()\n\nif __name__ == \"__main__\":\n    print \"Loaded MQTT configuration information.\"\n    print \"Endpoint URL: \" + mqtt_url\n    print \"Root Cert: \" + root_ca\n    print \"Device Cert: \" + public_crt\n    print \"Private Key: \" + private_key\n\n    client = mqtt.Client()\n    client.tls_set(root_ca,\n                   certfile = public_crt,\n                   keyfile = private_key,\n                   cert_reqs = ssl.CERT_REQUIRED,\n                   tls_version = ssl.PROTOCOL_TLSv1_2,\n                   ciphers = None)\n\n    client.on_connect = on_connect\n#    client.on_publish = on_publish\n\n    print \"Connecting to AWS IoT Broker...\"\n    client.connect(mqtt_url, port = 8883, keepalive=60)\n    client.loop_start()\n#    client.loop_forever()\n\n    while 1==1:\n        sleep(0.5)\n        print connflag\n        if connflag == True:\n            print \"Publishing...\"\n            ap_measurement = random.uniform(25.0, 150.0)\n            client.publish(\"ActivePower\", ap_measurement, qos=1)\n            print(\"ActivePower published: \" + \"%.2f\" % ap_measurement )\n        else:\n            print \"waiting for connection...\"\n</code></pre>\n\n<p>As I said, yesterday this code was working. Today, I am getting the following (there is no connection):</p>\n\n<blockquote>\n  <p>python awsiot-publish.py<br>\n  Loaded MQTT configuration information.<br>\n  Endpoint URL: XXXXXXX.iot.us-east-2.amazonaws.com<br>\n  Root Cert: ./certs/iotRootCA.pem<br>\n  Device Cert: ./certs/deviceCert.crt<br>\n  Private Key: ./certs/deviceCert.key<br>\n  Connecting to AWS IoT Broker... \n  False<br>\n  waiting for connection...<br>\n  False<br>\n  waiting for connection...<br>\n  False<br>\n  waiting for connection... \n  False</p>\n</blockquote>\n\n<p>I do not know if there is a problem with AWS IoT... I just think the documentation is deficient: it is not clear how we can use our code...</p>\n"
    }, {
        "tags": [
            "java",
            "mqtt",
            "iot",
            "paho",
            "publisher"
        ],
        "is_answered": false,
        "view_count": 140,
        "favorite_count": 0,
        "score": 0,
        "last_activity_date": 1520793483,
        "creation_date": 1520793240,
        "last_edit_date": 1520793483,
        "question_id": 49223610,
        "link": "https://stackoverflow.com/questions/49223610/publisher-mqtt-client-stops-to-work-in-subscribers-callback-paho-java",
        "title": "Publisher MQTT client stops to work in Subscriber&#39;s Callback. (PAHO JAVA)",
        "body": "<p>I'm trying to implement a fake broker (actually it is an mqtt publisher client in an mqtt subscriber's callback). There are 3 separated publisher clients which are publishing random numbers between 0 and 1. This fake broker just summarizes this random numbers, and publishes away to an other topic. (Maybe not in the right way, but for now it is ok) This solution is working but after a few incoming messages this broker stops to work. I Tried to debug it, but I found only ClassNotFound Exceptions... Here is my FakeBroker and it's Callback implementation.</p>\n\n<pre><code>public class FakeBroker implements Runnable{\n\npublic static final String BROKER_URL = \"\";\npublic static final String TOPIC_FAKE_A = \"\";\npublic static final String TOPIC_FAKE_B = \"\";\npublic static final String TOPIC_FAKE_C = \"\";\npublic static final String USER_NAME = \"\";\npublic static final char[] USER_PSW  = \"\".toCharArray();\n\nprivate MqttClient client;\nprivate MqttConnectOptions options;\nprivate SubscriberCallback callback;\n\npublic FakeBroker() {\n    options = new MqttConnectOptions();\n    options.setUserName(USER_NAME);\n    options.setPassword(USER_PSW);\n    options.setCleanSession(false);\n    callback = new SubscriberCallback();\n    try {\n        client = new MqttClient(BROKER_URL, MqttClient.generateClientId()+\"-sub\");\n        client.setCallback(callback);\n\n\n    } catch (MqttException e) {\n        e.printStackTrace();\n        System.exit(1);\n    }\n}\n\n\npublic void start() {\n    try {\n        client.connect(options);\n        System.out.println(\"Fake Broker are connected to the cloud.\");\n        client.subscribe(TOPIC_FAKE_A);\n        client.subscribe(TOPIC_FAKE_B);\n        client.subscribe(TOPIC_FAKE_C);\n\n\n    } catch (MqttException e) {\n        e.printStackTrace();\n    }\n}\n\n@Override\npublic void run() {\n    start();\n}\n}\n</code></pre>\n\n<p>And here is it's Callback</p>\n\n<pre><code>public class SubscriberCallback implements MqttCallback {\n\npublic static final String BROKER_URL = \"\";\npublic static final String TOPIC_FAKE_BROKER = \"\";\npublic static final String USER_NAME = \"\";\npublic static final char[] USER_PSW = \"\".toCharArray();\nprivate MqttClient client;\nprivate MqttConnectOptions options;\nprivate int counter = 1;\nprivate int result = 0;\npublic SubscriberCallback() {\n    try {\n        client = new MqttClient(BROKER_URL, \"4-pub\");\n        options = new MqttConnectOptions();\n\n        options.setPassword(USER_PSW);\n        options.setUserName(USER_NAME);\n    } catch (MqttException e) {\n        e.printStackTrace();\n    }\n\n}\n\n@Override\npublic void connectionLost(Throwable throwable) {\n\n\n}\n\n@Override\npublic void messageArrived(String topic, MqttMessage mqttMessage) throws Exception {\n    System.out.println(\"Message Arrived. Topic   \" + topic + \"    message:     \" +mqttMessage + \" ---- Message Counter: \" + counter);\n\n    int number = Integer.parseInt(mqttMessage.toString());\n    result += number;\n    if (counter%3 == 0) {\n        publishAway(new MqttMessage(Integer.toString(result).getBytes()));\n        result = 0;\n    }\n    incrementCounter();\n\n}\n\nprivate void publishAway(MqttMessage mqttMessage) throws MqttException {\n    client.connect(options);\n    final MqttTopic topicFakeBroker = client.getTopic(TOPIC_FAKE_BROKER);\n    topicFakeBroker.publish(mqttMessage);\n    client.disconnect();\n    System.out.println(\"Fake broker got the message \" + mqttMessage + \" and published away to\" + topicFakeBroker.getName());\n}\n\n@Override\npublic void deliveryComplete(IMqttDeliveryToken iMqttDeliveryToken) {\n\n}\n\nprivate void incrementCounter() {\n    counter++;\n}\n}\n</code></pre>\n\n<p>Of course I use valid BROKER_URL and TOPICS but these informations are confidential. Thanks for Your answers! :)</p>\n"
    }, {
        "tags": [
            "mqtt",
            "iot",
            "amazon-kinesis",
            "aws-iot"
        ],
        "is_answered": true,
        "view_count": 2686,
        "favorite_count": 0,
        "score": 0,
        "last_activity_date": 1520589342,
        "creation_date": 1520342191,
        "question_id": 49131778,
        "link": "https://stackoverflow.com/questions/49131778/mqtt-topic-limitations-with-aws-iot",
        "title": "MQTT topic limitations with AWS IoT",
        "body": "<p>I have a AWS IoT solution, in which ten thousands of devices send data per second to a MQTT topic. i.e 10,000 messages published per second. Messages will be sent to AWS Kinesis via IoT rule.</p>\n\n<p>So is there any limitation, saying that we can publish up to a certain number of messages per second to a MQTT topic.</p>\n\n<p>When we tried with higher number of messages per second, after a certain limit (700 messages per second) messages were lost and not stored in Kinesis.</p>\n\n<p>Having multiple topics to publish data, will resolve this issue?</p>\n"
    }, {
        "tags": [
            "javascript",
            "json",
            "amazon-web-services",
            "iot",
            "esp32"
        ],
        "is_answered": false,
        "view_count": 83,
        "favorite_count": 0,
        "score": 0,
        "last_activity_date": 1520353532,
        "creation_date": 1509773270,
        "last_edit_date": 1509802153,
        "question_id": 47107743,
        "link": "https://stackoverflow.com/questions/47107743/unable-to-receive-sns-email-notification-aamazon-web-services-aws",
        "title": "Unable to receive SNS Email notification Aamazon Web Services AWS",
        "body": "<p>I am new to AWS and using <a href=\"https://github.com/mongoose-os-apps/aws-iot-button\" rel=\"nofollow noreferrer\">this GitHub example</a> to get email notification. Working on a Mac system, I have followed all the steps mentioned in the example and have everything setup as instructed. </p>\n\n<p>After rebooting the ESP, my log looks like this</p>\n\n<pre><code>[Nov  4 10:44:18.460] ets Jun  8 2016 00:22:57\n\n[Nov  4 10:44:18.460] \n\n[Nov  4 10:44:18.460] rst:0x1 (POWERON_RESET),boot:0x13 (SPI_FAST_FLASH_BOOT)\n\n[Nov  4 10:44:18.881] ets Jun  8 2016 00:22:57\n\n[Nov  4 10:44:18.881] \n\n[Nov  4 10:44:18.881] rst:0x10 (RTCWDT_RTC_RESET),boot:0x13 (SPI_FAST_FLASH_BOOT)\n\n[Nov  4 10:44:18.881] configsip: 0, SPIWP:0xee\n\n[Nov  4 10:44:18.881] clk_drv:0x00,q_drv:0x00,d_drv:0x00,cs0_drv:0x00,hd_drv:0x00,wp_drv:0x00\n\n[Nov  4 10:44:18.881] mode:DIO, clock div:2\n\n[Nov  4 10:44:18.881] load:0x3fff0010,len:4\n\n[Nov  4 10:44:18.881] load:0x3fff0014,len:5244\n\n[Nov  4 10:44:18.881] load:0x40078000,len:0\n\n[Nov  4 10:44:18.881] load:0x40078000,len:13400\n\n[Nov  4 10:44:18.881] entry 0x40078b38\n\n[Nov  4 10:44:18.928] [0;32mI (28) boot: ESP-IDF v1.0-2569-gc60279b 2nd stage bootloader[0m\n\n[Nov  4 10:44:18.928] [0;32mI (28) boot: compile time 11:02:31[0m\n\n[Nov  4 10:44:18.928] [0;32mI (28) boot: Enabling RNG early entropy source...[0m\n\n[Nov  4 10:44:18.928] [0;32mI (34) boot: SPI Speed      : 40MHz[0m\n\n[Nov  4 10:44:18.928] [0;32mI (38) boot: SPI Mode       : DIO[0m\n\n[Nov  4 10:44:18.928] [0;32mI (42) boot: SPI Flash Size : 4MB[0m\n\n[Nov  4 10:44:18.928] [0;32mI (46) boot: Partition Table:[0m\n\n[Nov  4 10:44:18.928] [0;32mI (50) boot: ## Label            Usage          Type ST Offset   Length   Flags[0m\n\n[Nov  4 10:44:18.928] [0;32mI (58) boot:  0 nvs              WiFi data        01 02 00009000 00004000 00000000[0m\n\n[Nov  4 10:44:18.975] [0;32mI (66) boot:  1 otadata          OTA data         01 00 0000d000 00002000 00000000[0m\n\n[Nov  4 10:44:18.975] [0;32mI (74) boot:  2 app_0            OTA app          00 10 00010000 00180000 00000000[0m\n\n[Nov  4 10:44:18.975] [0;32mI (82) boot:  3 fs_0             SPIFFS           01 82 00190000 00040000 00000000[0m\n\n[Nov  4 10:44:18.975] [0;32mI (91) boot:  4 app_1            OTA app          00 11 001d0000 00180000 00000000[0m\n\n[Nov  4 10:44:18.975] [0;32mI (99) boot:  5 fs_1             SPIFFS           01 82 00350000 00040000 00000000[0m\n\n[Nov  4 10:44:19.006] [0;32mI (107) boot: End of partition table[0m\n\n[Nov  4 10:44:19.006] [0;32mI (111) boot: OTA data 0: seq 0x00000001, st 0x10, CRC 0x157a2b85, valid? 1[0m\n\n[Nov  4 10:44:19.006] [0;32mI (119) boot: OTA data 1: seq 0x00000000, st 0x00, CRC 0x00000000, valid? 0[0m\n\n[Nov  4 10:44:19.006] [0;32mI (127) boot: Disabling RNG early entropy source...[0m\n\n[Nov  4 10:44:19.006] [0;32mI (132) esp_image: segment 0: paddr=0x00010020 vaddr=0x3f400020 size=0x4a334 (303924) map[0m\n\n[Nov  4 10:44:19.146] [0;32mI (247) esp_image: segment 1: paddr=0x0005a35c vaddr=0x3ffc0000 size=0x02ce0 ( 11488) load[0m\n\n[Nov  4 10:44:19.146] [0;32mI (252) esp_image: segment 2: paddr=0x0005d044 vaddr=0x40080000 size=0x00400 (  1024) load[0m\n\n[Nov  4 10:44:19.146] [0;32mI (255) esp_image: segment 3: paddr=0x0005d44c vaddr=0x40080400 size=0x02bc4 ( 11204) load[0m\n\n[Nov  4 10:44:19.146] [0;32mI (268) esp_image: segment 4: paddr=0x00060018 vaddr=0x400d0018 size=0xf0640 (984640) map[0m\n\n[Nov  4 10:44:19.474] [0;32mI (615) esp_image: segment 5: paddr=0x00150660 vaddr=0x40082fc4 size=0x11638 ( 71224) load[0m\n\n[Nov  4 10:44:19.505] [0;32mI (644) esp_image: segment 6: paddr=0x00161ca0 vaddr=0x400c0000 size=0x00034 (    52) load[0m\n\n[Nov  4 10:44:19.552] [0;32mI (657) cpu_start: Pro cpu up.[0m\n\n[Nov  4 10:44:19.552] [0;32mI (657) cpu_start: Single core mode[0m\n\n[Nov  4 10:44:19.552] [0;32mI (657) heap_init: Initializing. RAM available for dynamic allocation:[0m\n\n[Nov  4 10:44:19.552] [0;32mI (661) heap_init: At 3FFAFF10 len 000000F0 (0 KiB): DRAM[0m\n\n[Nov  4 10:44:19.552] [0;32mI (667) heap_init: At 3FFD8078 len 00007F88 (31 KiB): DRAM[0m\n\n[Nov  4 10:44:19.552] [0;32mI (673) heap_init: At 3FFE0440 len 00003BC0 (14 KiB): D/IRAM[0m\n\n[Nov  4 10:44:19.552] [0;32mI (679) heap_init: At 3FFE4350 len 0001BCB0 (111 KiB): D/IRAM[0m\n\n[Nov  4 10:44:19.552] [0;32mI (686) heap_init: At 400945FC len 0000BA04 (46 KiB): IRAM[0m\n\n[Nov  4 10:44:19.567] [0;32mI (692) cpu_start: Pro cpu start user code[0m\n\n[Nov  4 10:44:19.567] [0;32mI (38) cpu_start: Starting scheduler on PRO CPU.[0m\n\n[Nov  4 10:44:19.583] m     }  }          0x3ffdf224 Mongoose init\n\n[Nov  4 10:44:19.583] esp32_mgos_init      default 1.0 (20171101-110218/1.19.5@92a0b527)\n[Nov  4 10:44:19.599] esp32_mgos_init      Mongoose OS 2017110111 (20171101-110235/???)\n[Nov  4 10:44:19.599] esp32_mgos_init      ESP-IDF v1.0-2569-gc60279b\n[Nov  4 10:44:19.599] esp32_mgos_init      Boot partition: app_0; flash: 4M; RAM: 161512 total, 123396 free\n[Nov  4 10:44:19.614] mgos_vfs_dev_open    esp32part ({\"label\": \"fs_0\", \"subtype\": 130}) -&gt; 0x3ffdf6b0\n[Nov  4 10:44:19.630] mgos_vfs_mount       Mount SPIFFS @ / (dev 0x3ffdf6b0, opts {\"encr\": false}) -&gt; 0x3ffdf6c0\n[Nov  4 10:44:19.708] mgos_vfs_mount       /: size 233681, used: 102659, free: 131022\n[Nov  4 10:44:19.786] mgos_sys_config_init MAC: 30AEA40550A8\n[Nov  4 10:44:19.786] mgos_sys_config_init WDT: 30 seconds\n[Nov  4 10:44:19.786] mgos_mdns_init       Listening on udp://:5353\n[Nov  4 10:44:19.801] mgos_mdns_hal_join_g Joining multicast group 224.0.0.251\n[Nov  4 10:44:19.801] mgos_mdns_hal_join_g udp_join_multigrup failed!\n[Nov  4 10:44:19.817] mgos_i2c_create      I2C GPIO init ok (SDA: 32, SCL: 33)\n[Nov  4 10:44:19.817] mgos_aws_init        AWS Greengrass enable (0)\n[Nov  4 10:44:19.833] mgos_bt_common_init  Bluetooth is disabled\n[Nov  4 10:44:19.833] mgos_wifi_set_config WiFi mode: STA\n[Nov  4 10:44:19.833] esp32_wifi_set_mode  WiFi mode: STA\n[Nov  4 10:44:19.848] E (581) wifi: esp_wifi_set_mode 779 wifi is not init\n[Nov  4 10:44:19.864] I (581) wifi: wifi firmware version: 7bd4899\n[Nov  4 10:44:19.864] I (591) wifi: config NVS flash: enabled\n[Nov  4 10:44:19.864] I (591) wifi: config nano formating: disabled\n[Nov  4 10:44:19.864] [0;32mI (601) system_api: Base MAC address is not set, read default base MAC address from BLK0 of EFUSE[0m\n[Nov  4 10:44:19.879] [0;32mI (611) system_api: Base MAC address is not set, read default base MAC address from BLK0 of EFUSE[0m\n[Nov  4 10:44:19.895] I (621) wifi: Init dynamic tx buffer num: 32\n[Nov  4 10:44:19.895] I (631) wifi: Init data frame dynamic rx buffer num: 64\n[Nov  4 10:44:19.895] I (631) wifi: Init management frame dynamic rx buffer num: 64\n[Nov  4 10:44:19.911] I (641) wifi: wifi driver task: 3ffe3d34, prio:23, stack:4096\n[Nov  4 10:44:19.911] I (651) wifi: Init static rx buffer num: 10\n[Nov  4 10:44:19.911] I (651) wifi: Init dynamic rx buffer num: 0\n[Nov  4 10:44:19.926] I (661) wifi: Init rx ampdu len mblock:7\n[Nov  4 10:44:19.926] I (661) wifi: Init lldesc rx ampdu entry mblock:4\n[Nov  4 10:44:19.942] I (671) wifi: wifi power manager task: 0x3ffe9528 prio: 21 stack: 2560\n[Nov  4 10:44:19.942] I (681) wpa: WPA2 ENTERPRISE VERSION: [v2.0] disable\n[Nov  4 10:44:19.942] \n[Nov  4 10:44:19.957] mgos_wifi_setup_sta  WiFi STA: Connecting to PE-2\n[Nov  4 10:44:19.957] E (691) wifi: esp_wifi_connect 836 wifi not start\n[Nov  4 10:44:19.989] [0;32mI (721) phy: phy_version: 362.0, 61e8d92, Sep  8 2017, 18:48:11, 0, 0[0m\n\n[Nov  4 10:44:19.989] I (721) wifi: mode : sta (30:ae:a4:05:50:a8)\n[Nov  4 10:44:20.004] mgos_http_server_ini HTTP server started on [80]\n[Nov  4 10:44:20.004] mg_rpc_channel_mqtt  0x3ffea64c esp32_0550A8/rpc/#\n[Nov  4 10:44:20.020] mg_rpc_channel_uart  0x3ffea9c8 UART0\n[Nov  4 10:44:20.020] mgos_init            Init done, RAM: 160748 total, 87480 free, 87480 min free\n[Nov  4 10:44:20.145] Flash button is configured on GPIO pin  0 \n[Nov  4 10:44:20.145] Press the flash button now! \n[Nov  4 10:44:20.145] mongoose_poll        New heap free LWM: 76444\n[Nov  4 10:44:20.160] mgos_net_on_change_c WiFi STA: connecting\n[Nov  4 10:44:21.330] I (2061) wifi: n:11 0, o:1 0, ap:255 255, sta:11 0, prof:1\n[Nov  4 10:44:22.173] I (2901) wifi: state: init -&gt; auth (b0)\n[Nov  4 10:44:22.173] I (2911) wifi: state: auth -&gt; assoc (0)\n[Nov  4 10:44:22.188] I (2921) wifi: state: assoc -&gt; run (10)\n[Nov  4 10:44:22.204] I (2941) wifi: connected with PE-2, channel 11\n[Nov  4 10:44:22.219] mgos_net_on_change_c WiFi STA: connected\n[Nov  4 10:44:22.391] [0;32mI (3131) event: sta ip: 192.168.3.24, mask: 255.255.255.0, gw: 192.168.3.1[0m\n[Nov  4 10:44:22.407] mgos_net_on_change_c WiFi STA: ready, IP 192.168.3.24, GW 192.168.3.1, DNS 8.8.8.8\n[Nov  4 10:44:22.422] mgos_mqtt_global_con MQTT connecting to a2wstxxxxxxxxxx.iot.us-west-2.amazonaws.com:8883\n[Nov  4 10:44:22.453] mongoose_poll        New heap free LWM: 75124\n[Nov  4 10:44:22.453] mongoose_poll        New heap free LWM: 74280\n[Nov  4 10:44:23.124] SW ECDSA verify curve 3 hash_len 32 sig_len 72\n[Nov  4 10:44:23.982] SW ECDSA verify curve 3 hash_len 64 sig_len 71\n[Nov  4 10:44:24.809] SW ECDH curve 3\n[Nov  4 10:44:25.199] I (5931) wifi: pm start, type:0\n[Nov  4 10:44:25.199] \n[Nov  4 10:44:26.073] mongoose_poll        New heap free LWM: 61344\n[Nov  4 10:44:26.073] mgos_sntp_query      SNTP query to pool.ntp.org\n[Nov  4 10:44:26.151] mgos_sntp_ev         SNTP reply from 123.108.200.124: time 1509772461.460180, local 6.578079, delta 1509772454.882101\n[Nov  4 10:44:26.603] mgos_mqtt_ev         MQTT TCP connect ok (0)\n[Nov  4 10:44:26.931] mgos_mqtt_ev         MQTT CONNACK 0\n[Nov  4 10:44:26.931] do_subscribe         Subscribing to 'esp32_0550A8/rpc'\n[Nov  4 10:44:26.946] do_subscribe         Subscribing to 'esp32_0550A8/rpc/#'\n</code></pre>\n\n<p>And when I click the Boot button on my esp32, I get the following log</p>\n\n<pre><code>[Nov  4 10:44:40.083] Published: yes topic: esp32_0550A8/button_pressed message: {\"free_ram\":80904,\"total_ram\":160340} \n</code></pre>\n\n<p>Please note:\nI have received the first, \"AWS Notification - Subscription Confirmation\" email. I clicked on the \"Confirm Subscription\" on which, my browser windows showed \"You have subscribed xxxxx@gmail.com to the topic xyz\". </p>\n\n<p>The problem is, I receive no other notification after pressing the Boot button on the ESP apart from the message on my MOS UI \"Published: yes topic: esp32_0550A8/button_pressed message: {\"free_ram\":80904,\"total_ram\":160340}\"</p>\n"
    }, {
        "tags": [
            "python",
            "mqtt",
            "iot",
            "paho"
        ],
        "is_answered": false,
        "view_count": 647,
        "favorite_count": 0,
        "score": 0,
        "last_activity_date": 1519760019,
        "creation_date": 1519760019,
        "question_id": 49016583,
        "link": "https://stackoverflow.com/questions/49016583/paho-mqtt-client-is-publishing-all-messages-at-once-rather-than-one-by-one",
        "title": "Paho Mqtt Client is publishing all messages at once rather than one by one",
        "body": "<p>I am collecting telemetry data from my sensor node to my raspberry pi through mqtt.There are 2 MQTT clients conected to a broker on localhost and broker on my VPS. The pi collects the data from the sensor node and sends it to my VPS server.</p>\n\n<p>If the pi goes offline it will collect all the values in a local database and then, after reconnection, its supposed to send the messages one by one to the VPS.</p>\n\n<p>Normally the messages are getting published one by one. But when it disconnects &amp; then reconnects it creates a thread \"redundancywork()\" and by the code it is supposed to publish messages one by one. </p>\n\n<p>But this is what ends up happening:</p>\n\n<pre><code>2018-02-28 00:29:00.304932,4.0,3.0,2.0,1.0,0.0\n2018-02-28 00:29:01.074249,4.0,3.0,2.0,1.0,0.0\n2018-02-28 00:29:01.496664,4.0,3.0,2.0,1.0,0.0\n2018-02-28 00:29:01.912588,4.0,3.0,2.0,1.0,0.0\n2018-02-28 00:29:02.264558,4.0,3.0,2.0,1.0,0.0\nMessage Published\nMessage Published\nMessage Published\nMessage Published\nMessage Published\n</code></pre>\n\n<p>It prints out the rows but publishes only AFTER the loop ends even though the publish function is within the loop. And after that it publishes normally one by one. The message does not get queued during disconnection as I set it that way. This is my code:</p>\n\n<pre><code>from sqlalchemy import create_engine\nfrom sqlalchemy.orm import sessionmaker\nfrom model import SN1, Base\nfrom datetime import datetime\nimport paho.mqtt.client as mqtt\nimport threading\nimport time\nimport os\n\n\n#Topics to Subscribe to as (Topic Name, QOS Level)\ntopics = [(\"SN1\",2)]\nbroker = \"localhost\"\nportno = 1883\n\n\n#Disconnect CHecker\nDISCONNECT = \"NO\"\n\n\n##Redundancy Stuff\nredundancydb_url = 'sqlite:///redundancy.db'\nredunandcy_engine = create_engine(redundancydb_url)\nBase.metadata.bind = redunandcy_engine\nif os.path.isfile(\"redundancy.db\") is False:\n    Base.metadata.create_all(redunandcy_engine)\nredunandcysession = sessionmaker(bind = redunandcy_engine)\nredundancydb = redunandcysession()\n\n\n'''\nHelper Methods\n'''\n\n#ToSubscribe\ndef on_connect(client, userdata, flags, rc):\n    global DISCONNECT\n    print(\"Connected with result code \"+str(rc))\n    # Subscribing in on_connect() means that if we lose the connection and\n    # reconnect then subscriptions will be renewed.\n    client.subscribe(topics)\n\n    #CHECK IF VPS CLIENT\n    if client._client_id == \"VPS Client\" and DISCONNECT == \"YES\":\n        DISCONNECT = \"NO\"\n        time.sleep(5)\n        print(\"Redundancy Work Begins\")\n        thread = threading.Thread(target = redundancywork())\n        thread.start()\n\n#Message Processing\ndef on_message(client, userdata, msg):\n    decoded = msg.payload.decode(\"utf-8\")\n    nowtime = datetime.now()\n    message = decoded.split(\",\")\n    print(message[0])\n    global DISCONNECT\n    global vpsclient\n\n\n    #MESSAGE SENDING\n    if message[0] == \"SN1\":\n        if DISCONNECT == \"NO\":\n            message_payload = \"{},{},{},{},{},{}\".format(nowtime, message[1], message[2], message[3], message[4], message[5])\n            print(message_payload)\n            vpsclient.publish(\"SN1\", payload = message_payload, qos = 1)\n        if DISCONNECT == \"YES\":\n            newvalues = SN1(nowtime, message[1], message[2], message[3], message[4], message[5])\n            redundancydb.add(newvalues)\n            redundancydb.commit()\n            print(\"Inserted to Redundancy DB\")\n\ndef on_publish(client, userdata,mid):\n    print(\"Message Published\")\n\n#Disconnection Handler\ndef on_disconnect(client, userdata, rc):\n    print(\"Client {} has disconnected From Broker\".format(client._client_id))\n    global DISCONNECT\n    DISCONNECT = \"YES\"\n\ndef redundancywork():\n    #Get First Value of DB\n    global vpsclient\n\n    rdbsession = sessionmaker(bind = redunandcy_engine)\n    rdb = rdbsession()\n    first = rdb.query(SN1).first()\n    print(first)\n\n    #Check if length of firstrow is not 0\n    while first is not None:\n        message_payload = \"{},{},{},{},{},{}\".format(first.date, first.airtemp, first.humidity, first.watertemp, first.light, first.ph)\n        print(message_payload)\n        vpsclient.publish(\"SN1\", payload = message_payload, qos = 1)\n        #DELETE ROW\n        rdb.delete(first)\n        rdb.commit()\n\n        #FETCH ROW\n        first = rdb.query(SN1).first()\n        time.sleep(2)\n\n'''\nMain Function\n'''\n\n\nif __name__ == \"__main__\":\n\n    #Local Broker Client\n    client = mqtt.Client()\n    client._client_id = \"Local Client\"\n    client.on_connect = on_connect\n    client.on_message = on_message\n    client.on_publish = on_publish\n    client.on_disconnect = on_disconnect\n    client.connect(broker, portno, keepalive = 20)\n\n    #Vps Broker Client\n    vpsbroker = \"*\"\n    vpsportno = 1883\n    global vpsclient\n    vpsclient = mqtt.Client()\n    vpsclient._client_id = \"VPS Client\"\n    vpsclient.on_connect = on_connect\n    vpsclient.on_publish = on_publish\n    vpsclient.on_disconnect = on_disconnect\n    vpsclient.max_inflight_messages_set(20)\n    vpsclient.connect(vpsbroker, vpsportno, keepalive = 20)\n\n\nwhile True:\n    try:\n        client.loop_start()\n        vpsclient.loop_start()\n    except Exception:\n        continue\n</code></pre>\n"
    }, {
        "tags": [
            "websocket",
            "mqtt",
            "iot",
            "mosquitto"
        ],
        "is_answered": true,
        "view_count": 1118,
        "favorite_count": 0,
        "score": 0,
        "last_activity_date": 1518181553,
        "creation_date": 1518093492,
        "last_edit_date": 1518180753,
        "question_id": 48685735,
        "link": "https://stackoverflow.com/questions/48685735/how-to-share-topics-between-two-protocols-in-mosquitto",
        "title": "How to share topics between two protocols in mosquitto",
        "body": "<p>I am using mosquitto mqtt both with MQTT protocol and MQTT over websockets protocol. Some client use mqtt protocol and some uses websocket protocol due to their limitations. MQTT port is 1883 and websocket port is 8083. The problem is that I want to share all the topics on both port i.e. on websocket and MQTT. What type of configurations i should do in my MQTT broker or any other solution? </p>\n\n<p>In other words I want to listen to all topics on websocket(port 8083) which are published on mqtt(port 1883) on same broker and vise versa.</p>\n\n<p><strong>mosquitto.conf</strong> file is following</p>\n\n<pre><code>allow_anonymous false\npassword_file /etc/mosquitto/passwd\n\nlistener 8083 127.0.0.1\nprotocol websockets\n</code></pre>\n"
    }, {
        "tags": [
            "node.js",
            "typeerror",
            "iot",
            "node-red",
            "google-cloud-pubsub"
        ],
        "is_answered": true,
        "view_count": 1993,
        "favorite_count": 1,
        "score": 0,
        "last_activity_date": 1517283625,
        "creation_date": 1514206003,
        "last_edit_date": 1514271292,
        "question_id": 47968777,
        "link": "https://stackoverflow.com/questions/47968777/google-cloud-pubsubtypeerror-state-topic-publish-is-not-a-function",
        "title": "google-cloud-pubsubTypeError: state.topic.publish is not a function",
        "body": "<p>This is image from node red in terminal</p>\n\n<p><a href=\"https://i.stack.imgur.com/jXFuA.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/jXFuA.png\" alt=\"enter image description here\"></a></p>\n\n<p>I am working in the sphere of IoT, and want to push message to Pub/Sub in Google, but every time when I run my node-Red, I've got the following error:</p>\n\n<blockquote>\n  <p>25 Dec 18:40:49 - [error] [google-cloud-pubsub out:b2451409.071148] TypeError: state.topic.publish is not a function*</p>\n</blockquote>\n\n<p>As a source code, I used pub/sub contribution in github, link:\n<a href=\"https://github.com/GoogleCloudPlatform/node-red-contrib-google-cloud/blob/master/pubsub.js\" rel=\"nofollow noreferrer\">https://github.com/GoogleCloudPlatform/node-red-contrib-google-cloud/blob/master/pubsub.js</a> \nIt seems that code works fine with credentials and it does create new-topic in Google,in the case, when topic is not present in the cloud, however the message is not published to the topic. In the case of repeating messages in particular interval, the problem above is arising.\nDoes anyone know how to solve this problem?</p>\n"
    }, {
        "tags": [
            "mqtt",
            "iot",
            "intel-edison"
        ],
        "is_answered": true,
        "view_count": 73,
        "favorite_count": 0,
        "score": 0,
        "last_activity_date": 1516391784,
        "creation_date": 1446069177,
        "last_edit_date": 1516391784,
        "question_id": 33402269,
        "link": "https://stackoverflow.com/questions/33402269/cylon-with-mqtt-passing-sensor-data",
        "title": "Cylon with MQTT Passing Sensor Data",
        "body": "<p>This is probably easy but I could not locate a solution online. I am working on a weather station project with Cylon and MQTT and attempting to pass a variable into an MQTT push but it is passing the literal text. The publish is successful but it just has \"msg\" instead of the sensor data. Here is the snippet..</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-js lang-js prettyprint-override\"><code>Cylon.robot({\r\n  connections: {\r\n    edison: { adaptor: 'intel-iot' }\r\n  },\r\n\r\n  devices: {\r\n    bmp180: { driver: 'bmp180' }\r\n  },\r\n\r\n  work: function(my) {\r\n    my.bmp180.getTemperature(function(err, val) {\r\n      if (err) {\r\n        console.log(err);\r\n        return;\r\n      }\r\n\r\n      console.log(\"\\tTemp: \" + val.temp + \" C\");\r\n        \r\n        var msg = { \"temperature\" : val.temp,\r\n                    \"pressure\" : val.press,\r\n                    \"altitude\" : val.alt\r\n                    };\r\n        var msgPressure = { \"pressure\" : val.press };\r\n        var msgAltitude = { \"altitude\" : val.alt };\r\n        device\r\n            .on('connect', function() {\r\n                console.log('connect');\r\n                device.subscribe('weather/push');\r\n                device.publish('weather/push', JSON.stringify({ msg: 1}));\r\n                });\r\n\r\n        device\r\n            .on('message', function(topic, payload) {\r\n                console.log('message', topic, payload.toString());\r\n                });\r\n        \r\n        \r\n    });\r\n}\r\n      \r\n}).start();</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p>Thank you</p>\n"
    }, {
        "tags": [
            ".net",
            "azure",
            "cloud",
            "iot",
            "azure-iot-hub"
        ],
        "is_answered": true,
        "view_count": 204,
        "favorite_count": 0,
        "score": 0,
        "last_activity_date": 1516298326,
        "creation_date": 1516294555,
        "question_id": 48326540,
        "link": "https://stackoverflow.com/questions/48326540/delay-specific-iothub-messages",
        "title": "Delay Specific IoTHub Messages",
        "body": "<p>When sending a message to IoTHub to be passed down to an IoT device. Is it possible to tell IoTHub to delay the delivery of specific messages?</p>\n\n<p>From looking at the Microsoft documentation I can see it allows you to throttle messages, however I am after being able to do this only for specific messages so unless my understanding of how the throttling works, it would not suit my purpose.</p>\n\n<p>Is this built into IoTHub or would I need to control the timing of messages from within my own application?</p>\n"
    }, {
        "tags": [
            "iot",
            "esp8266",
            "micropython"
        ],
        "is_answered": false,
        "view_count": 677,
        "favorite_count": 0,
        "score": 0,
        "last_activity_date": 1515567136,
        "creation_date": 1515476350,
        "question_id": 48162015,
        "link": "https://stackoverflow.com/questions/48162015/how-to-set-max-connections-in-ap-configuration-of-esp8266",
        "title": "How to set max connections in AP configuration of esp8266?",
        "body": "<p>I want to connect only one client at a time with esp8266. Second client trying to connect should disconnect immediately.But I can't find 'max_connection' like parameter in</p>\n\n<p><code>ap.configuration()</code></p>\n\n<p>Allowed parameters are essid, password, channel, authmode\nIs there a way to achieve this ?</p>\n"
    }, {
        "tags": [
            "java",
            "mqtt",
            "iot",
            "esp8266",
            "mosquitto"
        ],
        "is_answered": true,
        "view_count": 190,
        "favorite_count": 0,
        "score": 1,
        "last_activity_date": 1513420142,
        "creation_date": 1513206308,
        "last_edit_date": 1513230406,
        "question_id": 47803450,
        "link": "https://stackoverflow.com/questions/47803450/is-it-possible-with-org-eclipse-paho-client-mqttv3-1-2-0-library-in-java-to-ge",
        "title": "Is it possible with &quot;org.eclipse.paho.client.mqttv3-1.2.0&quot; Library in Java to get more than one MQTT message at a time?",
        "body": "<p>I'm new here at Stackoverflow and have a question.</p>\n\n<p>I want to create an IoT weather station with a ESP8266 that has two sensors (humidity, temperature) and send the data to a broker (Mosquitto) running on a Pi. Beside the easy way to fetch and visualize the data with nodered I want to program a desktop app in Java.</p>\n\n<p>I use the \"org.eclipse.paho.client.mqttv3-1.2.0\" package to create a client and fetch the messages. With one topic (e.g. \"/test/temperature\") it's easily possible to receive the temperature values. But if I add a second client for humidity, it's not possible to receive the two at the same time. When two clients are implemented just the later called client gets its values.</p>\n\n<p>I solved the problem by sending the values from the ESP8266 with a little time shift. But is there a way to fetch to messages at the same time? I thought about Threads but it's not working.</p>\n\n<p>Has anyone had already the same problem or got an idea?</p>\n\n<p>Thanks in advance and don't hesitate to ask further questions.</p>\n\n<p>Cheers.</p>\n\n<p>Robin </p>\n"
    }, {
        "tags": [
            "raspberry-pi",
            "rabbitmq",
            "cloud",
            "iot"
        ],
        "is_answered": false,
        "view_count": 102,
        "favorite_count": 0,
        "score": 0,
        "last_activity_date": 1512546924,
        "creation_date": 1512489344,
        "question_id": 47657680,
        "link": "https://stackoverflow.com/questions/47657680/rabbitmq-for-iot-using-federated-plugin",
        "title": "RabbitMQ for IoT using Federated Plugin?",
        "body": "<p>I am confused about RabbitMQ and the federated plugin.  Therefore, I seem unable to set it up to work.</p>\n\n<p>Let's say I have 'n' number of raspberry pi s  (rpi1, rpi2, rpi3... rpin)</p>\n\n<p>I want them all to send messages to a cloud server (c1).</p>\n\n<p>They will have intermittent connections to the internet so I want them all to queue their messages locally before sending to the server.  Then when they come online to send their messages to c1 so that I can retrieve them off a queue.  I want all of the messages to go to one queue.</p>\n\n<p>I set up rabbitmq on all of the hosts.</p>\n\n<p>Here is what I have done:</p>\n\n<p>I configure upstreams on all of the raspberry pi s</p>\n\n<pre><code>rabbitmqctl set_parameter federation-upstream my-upstream '{\"uri\":\"amqp://user:pwd@c1.foo.com\",\"expires\":3600000}'\nrabbitmqctl set_policy --apply-to exchanges federate-me \"^amq\\.\" '{\"federation-upstream-set\":\"all\"}'\n</code></pre>\n\n<p>The exchanges seem to set themselves up on the server</p>\n\n<p>I cannot seem to figure out how to add a message to a rpi queue and have it show up on the server.</p>\n\n<p>What am I missing? </p>\n\n<ol>\n<li>Is federation what I want? </li>\n<li>what do I have to do on c1 to get it to take incoming messages and drop them into a queue?</li>\n<li>what do I have to do on the rpi s to have them send their messages to the server</li>\n<li>Is this a good path for what I am attempting?</li>\n</ol>\n\n<p>Totally lost.  Thanks for your help!!</p>\n"
    }, {
        "tags": [
            "javascript",
            "mqtt",
            "iot"
        ],
        "is_answered": true,
        "view_count": 6707,
        "favorite_count": 0,
        "score": 0,
        "last_activity_date": 1510164070,
        "creation_date": 1510161267,
        "last_edit_date": 1510163011,
        "question_id": 47185787,
        "link": "https://stackoverflow.com/questions/47185787/mqtt-js-multiple-subscription",
        "title": "MQTT.js multiple subscription",
        "body": "<p>I'm playing around with MQTT and MQTT.js. I have running a MQTT broker and now I want to subscribe to multiple topics. One topic is no problem, but multiple.</p>\n\n<p>I have these two topics:</p>\n\n<pre><code>'sensor/esp8266-1/humidity'\n'sensor/esp8266-1/temperature'\n</code></pre>\n\n<p>and I with this piece of code I subscribe on these two topics</p>\n\n<pre><code>var mqtt = require('mqtt');\nvar client  = mqtt.connect('mqtt://10.0.0.18');\n\n\nclient.subscribe('sensor/esp8266-1/humidity');\nclient.subscribe('sensor/esp8266-1/temperature');\n\nclient.on('message', function(topic, message, packet) {\n    console.log(packet)\n});\n</code></pre>\n\n<p>With this code console.log returns me the following</p>\n\n<pre><code>Packet {\n  cmd: 'publish',\n  retain: false,\n  qos: 0,\n  dup: false,\n  length: 35,\n  topic: 'sensor/esp8266-1/temperature',\n  payload: &lt;Buffer 32 31 2e 32 30&gt; }\nPacket {\n  cmd: 'publish',\n  retain: false,\n  qos: 0,\n  dup: false,\n  length: 32,\n  topic: 'sensor/esp8266-1/humidity',\n  payload: &lt;Buffer 34 31 2e 30 30&gt; }\n</code></pre>\n\n<p>This looks at the first very good, but how can I get the temperature/humidity data from that?</p>\n\n<p>I tried it with this</p>\n\n<pre><code>console.log(packet.payload.toString())\n</code></pre>\n\n<p>But now I got every time temperature and humidty without which I know what number means.</p>\n\n<p>In the End I would like to get two variables (temperature/humidity) fill with the right data. Later I want to concat the two variables and store these to an SQL Database.</p>\n"
    }, {
        "tags": [
            "android",
            "amazon-web-services",
            "mqtt",
            "iot",
            "aws-iot"
        ],
        "is_answered": false,
        "view_count": 487,
        "favorite_count": 0,
        "score": 2,
        "last_activity_date": 1507718391,
        "creation_date": 1507718391,
        "question_id": 46686131,
        "link": "https://stackoverflow.com/questions/46686131/aws-iot-message-not-arrived-with-multiple-topics-subscribed",
        "title": "AWS IoT message not arrived with multiple topics subscribed",
        "body": "<p>When AWSIotMqttManager is connected, i subscribe to shadow topics</p>\n\n<pre><code>mMqttManager.subscribeToTopic(\"$aws/things/4/shadow/update/delta\", AWSIotMqttQos.QOS1, new AWSIotMqttNewMessageCallback() {\n        @Override\n        public void onMessageArrived(String topic, byte[] data) {\n                Log.d(\"DEBUG\", \"onMessageArrived: \" + topic);\n        }\n});\n\nmMqttManager.subscribeToTopic(\"$aws/things/4/shadow/get/accepted\", AWSIotMqttQos.QOS1, new AWSIotMqttNewMessageCallback() {\n        @Override\n        public void onMessageArrived(String topic, byte[] data) {\n                Log.d(\"DEBUG\", \"onMessageArrived: \" + topic);\n        }\n});\n</code></pre>\n\n<p>and then publish an empty message, as <a href=\"http://docs.aws.amazon.com/iot/latest/developerguide/thing-shadow-mqtt.html#get-pub-sub-topic\" rel=\"nofollow noreferrer\">stated in docs</a></p>\n\n<pre><code>mMqttManager.publishString(\"\", \"$aws/things/4/shadow/get\", AWSIotMqttQos.QOS1);\n</code></pre>\n\n<p>I get no callback. </p>\n\n<p>When i remove subscription to delta, i got it. </p>\n\n<p>Why? How to to subscribe on two topics on app start?</p>\n"
    }, {
        "tags": [
            "java",
            "amazon-web-services",
            "mqtt",
            "iot",
            "aws-iot"
        ],
        "is_answered": true,
        "view_count": 646,
        "favorite_count": 0,
        "score": 3,
        "last_activity_date": 1507301946,
        "creation_date": 1507276980,
        "question_id": 46601079,
        "link": "https://stackoverflow.com/questions/46601079/aws-iot-message-delivery",
        "title": "Aws IoT Message Delivery",
        "body": "<p>I am looking into Amazon IoT as a transport mechanism for mobile devices periodically measuring data (usually every N minutes, with N being anywhere between 2 and 32 minutes). With MQTT, I can utilize Amazon's broker to publish finished measurement results to subscribers with QoS=1. Let's also assume that my sole subscriber is just another device listening on wildcard topic (eg. abc/#) and storing published messages into a local database.</p>\n\n<p>But now it's also possible that:</p>\n\n<pre><code>the publishing mobile devices have spotty/bad/no connection to the cell network,\nthe subscriber dies (reboots, software failure, hardware failure, maintenance, etc.)\n</code></pre>\n\n<p>Assuming I use the official Java SDK . What would happen to data published during these times when at least either of them is offline? Will the subscriber get all the messages it has been missing out on upon reconnect?</p>\n\n<p>Also: does this depend on the protocol in question? For testing purposes, we're using WebSockets, but later development/production, we'd prefer MQTT over SSL. </p>\n"
    }, {
        "tags": [
            "ibm-cloud",
            "iot",
            "watson"
        ],
        "is_answered": true,
        "view_count": 133,
        "favorite_count": 1,
        "score": 0,
        "last_activity_date": 1506156761,
        "creation_date": 1506148392,
        "question_id": 46376781,
        "link": "https://stackoverflow.com/questions/46376781/unknown-client-trying-to-connect-watson-iot-device-continiously",
        "title": "unknown client trying to connect watson IoT device continiously",
        "body": "<p>i had connected Watson IoT-sensor-Simulator to Watson IoT device by entering device credentials, a few days back and closed the connection.</p>\n\n<p>now the device is continuously connected and receiving messages as\"The client id was reused\" thereby increasing the data usage rate .</p>\n\n<p>I need help in disconnecting the connection.\n<a href=\"https://i.stack.imgur.com/lcnxx.png\" rel=\"nofollow noreferrer\">message</a></p>\n"
    }, {
        "tags": [
            "java",
            "mqtt",
            "iot",
            "paho"
        ],
        "is_answered": true,
        "view_count": 572,
        "favorite_count": 0,
        "score": -1,
        "last_activity_date": 1505321230,
        "creation_date": 1505317028,
        "last_edit_date": 1505320843,
        "question_id": 46201624,
        "link": "https://stackoverflow.com/questions/46201624/how-to-access-the-payload-of-the-message-arrived-of-the-callback-method-message",
        "title": "How to access the payload of the message arrived of the callback method (messageArrived) in the main method Eclipse Paho?",
        "body": "<p>Problem statement:- I am trying to automate a MQTT flow, for that I a need to publish and subscribe to multiple topics but in a sequential order. The trick part is that the message received from the first publish has some value which will be passed in the next sub/pub commands.</p>\n\n<p>For eg. </p>\n\n<ol>\n<li>Sub to topicA/abc</li>\n<li>Pub to topicA/abc</li>\n<li>Message received on topicA/abc is xyz</li>\n<li>sub to topic topicA/xyz</li>\n<li>pub to topic topicA/xyz</li>\n</ol>\n\n<p>I am able to receive the message on the first topic but I am not getting how to access the payload of the received message in the main method and pass and attach it to the next topic for next sub.</p>\n\n<p>Is there a way to get the retrieved the message payload from messageArrived callback method to the main method where is client instance is created?</p>\n\n<p>Note:- I am using a single client for publish and subscribe. </p>\n\n<p>kindly help me out as I have ran out of options and methods to do so.</p>\n\n<p>Edited:-</p>\n\n<p>Code snippet</p>\n\n<p>Main class</p>\n\n<pre><code>public class MqttOverSSL {\nString deviceId;\nMqttClient client = null;\n\npublic MqttOverSSL() {\n\n}\n\npublic MqttOverSSL(String deviceId) throws MqttException, InterruptedException {\n    this.deviceId = deviceId;\n    MqttConnection mqttConObj = new MqttConnection();\n    this.client = mqttConObj.mqttConnection();\n}\n\npublic void getLinkCodeMethod() throws MqttException, InterruptedException {\n\n    client.subscribe(\"abc/multi/\" + deviceId + \"/linkcode\", 0);\n    publish(client, \"abc/multi/\" + deviceId + \"/getlinkcode\", 0, \"\".getBytes());\n\n\n}\n\n}\n</code></pre>\n\n<p>Mqtt Claback impl:-</p>\n\n<pre><code>public class SimpleMqttCallBack implements MqttCallback {\n\n  String arrivedMessage;\n\n  @Override\n  public void connectionLost(Throwable throwable) {\n    System.out.println(\"Connection to MQTT broker lost!\");\n  }\n\n  @Override\n  public void messageArrived(String s, MqttMessage mqttMessage) throws Exception {\n\n    arrivedMessage = mqttMessage.toString();\n\n    System.out.println(\"Message received:\\t\" + arrivedMessage);\n\n    linkCode(arrivedMessage);\n  }\n\n  @Override\n  public void deliveryComplete(IMqttDeliveryToken iMqttDeliveryToken) {\n    System.out.println(\"Delivery complete callback: Publish Completed \"+ Arrays.toString(iMqttDeliveryToken.getTopics()));\n  }\n\n\n  public void linkCode(String arrivedMessage) throws MqttException {\n    System.out.println(\"String is \"+ arrivedMessage);\n    Gson g = new Gson();\n    GetCode code = g.fromJson(arrivedMessage, GetCode.class);\n    System.out.println(code.getLinkCode());\n  }\n\n}\n</code></pre>\n\n<p>Publisher class:- </p>\n\n<pre><code>public class Publisher {\n    public static void publish(MqttClient client, String topicName, int qos, byte[] payload) throws MqttException {\n\n        String time = new Timestamp(System.currentTimeMillis()).toString();\n        log(\"Publishing at: \"+time+ \" to topic \\\"\"+topicName+\"\\\" qos \"+qos);\n\n        // Create and configure a message\n        MqttMessage message = new MqttMessage(payload);\n        message.setQos(qos);\n\n        // Send the message to the server, control is not returned until\n        // it has been delivered to the server meeting the specified\n        // quality of service.\n        client.publish(topicName, message);\n    }\n\n    static private void log(String message) {\n        boolean quietMode   = false;\n        if (!quietMode) {\n            System.out.println(message);\n        }\n    }\n}\n</code></pre>\n"
    }, {
        "tags": [
            "javascript",
            "communication",
            "mqtt",
            "paho",
            "iot"
        ],
        "is_answered": true,
        "view_count": 1575,
        "favorite_count": 0,
        "score": 0,
        "last_activity_date": 1505227342,
        "creation_date": 1419516639,
        "last_edit_date": 1419571814,
        "question_id": 27647925,
        "link": "https://stackoverflow.com/questions/27647925/mqtt-js-last-will-message-not-getting-published",
        "title": "MQTT Js Last Will Message not getting published",
        "body": "<p>I have the below code --></p>\n\n<pre><code>var last_will = new Paho.MQTT.Message(\"last message\");\nlast_will.destinationName = \"Bridge123\";\nclient = new Paho.MQTT.Client(\"broker.mqttdashboard.com\", Number(\"8000\"), \"AX123\");\nclient.onConnectionLost = onConnectionLost;\nclient.onMessageArrived = onMessageArrived;\nclient.connect({onSuccess:onConnect} , {willMessage:last_will});\n</code></pre>\n\n<p>When i disconnect the client i expect a last will message being sent to the topic i have created .. Am using Paho 's mqtt version -3.1 .. Websockets are getting created fine but i do not see the last will message ... </p>\n\n<p>Can anyone guide here ? </p>\n\n<p>Adding the bigger picture :</p>\n\n<p>I have a Python script p gathering current on / off status of a IOT device in the local environment and publishing to a topic \"IOT1\" over mqtt  . I do not want the python script always running to get status from the IOT device as it overloads the device .. To solve this i am in need of finding active clients for \"IOT1\" topic so that i run or pause the thread sending requests to the IOT device in the local environment .. Is there a way other than the last will message to know this ?</p>\n"
    }, {
        "tags": [
            "c",
            "ibm-cloud",
            "mqtt",
            "iot",
            "watson-iot"
        ],
        "is_answered": false,
        "view_count": 108,
        "favorite_count": 0,
        "score": 0,
        "last_activity_date": 1503694372,
        "creation_date": 1503689211,
        "question_id": 45888247,
        "link": "https://stackoverflow.com/questions/45888247/how-publish-data-from-multiple-devices-using-a-single-connection-to-a-broker",
        "title": "How publish data from multiple devices using a single connection to a broker",
        "body": "<p>I'm working with a 6LowPan IPV6 network of connected devices (nodes) that forward their data to a border router which is connected to the internet. I'm trying to figure a way so that each node shows up in Watson IOT as a separate device. Is it possible to have more than one mqtt connection on the border router to the broker ?</p>\n"
    }, {
        "tags": [
            "iot",
            "leshan"
        ],
        "is_answered": false,
        "view_count": 78,
        "favorite_count": 0,
        "score": 1,
        "last_activity_date": 1503498924,
        "creation_date": 1503483616,
        "last_edit_date": 1503498924,
        "question_id": 45837030,
        "link": "https://stackoverflow.com/questions/45837030/concurently-hit-the-wakama-clients-to-leshan-server-with-out-load-testing-tools",
        "title": "concurently hit the wakama clients to leshan server with out load testing tools in python language",
        "body": "<p>100k of wakama clients concurently hitting to leshan server with out jmeter  or any testing tools in python \nA python client in git is found which has wrote using asyncio coroutines i would like to modify the client code and achieve concurent hits of the clients how will be achieved?</p>\n"
    }, {
        "tags": [
            "javascript",
            "ibm-cloud",
            "mqtt",
            "iot",
            "watson-iot"
        ],
        "is_answered": true,
        "view_count": 774,
        "favorite_count": 1,
        "score": 2,
        "last_activity_date": 1503304443,
        "creation_date": 1503167855,
        "question_id": 45775107,
        "link": "https://stackoverflow.com/questions/45775107/cannot-connect-to-ibm-watson-iot-platform-using-eclipse-paho-mqtt-library-for-ja",
        "title": "Cannot connect to IBM Watson IoT Platform using Eclipse PAHO MQTT Library for JavaScript",
        "body": "<p>It seems that IBM recently stopped to accept non TLS connections to the MQTT borker for security reasons. </p>\n\n<p>I'm fond of a little application which reads accelerometer sensor data from the smartphone using JavaScript and sends it to the message broker via MQTT. </p>\n\n<p><a href=\"https://github.com/ibm-watson-iot/discover-iot-sample\" rel=\"nofollow noreferrer\">This application</a> is broken. Therefore I'm trying to fix it in this <a href=\"https://github.com/romeokienzler/discover-iot-sample\" rel=\"nofollow noreferrer\">fork</a>. </p>\n\n<p>As already mentioned, non TLS connections are rejected, that's why I've enabled TLS: </p>\n\n<pre><code>        window.client.connect({\n            onSuccess: onConnectSuccess,\n            onFailure: onConnectFailure,\n            userName: \"use-token-auth\",\n            password: window.password,\n            useSSL: true\n});\n</code></pre>\n\n<p>It still doesn't connect. On the IBM Watson IoT Platform I'm seeing this error in the log, nothing else:</p>\n\n<blockquote>\n  <p>Closed connection from 213.55.176.207. The operation is not authorized.</p>\n</blockquote>\n\n<p>Now I've created a little test <a href=\"https://gist.github.com/romeokienzler/51c7d42920667724d91afec0142d30cf\" rel=\"nofollow noreferrer\">index.html</a> file. If I'm connecting as a device, it still doesn't work, but if I'm connecting as an application it works, as can be seen <a href=\"https://gist.github.com/romeokienzler/8b88a04f07454e984d94bb7a6714ddb1\" rel=\"nofollow noreferrer\">here</a>. But I've created the devices in the platform. And if I'm using an old instance of Watson IoT Platform it works but with newer ones not.</p>\n\n<p>What am I doing wrong?</p>\n"
    }, {
        "tags": [
            "javascript",
            "amazon-web-services",
            "mqtt",
            "iot"
        ],
        "is_answered": true,
        "view_count": 208,
        "favorite_count": 0,
        "closed_date": 1502790456,
        "score": -2,
        "last_activity_date": 1502787239,
        "creation_date": 1502783560,
        "question_id": 45688602,
        "link": "https://stackoverflow.com/questions/45688602/how-connect-mqtt-with-aws-broker-in-broswer-javascript",
        "title": "How connect mqtt with AWS broker in broswer javascript",
        "body": "<p>Currently we have this certificates for our IOT  project</p>\n\n<pre><code>private.pem.key\npublic.pem.key\nrootca.pem\ncertificate.pen.crt\n</code></pre>\n\n<p>I have tried using this link, but can't link the above certificates.\n<a href=\"https://eclipse.org/paho/clients/js/\" rel=\"nofollow noreferrer\">https://eclipse.org/paho/clients/js/</a></p>\n\n<p>Any libraries recommendation would be helpful as i am not expect in this field.</p>\n\n<p>Thank you</p>\n"
    }, {
        "tags": [
            "amazon-web-services",
            "mqtt",
            "iot",
            "amazon-sns"
        ],
        "is_answered": true,
        "view_count": 338,
        "favorite_count": 0,
        "score": 0,
        "last_activity_date": 1502256878,
        "creation_date": 1502254778,
        "question_id": 45581970,
        "link": "https://stackoverflow.com/questions/45581970/aws-iot-rule-not-getting-triggered-using-mqtt-browser-client",
        "title": "AWS Iot Rule not getting triggered using MQTT browser client",
        "body": "<p>I have a SNS topic and subscriber set up like so :</p>\n\n<p><a href=\"https://i.stack.imgur.com/IuXjh.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/IuXjh.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>The subscribers are correctly notified when the Topic is tested via \"Publish to Topic\" from AWS console</p>\n\n<p>I have a IoT rule like so :</p>\n\n<p><a href=\"https://i.stack.imgur.com/cY5t4.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/cY5t4.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>I have a policy attached to the rule like so :</p>\n\n<pre><code>{\n\"Version\": \"2012-10-17\",\n\"Statement\": {\n    \"Effect\": \"Allow\",\n    \"Action\": \"sns:Publish\",\n    \"Resource\": \"arn:aws:sns:ap-southeast-xxxxxx:MySNSTopic\"\n}\n</code></pre>\n\n<p>}</p>\n\n<p>Yet when I try and test from the MQTT browser client, the notification is not fired</p>\n\n<p><a href=\"https://i.stack.imgur.com/4H1Cb.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/4H1Cb.jpg\" alt=\"enter image description here\"></a>\nWhat am I missing?</p>\n"
    }, {
        "tags": [
            "java",
            "ssl",
            "mqtt",
            "iot",
            "mosquitto"
        ],
        "is_answered": false,
        "view_count": 476,
        "favorite_count": 1,
        "score": 1,
        "last_activity_date": 1500511586,
        "creation_date": 1463321315,
        "last_edit_date": 1463396116,
        "question_id": 37239255,
        "link": "https://stackoverflow.com/questions/37239255/mosquitto-secure-mqtt-connection",
        "title": "Mosquitto Secure MQTT connection",
        "body": "<p>My Question is regarding TLS/SSL MQTT connection.\nI've installed moaquitto broker from this website.</p>\n\n<p><a href=\"http://www.eclipse.org/mosquitto/download/\" rel=\"nofollow\">http://www.eclipse.org/mosquitto/download/</a></p>\n\n<p>and done with simple subscribe/publish using paho eclipse library in java.\nthen I created X509 certificates using bouncycastle in java.\nbut now I am stuck at server configurations regarding these certificates.I need to use different certificates for different topics on same broker.\nWhat I found is the following mosquitto-auth-plug.</p>\n\n<p><a href=\"https://github.com/jpmens/mosquitto-auth-plug\" rel=\"nofollow\">https://github.com/jpmens/mosquitto-auth-plug</a></p>\n\n<p>But here  in mosquitto_auth_plugin we need to  define backend databases holding username and password for authentication. How can we save certificates here? as I stated above I am creating X509 rootCA for server and X509 certificates for client.I am quit confused about it.</p>\n\n<p>Is there any other/better way to acknowledge server regarding these certificates? Can this purpose be achieved using anyother broker like HiveMQ,ActiveMQ or RabbitMQ?</p>\n"
    }, {
        "tags": [
            "google-app-engine",
            "google-cloud-platform",
            "mqtt",
            "iot",
            "google-cloud-pubsub"
        ],
        "is_answered": false,
        "view_count": 388,
        "favorite_count": 0,
        "score": 1,
        "last_activity_date": 1499885768,
        "creation_date": 1499597326,
        "last_edit_date": 1499885768,
        "question_id": 44995571,
        "link": "https://stackoverflow.com/questions/44995571/implementing-publish-function-using-old-pub-sub-api-client-python-library-on-g",
        "title": "Implementing publish() function using old Pub/Sub API client python library on Google Cloud Platform",
        "body": "<p>I have written a code for implementing pub/sub on Google Cloud Platform using old API client libraries in python. I need to publish a message from my pubsub server to a MQTT client. The code which I have written - </p>\n\n<pre><code>PRIVATE_KEY_JSON = 'My First Project-ac2738b37b2b.json'\nAPI_SCOPES = ['https://www.googleapis.com/auth/pubsub']\ncredentials = ServiceAccountCredentials.from_json_keyfile_name(\n    PRIVATE_KEY_JSON, scopes=API_SCOPES)\npubsub = discovery.build('pubsub', 'v1', credentials=credentials)\nPROJECT_NAME = 'sonorous-treat-167211'\nPROJECT = 'projects/{0}'.format(PROJECT_NAME)\n\ntopics = pubsub.projects().topics().list(project=PROJECT)\ntopic_name = \"to-gateway\"\nsub_name = \"my_test2\"\nresponse = pubsub.projects().topics().publish(topic='{0}/topics/{1}'.format(PROJECT, topic_name), body={ \"messages\" :[{  \"attributes\" : {\"key\":\"topic\",\"value\" : \"gateway-command/foo4\",}, \"data\" : \"HIII\",},], }).execute()\n#response = pubsub.projects().subscriptions().create(name ='{0}/subscriptions/{1}'.format(PROJECT, sub_name),body = { \"ackDeadlineSeconds\": 42, \"topic\" : '{0}/topics/{1}'.format(PROJECT, topic_name) , \"name\" : '{0}/subscriptions/{1}'.format(PROJECT, sub_name), }).execute()\n##response = pubsub.projects().topics().create(name ='{0}/topics/{1}'.format(PROJECT, topic_name),body = {}).execute()\nstring = response\n@app.route('/')\ndef form():\n    #string1 = list_topics()\n    #publish_message(\"projects/sonorous-treat-167211/topics/to-gateway\", \"HII\")\n    return render_template('submitted_form.html',mydict = string)\n</code></pre>\n\n<p>Currently I am not getting any error in my code. But After publishing the message, I am not receiving the message on the client side. I am not getting where the issue is. May be the pub/sub api is not able to interact with the IOT Adapter. I have also used the new google cloud pub/sub libraries(currently in alpha version) but getting the same issue. </p>\n\n<p>Here is the docs of publish() - </p>\n\n<pre><code>publish(topic=None, body=*, x__xgafv=None)\nAdds one or more messages to the topic. Returns `NOT_FOUND` if the topic\ndoes not exist. The message payload must not be empty; it must contain\n either a non-empty data field, or at least one attribute.\n\nArgs:\n  topic: string, The messages in the request will be published on this topic.\nFormat is `projects/{project}/topics/{topic}`. (required)\n  body: object, The request body. (required)\n    The object takes the form of:\n\n{ # Request for the Publish method.\n    \"messages\": [ # The messages to publish.\n      { # A message data and its attributes. The message payload must not be empty;\n          # it must contain either a non-empty data field, or at least one attribute.\n        \"attributes\": { # Optional attributes for this message.\n          \"a_key\": \"A String\",\n        },\n        \"data\": \"A String\", # The message payload.\n        \"publishTime\": \"A String\", # The time at which the message was published, populated by the server when\n            # it receives the `Publish` call. It must not be populated by the\n            # publisher in a `Publish` call.\n        \"messageId\": \"A String\", # ID of this message, assigned by the server when the message is published.\n            # Guaranteed to be unique within the topic. This value may be read by a\n            # subscriber that receives a `PubsubMessage` via a `Pull` call or a push\n            # delivery. It must not be populated by the publisher in a `Publish` call.\n      },\n    ],\n  }\n</code></pre>\n"
    }, {
        "tags": [
            "amazon-web-services",
            "iot",
            "aws-iot"
        ],
        "is_answered": true,
        "view_count": 1021,
        "favorite_count": 3,
        "score": 5,
        "last_activity_date": 1499875982,
        "creation_date": 1499186402,
        "last_edit_date": 1592644375,
        "question_id": 44910791,
        "link": "https://stackoverflow.com/questions/44910791/what-is-the-difference-between-aws-iot-device-and-thingshadow-classes",
        "title": "What is the difference between aws IoT &#39;device&#39; and &#39;thingShadow&#39; classes?",
        "body": "<p>I have an app that subscribes and publishes to topics on aws IoT. I am wondering what the difference between the two classes &quot;device&quot; and &quot;thingShadow&quot; are. This <a href=\"https://github.com/aws/aws-iot-device-sdk-js/blob/master/README.md\" rel=\"nofollow noreferrer\">library</a> gives examples of both and they both seem to have similar functionalities.</p>\n"
    }, {
        "tags": [
            "arduino",
            "mqtt",
            "iot",
            "esp8266",
            "mosquitto"
        ],
        "is_answered": false,
        "view_count": 921,
        "favorite_count": 0,
        "score": 0,
        "last_activity_date": 1499743681,
        "creation_date": 1499054794,
        "last_edit_date": 1499059762,
        "question_id": 44877649,
        "link": "https://stackoverflow.com/questions/44877649/mqtt-mosquitto-and-two-esp8266",
        "title": "MQTT Mosquitto and two ESP8266",
        "body": "<p>My problem:</p>\n\n<p>I have a Raspberry Pi, and I have installed the Mosquitto MQTT broker on it. My objective is to make 2 MQTT clients communicate over the Mosquitto broker, so I have installed the code below on two ESP8266 (WeMos D1 mini)\nand I have created this MQTT command: <code>mosquitto_pub -h 192.168.1.20 -t /wassim/led -m \"on\"</code>.</p>\n\n<p>So, when I connect only one ESP client, I see  the message \"on\" in the serial monitor. But when I connect the second ESP client, I can't see any message on the serial monitor... (But if on the terminal of the Raspberry, then I can see everything. On the clients I can't see anything). The code:</p>\n\n<pre><code>#include &lt;ESP8266WiFi.h&gt;\n#include &lt;WiFiClient.h&gt;\n#include &lt;MQTTClient.h&gt;\n\nfloat temp;\nfloat lm;\nString aw=\"\";\nconst char* host = \"192.168.1.20\";\nconst char* ssid = \"THOMSON1121\";\nconst char* password = \"Wassim\";\nWiFiClient net;\nMQTTClient mqtt;\n\nvoid connect();\n\nvoid setup() {\n  Serial.begin(115200);\n  Serial.println();\n  Serial.println(\"Booting...\");\n  WiFi.mode(WIFI_AP_STA);\n  WiFi.begin(ssid, password);\n  mqtt.begin(host, net);\n  connect();\n  if(mqtt.subscribe(\"/wassim/led\")) {\n    Serial.println(\"Subscription Valid !\");\n  }\n  Serial.println(\"Setup completed...\");\n}\n\nvoid loop() {\n  if (!mqtt.connected()) {\n    connect();\n  }\n  mqtt.loop();\n  delay(3000);\n}\n\nvoid connect() {\n  while(WiFi.waitForConnectResult() != WL_CONNECTED) {\n    WiFi.begin(ssid, password);\n    Serial.println(\"WiFi connection failed. Retry.\");\n  }\n  Serial.print(\"Wifi connection successful - IP-Address: \");\n  Serial.println(WiFi.localIP());\n  while (!mqtt.connect(host)) {\n    Serial.print(\".\");\n  }\n  Serial.println(\"MQTT connected!\");\n}\n\nvoid messageReceived(String topic, String payload, char * bytes, unsigned int length) {\n  Serial.print(\"incoming: \");\n  Serial.print(topic);\n  Serial.print(\" - \");\n  Serial.print(payload);\n  Serial.println();\n}\n</code></pre>\n\n<p>The change from one client to another is <code>if(mqtt.subscribe(\"/wassim/tmp\"))</code>.</p>\n"
    }, {
        "tags": [
            "node.js",
            "iot",
            "watson-iot"
        ],
        "is_answered": true,
        "view_count": 112,
        "favorite_count": 0,
        "score": 0,
        "last_activity_date": 1498742747,
        "creation_date": 1498733665,
        "question_id": 44823185,
        "link": "https://stackoverflow.com/questions/44823185/watson-iot-node-js-continuous-retry-connection-failure",
        "title": "Watson IoT &amp; Node.JS - Continuous retry &amp; connection failure",
        "body": "<p><strong>Background:</strong> I am creating a Node.js Web application to simulate a device &amp; publish a event to Node-Red application &amp; Device registered in Watson IoT Platform.</p>\n\n<p>The Node red Application subscribes to the event and does custom logic.</p>\n\n<p>As part of the Node.js web application, On click of submit button in Web Application, I am submitting a post request with a text box value. I am processing the request in app.js and publishing the event</p>\n\n<p><strong>Issue:</strong> It works perfectly fine, When I submit the request for the first time. But from the second time,It continuously tries to reconnect and repeatedly publish the event</p>\n\n<p><strong>App.js Code</strong> --> Post method portion</p>\n\n<pre><code>app.post('/status/data', function(req, res) {    console.log(\"3rd param is \" + req.body.eid);      application.connect();   console.log(\"Successfully connected to our IoT service!\");      application.on(\"connect\", function () {         console.log(\"About to publish data \");        application.publishDeviceEvent(deviceType, deviceId, eventType, eventFormat, eventData);         console.log(\"published data \");    });     res.writeHead(200, \"OK\", {'Content-Type': 'text/plain'});   res.end();       }); \n</code></pre>\n\n<p>First Time post request - Log Details</p>\n\n<blockquote>\n  <p>Jun 29, 2017 04:12:47.346 PM APP/PROC/WEB/0 3rd param is 111111 Jun\n  29, 2017 04:13:04.785 PM APP/PROC/WEB/0 [BaseClient:connect]\n  Connecting to IoTF with host :\n  ssl://9z9mtd.messaging.internetofthings.ibmcloud.com:8883 Jun 29, 2017\n  04:13:04.786 PM APP/PROC/WEB/0 Successfully connected to our IoT\n  service! Jun 29, 2017 04:13:04.814 PM APP/PROC/WEB/0 About to publish\n  data Jun 29, 2017 04:13:04.855 PM APP/PROC/WEB/0\n  [ApplicationClient:publish] Publish:\n  iot-2/type/CardSim/id/EB27FNW/evt/update/fmt/json,\n  {\"d\":{\"eid\":222261,\"loc\":1234}}, QoS : 0 Jun 29, 2017 04:13:04.855 PM\n  APP/PROC/WEB/0 published data Jun 29, 2017 04:13:04.855 PM\n  APP/PROC/WEB/0 [ApplicationClient:connnect] ApplicationClient\n  Connected Jun 29, 2017 04:13:04.855 PM RTR/1</p>\n</blockquote>\n\n<p><strong>Second time POst Request - Log Details</strong></p>\n\n<blockquote>\n  <p>PP/PROC/WEB/0 3rd param is 222222 Jun 29, 2017 04:13:52.891 PM\n  APP/PROC/WEB/0 [BaseClient:connect] Connecting to IoTF with host :\n  ssl://9z9mtd.messaging.internetofthings.ibmcloud.com:8883 Jun 29, 2017\n  04:13:52.891 PM RTR/0 cardreaderapp.mybluemix.net -\n  [2017-06-29T10:43:52.857+0000] \"POST /status/data HTTP/1.1\" 200 10 0\n  \"-\" \"Mozilla/5.0 (Windows NT 6.1; WOW64; rv:45.0) Gecko/20100101\n  Firefox/45.0\" \"108.168.250.151:18180\" \"169.47.199.84:63789\"\n  x_forwarded_for:\"167.230.96.8\" x_forwarded_proto:\"https\"\n  vcap_request_id:\"0801beea-5ab8-434b-403d-6c5cc92e9aad\"\n  response_time:0.050970748\n  app_id:\"0cdbfec6-ac2a-4be1-9bab-3b1933ba3c57\" app_index:\"0\"\n  x_global_transaction_id:\"1003954655\" x_b3_traceid:\"920cb5951fe2dee3\"\n  x_b3_spanid:\"920cb5951fe2dee3\" x_b3_parentspanid:\"-\" Jun 29, 2017\n  04:13:52.908 PM APP/PROC/WEB/0 Successfully connected to our IoT\n  service! Jun 29, 2017 04:13:52.895 PM APP/PROC/WEB/0\n  [BaseClient:onClose] Connection was closed. Jun 29, 2017 04:13:52.929\n  PM APP/PROC/WEB/0 [BaseClient:connect] Iotfclient is offline. Retrying\n  connection Jun 29, 2017 04:13:52.928 PM APP/PROC/WEB/0\n  [BaseClient:connect] Retry in 3 sec. Count : 1 Jun 29, 2017\n  04:13:52.928 PM APP/PROC/WEB/0 [ApplicationClient:connnect]\n  ApplicationClient Connected Jun 29, 2017 04:13:52.930 PM\n  APP/PROC/WEB/0 About to publish data Jun 29, 2017 04:13:53.972 PM\n  APP/PROC/WEB/0 [ApplicationClient:publish] Publish:\n  iot-2/type/CardSim/id/EB27FNW/evt/update/fmt/json,\n  {\"d\":{\"eid\":222261,\"loc\":1234}}, QoS : 0</p>\n</blockquote>\n\n<p>This process keeps repeating. Please help</p>\n"
    }, {
        "tags": [
            "eclipse",
            "iot",
            "mosquitto",
            "paho",
            "libmosquitto"
        ],
        "is_answered": true,
        "view_count": 9286,
        "favorite_count": 2,
        "score": 7,
        "last_activity_date": 1498034681,
        "creation_date": 1490596837,
        "question_id": 43039471,
        "link": "https://stackoverflow.com/questions/43039471/mosquitto-vs-eclipse-paho-client-library",
        "title": "Mosquitto vs eclipse paho client library",
        "body": "<p>I'm just looking into the details of Eclipse <a href=\"http://www.eclipse.org/paho/\" rel=\"noreferrer\">PAHO</a> and <a href=\"https://projects.eclipse.org/projects/technology.mosquitto\" rel=\"noreferrer\">Mosquitto</a> client libraries (MQTT C++ libraries). It looks like the PAHO uses the mosquitto MQTT broker but provides its own MQTT client libraries. </p>\n\n<p>Also the <a href=\"http://wiki.neuromeka.net/index.php?title=Implementing_MQTT_Client_using_C%2B%2B_with_libmosquitto\" rel=\"noreferrer\">Mosquitto</a> library provides a way to implement client libraries for Mosquitto MQTT broker.</p>\n\n<p>I would like to understand what's the main difference between these two client libraries. <a href=\"https://groups.google.com/forum/#!topic/mqtt/9P6kZznHH0I\" rel=\"noreferrer\">Here</a> it is discussed but that does not answer my question. Which is preferred over another and why? and why eclipse supports both? </p>\n"
    }, {
        "tags": [
            "mqtt",
            "iot",
            "mosquitto"
        ],
        "is_answered": false,
        "view_count": 3882,
        "favorite_count": 0,
        "score": 0,
        "last_activity_date": 1497615809,
        "creation_date": 1497612033,
        "last_edit_date": 1497615809,
        "question_id": 44588005,
        "link": "https://stackoverflow.com/questions/44588005/mosquitto-connection-refused",
        "title": "Mosquitto Connection Refused",
        "body": "<p>I am running a Mosquitto broker locally on my PC. When I am trying to subscribe to a specific topic, I am getting the following error: </p>\n\n<p><strong>C:\\Users\\Desktop\\mosquitto>mosquitto_sub -h localhost -t sensors -d -v<br>\nClient mosqsub/4204-lbl sending CONNECT<br>\nClient mosqsub/4204-lbl received CONNACK<br>\nConnection Refused: bad user name or password.</strong></p>\n\n<p>I assume that I need to edit my mosquitto.conf file to allow access without a user name and a password...Is this possible? Can anyone advise me on how to do so? </p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code># Config file for mosquitto\r\n#\r\n# See mosquitto.conf(5) for more information.\r\n#\r\n# Default values are shown, uncomment to change.\r\n#\r\n# Use the # character to indicate a comment, but only if it is the \r\n# very first character on the line.\r\n\r\n# =================================================================\r\n# General configuration\r\n# =================================================================\r\n\r\n# Time in seconds to wait before resending an outgoing QoS=1 or \r\n# QoS=2 message.\r\n#retry_interval 20\r\n\r\n# Time in seconds between updates of the $SYS tree.\r\n# Set to 0 to disable the publishing of the $SYS tree.\r\n#sys_interval 10\r\n\r\n# Time in seconds between cleaning the internal message store of \r\n# unreferenced messages. Lower values will result in lower memory \r\n# usage but more processor time, higher values will have the \r\n# opposite effect.\r\n# Setting a value of 0 means the unreferenced messages will be \r\n# disposed of as quickly as possible.\r\n#store_clean_interval 10\r\n\r\n# Write process id to a file. Default is a blank string which means \r\n# a pid file shouldn't be written.\r\n# This should be set to /var/run/mosquitto.pid if mosquitto is\r\n# being run automatically on boot with an init script and \r\n# start-stop-daemon or similar.\r\n#pid_file\r\n\r\n# When run as root, drop privileges to this user and its primary \r\n# group.\r\n# Leave blank to stay as root, but this is not recommended.\r\n# If run as a non-root user, this setting has no effect.\r\n# Note that on Windows this has no effect and so mosquitto should \r\n# be started by the user you wish it to run as.\r\n#user mosquitto\r\n\r\n# The maximum number of QoS 1 and 2 messages currently inflight per \r\n# client.\r\n# This includes messages that are partway through handshakes and \r\n# those that are being retried. Defaults to 20. Set to 0 for no \r\n# maximum. Setting to 1 will guarantee in-order delivery of QoS 1 \r\n# and 2 messages.\r\n#max_inflight_messages 20\r\n\r\n# The maximum number of QoS 1 and 2 messages to hold in a queue \r\n# above those that are currently in-flight.  Defaults to 100. Set \r\n# to 0 for no maximum (not recommended).\r\n# See also queue_qos0_messages.\r\n#max_queued_messages 100\r\n\r\n# Set to true to queue messages with QoS 0 when a persistent client is\r\n# disconnected. These messages are included in the limit imposed by\r\n# max_queued_messages.\r\n# Defaults to false.\r\n# This is a non-standard option for the MQTT v3.1 spec but is allowed in\r\n# v3.1.1.\r\n#queue_qos0_messages false\r\n\r\n# This option sets the maximum publish payload size that the broker will allow.\r\n# Received messages that exceed this size will not be accepted by the broker.\r\n# The default value is 0, which means that all valid MQTT messages are\r\n# accepted. MQTT imposes a maximum payload size of 268435455 bytes. \r\n#message_size_limit 0\r\n\r\n# This option controls whether a client is allowed to connect with a zero\r\n# length client id or not. This option only affects clients using MQTT v3.1.1\r\n# and later. If set to false, clients connecting with a zero length client id\r\n# are disconnected. If set to true, clients will be allocated a client id by\r\n# the broker. This means it is only useful for clients with clean session set\r\n# to true.\r\n#allow_zero_length_clientid true\r\n\r\n# If allow_zero_length_clientid is true, this option allows you to set a prefix\r\n# to automatically generated client ids to aid visibility in logs.\r\n#auto_id_prefix\r\n\r\n# This option allows persistent clients (those with clean session set to false)\r\n# to be removed if they do not reconnect within a certain time frame.\r\n#\r\n# This is a non-standard option in MQTT V3.1 but allowed in MQTT v3.1.1.\r\n#\r\n# Badly designed clients may set clean session to false whilst using a randomly\r\n# generated client id. This leads to persistent clients that will never\r\n# reconnect. This option allows these clients to be removed.\r\n#\r\n# The expiration period should be an integer followed by one of h d w m y for\r\n# hour, day, week, month and year respectively. For example\r\n#\r\n# persistent_client_expiration 2m\r\n# persistent_client_expiration 14d\r\n# persistent_client_expiration 1y\r\n#\r\n# The default if not set is to never expire persistent clients.\r\n#persistent_client_expiration\r\n\r\n# If a client is subscribed to multiple subscriptions that overlap, e.g. foo/#\r\n# and foo/+/baz , then MQTT expects that when the broker receives a message on\r\n# a topic that matches both subscriptions, such as foo/bar/baz, then the client\r\n# should only receive the message once.\r\n# Mosquitto keeps track of which clients a message has been sent to in order to\r\n# meet this requirement. The allow_duplicate_messages option allows this\r\n# behaviour to be disabled, which may be useful if you have a large number of\r\n# clients subscribed to the same set of topics and are very concerned about\r\n# minimising memory usage.\r\n# It can be safely set to true if you know in advance that your clients will\r\n# never have overlapping subscriptions, otherwise your clients must be able to\r\n# correctly deal with duplicate messages even when then have QoS=2.\r\n#allow_duplicate_messages false\r\n\r\n# The MQTT specification requires that the QoS of a message delivered to a\r\n# subscriber is never upgraded to match the QoS of the subscription. Enabling\r\n# this option changes this behaviour. If upgrade_outgoing_qos is set true,\r\n# messages sent to a subscriber will always match the QoS of its subscription.\r\n# This is a non-standard option explicitly disallowed by the spec.\r\n#upgrade_outgoing_qos false\r\n\r\n# =================================================================\r\n# Default listener\r\n# =================================================================\r\n\r\n# IP address/hostname to bind the default listener to. If not\r\n# given, the default listener will not be bound to a specific \r\n# address and so will be accessible to all network interfaces.\r\n# bind_address ip-address/host name\r\n#bind_address\r\n\r\n# Port to use for the default listener.\r\n#port 1883\r\n\r\n# The maximum number of client connections to allow. This is \r\n# a per listener setting.\r\n# Default is -1, which means unlimited connections.\r\n# Note that other process limits mean that unlimited connections \r\n# are not really possible. Typically the default maximum number of \r\n# connections possible is around 1024.\r\n#max_connections -1\r\n\r\n# Choose the protocol to use when listening.\r\n# This can be either mqtt or websockets.\r\n# Websockets support is currently disabled by default at compile time.\r\n# Certificate based TLS may be used with websockets, except that\r\n# only the cafile, certfile, keyfile and ciphers options are supported.\r\n#protocol mqtt\r\n\r\n# When a listener is using the websockets protocol, it is possible to serve\r\n# http data as well. Set http_dir to a directory which contains the files you\r\n# wish to serve. If this option is not specified, then no normal http\r\n# connections will be possible.\r\n#http_dir\r\n\r\n# Set use_username_as_clientid to true to replace the clientid that a client\r\n# connected with with its username. This allows authentication to be tied to\r\n# the clientid, which means that it is possible to prevent one client\r\n# disconnecting another by using the same clientid.\r\n# If a client connects with no username it will be disconnected as not\r\n# authorised when this option is set to true.\r\n# Do not use in conjunction with clientid_prefixes.\r\n# See also use_identity_as_username.\r\n#use_username_as_clientid\r\n\r\n# -----------------------------------------------------------------\r\n# Certificate based SSL/TLS support\r\n# -----------------------------------------------------------------\r\n# The following options can be used to enable SSL/TLS support for \r\n# this listener. Note that the recommended port for MQTT over TLS\r\n# is 8883, but this must be set manually.\r\n#\r\n# See also the mosquitto-tls man page.\r\n\r\n# At least one of cafile or capath must be defined. They both \r\n# define methods of accessing the PEM encoded Certificate \r\n# Authority certificates that have signed your server certificate \r\n# and that you wish to trust.\r\n# cafile defines the path to a file containing the CA certificates.\r\n# capath defines a directory that will be searched for files\r\n# containing the CA certificates. For capath to work correctly, the\r\n# certificate files must have \".crt\" as the file ending and you must run\r\n# \"c_rehash &lt;path to capath&gt;\" each time you add/remove a certificate.\r\n#cafile\r\n#capath\r\n\r\n# Path to the PEM encoded server certificate.\r\n#certfile\r\n\r\n# Path to the PEM encoded keyfile.\r\n#keyfile\r\n\r\n# This option defines the version of the TLS protocol to use for this listener.\r\n# The default value allows v1.2, v1.1 and v1.0, if they are all supported by\r\n# the version of openssl that the broker was compiled against. For openssl &gt;=\r\n# 1.0.1 the valid values are tlsv1.2 tlsv1.1 and tlsv1. For openssl &lt; 1.0.1 the\r\n# valid values are tlsv1.\r\n#tls_version\r\n\r\n# By default a TLS enabled listener will operate in a similar fashion to a\r\n# https enabled web server, in that the server has a certificate signed by a CA\r\n# and the client will verify that it is a trusted certificate. The overall aim\r\n# is encryption of the network traffic. By setting require_certificate to true,\r\n# the client must provide a valid certificate in order for the network\r\n# connection to proceed. This allows access to the broker to be controlled\r\n# outside of the mechanisms provided by MQTT.\r\n#require_certificate false\r\n\r\n# If require_certificate is true, you may set use_identity_as_username to true\r\n# to use the CN value from the client certificate as a username. If this is\r\n# true, the password_file option will not be used for this listener.\r\n#use_identity_as_username false\r\n\r\n# If you have require_certificate set to true, you can create a certificate\r\n# revocation list file to revoke access to particular client certificates. If\r\n# you have done this, use crlfile to point to the PEM encoded revocation file.\r\n#crlfile\r\n\r\n# If you wish to control which encryption ciphers are used, use the ciphers\r\n# option. The list of available ciphers can be optained using the \"openssl\r\n# ciphers\" command and should be provided in the same format as the output of\r\n# that command.\r\n# If unset defaults to DEFAULT:!aNULL:!eNULL:!LOW:!EXPORT:!SSLv2:@STRENGTH\r\n#ciphers DEFAULT:!aNULL:!eNULL:!LOW:!EXPORT:!SSLv2:@STRENGTH\r\n\r\n# -----------------------------------------------------------------\r\n# Pre-shared-key based SSL/TLS support\r\n# -----------------------------------------------------------------\r\n# The following options can be used to enable PSK based SSL/TLS support for\r\n# this listener. Note that the recommended port for MQTT over TLS is 8883, but\r\n# this must be set manually.\r\n#\r\n# See also the mosquitto-tls man page and the \"Certificate based SSL/TLS\r\n# support\" section. Only one of certificate or PSK encryption support can be\r\n# enabled for any listener.\r\n\r\n# The psk_hint option enables pre-shared-key support for this listener and also\r\n# acts as an identifier for this listener. The hint is sent to clients and may\r\n# be used locally to aid authentication. The hint is a free form string that\r\n# doesn't have much meaning in itself, so feel free to be creative.\r\n# If this option is provided, see psk_file to define the pre-shared keys to be\r\n# used or create a security plugin to handle them.\r\n#psk_hint\r\n\r\n# Set use_identity_as_username to have the psk identity sent by the client used\r\n# as its username. Authentication will be carried out using the PSK rather than\r\n# the MQTT username/password and so password_file will not be used for this\r\n# listener.\r\n#use_identity_as_username false\r\n\r\n# When using PSK, the encryption ciphers used will be chosen from the list of\r\n# available PSK ciphers. If you want to control which ciphers are available,\r\n# use the \"ciphers\" option.  The list of available ciphers can be optained\r\n# using the \"openssl ciphers\" command and should be provided in the same format\r\n# as the output of that command.\r\n#ciphers\r\n\r\n# =================================================================\r\n# Extra listeners\r\n# =================================================================\r\n\r\n# Listen on a port/ip address combination. By using this variable \r\n# multiple times, mosquitto can listen on more than one port. If \r\n# this variable is used and neither bind_address nor port given, \r\n# then the default listener will not be started.\r\n# The port number to listen on must be given. Optionally, an ip \r\n# address or host name may be supplied as a second argument. In \r\n# this case, mosquitto will attempt to bind the listener to that \r\n# address and so restrict access to the associated network and \r\n# interface. By default, mosquitto will listen on all interfaces.\r\n# Note that for a websockets listener it is not possible to bind to a host\r\n# name.\r\n# listener port-number [ip address/host name]\r\n#listener\r\n\r\n# The maximum number of client connections to allow. This is \r\n# a per listener setting.\r\n# Default is -1, which means unlimited connections.\r\n# Note that other process limits mean that unlimited connections \r\n# are not really possible. Typically the default maximum number of \r\n# connections possible is around 1024.\r\n#max_connections -1\r\n\r\n# The listener can be restricted to operating within a topic hierarchy using\r\n# the mount_point option. This is achieved be prefixing the mount_point string\r\n# to all topics for any clients connected to this listener. This prefixing only\r\n# happens internally to the broker; the client will not see the prefix.\r\n#mount_point\r\n\r\n# Choose the protocol to use when listening.\r\n# This can be either mqtt or websockets.\r\n# Certificate based TLS may be used with websockets, except that only the\r\n# cafile, certfile, keyfile and ciphers options are supported.\r\n#protocol mqtt\r\n\r\n# When a listener is using the websockets protocol, it is possible to serve\r\n# http data as well. Set http_dir to a directory which contains the files you\r\n# wish to serve. If this option is not specified, then no normal http\r\n# connections will be possible.\r\n#http_dir\r\n\r\n# Set use_username_as_clientid to true to replace the clientid that a client\r\n# connected with with its username. This allows authentication to be tied to\r\n# the clientid, which means that it is possible to prevent one client\r\n# disconnecting another by using the same clientid.\r\n# If a client connects with no username it will be disconnected as not\r\n# authorised when this option is set to true.\r\n# Do not use in conjunction with clientid_prefixes.\r\n# See also use_identity_as_username.\r\n#use_username_as_clientid\r\n\r\n# -----------------------------------------------------------------\r\n# Certificate based SSL/TLS support\r\n# -----------------------------------------------------------------\r\n# The following options can be used to enable certificate based SSL/TLS support\r\n# for this listener. Note that the recommended port for MQTT over TLS is 8883,\r\n# but this must be set manually.\r\n#\r\n# See also the mosquitto-tls man page and the \"Pre-shared-key based SSL/TLS\r\n# support\" section. Only one of certificate or PSK encryption support can be\r\n# enabled for any listener.\r\n\r\n# At least one of cafile or capath must be defined to enable certificate based\r\n# TLS encryption. They both define methods of accessing the PEM encoded\r\n# Certificate Authority certificates that have signed your server certificate\r\n# and that you wish to trust.\r\n# cafile defines the path to a file containing the CA certificates.\r\n# capath defines a directory that will be searched for files\r\n# containing the CA certificates. For capath to work correctly, the\r\n# certificate files must have \".crt\" as the file ending and you must run\r\n# \"c_rehash &lt;path to capath&gt;\" each time you add/remove a certificate.\r\n#cafile\r\n#capath\r\n\r\n# Path to the PEM encoded server certificate.\r\n#certfile\r\n\r\n# Path to the PEM encoded keyfile.\r\n#keyfile\r\n\r\n# By default an TLS enabled listener will operate in a similar fashion to a\r\n# https enabled web server, in that the server has a certificate signed by a CA\r\n# and the client will verify that it is a trusted certificate. The overall aim\r\n# is encryption of the network traffic. By setting require_certificate to true,\r\n# the client must provide a valid certificate in order for the network\r\n# connection to proceed. This allows access to the broker to be controlled\r\n# outside of the mechanisms provided by MQTT.\r\n#require_certificate false\r\n\r\n# If require_certificate is true, you may set use_identity_as_username to true\r\n# to use the CN value from the client certificate as a username. If this is\r\n# true, the password_file option will not be used for this listener.\r\n#use_identity_as_username false\r\n\r\n# If you have require_certificate set to true, you can create a certificate\r\n# revocation list file to revoke access to particular client certificates. If\r\n# you have done this, use crlfile to point to the PEM encoded revocation file.\r\n#crlfile\r\n\r\n# If you wish to control which encryption ciphers are used, use the ciphers\r\n# option. The list of available ciphers can be optained using the \"openssl\r\n# ciphers\" command and should be provided in the same format as the output of\r\n# that command.\r\n#ciphers\r\n\r\n# -----------------------------------------------------------------\r\n# Pre-shared-key based SSL/TLS support\r\n# -----------------------------------------------------------------\r\n# The following options can be used to enable PSK based SSL/TLS support for\r\n# this listener. Note that the recommended port for MQTT over TLS is 8883, but\r\n# this must be set manually.\r\n#\r\n# See also the mosquitto-tls man page and the \"Certificate based SSL/TLS\r\n# support\" section. Only one of certificate or PSK encryption support can be\r\n# enabled for any listener.\r\n\r\n# The psk_hint option enables pre-shared-key support for this listener and also\r\n# acts as an identifier for this listener. The hint is sent to clients and may\r\n# be used locally to aid authentication. The hint is a free form string that\r\n# doesn't have much meaning in itself, so feel free to be creative.\r\n# If this option is provided, see psk_file to define the pre-shared keys to be\r\n# used or create a security plugin to handle them.\r\n#psk_hint\r\n\r\n# Set use_identity_as_username to have the psk identity sent by the client used\r\n# as its username. Authentication will be carried out using the PSK rather than\r\n# the MQTT username/password and so password_file will not be used for this\r\n# listener.\r\n#use_identity_as_username false\r\n\r\n# When using PSK, the encryption ciphers used will be chosen from the list of\r\n# available PSK ciphers. If you want to control which ciphers are available,\r\n# use the \"ciphers\" option.  The list of available ciphers can be optained\r\n# using the \"openssl ciphers\" command and should be provided in the same format\r\n# as the output of that command.\r\n#ciphers\r\n\r\n# =================================================================\r\n# Persistence\r\n# =================================================================\r\n\r\n# If persistence is enabled, save the in-memory database to disk \r\n# every autosave_interval seconds. If set to 0, the persistence \r\n# database will only be written when mosquitto exits. See also\r\n# autosave_on_changes.\r\n# Note that writing of the persistence database can be forced by \r\n# sending mosquitto a SIGUSR1 signal.\r\n#autosave_interval 1800\r\n\r\n# If true, mosquitto will count the number of subscription changes, retained\r\n# messages received and queued messages and if the total exceeds\r\n# autosave_interval then the in-memory database will be saved to disk.\r\n# If false, mosquitto will save the in-memory database to disk by treating\r\n# autosave_interval as a time in seconds.\r\n#autosave_on_changes false\r\n\r\n# Save persistent message data to disk (true/false).\r\n# This saves information about all messages, including \r\n# subscriptions, currently in-flight messages and retained \r\n# messages.\r\n# retained_persistence is a synonym for this option.\r\n#persistence false\r\n\r\n# The filename to use for the persistent database, not including \r\n# the path.\r\n#persistence_file mosquitto.db\r\n\r\n# Location for persistent database. Must include trailing /\r\n# Default is an empty string (current directory).\r\n# Set to e.g. /var/lib/mosquitto/ if running as a proper service on Linux or\r\n# similar.\r\n#persistence_location\r\n\r\n# =================================================================\r\n# Logging\r\n# =================================================================\r\n\r\n# Places to log to. Use multiple log_dest lines for multiple \r\n# logging destinations.\r\n# Possible destinations are: stdout stderr syslog topic file\r\n#\r\n# stdout and stderr log to the console on the named output.\r\n#\r\n# syslog uses the userspace syslog facility which usually ends up \r\n# in /var/log/messages or similar.\r\n#\r\n# topic logs to the broker topic '$SYS/broker/log/&lt;severity&gt;', \r\n# where severity is one of D, E, W, N, I, M which are debug, error, \r\n# warning, notice, information and message. Message type severity is used by\r\n# the subscribe/unsubscribe log_types and publishes log messages to\r\n# $SYS/broker/log/M/susbcribe or $SYS/broker/log/M/unsubscribe.\r\n#\r\n# The file destination requires an additional parameter which is the file to be\r\n# logged to, e.g. \"log_dest file /var/log/mosquitto.log\". The file will be\r\n# closed and reopened when the broker receives a HUP signal. Only a single file\r\n# destination may be configured.\r\n#\r\n# Note that if the broker is running as a Windows service it will default to\r\n# \"log_dest none\" and neither stdout nor stderr logging is available.\r\n# Use \"log_dest none\" if you wish to disable logging.\r\n#log_dest stderr\r\n\r\n# If using syslog logging (not on Windows), messages will be logged to the\r\n# \"daemon\" facility by default. Use the log_facility option to choose which of\r\n# local0 to local7 to log to instead. The option value should be an integer\r\n# value, e.g. \"log_facility 5\" to use local5.\r\n#log_facility\r\n\r\n# Types of messages to log. Use multiple log_type lines for logging\r\n# multiple types of messages.\r\n# Possible types are: debug, error, warning, notice, information, \r\n# none, subscribe, unsubscribe, websockets, all.\r\n# Note that debug type messages are for decoding the incoming/outgoing\r\n# network packets. They are not logged in \"topics\".\r\n#log_type error\r\n#log_type warning\r\n#log_type notice\r\n#log_type information\r\n\r\n# Change the websockets logging level. This is a global option, it is not\r\n# possible to set per listener. This is an integer that is interpreted by\r\n# libwebsockets as a bit mask for its lws_log_levels enum. See the\r\n# libwebsockets documentation for more details. \"log_type websockets\" must also\r\n# be enabled.\r\n#websockets_log_level 0\r\n\r\n# If set to true, client connection and disconnection messages will be included\r\n# in the log.\r\n#connection_messages true\r\n\r\n# If set to true, add a timestamp value to each log message.\r\n#log_timestamp true\r\n\r\n# =================================================================\r\n# Security\r\n# =================================================================\r\n\r\n# If set, only clients that have a matching prefix on their \r\n# clientid will be allowed to connect to the broker. By default, \r\n# all clients may connect.\r\n# For example, setting \"secure-\" here would mean a client \"secure-\r\n# client\" could connect but another with clientid \"mqtt\" couldn't.\r\n#clientid_prefixes\r\n\r\n# Boolean value that determines whether clients that connect \r\n# without providing a username are allowed to connect. If set to \r\n# false then a password file should be created (see the \r\n# password_file option) to control authenticated client access. \r\n# Defaults to true.\r\nallow_anonymous true\r\n\r\n# In addition to the clientid_prefixes, allow_anonymous and TLS \r\n# authentication options, username based authentication is also \r\n# possible. The default support is described in \"Default \r\n# authentication and topic access control\" below. The auth_plugin \r\n# allows another authentication method to be used.\r\n# Specify the path to the loadable plugin and see the \r\n# \"Authentication and topic access plugin options\" section below.\r\n#auth_plugin</code></pre>\r\n</div>\r\n</div>\r\n</p>\n"
    }, {
        "tags": [
            "java",
            "android",
            "iot"
        ],
        "is_answered": false,
        "view_count": 127,
        "favorite_count": 0,
        "score": 1,
        "last_activity_date": 1496312321,
        "creation_date": 1496312321,
        "question_id": 44304848,
        "link": "https://stackoverflow.com/questions/44304848/how-to-create-mqtt-secure-channel-using-tls-psk-cipher-suit-in-android",
        "title": "How to create MQTT secure channel using TLS-PSK cipher suit in android",
        "body": "<p>I am implementing an app which requires MQTT communication should be secure in P2P local mode (No internet connectivity only both device and application connects to router). So I have decided to use TLS-PSK cipher based handshake mechanism. </p>\n\n<p>I have tried with Android native support PSKKeyManager but there are not enough references to create that Channel.\nOther options like bouncy castle need to explore. </p>\n\n<p>Please help how can we use TLS-PSK cipher along with MQTT.</p>\n"
    }, {
        "tags": [
            "spring",
            "spring-integration",
            "mqtt",
            "iot",
            "mosquitto"
        ],
        "is_answered": false,
        "view_count": 299,
        "favorite_count": 0,
        "score": -1,
        "last_activity_date": 1495785741,
        "creation_date": 1495663127,
        "last_edit_date": 1495724627,
        "question_id": 44169158,
        "link": "https://stackoverflow.com/questions/44169158/spring-integration-mqtt-over-udp-or-mqtt-sn",
        "title": "spring integration mqtt over udp or mqtt-sn",
        "body": "<p>In IoT scenario a lot of standard force pushing packets to mqtt queues over UDP protocol. This scenario become more and more frequent day by day, and for this reason now we have a new kind of mqtt queues named <a href=\"http://mqtt.org/new/wp-content/uploads/2009/06/MQTT-SN_spec_v1.2.pdf\" rel=\"nofollow noreferrer\">mqtt-sn</a>.</p>\n\n<p>In spring-integration-mqtt I'm using a <a href=\"https://eclipse.org/paho/\" rel=\"nofollow noreferrer\">paho client</a>, however this has a specific client implementation ready to use mqtt-sn (<a href=\"https://eclipse.org/paho/clients/c/embedded-sn/\" rel=\"nofollow noreferrer\">https://eclipse.org/paho/clients/c/embedded-sn/</a>) and there is also an implementation of moquitto over mqtt-sn (<a href=\"https://github.com/eclipse/mosquitto.rsmb\" rel=\"nofollow noreferrer\">https://github.com/eclipse/mosquitto.rsmb</a>).</p>\n\n<p>There is any way to for spring-integration-mqtt over UDP protocol or there is an implementation which allow to use mqtt-sn over spring-integration?</p>\n"
    }, {
        "tags": [
            "python",
            "mqtt",
            "iot",
            "mosquitto",
            "paho"
        ],
        "is_answered": true,
        "view_count": 1511,
        "favorite_count": 0,
        "score": 0,
        "last_activity_date": 1495648720,
        "creation_date": 1495648019,
        "last_edit_date": 1495648477,
        "question_id": 44165348,
        "link": "https://stackoverflow.com/questions/44165348/two-mqtt-server-pub-sub-with-python",
        "title": "Two MQTT server pub/sub with python",
        "body": "<p>I've been trying to find answers or info about this question but without results yet. The idea is to publish the same topic into two different MQTT servers with python. I mean, something like this:</p>\n\n<pre><code>import paho.mqtt.client as paho\nimport datetime, time\n\nmqttc = paho.Client()\n\nhost1 = \"broker.hivemq.com\" # the address of 1st mqtt broker\nhost2 = \"192.168.1.200\" # the address of 2nd mqtt broker\ntopic= \"testingTopic\"\nport = 1883\n\ndef on_connect(mosq, obj, rc):\n   print(\"on_connect() \"+str(rc))\n\nmqttc.on_connect = on_connect\n\nprint(\"Connecting to \" + host)\nmqttc.connect(host1, port, 60)\nmqttc.connect(host2, port, 60)\n\nwhile 1:\n    # publish some data at a regular interval\n    now = datetime.datetime.now()\n    mqttc.publish(topic, now.strftime('%H:%M:%S')) #Publishing to MQTT1\n    mqttc.publish(topic, now.strftime('%H:%M:%S')) #Publishing to MQTT2\n    time.sleep(1)\n</code></pre>\n\n<p>So, the question is about the while statment... how can I do to publish the same topic into MQTT1 and MQTT2? \nAs you can see, I want to have to posibility to publish that payload in MQTT broker that is running in internet, but if I lose internet connection, then I can pub/sub to MQTT broker in my LAN.</p>\n"
    }, {
        "tags": [
            "c#",
            "multithreading",
            "persistence",
            "mqtt",
            "iot"
        ],
        "is_answered": true,
        "view_count": 673,
        "favorite_count": 0,
        "score": 2,
        "last_activity_date": 1495173791,
        "creation_date": 1489563401,
        "question_id": 42803607,
        "link": "https://stackoverflow.com/questions/42803607/m2mqtt-message-buffering",
        "title": "M2Mqtt message buffering",
        "body": "<p>I know that M2MQTT does not support out-of-the-box disk buffering. But I would need to implement this. The purpose of this is to be sure that all messages published actually reached the broker.</p>\n\n<p>Right now when I publish a message, my class directly puts the message in a key-value database that is stored on disk.</p>\n\n<p>In another thread, a method loops a peek operation on the key-value database and looks for messages to publish. When a new message is found in the key-value database, the thread calls the M2Mqtt method Publish, it then directly ends up in the internal M2MQTT inflight queue and it returns a publish ID. It then waits for the M2Mqtt event MessagePublished before publishing any other data, once the event is called, it compares the MessagePublished ID from the event with the one it received from the Publish method. If they are equal it knows the message was successfully published.</p>\n\n<p>To summarize:</p>\n\n<ol>\n<li>Thread 1 enqueues message to key-value database</li>\n<li>Thread 2 runs a peek loop on key-value database queue</li>\n<li>Thread 2 finds a new message</li>\n<li>Thread 2 calls M2Mqtt Publish and recieves ID1 from Publish method</li>\n<li>Thread 2 is halted and waits for MessagePublished event and checks if the ID that were published is equal to ID1, if that is the case, the key-value database queue is dequeued once and at this point the message is considered successfully sent.</li>\n<li>Thread 2 continues its loop as in step 2, looking for new messages to publish.</li>\n</ol>\n\n<p>During all operations thread 1 might enqueue a lot of messages, but thread 2 will only be able to publish messages one-by-one in order to verify that the message was successfully published before actually dequeuing/removing it from the key-value database and consider it sent. I need to publish them to the broker in the same order as they appeared from thread 1.</p>\n\n<p>If thread 2 simply just published all messages incoming from thread 1 via the key-value database. Thread 2 might dequeue/remove values from the key-value database despite the messages actually did not reach the broker. They might be in the RAM inflight queue, but a server reboot or service restart would empty this queue, leaving the messages completely lost because thread 2 dequeued them from the key-value database without actually verifying they reached the broker.</p>\n\n<p>Can you give med guidance of how this implementation should be made in best practice with M2Mqtt? Is the pattern above best practice? And what key-value database is prefered for this type of implementation? Right now I have tried using SqlCeCompact.</p>\n"
    }, {
        "tags": [
            "node.js",
            "websocket",
            "sap",
            "mqtt",
            "iot"
        ],
        "is_answered": true,
        "view_count": 248,
        "favorite_count": 1,
        "score": 0,
        "last_activity_date": 1495171227,
        "creation_date": 1494941229,
        "question_id": 44002840,
        "link": "https://stackoverflow.com/questions/44002840/cant-connect-to-sap-server-with-mqtt-over-wss",
        "title": "Can&#39;t connect to SAP Server with MQTT over WSS",
        "body": "<p>ich trie since 3 Days to connect to the SAP MQTT over WSS (wss://iotmmsXXXXXXXXX.hana.ondemand.com/com.sap.iotservices.mms/v1/api/ws/mqtt).</p>\n\n<p>With this i'm using a p12 client certificate.</p>\n\n<p>But it goes to stuck on/ after the Handshake (see Wireshark Picture).</p>\n\n<p><img src=\"https://cloud.githubusercontent.com/assets/20642456/26107911/2d7a2664-3a4b-11e7-9c65-8689b1e32abe.png\" alt=\"wireshark\">\n10.XX.XX.XXX is my IP</p>\n\n<p>155.XX.XX.XXX is the SAP IP </p>\n\n<p>After 30 seconds i got this error:\n<img src=\"https://cloud.githubusercontent.com/assets/20642456/26107508/d0df65c8-3a49-11e7-854f-6739166c7f75.png\" alt=\"output\">\nAnd he try to connect again.</p>\n\n<p>Here is the Source: </p>\n\n<pre><code>const fs = require('fs');\nconst mqtt = require('mqtt');\n\n// Parts of URL and Path\nconst hcp_account_id = 'WWWWWWWWW';\nconst hcp_landscape_host = '.hana.ondemand.com' // this is used on PROD with Client Certificate Authentication\nconst my_endpoint_url_path = '/com.sap.iotservices.mms/v1/api/ws/mqtt';\n\n//Certificate\nconst client_p12 = \"./YYYYYYYY-YYYY-YYYY-YYYY-YYYYYYYYYYYY.p12\";\n\n// the following values need to be taken from the IoT Cockpit\nconst device_id = 'XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX';\nconst message_type_id_From_device = 'ZZZZZZZZZZZZZZZZZZZZ';\n\n// for down- upstream communication\nvar my_publish_topic = \"iot/data/\" + device_id;\nvar my_subscription_topic = \"iot/push/\" + device_id;\n\nvar my_endpoint = \"iotmms\" + hcp_account_id + hcp_landscape_host;\n\nvar wsoptions =\n    {\n        host: my_endpoint,\n        port: 443,\n        pfx: fs.readFileSync(client_p12),\n        passphrase: 'AAAAA',\n        checkServerIdentity: false,\n        protocol: 'mqttv3.1',\n        protocolVersion: 13,\n        perMessageDeflate: true,\n        client_max_window_bits: true\n    }\n\nvar options =\n    {\n        wsOptions: wsoptions,\n        clientId: device_id,\n        protocolId: 'MQIsdp',\n        protocolVersion: 3,\n        protocol: 'wss',\n        hostname: my_endpoint,\n        port: 443,\n        path: my_endpoint_url_path\n    }\n\nconst mqttc = mqtt.connect(options);\n\nmqttc.subscribe(my_subscription_topic, 0);\n\nmqttc.on('connect', () =&gt; console.log('connected!'));\n\nmqttc.on('error', (msg) =&gt; console.log('error: ' + msg));\n\nmqttc.on('offline', (msg) =&gt; console.log('offline: ' + msg));\n\nmqttc.on('close', (msg) =&gt; console.log('close: ' + msg));\n\n// message is Buffer\nmqttc.on('message', (topic, message) =&gt; console.log('message(' + topic + '): ' + message.toString()));\n</code></pre>\n"
    }, {
        "tags": [
            "ibm-cloud",
            "mqtt",
            "iot",
            "mosquitto",
            "watson-iot"
        ],
        "is_answered": true,
        "view_count": 577,
        "favorite_count": 0,
        "score": 0,
        "last_activity_date": 1494881224,
        "creation_date": 1494511539,
        "last_edit_date": 1494881224,
        "question_id": 43917742,
        "link": "https://stackoverflow.com/questions/43917742/mosquitto-and-ibm-watson-iot-on-raspberry-pi-connection-refused",
        "title": "mosquitto and ibm watson iot on raspberry pi Connection Refused",
        "body": "<p>I am new to IoT. I just installed mosquitto on my rpi and registered my devices and gateway in Watson IoT Platform using this tutorial: <a href=\"https://developer.ibm.com/recipes/tutorials/using-mosquitto-as-a-gateway-for-watson-iot/\" rel=\"nofollow noreferrer\">https://developer.ibm.com/recipes/tutorials/using-mosquitto-as-a-gateway-for-watson-iot/</a></p>\n\n<p>Mosquitto works fine local mode. However, I am facing a problem subscribing/publishing using these commands:</p>\n\n<pre><code> mosquitto_sub -d -h pxci52.messaging.internetofthings.ibmcloud.com  -i 'g:pxci52:myfstream:gateway' -t iot-2/type/myfstream/id/gateway/evt/status/fmt/raw\n</code></pre>\n\n<p>and</p>\n\n<pre><code>sudo mosquitto_pub -d -h pxci52.messaging.internetofthings.ibmcloud.com  -i 'g:pxci52:myfstream:gateway' -t iot-2/type/myfstream/id/gateway/evt/status/fmt/raw -m \"hello\"\n</code></pre>\n\n<p>Here is my conf file:</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>pid_file /var/run/mosquitto.pid\r\n\r\npersistence true\r\npersistence_location /var/lib/mosquitto/\r\n\r\nlog_dest topic\r\n\r\n\r\nlog_type error\r\nlog_type warning\r\nlog_type notice\r\nlog_type information\r\n\r\nconnection_messages true\r\nlog_timestamp true\r\n\r\ninclude_dir /etc/mosquitto/conf.d\r\nconnection bridge-to-watsoniot\r\naddress pxci52.messaging.internetofthings.ibmcloud.com:1883\r\ncleansession true\r\ntry_private false\r\nbridge_attempt_unsubscribe false\r\nnotifications false\r\nnotification_topic iot-2/type/myfstream/id/gateway/evt/status/fmt/raw\r\nremote_username token\r\nremote_password xxxxxx\r\nremote_clientid g:pxci52:myfstream:gateway\r\nnotifications true\r\ntopic iot-2/type/+/id/+/cmd/+/fmt/+ in iot-2/type/+/id/+/cmd/+/fmt/+\r\ntopic iot-2/type/+/id/+/evt/+/fmt/+ out iot-2/type/+/id/+/evt/+/fmt/+\r\nconnection_messages true</code></pre>\r\n</div>\r\n</div>\r\n</p>\n"
    }, {
        "tags": [
            "ibm-cloud",
            "mqtt",
            "iot",
            "node-red"
        ],
        "is_answered": true,
        "view_count": 483,
        "favorite_count": 0,
        "score": 1,
        "last_activity_date": 1494418047,
        "creation_date": 1494337802,
        "last_edit_date": 1592644375,
        "question_id": 43871689,
        "link": "https://stackoverflow.com/questions/43871689/subscribe-mqtt-not-working-in-bluemix-using-node-red",
        "title": "Subscribe MQTT not working in bluemix using node-red",
        "body": "<p>I am having trouble in MQTT communication. I am new to MQTT and IOT. I am using IBM Bluemix as a cloud service. I can publish the data using node-red MQTT node on the device type. But I am not able to subscribe to that device and topic. Whenever I try to subscribe, it gets disconnected.\nThanks</p>\n<p>In this picture, I am publishing the status event to the device\n<a href=\"https://i.stack.imgur.com/ygO8R.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ygO8R.png\" alt=\"enter image description here\" /></a></p>\n<p>In this picture, I am getting the published data in the cloud\n<a href=\"https://i.stack.imgur.com/IrRxI.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/IrRxI.png\" alt=\"enter image description here\" /></a></p>\n<p>However, as shown below, when i try to subscribe, it gets disconnected\n<a href=\"https://i.stack.imgur.com/Rk8zI.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Rk8zI.png\" alt=\"enter image description here\" /></a></p>\n<p>PS: I am using the same client ID. I don't know how to use a different client ID for the same device type.</p>\n"
    }, {
        "tags": [
            "java",
            "android",
            "iot",
            "paho",
            "hivemq"
        ],
        "is_answered": true,
        "view_count": 552,
        "favorite_count": 0,
        "score": 1,
        "last_activity_date": 1493387300,
        "creation_date": 1493294831,
        "question_id": 43657343,
        "link": "https://stackoverflow.com/questions/43657343/how-to-run-broker-hivemq-localy-and-connect-android-application-to-it",
        "title": "How to run broker &#39;HiveMQ&#39; localy and connect android application to it",
        "body": "<p>I followed a tutorial to send message to the hiveMQ(which run through executing run.bat file that I downloaded from their website) from paho graphical user interface downloaded from <a href=\"http://www.eclipse.org/paho/clients/tool/\" rel=\"nofollow noreferrer\">here</a> , it worked fine and showed logs that client connected and sent message that worked fine, now I have made android client application that can publish messages to the public broker, that also worked fine I successfully published message to their public broker(tcp://broker.hivemq.com:1883) </p>\n\n<p>I want to have hiveMQ as broker on my computer so that I can send messages from my application to locally running broker and see the message what I sent from application, how can I do that?</p>\n\n<p>Thanks</p>\n"
    }, {
        "tags": [
            "javascript",
            "ibm-cloud",
            "mqtt",
            "iot",
            "watson-iot"
        ],
        "is_answered": true,
        "view_count": 1139,
        "favorite_count": 1,
        "score": 6,
        "last_activity_date": 1491546938,
        "creation_date": 1491478566,
        "question_id": 43254056,
        "link": "https://stackoverflow.com/questions/43254056/how-to-connect-ibm-watson-iot-using-paho-mqtt-javascript-client",
        "title": "How to connect IBM Watson IOT using Paho MQTT javascript client?",
        "body": "<p>I am trying to connect IBM Watson IoT platform using Paho MQTT Javascript client as mentioned in the below example code.</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-js lang-js prettyprint-override\"><code> \r\n var client = new Messaging.Client(\"myOqgId.messaging.internetofthings.ibmcloud.com\", 8883, \"myclientid_\" + parseInt(Math.random() * 100, 10));\r\n\r\n //Gets  called if the websocket/mqtt connection gets disconnected for any reason\r\n client.onConnectionLost = function (responseObject) {\r\n     //Depending on your scenario you could implement a reconnect logic here\r\n     alert(\"connection lost: \" + responseObject.errorMessage);\r\n };\r\n\r\n //Gets called whenever you receive a message for your subscriptions\r\n client.onMessageArrived = function (message) {\r\n     //Do something with the push message you received\r\n     $('#messages').append('&lt;span&gt;Topic: ' + message.destinationName + '  | ' + message.payloadString + '&lt;/span&gt;&lt;br/&gt;');\r\n };\r\n\r\n //Connect Options\r\n var options = {\r\n     userName: API-Key here,\r\n     password: Auth token here,\r\n     timeout: 3,\r\n     //Gets Called if the connection has sucessfully been established\r\n     onSuccess: function () {\r\n         alert(\"Connected\");\r\n     },\r\n     //Gets Called if the connection could not be established\r\n     onFailure: function (message) {\r\n         alert(\"Connection failed: \" + message.errorMessage);\r\n     }\r\n };\r\n\r\n //Creates a new Messaging.Message Object and sends it to the HiveMQ MQTT Broker\r\n var publish = function (payload, topic, qos) {\r\n     //Send your message (also possible to serialize it as JSON or protobuf or just use a string, no limitations)\r\n     var message = new Messaging.Message(payload);\r\n     message.destinationName = topic;\r\n     message.qos = qos;\r\n     client.send(message);\r\n }</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p>But not able to connect.\nI am getting this error:\n<em>WebSocket connection to 'ws://myOrgIdXYZ.messaging.internetofthings.ibmcloud.com:8883/mqtt' failed: Error during WebSocket handshake: net::ERR_CONNECTION_RESET</em></p>\n\n<p>Please anybody out there who tried connecting IBM Watson IoT using Paho Mqtt client.</p>\n"
    }, {
        "tags": [
            "mqtt",
            "publish-subscribe",
            "iot",
            "pubnub"
        ],
        "is_answered": true,
        "view_count": 2128,
        "favorite_count": 1,
        "score": 2,
        "last_activity_date": 1490330911,
        "creation_date": 1490212797,
        "question_id": 42961534,
        "link": "https://stackoverflow.com/questions/42961534/can-mqtt-broker-be-configured-to-send-data-to-subscribers-at-a-different-rate",
        "title": "Can MQTT broker be configured to send data to subscribers at a different rate?",
        "body": "<p>I am new to MQTT and working with the mosquitto broker and development libraries. </p>\n\n<p>I have a usecase where different subscribers may want to subscribe to a given topic but would want the data at different rates. So, subscriber1 may want it only on change from the previous value while subscriber2 may want it on a fixed cadence, say, every few mins/seconds.</p>\n\n<p>Is there a way to configure that in the mosquitto broker? Or any other broker that supports it?</p>\n"
    }, {
        "tags": [
            "java",
            "mqtt",
            "iot",
            "paho"
        ],
        "is_answered": true,
        "view_count": 55,
        "favorite_count": 0,
        "score": 1,
        "last_activity_date": 1490223368,
        "creation_date": 1490193872,
        "last_edit_date": 1490193983,
        "question_id": 42954957,
        "link": "https://stackoverflow.com/questions/42954957/is-message-in-the-broker-not-timestamped",
        "title": "Is message in the Broker not timestamped?",
        "body": "<p>I am playing with a IoT project, so far so good, I can share data between Clients using a free broker I found on the web... </p>\n\n<p>My Use case is about a Temperature sensor that is publishing the msg with retention to a topic <strong>room/temp</strong></p>\n\n<p>Since the msg is retained, a <em>client_2</em> is comming latter, makes a subscription to that topic and get the last value of the temp that <em>client_1</em> published a while ago.</p>\n\n<p>Now to my question:</p>\n\n<p>I need that <em>Client_2</em> gets aswell when was that message published, I mean I would like to know how many seconds later am getting that information..</p>\n\n<p>I am Using Paho-Eclipse as jar and in the callback <a href=\"https://www.eclipse.org/paho/files/javadoc/org/eclipse/paho/client/mqttv3/MqttCallback.html\" rel=\"nofollow noreferrer\">here</a> </p>\n\n<pre><code>messageArrived(java.lang.String topic, MqttMessage message)\n</code></pre>\n\n<p>is nothing about that</p>\n\n<p>why?\nHow can I?</p>\n\n<p>Thanks!! :)</p>\n"
    }, {
        "tags": [
            "mqtt",
            "iot",
            "broker",
            "emq"
        ],
        "is_answered": true,
        "view_count": 93,
        "favorite_count": 1,
        "score": 0,
        "last_activity_date": 1489508776,
        "creation_date": 1489059511,
        "last_edit_date": 1592644375,
        "question_id": 42694411,
        "link": "https://stackoverflow.com/questions/42694411/erlang-mqtt-configuration-broken",
        "title": "Erlang MQTT configuration broken?",
        "body": "<p>There is a way (according to <a href=\"http://emqttd-docs.readthedocs.io/en/latest/plugins.html\" rel=\"nofollow noreferrer\">this</a> and <a href=\"https://github.com/emqtt/emq-auth-username\" rel=\"nofollow noreferrer\">this</a>) in Erlang eMQ to enable in my MQTT Broker a plugin for the <strong>emq_auth_username</strong>, meaning I can config my broker to allow connections bases on my <strong>etc/emq_auth_username.conf</strong> file.</p>\n<p>I did create the file and put inside similar entries...</p>\n<p>however myclient is not comming in:</p>\n<p><a href=\"https://i.stack.imgur.com/c2QHi.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/c2QHi.png\" alt=\"enter image description here\" /></a></p>\n<p>my file looks like:</p>\n<blockquote>\n<h2>auth.user.$N.username = admin</h2>\n<h2>auth.user.$N.password = public</h2>\n<h2>auth.user.$1.username = dummy_username</h2>\n<h2>auth.user.$1.password = dummy_password</h2>\n<h2>auth.user.$N.username = dummy_username</h2>\n<h2>auth.user.$N.password = dummy_password</h2>\n</blockquote>\n<p>since am trying to get how it works....</p>\n<p>any hint how can  I add a new credential here in this file???</p>\n<p>Thanks!</p>\n"
    }, {
        "tags": [
            "c#",
            "mqtt",
            "soa",
            "iot",
            "broker"
        ],
        "is_answered": false,
        "view_count": 217,
        "favorite_count": 0,
        "score": 1,
        "last_activity_date": 1489504464,
        "creation_date": 1489504464,
        "question_id": 42789782,
        "link": "https://stackoverflow.com/questions/42789782/gnatmq-traceability",
        "title": "GnatMQ traceability",
        "body": "<p>I am using GnatMQ as a MQTT broker in my IIoT application. I package this as an external class library in my main application which has a Service-Oriented Architecture.</p>\n\n<p>My problem now is that some messages does not reach the broker. I am using M2MQTT to publish messages to the broker. Is there a possibility to log (inside my broker class library) each message that passes the broker? If this is not possible. Can you recommend an alternative C# MQTT broker that I can embedd into my application as a class library or service.</p>\n"
    }, {
        "tags": [
            "iot"
        ],
        "is_answered": true,
        "view_count": 1264,
        "favorite_count": 0,
        "score": 1,
        "last_activity_date": 1489100928,
        "creation_date": 1473075941,
        "question_id": 39329919,
        "link": "https://stackoverflow.com/questions/39329919/windows-iot-remote-client-tool-not-connecting-with-dragonboard410c",
        "title": "Windows IoT Remote Client tool not connecting with Dragonboard410c",
        "body": "<p>I tried windows IoT Client application with the Dragonboard410c but it is not working, Any one have any idea how it can be connected.</p>\n"
    }, {
        "tags": [
            "websocket",
            "mqtt",
            "iot",
            "broker",
            "mosquitto"
        ],
        "is_answered": true,
        "view_count": 10773,
        "favorite_count": 1,
        "score": 2,
        "last_activity_date": 1488536889,
        "creation_date": 1432240115,
        "last_edit_date": 1488536889,
        "question_id": 30383753,
        "link": "https://stackoverflow.com/questions/30383753/mosquitto-1-4-2-websocket-support",
        "title": "Mosquitto 1.4.2 Websocket support",
        "body": "<p>I'm trying to utilize Mosquittos recent update to support websockets in the broker. I'm running Mosquitto v1.4.2 and I've added the following lines to the mosquitto configuration file (mosquitto.conf):</p>\n\n<pre><code>listener 10001 127.0.0.1\nprotocol websockets\n\nlistener 1883\nprotocol mqtt\n</code></pre>\n\n<p>When I try and start the broker with the new configuration I get the following :</p>\n\n<pre><code>$ mosquitto -c /etc/mosquitto/mosquitto.conf\nError: Websockets support not available.\nError found at /etc/mosquitto/mosquitto.conf:16.\nError: Unable to open configuration file.\n</code></pre>\n\n<p>I was under the assumption that version 1.4 and above of Mosquitto has websocket support now (don't have to build from source to enable websocket support like you had to before v1.4) so I'm wondering what I'm missing. Any help on what direction to look to troubleshoot the problem is appreciated.</p>\n\n<p>Edit: Forgot to mention I'm running CentOS6</p>\n"
    }, {
        "tags": [
            "java",
            "eclipse",
            "mqtt",
            "iot",
            "paho"
        ],
        "is_answered": true,
        "view_count": 10770,
        "favorite_count": 0,
        "score": 2,
        "last_activity_date": 1487959277,
        "creation_date": 1487711699,
        "last_edit_date": 1495535380,
        "question_id": 42378119,
        "link": "https://stackoverflow.com/questions/42378119/how-to-subscribe-to-a-mqtt-topic-and-print-received-messages-on-eclipse-java",
        "title": "How to subscribe to a MQTT topic and print received messages on Eclipse (Java)",
        "body": "<p>I have a microcontroller with a thermostat sending its data over Raspberry Pi to my computer using MQTT protocol. Kura is installed and working on the Raspberry.</p>\n\n<p>I'm having no problems with receiving the data on Putty, but now I need to receive it on Eclipse so I can develop a program.</p>\n\n<p>I managed to publish on the topic via eclipse using Paho with the following code, (which is an adaptation of this other topic <a href=\"https://stackoverflow.com/questions/22715682/subscribe-and-read-mqtt-message-using-paho\">Subscribe and Read MQTT Message Using PAHO</a>):</p>\n\n<pre><code>package publish;\n\nimport org.eclipse.paho.client.mqttv3.MqttClient;\nimport org.eclipse.paho.client.mqttv3.MqttException;\nimport org.eclipse.paho.client.mqttv3.MqttMessage;\n\npublic class PublishSemInterface {\nMqttClient client;\n\npublic PublishSemInterface() {}\n\npublic static void main(String[] args) {\n    new PublishSemInterface().doDemo();\n}\n\npublic void doDemo() {\n    try {\n        client = new MqttClient(\"tcp://192.168.0.39:1883\", \"user\");\n        client.connect();\n        MqttMessage message = new MqttMessage();\n        message.setPayload(\"Published message\".getBytes());\n        client.publish(\"sensor/temp/out\", message);\n        client.disconnect();\n    } catch (MqttException e) {\n        e.printStackTrace();\n    }\n}\n}\n</code></pre>\n\n<p>But the subscribe is being a pain. I tried using the answer of the topic I mentioned above, implementing MqttCallback interface:</p>\n\n<pre><code>public class PublishSemInterface implements MqttCallback\n</code></pre>\n\n<p>Adding setCallback after connecting to the client and the required interface methods (I only need messageArrived):</p>\n\n<pre><code>client.setCallback(this);\n\n@Override\npublic void connectionLost(Throwable cause) {}\n\n@Override\npublic void messageArrived(String topic, MqttMessage message)\n    throws Exception {\nSystem.out.println(message);   \n}\n\n@Override\npublic void deliveryComplete(IMqttDeliveryToken token) {}\n</code></pre>\n\n<p>But it didn't work. I also tried using the answer from the following topic: <a href=\"https://stackoverflow.com/questions/38805669/how-to-read-data-from-mqtt-in-eclipse-paho\">How to read data from MQTT in Eclipse Paho?</a></p>\n\n<pre><code>public static void main(String[] args) {\n\n    MqttClient client;\n    MqttConnectOptions conn;\n\n    try {\n        client = new MqttClient(\"tcp://192.168.0.39:1883\", \"user\");\n        client.connect();\n        client.setCallback(new MqttCallback() {\n            public void connectionLost(Throwable cause) {}\n\n            public void messageArrived(String topic,\n                    MqttMessage message)\n                            throws Exception {\n                System.out.println(message.toString());\n            }\n\n            public void deliveryComplete(IMqttDeliveryToken token) {}\n        });\n\n        client.subscribe(\"sensor/temp/in\");\n\n    } catch (MqttException e) {\n        e.printStackTrace();\n    }\n}\n</code></pre>\n\n<p>Except that it didn't work either. In both cases, when I run the code, the console is active, but when the microcontroller send the data (which appears on Putty), instead of printing it, the program is terminated. It looks as if the messageArrived methods are not being called.</p>\n\n<p>Can anyone help me with the subscription and printing on Eclipse's console?</p>\n"
    }, {
        "tags": [
            "node.js",
            "mqtt",
            "iot"
        ],
        "is_answered": true,
        "view_count": 3898,
        "favorite_count": 1,
        "score": 1,
        "last_activity_date": 1487879690,
        "creation_date": 1451442138,
        "question_id": 34522088,
        "link": "https://stackoverflow.com/questions/34522088/what-is-the-maximum-number-of-topics-that-a-mqtt-broker-can-handle",
        "title": "What is the maximum number of topics that a MQTT broker can handle?",
        "body": "<p>I am using the node.js mosca MQTT broker for some internet of things (iot) application.</p>\n\n<p><a href=\"https://github.com/mcollina/mosca\" rel=\"nofollow\">https://github.com/mcollina/mosca</a></p>\n\n<p>What is the maximum number of topics that a MQTT broker, specifically mosca, can handle? </p>\n\n<p>If I want to increase the number of allowed topics, is there a configuration parameter I can modify or which part of the code can I change?</p>\n"
    }, {
        "tags": [
            "windows",
            "iot",
            "alljoyn"
        ],
        "is_answered": true,
        "view_count": 37,
        "favorite_count": 0,
        "score": 0,
        "last_activity_date": 1486487344,
        "creation_date": 1486466687,
        "question_id": 42088635,
        "link": "https://stackoverflow.com/questions/42088635/what-is-format-to-specify-connectspec-for-alljoyn-busattachment-connect-on-windo",
        "title": "what is format to specify connectSpec for alljoyn_busattachment_connect on windows machine",
        "body": "<p>Alljoyn SDK documentation for <strong>alljoyn_busattachment_connect</strong> @ <a href=\"https://allseenalliance.org/docs/api/c/_bus_attachment_8h.html#aeb22a38b231141d0d59b7b907379661f\" rel=\"nofollow noreferrer\">https://allseenalliance.org/docs/api/c/_bus_attachment_8h.html#aeb22a38b231141d0d59b7b907379661f</a><br>\nsays we can provide connectSpec to this method. Can you please let me know some real example how can i format machine IP address &amp; PORT to form a correct connectSpec.</p>\n\n<p>I just want to establish connection via explicit IP &amp; PORT</p>\n"
    }, {
        "tags": [
            "raspberry-pi",
            "mqtt",
            "iot",
            "raspberry-pi3",
            "mosquitto"
        ],
        "is_answered": false,
        "view_count": 547,
        "favorite_count": 0,
        "score": 0,
        "last_activity_date": 1486314926,
        "creation_date": 1484333453,
        "last_edit_date": 1486314926,
        "question_id": 41641506,
        "link": "https://stackoverflow.com/questions/41641506/how-do-i-execute-a-python-file-when-i-receive-a-specific-msg-from-mosquitto-brok",
        "title": "How do I execute a python file when I receive a specific msg from Mosquitto broker",
        "body": "<p>I have made an android app that publishes topics to Cloudmqtt(powered by AWS ) using Mqtt protocol. My raspberrypi has a local Mosquitto broker which is bridged with remote Cloudmqtt. So as soon as I publish a topic via my android app it is received on the raspberrypi console.\nHere comes the problem.  As soon as I receive the msg on my raspberrypi console it should execute a python file. How can it be done?</p>\n\n<p>I write this following command to receive the topic</p>\n\n<pre><code>mosquitto_sub -h host_name -p port_no -u remote_user_name -P remote_password  -t hello/today/world\n</code></pre>\n\n<p>Now as soon as I receive a msg through the topic <code>hello/today/world</code> I have to run a python file that makes decisions according to the msg received from the topic(if the msg received is <code>on</code>, the led turns on)</p>\n\n<p>But the main problem is that how can we read the msg and execute the file accordingly?</p>\n\n<p>This morning I saw someone posted a similar question and I took up the challenge to find out the solution but I am not getting any way to do so.</p>\n\n<p>I tried to write in shell but it didn't work </p>\n\n<pre><code>c=mosquitto_sub -h host_name -p port_no -u remote_user_name -P remote_password  -t hello/today/world\nif ( c == \"rushabh welcome to garden assistant\" )\nthen\n   GPIO mode 12 out\n   GPIO mode 12 1\n   GPIO mode 12 0\nelse\n   echo \"not matched\"\nfi\n</code></pre>\n\n<p>Since I want to turn on the led at gpio 12 as soon as I receive <code>rushabh welcome to garden assistant</code> from the mosquitto broker</p>\n\n<p>Can we use <code>$SYS/broker/messages/stored</code></p>\n"
    }, {
        "tags": [
            "mqtt",
            "iot",
            "mosquitto",
            "esp8266",
            "nodemcu"
        ],
        "is_answered": true,
        "view_count": 3916,
        "favorite_count": 0,
        "score": 1,
        "last_activity_date": 1483882795,
        "creation_date": 1446122172,
        "last_edit_date": 1446200418,
        "question_id": 33414441,
        "link": "https://stackoverflow.com/questions/33414441/nodemcu-and-esp8266-slow-mqtt-publish",
        "title": "NodeMCU and ESP8266: slow mqtt publish",
        "body": "<p>I'm using esp8266 with the firmware produced with Marcel's NodeMCU custom builds <a href=\"http://frightanic.com/nodemcu-custom-build/\" rel=\"nofollow\">http://frightanic.com/nodemcu-custom-build/</a>\nI tested the \"dev\" branch and the \"master\".</p>\n\n<p>I changed a little bit the \"<em>Connect to MQTT Broker</em>\" code found here <a href=\"https://github.com/nodemcu/nodemcu-firmware\" rel=\"nofollow\">https://github.com/nodemcu/nodemcu-firmware</a> </p>\n\n<pre><code>-- init mqtt client with keepalive timer 120sec\nm = mqtt.Client(\"clientid\", 120, \"user\", \"password\")\n\nm:on(\"connect\", function(con) print (\"connected\") end)\nm:on(\"offline\", function(con) print (\"offline\") end)\n\n-- m:connect( host, port, secure, auto_reconnect, function(client) )\n-- for secure: m:connect(\"192.168.11.118\", 1880, 1, 0)\n-- for auto-reconnect: m:connect(\"192.168.11.118\", 1880, 0, 1)\nm:connect(\"192.168.11.118\", 1880, 0, 0, function(conn) print(\"connected\") end)\n\n-- publish a message with data = hello, QoS = 0, retain = 0\nlocal i = 1\nwhile i &lt; 10 do\n  m:publish(\"/topic\",\"hello\",0,0, function(conn) print(\"sent\") end)\n  i = i + 1\nend\n\nm:close();  \n</code></pre>\n\n<p>I'm using mosquitto as a mqtt broker and I have launched a subscriber on all topic <strong>#</strong>.</p>\n\n<p>The result is: the messages arrives correctly but they are really slow to arrive on the subscriber (around 1 second each)... why?</p>\n\n<p>I tried also to change the mqtt architecture in favor of UDP.. the esp8266 send the 100 messages fast.</p>\n\n<p><strong>UPDATE 1#:</strong></p>\n\n<p>I have done some more experiments: </p>\n\n<ul>\n<li>Testing the broker and the\nsubscriber with an [android phone + a mqtt publisher], the subscriber\nreceive messages immediately </li>\n<li>I loaded a nodemcu with \"debug\" enabled\nand I have done an interesting discovery: read on</li>\n</ul>\n\n<p>For what I have understood reading debug log and source code.. \nThere is a sort of queue that saves the messages in memory and a timer (I don't know the frequency/interval) reads a message from the queue and it sends it through mqtt. \nIf you try to send 100 messages, the queue increases, but it is not able to deliver messages at the same time (maybe there is a race condition? ).</p>\n\n<p>There is a second problem here, after it has enqueued more than 15 messages, the firmware crash and the device reboots: it seems a symptom of memory no more available.</p>\n"
    }, {
        "tags": [
            "iot",
            "kaa"
        ],
        "is_answered": true,
        "view_count": 36,
        "favorite_count": 0,
        "score": 0,
        "last_activity_date": 1483110242,
        "creation_date": 1482934127,
        "question_id": 41363776,
        "link": "https://stackoverflow.com/questions/41363776/can-we-use-kaa-0-8-0-client-sdk-with-kaa-0-8-1-server",
        "title": "Can we use KAA 0.8.0 Client SDK with KAA 0.8.1 Server?",
        "body": "<p>Can we use KAA 0.8.0 Client SDK with KAA 0.8.1 Server?</p>\n\n<p>Is it possible to use KAA 0.8.0 Client SDK with KAA 0.8.1 Server? \nWe are planning to upgrade our server, will this affect our current endpoints?\nAny information will be appreciated.</p>\n"
    }, {
        "tags": [
            "amazon-web-services",
            "mqtt",
            "iot"
        ],
        "is_answered": true,
        "view_count": 583,
        "favorite_count": 0,
        "score": 1,
        "last_activity_date": 1482359786,
        "creation_date": 1472680016,
        "question_id": 39259515,
        "link": "https://stackoverflow.com/questions/39259515/aws-shared-subscription-behaviour-capability-of-aws-mqtt-broker",
        "title": "AWS, Shared subscription behaviour capability of AWS MQTT broker",
        "body": "<p>I'm exploring AWS IoT MQTT broker capabilities for my future use and I'm trying to figure out if AWS MQTT broker supports \"shared subscriptions\" functionality.</p>\n\n<p>Shared subscriptions, relatively new functionality, introduced by IBM MessageSight. Represents \"queue\" or \"p2p\" behavior when multiple subscribers with same clientID can be connected/subscribed to the same topic and only one subscriber instance (load is balancing automatically) receives particular message. Against of pub/sub topic model, when all subscribers receive copies, this is very convenient to use in software architecture as we don't need to use one more \"player\" message queue to distribute load between parallel application instances.</p>\n\n<p>In case if IoT, messages published by devices can be consumed by several application instances, working in parallel, to distribute load between them.</p>\n"
    }, {
        "tags": [
            "python",
            "raspberry-pi",
            "ibm-cloud",
            "raspbian",
            "iot"
        ],
        "is_answered": false,
        "view_count": 287,
        "favorite_count": 0,
        "score": 0,
        "last_activity_date": 1480621957,
        "creation_date": 1480553529,
        "last_edit_date": 1480621957,
        "question_id": 40900849,
        "link": "https://stackoverflow.com/questions/40900849/operation-time-out-connection-to-ibm-iot-service",
        "title": "operation time out connection to IBM iot service",
        "body": "<p>I was trying run the python script on my raspberry pi. And my device is also already connected on bluemix. At first, I could able to run the script but now I got the following error.</p>\n\n<hr>\n\n<p>2016-11-14 06:46:30,490   ibmiotf.application.Client  WARNING Unable to encrypt    messages because TLSv1.2 is unavailable (MQTT over SSL requires at least Python    v2.7.9 or 3.4 and openssl v1.0.1)\n2016-11-14 06:46:40,571   ibmiotf.application.Client  CRITICAL Operation timed o   ut connecting to the IBM Internet of Things service: 1tlj3z.messaging.internetof   things.ibmcloud.com\nOperation timed out connecting to the IBM Internet of Things service: 1tlj3z.mes   saging.internetofthings.ibmcloud.com</p>\n\n<pre><code>PIO.setmode(GPIO.BCM)\nGPIO.setup(18, GPIO.IN, pull_up_down=GPIO.PUD_UP)\nGPIO.setup(17, GPIO.OUT)\nclient = None\ndef myCommandCallback(cmd):\nif cmd.event == \"light\":\n</code></pre>\n\n<p>payload = json.loads(cmd.payload)</p>\n\n<pre><code> command = payload[\"command\"]\nprint command\nif command == \"on\":\nGPIO.output(17, True)\n</code></pre>\n\n<p>elif command == \"off\":</p>\n\n<p>GPIO.output(17, False)</p>\n\n<pre><code>try:\noptions = ibmiotf.application.ParseConfigFile(\"/home/pi/device.cfg\")\noptions[\"deviceId\"] = options[\"id\"]\noptions[\"id\"] = \"aaa\" + options[\"id\"]\nclient = ibmiotf.application.Client(options)\nclient.connect()\nclient.deviceEventCallback = myCommandCallback\nclient.subscribeToDeviceEvents(event=\"light\")        \n\nwhile True:\n    GPIO.wait_for_edge(18, GPIO.FALLING)\n    print \"Button Pushed\"\n    myData = {'buttonPushed' : True}\n    client.publishEvent(\"raspberrypi\", options[\"deviceId\"], \"input\", \"json\", myData)\n    time.sleep(0.2)\n</code></pre>\n\n<p>except ibmiotf.ConnectionException  as e:\n    print e</p>\n"
    }, {
        "tags": [
            "javascript",
            "node.js",
            "mqtt",
            "iot"
        ],
        "is_answered": true,
        "view_count": 1885,
        "favorite_count": 0,
        "score": 0,
        "last_activity_date": 1479299473,
        "creation_date": 1479129190,
        "question_id": 40589613,
        "link": "https://stackoverflow.com/questions/40589613/mqtt-js-client-connected-returns-false-though-client-seems-to-be-connected",
        "title": "mqtt.js | client.connected returns false though client seems to be connected",
        "body": "<p>while playing around with mqtt.js of node.js i figured out that the value of client.connected seem to be wrong or i misunderstand something. <br/>\nI did this tutorial <a href=\"http://thejackalofjavascript.com/getting-started-mqtt/\" rel=\"nofollow noreferrer\">http://thejackalofjavascript.com/getting-started-mqtt/</a> and everything works fine. <br/><br>\nI tried to get more into mqtt, so i looked up on <a href=\"https://www.npmjs.com/package/mqtt#mqttclientconnected\" rel=\"nofollow noreferrer\">https://www.npmjs.com/package/mqtt#mqttclientconnected</a> , Description of client.connected:</p>\n\n<blockquote>\n  <p>Boolean : set to true if the client is connected. false otherwise.</p>\n</blockquote>\n\n<p><br/></p>\n\n<p>In order to look if it works, i modified the sourcecode for the firstline just like this</p>\n\n<pre><code>var mqtt = require('mqtt')\n\nclient = mqtt.connect('mqtt://localhost');\n\n  if (client.connected == true) {\n        console.log(\"Connection successful.\")\n    }\n    else{\n        console.log(\"Something went wrong.\")\n    }\n\nclient.subscribe('presence');\n\nconsole.log('Client publishing.. ');\nclient.publish('presence', 'Client 1 is alive.. Test Ping! ' + Date());\n\nclient.end();\n</code></pre>\n\n<p>I just added the if-clause. When executing the script, I always receive the message, that something went wrong, ergo: connected --> false. <br/>\nBut why?</p>\n"
    }, {
        "tags": [
            "wso2",
            "iot",
            "wso2-das"
        ],
        "is_answered": true,
        "view_count": 1026,
        "favorite_count": 0,
        "score": 1,
        "last_activity_date": 1478864547,
        "creation_date": 1465353333,
        "question_id": 37692336,
        "link": "https://stackoverflow.com/questions/37692336/wso2-das-certificate-didnt-match",
        "title": "WSO2 DAS: certificate didn&#39;t match",
        "body": "<p>I'm installed <code>WSO2 DAS Server</code> on my LAN network, but I can't create new <code>Dashboard</code> because this error:</p>\n\n<blockquote>\n  <p>javax.net.ssl.SSLException: hostname in certificate didn't match: \n  &lt;192.168.3.27> != localhost</p>\n</blockquote>\n\n<p>in <a href=\"http://pastebin.com/4Z6YxgY2\" rel=\"nofollow\">log file here</a>.</p>\n\n<p>Please help and thanks</p>\n"
    }, {
        "tags": [
            "mqtt",
            "iot",
            "esp8266",
            "tls1.2",
            "watson-iot"
        ],
        "is_answered": false,
        "view_count": 345,
        "favorite_count": 1,
        "score": 0,
        "last_activity_date": 1478547976,
        "creation_date": 1475512764,
        "last_edit_date": 1475578522,
        "question_id": 39836382,
        "link": "https://stackoverflow.com/questions/39836382/ibm-watson-subscribe",
        "title": "IBM Watson Subscribe",
        "body": "<p>I am looking for a way for my ESP8266 Arduino device to subscribe to the IBM Watson IoT platform to receive device management messages (reboot, update etc.). I have located examples that use the PubSubClient library (<a href=\"https://developer.ibm.com/recipes/tutorials/run-an-esp8266arduino-as-a-iot-foundation-managed-device/\" rel=\"nofollow\">https://developer.ibm.com/recipes/tutorials/run-an-esp8266arduino-as-a-iot-foundation-managed-device/</a>) to do this, however, I have not yet found a working example of PubSubClient using TLS1.2 (a requirement for this project). As such I am currently using the Adafruit_MQTT_Client which can connect and publish to Watson using TLS1.2, but I have not had success subscribing to the platform. If anyone could suggest a way to connect, publish and subscribe to IBM Watson IoT platform using TLS1.2, it would be much appreciated!</p>\n"
    }, {
        "tags": [
            "apache-kafka",
            "iot"
        ],
        "is_answered": true,
        "view_count": 4106,
        "favorite_count": 1,
        "score": 5,
        "last_activity_date": 1476760915,
        "creation_date": 1414856484,
        "last_edit_date": 1444722594,
        "question_id": 26690884,
        "link": "https://stackoverflow.com/questions/26690884/kafka-security-and-authentication",
        "title": "Kafka security and authentication",
        "body": "<p>We are trying to make Kafka for public accessible.Does Kafka support SSL connection? Is there possible to authenticate client connection?\nPlease share some idea's to implement..</p>\n"
    }, {
        "tags": [
            "mqtt",
            "iot",
            "mosquitto"
        ],
        "is_answered": true,
        "view_count": 1751,
        "favorite_count": 1,
        "score": 1,
        "last_activity_date": 1474833452,
        "creation_date": 1473053851,
        "question_id": 39324470,
        "link": "https://stackoverflow.com/questions/39324470/paho-mqtt-client-broker-connection",
        "title": "paho mqtt client broker connection",
        "body": "<p>My publisher and broker are working on different systems. I am using QOS=2 for delivery of messages.I am using python paho mqtt broker. It is further extension to MQTT - Is there a way to check if the client is still connected</p>\n\n<p>1) When I publish a message to connected broker, it acknowledge me by calling on_publish() callback. but when I disconnected my broker running on different machine from the network, the publisher stores the publish message on local machine and again when I connect my broker to network it publishes all previous messages to broker. I think these messages stored as inflight messages (not confirmed), if these messages are inflight messages, then where these messages are stored,is there any limit of these inflight messages as I have not include anything in my code regarding inflight messages.</p>\n"
    }, {
        "tags": [
            "ibm-cloud",
            "iot",
            "watson-iot"
        ],
        "is_answered": true,
        "view_count": 961,
        "favorite_count": 0,
        "score": 2,
        "last_activity_date": 1472695507,
        "creation_date": 1472534969,
        "question_id": 39219355,
        "link": "https://stackoverflow.com/questions/39219355/in-watson-iot-can-we-publish-events-and-subscribe-for-commands-using-the-same-au",
        "title": "In Watson IoT can we publish events and subscribe for commands using the same auth-token on the Device?",
        "body": "<p>What is the approach to be followed (on the device) if we have to publish events to cloud and subscribe for MQTT messages on the Device at the same time using the auth-token provided by the Watson IoT platform.\nWhen we try to publish to a topic when the device has already subscribed to some topics then the connection is lost. What would be the right approach to be followed in order to publish and subscribe at the same time?\nThe details of the MQTT connection are as follows,</p>\n\n<pre><code>Client id- &lt;d:orgId:deviceType:deviceId&gt;\nUsername - use-token-auth\nPassword - &lt;platform-generated-token&gt;\n</code></pre>\n"
    }, {
        "tags": [
            "python",
            "mqtt",
            "iot",
            "mosquitto",
            "paho"
        ],
        "is_answered": false,
        "view_count": 475,
        "favorite_count": 0,
        "score": 1,
        "last_activity_date": 1472122391,
        "creation_date": 1472121899,
        "last_edit_date": 1495541697,
        "question_id": 39143183,
        "link": "https://stackoverflow.com/questions/39143183/python-paho-client-broker-connection",
        "title": "python paho client broker connection",
        "body": "<p>My publisher and broker are working on different systems. I am using QOS=2 for delivery of messages.I am using python paho mqtt broker. It is further extension to \n<a href=\"https://stackoverflow.com/questions/36093078/mqtt-is-there-a-way-to-check-if-the-client-is-still-connected\">MQTT - Is there a way to check if the client is still connected</a>   </p>\n\n<p>1) When I publish a message to connected broker, it acknowledge me by calling on_publish() callback. but when I disconnected my broker running on different machine from the network, the publisher stores the publish message on local machine and again when I connect my broker to network it publishes all previous messages to broker. I think these messages stored as inflight messages (not confirmed), if these messages are inflight messages, then  where these messages are stored,is there any limit of these inflight messages as I have not include anything in my code regarding inflight messages.</p>\n\n<p>2)In first case I disconnect my broker from the network, now I shutdown my broker and again connect to network,  my program call on_disconnect() callback says unexpected disconnection, then publishes all unpublished messages to broker.\n    a) I am confused why on_disconnect() callback calls only when I shut down by broker not on when I disconnect my broker from my local network.\n   b) on_disconnect() method calls only when my broker again connect to network.\n      Is there any way if my broker disconnect suddenly, then immediately it will be informed to publisher?</p>\n\n<p>3) I am using mqtt in real time gps tracking, I want to store messages to local db when publisher not connected to broker , but I can't find any way how publisher comes to know immediately when it disconnected from broker.</p>\n\n<p>4) Is using QOS=2 is best way to ensure message delivery to broker or using local db for storage purpose when disconnected to broker and then sync automatically with local db to publish all messages</p>\n"
    }, {
        "tags": [
            "wso2",
            "authorization",
            "mqtt",
            "iot",
            "messagebroker"
        ],
        "is_answered": false,
        "view_count": 140,
        "favorite_count": 0,
        "score": 0,
        "last_activity_date": 1472005084,
        "creation_date": 1449098255,
        "question_id": 34054966,
        "link": "https://stackoverflow.com/questions/34054966/wso2-message-broker-authorization",
        "title": "WSO2 Message Broker - Authorization",
        "body": "<p>I am trying to implement an authorization mechanism on WSO2 Message Broker, but I am pretty new to WSO2 products. My goal is to implement MQTT Topic Authorization in the same manner it is implemented for JMS topics. Actually I am looking the code on the \"andes\" repository and \"carbon-business-messaging\" repository, and I would be very grateful if you can suggest me where to start. (that's a lot of code to look at)</p>\n\n<p>What I want to do is to allow a particular user to publish/subscribe topics using the User Role permissions, so that even if someone connects to the Broker, he/she can't subscribe or publish without permission.</p>\n"
    }, {
        "tags": [
            "networking",
            "simulation",
            "mqtt",
            "iot"
        ],
        "is_answered": false,
        "view_count": 380,
        "favorite_count": 0,
        "score": 0,
        "last_activity_date": 1471544751,
        "creation_date": 1457368867,
        "last_edit_date": 1457388796,
        "question_id": 35849183,
        "link": "https://stackoverflow.com/questions/35849183/mqtt-in-depth-analysis-and-performance-testing-need-simulation-tools-and-examp",
        "title": "MQTT in-depth analysis and performance testing . Need simulation tools and examples",
        "body": "<p>I an working on a project to carry on an in-depth analysis of the MQTT protocol for IOT devices . Something like delay , bandwidth , roundtrip , packet drops , QOS , etc . </p>\n\n<p>Can you suggest me some software with examples to simulate a simple client broker scenario ? . </p>\n\n<p>I would run the test on an arduino based sensor nodes , sending data to a raspberry pi acting as the gateway . Also i wish to use Eclipse Paho as the client and HiveMQ / Mosquitto as the broker . \nIt would be better if you can give examples that can support the hardware that i am using . </p>\n\n<p>Thanks a lot</p>\n"
    }, {
        "tags": [
            "azure",
            "mqtt",
            "iot",
            "azure-iot-hub"
        ],
        "is_answered": true,
        "view_count": 721,
        "favorite_count": 0,
        "score": 2,
        "last_activity_date": 1471375229,
        "creation_date": 1470719652,
        "last_edit_date": 1471375229,
        "question_id": 38842560,
        "link": "https://stackoverflow.com/questions/38842560/not-receiving-message-for-subcribed-topic-from-azure-iot-mqtt-broker",
        "title": "Not receiving message for subcribed topic from Azure IoT MQTT broker",
        "body": "<p>Please, help me to resolve this issue, I have tried all the options...\ni used <code>MqttClient</code> client to subcribed iot hub mqtt broker using topic</p>\n\n<pre><code>devices/t2c-171bdd65-407d-4de9-992b-36cee0914b3f/messages/devicebound/#\n</code></pre>\n\n<p>but I wasn't able to receive any callback...\nI am  running this application from my local machine and connecting to Azure IoT hub MQTT broker. well, I am able to publish message to IoT hub, I can confirm this because IoT hub message count is increasing &amp; device explorer running on my local machine is displaying message in monitor mode.</p>\n"
    }, {
        "tags": [
            "mqtt",
            "iot",
            "mosquitto",
            "paho"
        ],
        "is_answered": true,
        "view_count": 3425,
        "favorite_count": 3,
        "score": 5,
        "last_activity_date": 1471112246,
        "creation_date": 1471089460,
        "last_edit_date": 1471112246,
        "question_id": 38932479,
        "link": "https://stackoverflow.com/questions/38932479/published-message-store-by-mosquitto-broker-when-subscriber-is-offline-with-qos",
        "title": "published message store by mosquitto broker when subscriber is offline with QOS=2",
        "body": "<p>My both publisher and subscriber are both connected to mosquitto (paho) broker with QOS=2 and maintaining persistent session by clean_session=false. When i publish message with subscriber connected to broker, it successfully received by subscriber, now if I disconnect the subscriber , then again publish message and  connect subscriber after, I will be able to retrieve message those messages when my subscriber was offline.</p>\n\n<p>My question is --</p>\n\n<ol>\n<li><p>Is there any storage in the broker which stores all the messages when subscriber is offline.</p></li>\n<li><p>If yes, how much long or how many message it can store.</p></li>\n<li><p>Is this approach is good for real time GPS tracking where subscriber can go offline for a long time (5-6 hr) approx.</p></li>\n<li><p>Is session persistence is maintained even if power goes off.</p></li>\n<li><p>How much traffic it can handle for scalable application if I use this approach in real time gps tracking..</p></li>\n</ol>\n"
    }, {
        "tags": [
            "mqtt",
            "iot",
            "mosquitto"
        ],
        "is_answered": true,
        "view_count": 590,
        "favorite_count": 1,
        "score": 1,
        "last_activity_date": 1471112211,
        "creation_date": 1471109750,
        "last_edit_date": 1471112211,
        "question_id": 38935339,
        "link": "https://stackoverflow.com/questions/38935339/synchronization-between-publisher-db-and-mosquitto-broker-db-mqtt",
        "title": "Synchronization Between publisher db and mosquitto broker db mqtt",
        "body": "<p>My publisher and broker are working on different systems. The publisher has local DB in which it stores new outbound messages. I want to ask It is possible to have sync between publisher local DB with broker DB (mosquitto.db) when publisher lost connection with the broker and then broker automatically send these messages to the subscriber if subscriber connected to a broker or when connected to a broker. </p>\n"
    }, {
        "tags": [
            "protocols",
            "mqtt",
            "iot"
        ],
        "is_answered": true,
        "view_count": 1215,
        "favorite_count": 1,
        "score": 3,
        "last_activity_date": 1470044863,
        "creation_date": 1469919196,
        "last_edit_date": 1469952254,
        "question_id": 38679219,
        "link": "https://stackoverflow.com/questions/38679219/how-to-implement-one-to-one-communication-in-mqtt",
        "title": "How to implement one-to-one communication in MQTT?",
        "body": "<p>I am trying to set up a MQTT system for a project that connects many clients. </p>\n\n<p>These clients are of different type and may have different functionality. Some client-types have information - like temperature - which is being published but at the same time feature states that need to be set - like switches - which can be set by other clients.</p>\n\n<p>So using MQTT I came up with the following concept:</p>\n\n<ol>\n<li><p>The client publishes the informations it has - in the above example this would be the temperature, so like:</p>\n\n<p>customer/group/device/temperature</p></li>\n<li><p>When the client connects to a broker, in order to receive a state for the switch from different clients it subscribes to:</p>\n\n<p>customer/group/device/switch</p></li>\n</ol>\n\n<p>I have been using a websocket based solution so far but since MQTT is a famous protocol for IoT devices I was asking myself how to implement one to one communications between clients and came up with the above example of how I would do that. </p>\n"
    }, {
        "tags": [
            "mqtt",
            "iot",
            "mosquitto"
        ],
        "is_answered": false,
        "view_count": 123,
        "favorite_count": 0,
        "score": -1,
        "last_activity_date": 1469817655,
        "creation_date": 1469814427,
        "last_edit_date": 1469817655,
        "question_id": 38664700,
        "link": "https://stackoverflow.com/questions/38664700/detect-the-identity-of-the-mqtt-clients-and-a-mosquitto-broker-in-iot-scenario",
        "title": "detect the identity of the MQTT clients and a Mosquitto broker in IoT scenario?",
        "body": "<p>I am new to <strong>mqtt</strong> and <strong>IoT</strong>,, using mosquitto broker, tried to extend the broker in java for the IoT application...</p>\n\n<p>Is there any algorithm to detect the identity of a mqtt client and a broker???</p>\n"
    }, {
        "tags": [
            "javascript",
            "amazon-web-services",
            "lambda",
            "mqtt",
            "iot"
        ],
        "is_answered": true,
        "view_count": 712,
        "favorite_count": 0,
        "score": 0,
        "last_activity_date": 1469123911,
        "creation_date": 1469053619,
        "last_edit_date": 1469123911,
        "question_id": 38491890,
        "link": "https://stackoverflow.com/questions/38491890/how-to-increase-reliability-of-mqtt-messages-between-aws-lambda-and-web-app-via",
        "title": "How to increase reliability of MQTT messages between AWS Lambda and web app via IoT",
        "body": "<p>I'm having a problem with consistently receiving MQTT messages published by a Lambda function and subscribed to by a web application (using a \"thing\" in IoT called \"workstation\"). I sometimes get them right away but somewhat intermittently, but most often, I get them after a very long delay if I get them at all. I'm always able to connect and subscribe. I've tried qos 0 and 1.</p>\n\n<p>EDIT: If I just use a generic topic string without the $aws/... prefix stuff, and qos of 1, I now tend to get a slim majority of the messages I send. But they are rarely immediate and they tend to stack up and come through several at a time. And several are lost altogether.</p>\n\n<p>I have an Lambda function that serves an Alexa skill, and it publishes to an IoT MQTT topic/thing like this:</p>\n\n<pre><code>var params = {\n  // have also tried topic strings without $aws/things/ prefix here\n  topic: '$aws/things/workstation/', \n  payload: new Buffer('test message'),\n  qos: 0\n};\n\niotData.publish(params, function(err, data) {\n  if (err) console.log('ERR: ', err); // an error occurred\n  else if (data) console.log('DATA: ', data);  // successful response\n});\n</code></pre>\n\n<p>I then have a web application using the AWS IOT Device SDK that subscribes to that MQTT channel and listens for messages like this:</p>\n\n<pre><code>var device = awsIoT.device({\n    keyPath: './keys/abcd1234xyz-private.pem.key',\n    certPath: './keys/abcd1234xyz-certificate.pem.crt',\n    caPath: './keys/root-CA.crt',\n    clientId: 'workstation',\n    region: 'us-east-1',\n    host: \"abcd1234xyz.iot.us-east-1.amazonaws.com\",\n    port: 8883\n});\n\ndevice.on('connect', function() {\n  console.log('connect');\n  // have also tried topic strings without $aws/things/ prefix here\n  device.subscribe('$aws/things/workstation/');\n});\n\ndevice.on('message', function(topic, payload) {\n  console.log('message', topic, payload.toString());\n});\n</code></pre>\n"
    }, {
        "tags": [
            "java",
            "iot",
            "opc-ua"
        ],
        "is_answered": true,
        "view_count": 257,
        "favorite_count": 0,
        "score": 0,
        "last_activity_date": 1469112333,
        "creation_date": 1469093333,
        "last_edit_date": 1469112333,
        "question_id": 38500289,
        "link": "https://stackoverflow.com/questions/38500289/how-can-i-test-if-a-milo-client-connection-to-a-server-is-actually-using-encrypt",
        "title": "How can I test if a Milo client connection to a server is actually using encryption?",
        "body": "<p>When using <code>Eclipse Milo</code> as a client, I want to test, after the connection has been established, if the connection is actually using encryption.</p>\n\n<p>What is the best approach to do so?</p>\n"
    }, {
        "tags": [
            "python",
            "mqtt",
            "iot",
            "paho"
        ],
        "is_answered": false,
        "view_count": 131,
        "favorite_count": 0,
        "score": 0,
        "last_activity_date": 1469091932,
        "creation_date": 1469080976,
        "question_id": 38496055,
        "link": "https://stackoverflow.com/questions/38496055/subscribe-to-carriots-stream",
        "title": "Subscribe to Carriots Stream",
        "body": "<p>I am trying to subscribe to carriots data stream using paho mqtt client. But i am not able to read any data from carriots. \nHere's the source code i am using to subscribe to carriots.</p>\n\n<pre><code>#!/usr/bin/env python\n# -*- coding: utf-8 -*- \n# Client paho-mqtt CarriotsMqttServer\n# sub_carriot.py\n\nimport paho.mqtt.subscribe as mqtt\n\nclass CarriotsMqttClient():\n    host = 'mqtt.carriots.com'\n    port = '1883'\n    auth = {}\n    topic = '%s/streams'\n    tls = None\n\n    def __init__(self, auth, tls=None):\n        self.auth = auth\n        self.topic = '%s/streams' % auth['username']\n        if tls:\n            self.tls = tls\n            self.port = '8883'\n\n    #Subscribe\n    def subscribe(self):\n        try:\n            mqtt.simple(topics=self.topic, msg_count=10, hostname=self.host, port=self.port, auth=self.auth, tls=self.tls)\n        except Exception, ex:\n            print ex\nif __name__ == '__main__':\n     auth = {'username': '72cdf4ec......bbeec9d9fb4483e', 'password': ''}\n     client_mqtt = CarriotsMqttClient(auth=auth) \n     client_mqtt.subscribe()\n</code></pre>\n\n<p>Can anybody tell me if there is something wrong with the code or i am missing some step which is required to subscribe to cariots stream.</p>\n\n<p>I was able to successfully publish on carriots using paho mqtt, with help of reference code given on carriots website.</p>\n"
    }, {
        "tags": [
            "python",
            "websocket",
            "mqtt",
            "iot",
            "paho"
        ],
        "is_answered": true,
        "view_count": 14562,
        "favorite_count": 4,
        "score": 4,
        "last_activity_date": 1469016874,
        "creation_date": 1456385851,
        "last_edit_date": 1466058557,
        "question_id": 35621075,
        "link": "https://stackoverflow.com/questions/35621075/mqtt-over-websocket-in-python",
        "title": "MQTT over websocket in python",
        "body": "<p>is there any support in python to subscribe on mqtt broker with port 8080</p>\n\n<pre><code> import sys\n import paho.mqtt.client as mqtt\n\n def on_connect(mqttc, obj, flags, rc):\n     print(\"rc: \"+str(rc))\n\n def on_message(mqttc, obj, msg):\n     print(msg.topic+\" \"+str(msg.qos)+\" \"+str(msg.payload))\n\n def on_publish(mqttc, obj, mid):\n     print(\"mid: \"+str(mid))\n\n def on_subscribe(mqttc, obj, mid, granted_qos):\n     print(\"Subscribed: \"+str(mid)+\" \"+str(granted_qos))\n\n def on_log(mqttc, obj, level, string):\n     print(string)\n\n mqttc = mqtt.Client()   \n mqttc.on_message = on_message\n mqttc.on_connect = on_connect\n mqttc.on_publish = on_publish\n mqttc.on_subscribe = on_subscribe\n mqttc.connect(\"test.mosquitto.org\", 8080, 60)\n mqttc.subscribe(\"test/iot\", 0)\n\n mqttc.loop_forever()\n</code></pre>\n\n<p>i can not connect with this code. Mosquitto has websocket support at port 8080 but this paho library does not work for it. any solution for python?\ni am using python 2.7 on windows 10.</p>\n"
    }, {
        "tags": [
            "node.js",
            "mqtt",
            "iot"
        ],
        "is_answered": true,
        "view_count": 36061,
        "favorite_count": 6,
        "score": 30,
        "last_activity_date": 1467378747,
        "creation_date": 1451441855,
        "question_id": 34522053,
        "link": "https://stackoverflow.com/questions/34522053/what-is-the-maximum-message-length-for-a-mqtt-broker",
        "title": "What is the maximum message length for a MQTT broker?",
        "body": "<p>I am using the node.js mosca MQTT broker for some internet of things (iot) application.</p>\n\n<p><a href=\"https://github.com/mcollina/mosca\" rel=\"noreferrer\">https://github.com/mcollina/mosca</a></p>\n\n<p>What is the maximum message length that a topic can receive for the mosca broker? What are the factors that constrain the message length? </p>\n\n<p>If I want to increase the message length, is there a configuration parameter I can modify or which part of the code can I change?</p>\n"
    }, {
        "tags": [
            "javascript",
            "node.js",
            "azure",
            "iot"
        ],
        "is_answered": true,
        "view_count": 1149,
        "favorite_count": 1,
        "score": 4,
        "last_activity_date": 1466388477,
        "creation_date": 1466144000,
        "question_id": 37874359,
        "link": "https://stackoverflow.com/questions/37874359/azure-node-js-service-bus-persistent-subscription-of-topic",
        "title": "Azure + Node Js Service bus persistent subscription of topic",
        "body": "<p>Using node js i want to create persistent subscription for Azure service bus service topic. right now it is execute only once. Please guide me I am new to this. Thanks in advance. I am using following code to subscribe topic.</p>\n\n<pre><code>var azure = require('azure');\n\nvar azureConnection = \"Endpoint=sb:My connection string\"\n\nvar retryOperations = new azure.ExponentialRetryPolicyFilter();\nvar serviceBusService = azure.createServiceBusService(azureConnection).withFilter(retryOperations);\n\nserviceBusService.receiveSubscriptionMessage('mytopic01', 'mytopicsub', function (error, receivedMessage) {\n\n    if (!error) {\n        // // // Message received and deleted\n        console.log(receivedMessage);\n    }\n});\n</code></pre>\n\n<p>Also I don't want to use setInterval function. I want to solution if message publish to the topic it should automatically trigger subscription. </p>\n"
    }, {
        "tags": [
            "amazon-web-services",
            "iot"
        ],
        "is_answered": true,
        "view_count": 745,
        "favorite_count": 0,
        "score": 1,
        "last_activity_date": 1466063497,
        "creation_date": 1465287329,
        "question_id": 37673969,
        "link": "https://stackoverflow.com/questions/37673969/listing-all-topics-in-aws-iot-to-isolate-rogue-topics",
        "title": "Listing all topics in AWS-IoT to isolate rogue topics",
        "body": "<p>Is there a way to list all the topics that the MQTT Clients are sending data to or receiving data from in AWS-IoT?</p>\n\n<ol>\n<li>I didn't come across this anywhere in the documentation or the console.</li>\n<li>What if a client device gets hacked, and the exploiter starts making his own topics and uses it as a network for himself? right now, is there a way to track rogue topics and kick the device out?</li>\n</ol>\n\n<p>If I know there is an unauthorized topic i can detect it, but for that i still need a list of topics like we get in RabbitMQ.</p>\n\n<p>Any thoughts?</p>\n"
    }, {
        "tags": [
            "mqtt",
            "iot"
        ],
        "is_answered": false,
        "view_count": 278,
        "favorite_count": 0,
        "score": 2,
        "last_activity_date": 1464517346,
        "creation_date": 1464517346,
        "question_id": 37508738,
        "link": "https://stackoverflow.com/questions/37508738/iot-foundation-errors-the-topic-is-not-valid-the-topic-does-not-match-an-allow",
        "title": "IoT Foundation errors (The topic is not valid, The topic does not match an allowed rule)",
        "body": "<p>I have a device connected to IBM IoT foundation. It uses a TI CC3100 Wi-Fi chip driven by an MSP430 MCU. The device used to connect perfectly to IOTF in the past. I didn't use it for a couple of months and now suddenly it does not connect. Did IBM recently change anything in the MQTT protocol for IOTF ?</p>\n\n<p>I get the following messages on the device's console:</p>\n\n<p><Blockquote><BR>Device is configured in default state<BR>\nDevice started as STATION<BR>\nConnection established with AP<BR>\nBroker connect failed for conn no. 1<BR>\nExiting the Application<BR></Blockquote></p>\n\n<p>In the Watson IoT foundation dashboard I see the following messages (in the connection log):</p>\n\n<p><Blockquote><BR>Closed connection from 217.132.56.201. The topic does not match an allowed rule 2 times in the last 5 minutes   May 29, 2016 8:36:46 AM<BR>\nClosed connection from 217.132.56.201. The topic is not valid. 2 times in the last 5 minutes<BR></Blockquote></p>\n\n<p>Can anyone help resolving this problem ?</p>\n\n<p>Thanks a lot,\nDanny </p>\n"
    }, {
        "tags": [
            "mqtt",
            "iot",
            "paho"
        ],
        "is_answered": false,
        "view_count": 629,
        "favorite_count": 0,
        "score": 0,
        "last_activity_date": 1463746455,
        "creation_date": 1463742875,
        "last_edit_date": 1463746455,
        "question_id": 37345259,
        "link": "https://stackoverflow.com/questions/37345259/message-exchange-between-paho-java-javascript-client-not-happening",
        "title": "Message exchange between Paho java &amp; javascript client not happening",
        "body": "<p>How can I send a message from paho java client to paho javascript client.</p>\n\n<pre><code>    String topic        = \"chatWith/904\";\n    String content      = \"Message from MqttPublishSample\";\n    int qos             = 0;\n    String broker       = \"tcp://127.0.0.1:1883\";\n    String clientId     = \"JavaSample\";\n    MemoryPersistence persistence = new MemoryPersistence();\n\n    try {\n        MqttClient sampleClient = new MqttClient(broker, clientId, persistence);\n        MqttConnectOptions connOpts = new MqttConnectOptions();\n        connOpts.setCleanSession(true);\n        System.out.println(\"Connecting to broker: \"+broker);\n        sampleClient.connect(connOpts);\n        System.out.println(\"Connected\");\n        System.out.println(\"Publishing message: \"+content);\n        MqttMessage message = new MqttMessage(content.getBytes());\n        message.setQos(qos);\n        sampleClient.publish(topic, message);\n        System.out.println(\"Message published\");\n        sampleClient.disconnect();\n        System.out.println(\"Disconnected\");\n        System.exit(0);\n    } catch(MqttException me) {\n        me.printStackTrace();\n    }\n</code></pre>\n\n<p>Message exchange between two JS client is happening. But between Javasript &amp; java client, message exchange is not happening.</p>\n\n<p>Here is JS code</p>\n\n<pre><code> client = new Messaging.Client(host, Number(port), clientId);\n\n  client.onConnect = onConnect;\n\n  client.onMessageArrived = onMessageArrived;\n  client.onMessageDelivered = onMessageDelivered;\n  client.onConnectionLost = onConnectionLost;            \n var willMessage = createByteMessage({\n        id: '',\n        'msgType':'USER_STATUS',\n        'status': 'Offline',\n        'senderId': myUserId,\n        'senderName': myName\n    }, statusTopic);    \n    willMessage.retained = true;  \n\n  client.connect({\n    userName:user, \n    password:password, \n    onSuccess:onConnect, \n    onFailure:onFailure,\n    'willMessage': willMessage\n  }); \n</code></pre>\n\n<p>Here port is 8083 and mqtt broker is <a href=\"http://emqtt.io\" rel=\"nofollow\">emqtt</a></p>\n\n<p><code>client.config</code></p>\n\n<pre><code>testclientid0\ntestclientid1 127.0.0.1\ntestclientid2 192.168.0.1/24\n</code></pre>\n\n<p><code>emqttd.config</code></p>\n\n<pre><code>% -*- mode: erlang;erlang-indent-level: 4;indent-tabs-mode: nil -*-\n%% ex: ft=erlang ts=4 sw=4 et\n[{kernel, [\n    {start_timer, true},\n    {start_pg2, true}\n ]},\n {sasl, [\n    {sasl_error_logger, {file, \"log/emqttd_sasl.log\"}}\n ]},\n {ssl, [\n    %{versions, ['tlsv1.2', 'tlsv1.1']}\n ]},\n {lager, [\n    {colored, true},\n    {async_threshold, 5000},\n    {error_logger_redirect, false},\n    {crash_log, \"log/emqttd_crash.log\"},\n    {handlers, [\n        %%{lager_console_backend, info},\n        %%NOTICE: Level &gt;= error\n        %%{lager_emqtt_backend, error},\n        {lager_file_backend, [\n            {formatter_config, [time, \" \", pid, \" [\",severity,\"] \", message, \"\\n\"]},\n            {file, \"log/emqttd_error.log\"},\n            {level, error},\n            {size, 104857600},\n            {date, \"$D0\"},\n            {count, 30}\n        ]}\n    ]}\n ]},\n {esockd, [\n    {logger, {lager, error}}\n ]},\n {emqttd, [\n    %% Authentication and Authorization\n    {access, [\n        %% Authetication. Anonymous Default\n        {auth, [\n            %% Authentication with username, password\n            %{username, []},\n\n            %% Authentication with clientid\n            %{clientid, [{password, no}, {file, \"etc/clients.config\"}]},\n\n            %% Authentication with LDAP\n            % {ldap, [\n            %    {servers, [\"localhost\"]},\n            %    {port, 389},\n            %    {timeout, 30},\n            %    {user_dn, \"uid=$u,ou=People,dc=example,dc=com\"},\n            %    {ssl, fasle},\n            %    {sslopts, [\n            %        {\"certfile\", \"ssl.crt\"},\n            %        {\"keyfile\", \"ssl.key\"}]}\n            % ]},\n\n            %% Allow all\n            {anonymous, []}\n        ]},\n        %% ACL config\n        {acl, [\n            %% Internal ACL module\n            {internal,  [{file, \"etc/acl.config\"}, {nomatch, allow}]}\n        ]}\n    ]},\n    %% MQTT Protocol Options\n    {mqtt, [\n        %% Packet\n        {packet, [\n            %% Max ClientId Length Allowed\n            {max_clientid_len, 512},\n            %% Max Packet Size Allowed, 64K default\n            {max_packet_size, 65536}\n        ]},\n        %% Client\n        {client, [\n            %% Socket is connected, but no 'CONNECT' packet received\n            {idle_timeout, 30} %% seconds\n        ]},\n        %% Session\n        {session, [\n            %% Max number of QoS 1 and 2 messages that can be \u201cin flight\u201d at one time.\n            %% 0 means no limit\n            {max_inflight, 100},\n\n            %% Retry interval for redelivering QoS1/2 messages.\n            {unack_retry_interval, 60},\n\n            %% Awaiting PUBREL Timeout\n            {await_rel_timeout, 20},\n\n            %% Max Packets that Awaiting PUBREL, 0 means no limit\n            {max_awaiting_rel, 0},\n\n            %% Statistics Collection Interval(seconds)\n            {collect_interval, 0},\n\n            %% Expired after 2 day (unit: minute)\n            {expired_after, 2880}\n\n        ]},\n        %% Queue\n        {queue, [\n            %% simple | priority\n            {type, simple},\n\n            %% Topic Priority: 0~255, Default is 0\n            %% {priority, [{\"topic/1\", 10}, {\"topic/2\", 8}]},\n\n            %% Max queue length. Enqueued messages when persistent client disconnected,\n            %% or inflight window is full.\n            {max_length, infinity},\n\n            %% Low-water mark of queued messages\n            {low_watermark, 0.2},\n\n            %% High-water mark of queued messages\n            {high_watermark, 0.6},\n\n            %% Queue Qos0 messages?\n            {queue_qos0, true}\n        ]}\n    ]},\n    %% Broker Options\n    {broker, [\n        %% System interval of publishing broker $SYS messages\n        {sys_interval, 60},\n\n        %% Retained messages\n        {retained, [\n            %% Expired after seconds, never expired if 0\n            {expired_after, 0},\n\n            %% Max number of retained messages\n            {max_message_num, 100000},\n\n            %% Max Payload Size of retained message\n            {max_playload_size, 65536}\n        ]},\n\n        %% PubSub and Router\n        {pubsub, [\n            %% Default should be scheduler numbers\n            {pool_size, 8},\n\n            %% Store Subscription: true | false\n            {subscription, true},\n\n            %% Route aging time(seconds)\n            {route_aging, 5}\n        ]},\n\n        %% Bridge\n        {bridge, [\n            %%TODO: bridge queue size\n            {max_queue_len, 10000},\n\n            %% Ping Interval of bridge node\n            {ping_down_interval, 1} %seconds\n        ]}\n    ]},\n    %% Modules\n    {modules, [\n        %% Client presence management module.\n        %% Publish messages when client connected or disconnected\n        {presence, [{qos, 0}]},\n\n        %% Subscribe topics automatically when client connected\n        {subscription, [\n\n            %% $c will be replaced by clientid\n            %% {\"$queue/clients/$c\", 1},\n\n            %% Static subscriptions from backend\n            backend\n        ]}\n\n        %% Rewrite rules\n        %% {rewrite, [{file, \"etc/rewrite.config\"}]}\n    ]},\n    %% Plugins\n    {plugins, [\n        %% Plugin App Library Dir\n        {plugins_dir, \"./plugins\"},\n\n        %% File to store loaded plugin names.\n        {loaded_file, \"./data/loaded_plugins\"}\n    ]},\n\n    %% Listeners\n    {listeners, [\n        {mqtt, 1883, [\n            %% Size of acceptor pool\n            {acceptors, 16},\n\n            %% Maximum number of concurrent clients\n            {max_clients, 512},\n\n            %% Socket Access Control\n            {access, [{allow, all}]},\n\n            %% Connection Options\n            {connopts, [\n                %% Rate Limit. Format is 'burst, rate', Unit is KB/Sec\n                %% {rate_limit, \"100,10\"} %% 100K burst, 10K rate\n            ]},\n\n            %% Socket Options\n            {sockopts, [\n                %Set buffer if hight thoughtput\n                %{recbuf, 4096},\n                %{sndbuf, 4096},\n                %{buffer, 4096},\n                %{nodelay, true},\n                {backlog, 1024}\n            ]}\n        ]},\n\n        {mqtts, 8883, [\n            %% Size of acceptor pool\n            {acceptors, 4},\n\n            %% Maximum number of concurrent clients\n            {max_clients, 512},\n\n            %% Socket Access Control\n            {access, [{allow, all}]},\n\n            %% SSL certificate and key files\n            {ssl, [{certfile, \"etc/ssl/ssl.crt\"},\n                   {keyfile,  \"etc/ssl/ssl.key\"}]},\n\n            %% Socket Options\n            {sockopts, [\n                {backlog, 1024}\n                %{buffer, 4096},\n            ]}\n        ]},\n        %% WebSocket over HTTPS Listener\n        %% {https, 8083, [\n        %%  %% Size of acceptor pool\n        %%  {acceptors, 4},\n        %%  %% Maximum number of concurrent clients\n        %%  {max_clients, 512},\n        %%  %% Socket Access Control\n        %%  {access, [{allow, all}]},\n        %%  %% SSL certificate and key files\n        %%  {ssl, [{certfile, \"etc/ssl/ssl.crt\"},\n        %%         {keyfile,  \"etc/ssl/ssl.key\"}]},\n        %%  %% Socket Options\n        %%  {sockopts, [\n        %%      %{buffer, 4096},\n        %%      {backlog, 1024}\n        %%  ]}\n        %%]},\n\n        %% HTTP and WebSocket Listener\n        {http, 8083, [\n            %% Size of acceptor pool\n            {acceptors, 4},\n            %% Maximum number of concurrent clients\n            {max_clients, 64},\n            %% Socket Access Control\n            {access, [{allow, all}]},\n            %% Socket Options\n            {sockopts, [\n                {backlog, 1024}\n                %{buffer, 4096},\n            ]}\n        ]}\n    ]},\n\n    %% Erlang System Monitor\n    {sysmon, [\n        %% Long GC, don't monitor in production mode for:\n        %% https://github.com/erlang/otp/blob/feb45017da36be78d4c5784d758ede619fa7bfd3/erts/emulator/beam/erl_gc.c#L421\n        {long_gc, false},\n\n        %% Long Schedule(ms)\n        {long_schedule, 240},\n\n        %% 8M words. 32MB on 32-bit VM, 64MB on 64-bit VM.\n        %% 8 * 1024 * 1024\n        {large_heap, 8388608},\n\n        %% Busy Port\n        {busy_port, false},\n\n        %% Busy Dist Port\n        {busy_dist_port, true}\n\n    ]}\n ]}\n].\n</code></pre>\n"
    }, {
        "tags": [
            "android",
            "ibm-cloud",
            "mqtt",
            "iot"
        ],
        "is_answered": true,
        "view_count": 155,
        "favorite_count": 0,
        "score": 1,
        "last_activity_date": 1463475622,
        "creation_date": 1463311168,
        "last_edit_date": 1463460785,
        "question_id": 37237614,
        "link": "https://stackoverflow.com/questions/37237614/ibm-bluemix-disconnecting-the-mqttandroidclient-after-sometime",
        "title": "IBM Bluemix disconnecting the MqttAndroidClient after sometime",
        "body": "<p>I am working on CC2650 sensortag and Bluemix(using IOT starter boilerplate) as a cloud solution.\nThe cc2650 android app uses MqttAndroidClient to connect to MQTT server provided by bluemix. The problem I am facing after sometime (around 7 mins) it get timedout.</p>\n\n<p>Following exception is visible on the android studio console\n<em>d:2f7tpk:ti-sensortag2:B0B448C07886: Timed out as no activity, keepAlive=240,000 lastOutboundActivity=1,463,309,545,312 lastInboundActivity=1,463,309,275,609 time=1,463,309,785,352 lastPing=1,463,309,545,312</em></p>\n\n<p>Please note that every 10 seconds I am publishing the data to server from my android client app. So not sure why it is saying no activity.\nKeepalive interval is set to 120 seconds.</p>\n\n<p>I confirmed it. It is IBM Bluemix which is disconnecting the client after approx 7 min. During this period client was continuously sending the data in 10 sec interval and that was also visible on the Bluemix device page.</p>\n\n<p>Any idea why Bluemix is disconnecting it after 6-7 minutes (It is not fixed but out of 6 in 5 it got disconnected in 7 min and once it was around 6 min).</p>\n\n<p>New observation:\nThe other observation is once it is disconnected then it takes 10-12 retries before I am able to reconnect to Bluemix server. From Mqttv3 client I get the exception \"Unable to connect to server\". But during this period I am able to ping to server through cmdline ping utility.</p>\n"
    }, {
        "tags": [
            "android",
            "mqtt",
            "iot",
            "mosquitto",
            "paho"
        ],
        "is_answered": true,
        "view_count": 2710,
        "favorite_count": 1,
        "score": 0,
        "last_activity_date": 1459320132,
        "creation_date": 1459267530,
        "question_id": 36289471,
        "link": "https://stackoverflow.com/questions/36289471/mosquitto-broker-retain-multiple-messages",
        "title": "mosquitto broker retain multiple messages",
        "body": "<p>I am having mosquitto broker running on Ubuntu on EC2. Also I did a change <code>max_queued_messages 1000</code> and <code>max_inflight_messages 10</code> in <code>/etc/mosquitto/mosquitto.conf</code></p>\n\n<p>I am publishing to this broker with <strong>qos=2</strong> and <strong>retain enabled</strong>. For publishing I am using <code>mosquitto_pub -t 1 -m \"{c:{d:\\\"pN\\\",m:\\\"Pr1\\\"}}\" -r -q 2</code>. And subscriber side I am using  <code>org.eclipse.paho.android.service:1.0.2</code> library with same qos=2. <br>and only providing single option by <code>options.setMqttVersion(MqttConnectOptions.MQTT_VERSION_3_1)</code> for parameters to <code>client.connect(options)</code>.</p>\n\n<p>Problem is coming if subscriber device connected to the server disconnects and reconnects again due to any reason, then getting only single last retained message, it is missing the all in between messages.\n<br>And also if nothing even published yet, still after reconnecting gets the last retained message which subscriber device might had already got before disconnecting.</p>\n\n<p>I want that after reconnecting subscriber should get all messages which were published in the period of disconnection and if already got then should not shown again. Wanted to know how and where to do it.</p>\n"
    }, {
        "tags": [
            "android",
            "mqtt",
            "iot",
            "paho",
            "m2m"
        ],
        "is_answered": true,
        "view_count": 1345,
        "favorite_count": 2,
        "score": 0,
        "last_activity_date": 1458753555,
        "creation_date": 1458752900,
        "question_id": 36184490,
        "link": "https://stackoverflow.com/questions/36184490/mqtt-client-disconnects-when-another-client-connects-to-the-server",
        "title": "Mqtt client disconnects when another client connects to the server",
        "body": "<p>I am new to MQTT messaging system, but yet i managed to implement the paho Android service in snapdragon board running AOSP kk-4.4.2 . My service will start at the boot up and it will connect to the public broker of HiveMQ with port 1883 .</p>\n\n<p>The problem is after connecting my Android device running my custom AOSP to the server and if i try to connect another client from the android application which is running on a phone. The client in the snapdragon board automatically disconnects from the server. when i try to reconnect it is connecting to the server again.</p>\n\n<p>I use different client Id and user names while connecting to the server</p>\n"
    }, {
        "tags": [
            "mqtt",
            "iot",
            "mosquitto",
            "broker"
        ],
        "is_answered": true,
        "view_count": 664,
        "favorite_count": 0,
        "score": 0,
        "last_activity_date": 1458131211,
        "creation_date": 1458128861,
        "last_edit_date": 1458131211,
        "question_id": 36034824,
        "link": "https://stackoverflow.com/questions/36034824/kick-or-ban-user-or-client-in-mosquitto-mqtt",
        "title": "Kick or Ban user or client in Mosquitto MQTT",
        "body": "<p>i have a configured Mosquitto MQTT broker... </p>\n\n<p>I'd like to <strong>kick</strong> or <strong>ban</strong> a user for an amount of time?</p>\n\n<p>How can i do this from another subscribed client? \nShould i do this from the broker? How?</p>\n"
    }, {
        "tags": [
            "ibm-cloud",
            "iot"
        ],
        "is_answered": false,
        "view_count": 178,
        "favorite_count": 0,
        "score": 0,
        "last_activity_date": 1457962087,
        "creation_date": 1457669915,
        "last_edit_date": 1457951261,
        "question_id": 35932138,
        "link": "https://stackoverflow.com/questions/35932138/bluemix-iot-foundation-starter-node-red-flow-doesnt-work",
        "title": "Bluemix IoT Foundation Starter - Node-Red flow doesn&#39;t work",
        "body": "<p>I'm following <a href=\"http://m2m.demos.ibm.com/iotstarter.html\" rel=\"nofollow\">http://m2m.demos.ibm.com/iotstarter.html</a></p>\n\n<p>I've connected my phone to the IoT service and could see messages in WebUI but provided Node-Red flow seems couldn't connect to IoT data. \nI've connected debug node to the IoT In node and don't see any messages.<br>\nAuthentication type was 'Bluemix' and changed to 'Quickstart' now. Is it related somehow?</p>\n\n<p>[{\"id\":\"2a8baa.ecd60456\",\"type\":\"comment\",\"name\":\"Sample 2: IoT Starter accel to color flow\",\"info\":\"\",\"x\":196,\"y\":275,\"z\":\"3f16d263.e01496\",\"wires\":[]},{\"id\":\"b83ddfdb.7b3368\",\"type\":\"ibmiot in\",\"authentication\":\"boundService\",\"apiKey\":\"\",\"inputType\":\"evt\",\"deviceId\":\"\",\"applicationId\":\"\",\"deviceType\":\"+\",\"eventType\":\"accel\",\"commandType\":\"\",\"format\":\"json\",\"name\":\"IBM IoT App In\",\"service\":\"registered\",\"allDevices\":true,\"allApplications\":\"\",\"allDeviceTypes\":true,\"allEvents\":false,\"allCommands\":\"\",\"allFormats\":false,\"x\":117,\"y\":313,\"z\":\"3f16d263.e01496\",\"wires\":[[\"64ebf370.5a0b5c\"]]},{\"id\":\"64ebf370.5a0b5c\",\"type\":\"function\",\"name\":\"Handle accel\",\"func\":\"msg.deviceId = msg.payload.d.deviceId;\\nmsg.deviceType = msg.payload.d.deviceType;\\nmsg.format = \\\"json\\\";\\n\\nvar accelZ = msg.payload.d.acceleration_z;\\nvar r = 0.0;\\nvar b = 0.0;\\nvar g = 0.0;\\nif (accelZ > 0) {\\n\\tg = 255.0;\\n} else if (accelZ &lt; 0) {\\n\\tr = 255.0;\\n} else {\\n\\tr = 104;\\n\\tg = 109;\\n\\tb = 115;\\n}\\na = 1.0;\\n\\t\\nmsg.eventOrCommandType = \\\"color\\\";\\nmsg.payload = JSON.stringify({\\\"d\\\":{\\\"deviceId\\\":msg.deviceId, \\\"r\\\":r,\\\"b\\\":b,\\\"g\\\":g,\\\"alpha\\\":a}});\\n\\nreturn msg;\",\"outputs\":1,\"x\":287,\"y\":313,\"z\":\"3f16d263.e01496\",\"wires\":[[\"56d70240.c2bd14\"]]},{\"id\":\"56d70240.c2bd14\",\"type\":\"ibmiot out\",\"authentication\":\"boundService\",\"apiKey\":\"\",\"outputType\":\"cmd\",\"deviceId\":\"AAA\",\"deviceType\":\"iPhone\",\"eventCommandType\":\"text\",\"format\":\"json\",\"data\":\"{\\\"d\\\":{\\\"value\\\":\\\"text\\\"}}\",\"name\":\"IBM IoT App Out\",\"service\":\"registered\",\"x\":469,\"y\":313,\"z\":\"3f16d263.e01496\",\"wires\":[]}]</p>\n"
    }, {
        "tags": [
            "server",
            "client",
            "mqtt",
            "iot",
            "m2m"
        ],
        "is_answered": true,
        "view_count": 709,
        "favorite_count": 0,
        "score": 2,
        "last_activity_date": 1457456441,
        "creation_date": 1457397392,
        "question_id": 35856845,
        "link": "https://stackoverflow.com/questions/35856845/how-does-a-mqtt-server-send-a-message-to-a-client-saying-that-its-not-authorized",
        "title": "How does a MQTT server send a message to a client saying that its not authorized to connect?",
        "body": "<p>I have a MQTT client that sends a CONNECT packet the the MQTT broker with username and password. Now if the client is not authorized to connect, the broker is going to close the connection. How can the MQTT broker tell the client that the reason for closing the connection is that its not authorized? The CONNACK packet does not allow any payloads.</p>\n\n<p>Thanks!</p>\n"
    }, {
        "tags": [
            "mqtt",
            "iot",
            "mosquitto"
        ],
        "is_answered": false,
        "view_count": 278,
        "favorite_count": 0,
        "score": 0,
        "last_activity_date": 1454515870,
        "creation_date": 1454515055,
        "last_edit_date": 1454515870,
        "question_id": 35181722,
        "link": "https://stackoverflow.com/questions/35181722/mqtt-complete-broker-control-via-api-or-ui",
        "title": "MQTT: Complete broker control via API or UI",
        "body": "<p>I am using mosquitto as a broker for delivering QoS1 messages.</p>\n\n<p>Sometimes, the device may fail to acknowledge a particular type of message. For example, if a message causes the device to reset, the device won't acknowledge the message. Upon reboot, it will receive the message again. So it will enter an infinite reboot-connect-reboot cycle. Setting the clean session flag is not an option as frequent disconnections are to be expected and I do not want the device to miss messages sent when it was disconnected.</p>\n\n<p>I can take care while writing device and server side code to prevent such things from happening but the possibility of bugs cannot be ruled out. </p>\n\n<p>I was hoping to find something which gives the server side application or administrator full control over the broker - things like querying list of connected/registered clients, ability to list/delete messages from queues of a particular client. Cleaning the session of a client without client requesting it. </p>\n\n<p>If not that I would atleast like to know if there is a config option to control maximum number of retries for QoS1/QoS2 messages in mosquitto (or any other broker barring the cloud based ones). The client is a GSM node. Such infinite loops can end up consuming large amounts of cellular data.</p>\n\n<p>MQTT is great but I'm finding that the brokers lack many fundamental features required for real world applications.</p>\n"
    }, {
        "tags": [
            "protocols",
            "messaging",
            "mqtt",
            "iot"
        ],
        "is_answered": true,
        "view_count": 1745,
        "favorite_count": 0,
        "score": 8,
        "last_activity_date": 1454424445,
        "creation_date": 1454111009,
        "last_edit_date": 1495540232,
        "question_id": 35096109,
        "link": "https://stackoverflow.com/questions/35096109/how-to-enforce-the-order-of-messages-passed-to-an-iot-device-over-mqtt-via-a-clo",
        "title": "How to enforce the order of messages passed to an IoT device over MQTT via a cloud-based system (API design issue)",
        "body": "<p>Suppose I have an IoT device which I'm about to control (lets say switch on/off) and monitor (e.g. collect temperature readings). It seems MQTT could be the right fit. I could publish messages to the device to control it and the device could publish messages to a broker to report temperature readings. So far so good.</p>\n\n<p>The problems start to occur when I try to design the API to control the device.</p>\n\n<p>Lets day the device subscribes to two topics:</p>\n\n<ul>\n<li>/device-id/control/on</li>\n<li>/device-id/control/off</li>\n</ul>\n\n<p>Then I publish messages to these topics in some order. But given the fact that messaging is typically an asynchronous process there are no guarantees on the order of messages received by the device.</p>\n\n<p>So in case two messages are published in the following order:</p>\n\n<ol>\n<li>/device-id/control/on</li>\n<li>/device-id/control/off</li>\n</ol>\n\n<p>they <em>could</em> be received in the reversed order leaving the device turned on, which can have dramatic consequences, depending on the context.</p>\n\n<p>Of course the API could be designed in some other way, for example there could be just one topic</p>\n\n<ol>\n<li>/device-id/control</li>\n</ol>\n\n<p>and the payload of individual messages would carry the meaning of an individual message (on/off). So in case messages are published to this topic in a given order they are expected to be received in the exact same order on the device.</p>\n\n<p>But what if the order of publishes to individual topics cannot be guaranteed? Suppose the following architecture of a system for IoT devices:</p>\n\n<pre><code>                       / control service \\\napplication -&gt; broker -&gt; control service -&gt; broker -&gt; IoT device\n                       \\ control service /\n</code></pre>\n\n<p>The components of the system are:</p>\n\n<ul>\n<li>an application which effectively controls the device by publishing messages to a broker</li>\n<li>a typical message broker</li>\n<li>a control service with some business logic</li>\n</ul>\n\n<p>The important part is that as in most modern distributed systems the control service is a distributed, multi instance entity capable of processing multiple control messages from the application at a time. Therefore the order of messages published by the application can end up totally mixed when delivered to the IoT device.</p>\n\n<p>Now given the fact that most MQTT brokers only implement QoS0 and QoS1 but no QoS2 it gets even more interesting as such control messages could potentially be delivered multiple times (assuming QoS1 - see <a href=\"https://stackoverflow.com/a/30959058/1776942\">https://stackoverflow.com/a/30959058/1776942</a>).</p>\n\n<p>My point is that separate topics for control messages is a bad idea. The same goes for a single topic. In both cases there are no message delivery order guarantees.</p>\n\n<p>The only solution to this particular issue that comes to my mind is message versioning so that old (out-dated) messages could simply be skipped when delivered after another message with more recent version property.</p>\n\n<ul>\n<li>Am I missing something?</li>\n<li>Is message versioning the only solution to this problem? </li>\n</ul>\n"
    }, {
        "tags": [
            "lua",
            "microcontroller",
            "ibm-cloud",
            "iot",
            "esp8266"
        ],
        "is_answered": true,
        "view_count": 821,
        "favorite_count": 0,
        "score": 4,
        "last_activity_date": 1454274850,
        "creation_date": 1453885681,
        "question_id": 35032975,
        "link": "https://stackoverflow.com/questions/35032975/nodemcu-fails-to-connect-to-bluemix-with-tls",
        "title": "NodeMCU fails to connect to Bluemix with TLS",
        "body": "<p>I try to connect the NodeMCU with the IBM Bluemix IoT Foundation. The unsecured MQTT connect works splendid and pushes data from a BMP180 to the cloud. However, when I start using TLS it won't connect to the broker. I tried to make a TLS connection with mqtt.fx and it works fine, it seems like the NodeMCU is the problem.\nIf I run this code:</p>\n\n<pre class=\"lang-Lua prettyprint-override\"><code>orgID=\"****\"\nBROKER = orgID..\".&lt;bluemix&gt;\"\nBRPORT = 8883\n\nCLIENTID = \"d:\"..orgID..\":generic_esp:generic_esp_01\"\nprint(\"ClientID: \"..CLIENTID)\nBRPWD  = \"***********\"\n\nBRUSER = \"use-token-auth\"\n\nlocal function publish()\n   dofile('sensor.lc')\n   m:publish('iot-2/evt/esp8266/fmt/json',payload,1,0, \n            function(conn) print('Payload published') end)\nend\n\nm = mqtt.Client(CLIENTID, 120, BRUSER, BRPWD)\nc = false\n\nprint('MQTT Init')\nm:on('offline', function(con) print('mqtt offline'); c = false end)\nm:connect(BROKER, BRPORT, 1, function(conn) \n   print('MQTT connected: '..BROKER..':'..BRPORT) \n   c = true \n   publish()\nend)\n\ntmr.alarm(1, 1000, 1, function() \n    if not c then\n      print('MQTT reconnecting')\n      m:close()\n      c = false\n      m:connect(BROKER, BRPORT, 1, function(conn) print('.. MQTT reconnected: '..BROKER..':'..BRPORT); c = true end)\n    end\n    if c then\n      publish()\n    end\n end)\n</code></pre>\n\n<p>the esp8266 just prints \"MQTT reconnecting\" and can't connect.\nIs something wrong with my code or is TLS not fully supported in NodeMCU 1.4, yet?</p>\n"
    }, {
        "tags": [
            "android",
            "ibm-cloud",
            "mqtt",
            "iot",
            "paho"
        ],
        "is_answered": true,
        "view_count": 378,
        "favorite_count": 0,
        "score": 1,
        "last_activity_date": 1453295712,
        "creation_date": 1453285956,
        "last_edit_date": 1453286682,
        "question_id": 34897561,
        "link": "https://stackoverflow.com/questions/34897561/bluemix-quickstart-disconnects-at-publish-with-paho-mqtt-client",
        "title": "Bluemix quickstart disconnects at publish with Paho MQTT client",
        "body": "<p>I used Paho MQTT client in Android to connect to IBM Bluemix quickstart IoT service. The connection part works well, but when I publish, the cloud application displays that I'm disconnected, but in the client I don't get exceptions.</p>\n\n<p>I use this permission:</p>\n\n<pre><code>&lt;uses-permission android:name=\"android.permission.INTERNET\"/&gt;\n</code></pre>\n\n<p>Connect:</p>\n\n<pre><code>String broker       = \"tcp://quickstart.messaging.internetofthings.ibmcloud.com:1883\";\nString clientId     = \"d:quickstart:iotqs-sensor:myDeviceID\";\n\ntry {\n    client = new MqttClient(broker, clientId, null);\n    MqttConnectOptions connOpts = new MqttConnectOptions();\n    client.connect(connOpts);\n} catch(MqttException me) {\n</code></pre>\n\n<p>Publish:</p>\n\n<pre><code>String topic        = \"iot-2/evt/iotsensor/fmt/jon\";\nString content      = \"{ \\\"d\\\" : { \\\"data\\\" : 5 } }\";\n\ntry {\n    MqttMessage message = new MqttMessage(content.getBytes());\n    message.setQos(0);\n    client.publish(topic, message);\n} catch(MqttException me) {\n</code></pre>\n\n<p>The strange thing is: this code worked yesterday.\nWhat could be the problem?\nThe next step will be to connect and publish to my own Bluemix IoT service, but if I can't send messages to the demo, I can't hope for more.</p>\n\n<p>UPDATE:\nIf I connect, and publish, the quickstart app shows that I'm disconnected, but the client still lets me publish for about 3 secs, after that I get an exception: 32104 (the client is not connected).</p>\n"
    }, {
        "tags": [
            "android",
            "node.js",
            "ibm-cloud",
            "iot"
        ],
        "is_answered": true,
        "view_count": 275,
        "favorite_count": 0,
        "score": 0,
        "last_activity_date": 1453214829,
        "creation_date": 1453142662,
        "last_edit_date": 1453203812,
        "question_id": 34861842,
        "link": "https://stackoverflow.com/questions/34861842/ibm-bluemix-iot-topics-url-different-for-android-vs-node-js-clarification-requ",
        "title": "IBM Bluemix IoT Topics/URL, different for Android vs Node.js, clarification required?",
        "body": "<p>I am using an IoT service in Bluemix, and am connecting to it with a Node.js express server and an Android device. </p>\n\n<p>The Android app is based on the ibmiot starter app(<a href=\"https://github.com/ibm-messaging/iot-starter-for-android\" rel=\"nofollow\">https://github.com/ibm-messaging/iot-starter-for-android</a>). This connects with:<br>\nURL: <code>&lt;org</code>>.messaging.internetofthings.ibmcloud.com:1883<br>\nTopic format: iot-2/cmd/+/fmt/json<br>\nCredentials: organization, deviceType, deviceId</p>\n\n<p>The express server connects with the npm ibmiotf module, version 0.2.2. Connects with:<br>\nURL:  <code>&lt;org</code>>.messaging.internetofthings.ibmcloud.com:8883<br>\nTopic format: iot-2/type/<code>&lt;type</code>>/id/<code>&lt;id</code>>/cmd/<code>&lt;cmd</code>>/fmt/json<br>\nCredentials: organization, id (Bluemix space name?), apiKey, apiToken</p>\n\n<p>If I try to subscribe to a topic in the second format with the Android app, I am disconnected from the service due to the topic not being valid. However, the provided object (ApplicationClient) from the npm node contains functions such as publishDeviceCommand(deviceType, deviceId, commandType, format, data)<br>\nwhich publishes to a topic in the second format, which the app cannot subscribe to. Is this reformatting of the topic styles due to different versions?</p>\n\n<p>So, how can I publish to a valid topic with the express server that the app can subscribe to? Does this require writing my own version of publishDeviceCommand? This is feasible, but does not seem ideal. It also is a function within the provided npm module, changes would only be local and not remote. </p>\n\n<p>I can view events that the app publishes to topics in the first format through the service Dashboard, but I cannot see the same for the express ApplicationClient - perhaps because it is not a registered device? </p>\n"
    }, {
        "tags": [
            "java",
            "ibm-cloud",
            "mqtt",
            "iot"
        ],
        "is_answered": true,
        "view_count": 1085,
        "favorite_count": 0,
        "score": 2,
        "last_activity_date": 1453129182,
        "creation_date": 1453061143,
        "question_id": 34843041,
        "link": "https://stackoverflow.com/questions/34843041/publishing-commands-to-device-in-ibm-iot-using-mqtt-in-java",
        "title": "Publishing commands to device in IBM IoT using MQTT in Java",
        "body": "<p>I am currently trying to publish a command to a specific topic in the IBM IoT Foundation MQTT Broker using a Java web application. My application is already able to listen to device events and act on them, however publishing commands to the device is a problem. I know for sure that my device is listening to the proper topic for commands, so what could be the problem? More specifically, here is the command I call to publish to the topic (from my Java app): </p>\n\n<pre><code>publish(\"iot-2/cmd/\" + MQTTUtil.getDefaultCmdId() + \"/fmt/json\", rawJSONCommand, false, 0); \nSystem.out.println(\"Finished sending command!\"); \n</code></pre>\n\n<p>Where the \"publish\" method is defined as follows: </p>\n\n<pre><code>public void publish(String topic, String message, boolean retained, int qos) { // check if client is connected\nif (isMqttConnected()) \n{\n// create a new MqttMessage from the message string \nMqttMessage mqttMsg = new MqttMessage(message.getBytes()); \n// set retained flag \nmqttMsg.setRetained(retained); \n// set quality of service \nmqttMsg.setQos(qos);\ntry { \nSystem.out.println(\"About to send!\"); \nclient.publish(topic, mqttMsg); \nSystem.out.println(\"Finished sending!\"); } \ncatch (MqttPersistenceException e)\n{ e.printStackTrace(); } \ncatch (MqttException e)\n{ e.printStackTrace(); } }\nelse {\nSystem.out.println(\"Connection lost!\"); connectionLost(null); \n} }\n</code></pre>\n\n<p>All that happens is that I enter the method, I get \"About to send!\" printed on my console as the code specifies, and then the actual 'client.publish(topic, mqttMsg)' call blocks my program indefinitely.. Eventually, after blocking for a while, I get the following error: </p>\n\n<pre><code>org.eclipse.paho.client.mqttv3.internal.ClientState checkForActivity SEVERE: a:2uwqwc:&lt;MY_APP_NAME&gt;: Timed out as no write activity, keepAlive=60,000 lastOutboundActivity=1,452,646,209,624 lastInboundActivity=1,452,646,149,303 time=1,452,646,329,628 lastPing=0\n</code></pre>\n\n<p>Thanks for the help!</p>\n"
    }, {
        "tags": [
            "mqtt",
            "iot",
            "mosquitto",
            "broker",
            "esp8266"
        ],
        "is_answered": true,
        "view_count": 208,
        "favorite_count": 0,
        "score": 1,
        "last_activity_date": 1450434873,
        "creation_date": 1450409340,
        "question_id": 34348099,
        "link": "https://stackoverflow.com/questions/34348099/how-to-model-mqtt-broker-to-enable-clients-to-subscribe-to-their-messages-alone",
        "title": "How to model MQTT broker to enable clients to subscribe to their messages alone?",
        "body": "<p>I am new to MQTT protocol. I tested the MQTT broker which facilitates the publishing from my android phone and subscription of my IOT actuators(Motors). But I am confused, as how to enable actuators to work only from a particular publisher. In otherwords, I want to control my MotorA from my PhoneA and MotorB from PhoneB and so on... I don't know how to get started outside the localhost(LAN) to make my broker work with the help of internet.</p>\n\n<p>I am using Mosquitto broker and ESP8266 as client. Please share your views on how to get started with Mosquitto broker hosted on internet.</p>\n"
    }, {
        "tags": [
            "lua",
            "ibm-cloud",
            "mqtt",
            "iot"
        ],
        "is_answered": false,
        "view_count": 548,
        "favorite_count": 0,
        "score": 1,
        "last_activity_date": 1449495829,
        "creation_date": 1449442512,
        "last_edit_date": 1449495829,
        "question_id": 34123874,
        "link": "https://stackoverflow.com/questions/34123874/bluemix-iot-the-topic-is-not-valid",
        "title": "Bluemix IoT &quot;The topic is not valid&quot;",
        "body": "<p>Using Bluemix. Using NodeMCU MQTT Lua. Get the following message about topic is not valid. How to debug?</p>\n\n<hr>\n\n<p>Closed connection from 108.67.152.187. [The topic is not valid.] [6] times in the last [5] minutes</p>\n\n<p>Token auth succeeded: ClientID='myClientID'</p>\n\n<hr>\n\n<p>NodeMCU Lua code:</p>\n\n<p>t1=123 -- arbitrary value</p>\n\n<p>topic = \"iotsensor.fake\"</p>\n\n<p>m:publish(topic ,'{\"d\": {\"data\":'..t1..'}}', 0, 0,</p>\n\n<p>function(conn)\n -- Print confirmation of data published\n print(\"Sent message #\"..count..\" data:\"..t1)\n end)</p>\n"
    }, {
        "tags": [
            "c",
            "server",
            "mqtt",
            "iot"
        ],
        "is_answered": false,
        "view_count": 121,
        "favorite_count": 1,
        "score": 0,
        "last_activity_date": 1448082489,
        "creation_date": 1448082489,
        "question_id": 33839915,
        "link": "https://stackoverflow.com/questions/33839915/where-do-i-store-the-clients-subscribed-to-topics-in-a-mqtt-server",
        "title": "Where do I store the clients subscribed to topics in a MQTT server?",
        "body": "<p>So I'm trying to build a MQTT server using C. Now as you know, MQTT has a publish subscribe model where clients subscribe to topics and other clients publish to topics. </p>\n\n<p>So whenever a client connects to my MQTT broker and subscribes to a topic, where do I store the corresponding topic name and client? Do I create a hashmap containing topic names as keys and clients subscribed to them as values? Or is there any other way to do it?</p>\n\n<p>Also do I store this in memory or in a database? Which one would be more efficient? </p>\n\n<p>Thanks</p>\n"
    }, {
        "tags": [
            "logging",
            "ibm-cloud",
            "mqtt",
            "iot",
            "node-red"
        ],
        "is_answered": false,
        "view_count": 137,
        "favorite_count": 0,
        "score": 2,
        "last_activity_date": 1446207577,
        "creation_date": 1444051463,
        "question_id": 32949778,
        "link": "https://stackoverflow.com/questions/32949778/how-can-i-look-at-the-mqtt-log-in-bluemix-iotf",
        "title": "How can I look at the MQTT log in Bluemix IoTF",
        "body": "<p>I'm using Node-RED on Bluemix to talk to an Arduino Uno with a temperature sensor. I'm using a recipe that publishes the temperature to a MQTT Topic and have added code from the example that comes with the paho pubsubclient library by @knolleary to add code to subscribe to a MQTT topic.  I'm getting errors when trying to subscribe. How can I look at the MQTT logs to find out what is going wrong?</p>\n"
    }, {
        "tags": [
            "python",
            "flask",
            "mqtt",
            "iot",
            "paho"
        ],
        "is_answered": false,
        "view_count": 2979,
        "favorite_count": 1,
        "score": 2,
        "last_activity_date": 1445857711,
        "creation_date": 1443858649,
        "question_id": 32920225,
        "link": "https://stackoverflow.com/questions/32920225/sending-mqtt-messages-from-a-webpage-written-in-python-with-flask",
        "title": "sending MQTT messages from a webpage written in python with Flask",
        "body": "<p>I am trying to send a MQTT message from a web page built using Flask.</p>\n\n<p>I have established the connection in the main loop and I am able to send a message before starting Flask </p>\n\n<p>When i call:</p>\n\n<pre><code>client.publish('all/camera/'+path, 'all') \n</code></pre>\n\n<p>nothing happens. No error but no message is sent. My best guess is that this is a scope problem. ie. that the object 'client' is not visible to the function. I have tried to initiate the client outside of the main function and i have also tried to declare 'client' as global inside the capture() function</p>\n\n<p>the code for the flask app is below:</p>\n\n<pre><code>#!/usr/bin/env python\nfrom flask import Flask, render_template, request\nimport paho.mqtt.client as mqtt\nfrom datetime import datetime\n\napp = Flask(__name__)\n\n@app.route('/', methods = ['POST', 'GET'])\ndef capture():\n    timestring=datetime.now().strftime(\"%Y%m%d-%H%M%S\")\n    if 'sessionName' in request.form:\n        sessionName = request.form['sessionName']\n        path = sessionName + \"_\" + timestring\n        return render_template ('capture.html', path=path, timestring=timestring, sessionName=sessionName)\n        client.publish('all/camera/'+path, 'all')\n    else:\n        return render_template ('capture.html',timestring=timestring)\n\n\n# paho callbacks\n\ndef on_connect(client, userdata, flags, rc):\n\n    #sub here will re subscribe on reconnection\n    client.subscribe(\"+/camera/#\")\n    client.subscribe(\"+/led\")\n\n\n\n# Main Code\n\n\nif __name__=='__main__':\n\n    client = mqtt.Client()\n    client.on_connect = on_connect\n    client.connect(\"scanserver.local\",1883,60)\n    client.loop_start()\n    client.publish('debug', 'server running')\n\n    app.run(host = '0.0.0.0' , debug = True, port=5001)\n</code></pre>\n"
    }, {
        "tags": [
            "java",
            "iot",
            "mosquitto",
            "paho"
        ],
        "is_answered": true,
        "view_count": 243,
        "favorite_count": 0,
        "score": 0,
        "last_activity_date": 1445448756,
        "creation_date": 1445242692,
        "last_edit_date": 1445248766,
        "question_id": 33209672,
        "link": "https://stackoverflow.com/questions/33209672/mosquitto-qos-2-messages-delivered-more-than-once",
        "title": "mosquitto qos 2 messages delivered more than once",
        "body": "<p>I have Mosquitto installed on Windows 8 and I am trying to write Paho clients in Java to understand MQTT. I wrote a blocking publisher and a client subscriber. I created two threads of the subscribing client with different client ids. When I publish one message with QoS 2, both the clients receive the message. I am expecting exactly one client to receive the message. Is my expectation wrong?</p>\n\n<p>I felt I didn't program to the API correctly and wanted to troubleshoot with mosquitto_pub and mosquitto_sub. Same result. Both the subscribers received the message. Please check the screenshot here: <a href=\"http://imgur.com/a/G5a4D\" rel=\"nofollow\">http://imgur.com/a/G5a4D</a></p>\n\n<p>I am pretty sure that I am doing something wrong but I am not able to pinpoint it. All mosquitto.conf properties are set to default. Any help would be appreciated. I have exhausted half a day on this already. :(</p>\n"
    }, {
        "tags": [
            "python",
            "ibm-cloud",
            "mqtt",
            "iot"
        ],
        "is_answered": true,
        "view_count": 869,
        "favorite_count": 0,
        "score": 1,
        "last_activity_date": 1445341771,
        "creation_date": 1444505412,
        "question_id": 33058114,
        "link": "https://stackoverflow.com/questions/33058114/mqtt-client-keeps-disconnecting-from-bluemix-iot-foundation",
        "title": "MQTT client keeps disconnecting from Bluemix IOT Foundation",
        "body": "<p>I just try to connect to my Bluemix IOT Foundation instance with a mosquitto mqtt client. I configured everything as described in <a href=\"https://docs.internetofthings.ibmcloud.com/messaging/devices.html\" rel=\"nofollow\">https://docs.internetofthings.ibmcloud.com/messaging/devices.html</a>. My python client connects but disconnect after a second. </p>\n\n<pre><code>import paho.mqtt.client as mqtt\n\ndef on_connect(client, userdata, flags, rc):\n    print(\"Connected with result code \"+str(rc))\n    client.subscribe(\"$SYS/#\")\n\ndef on_disconnect(client, userdata, rc):\nprint(\"Disconnect with result code \"+str(rc))\n\ndef on_message(client, userdata, msg):\n    print(msg.topic+\" \"+str(msg.payload))\n\nclient = mqtt.Client(client_id=\"d:gixu3a:RaspberryPi:abcdefgh\")\n\nclient.on_connect    = on_connect\nclient.on_message    = on_message\nclient.on_disconnect = on_disconnect\n\nclient.username_pw_set(\"use-token-auth\", password=\"XXXXXXX\")\n\nclient.connect(\"gixu3a.messaging.internetofthings.ibmcloud.com\", 1883, 60)\n\nclient.loop_forever()\n</code></pre>\n\n<p>Return code when I get disconnected is 1 and I can also see the connection inside the IOT Foundation dashboard:</p>\n\n<pre><code>Connection State\nDisconnected on Saturday, October 10, 2015 at 9:10:22 PM from 89.140.177.130 \nwith an insecure connection Refresh\n</code></pre>\n\n<p>Can I get any logfile from the Bluemix side?</p>\n"
    }, {
        "tags": [
            "amazon-web-services",
            "certificate",
            "iot"
        ],
        "is_answered": true,
        "view_count": 228,
        "favorite_count": 1,
        "score": 2,
        "last_activity_date": 1444998477,
        "creation_date": 1444957206,
        "last_edit_date": 1444959094,
        "question_id": 33160908,
        "link": "https://stackoverflow.com/questions/33160908/aws-iot-cli-provision-a-security-certificate-is-it-working",
        "title": "AWS IoT - CLI Provision a Security Certificate - is it working?",
        "body": "<p>When I use AWS's CLI to get a security certificate for a IoT Thing I enter:</p>\n\n<blockquote>\n  <p>aws iot\u200b describe-certificate --certificate-id <em>myCertificateId</em>\n  --output text --query certificateDescription.certificatePem > cert.pem</p>\n</blockquote>\n\n<p>but I get </p>\n\n<blockquote>\n  <p>usage: aws [options]   [parameters] aws: error:\n  argument command: Invalid choice, valid choices are: blah blah blah</p>\n</blockquote>\n\n<p>However, cert.pem file was created, but it's empty. \nAlso the certificate did show up in the AWS IoT console with the correct <em>myCertificateId</em>.</p>\n\n<p>Did it work correctly? Is something wrong with the AWS CLI args parameter error handling?</p>\n"
    }, {
        "tags": [
            "mqtt",
            "iot",
            "messagebroker"
        ],
        "is_answered": true,
        "view_count": 1262,
        "favorite_count": 0,
        "score": 1,
        "last_activity_date": 1444722974,
        "creation_date": 1436792806,
        "last_edit_date": 1444722974,
        "question_id": 31384260,
        "link": "https://stackoverflow.com/questions/31384260/memory-usage-on-mqtt-subscription",
        "title": "Memory usage on MQTT subscription",
        "body": "<p>How much of memory used whenever we use from <strong># (wildcard)</strong> to subscription into many topics? for example if we have over <strong>10M topics</strong>, it's possible to use <strong>#</strong> to subscribe into all of them, or it caused to memory leaks?</p>\n"
    }, {
        "tags": [
            "eclipse",
            "mqtt",
            "iot",
            "mosquitto"
        ],
        "is_answered": true,
        "view_count": 93,
        "favorite_count": 0,
        "score": 1,
        "last_activity_date": 1444711451,
        "creation_date": 1436812956,
        "last_edit_date": 1444711451,
        "question_id": 31391040,
        "link": "https://stackoverflow.com/questions/31391040/mosquitto-universal-subscriber",
        "title": "Mosquitto Universal Subscriber",
        "body": "<p>I need to subscribe to all the topics of the broker as the superuser. I have tried adding \"/\" as the topic, but it didn't work. Please let me know how to subscribe every topic without adding separate topic subscriptions. </p>\n"
    }, {
        "tags": [
            "java",
            "eclipse",
            "iot"
        ],
        "is_answered": false,
        "view_count": 1213,
        "favorite_count": 0,
        "score": 3,
        "last_activity_date": 1443437945,
        "creation_date": 1432018441,
        "question_id": 30318654,
        "link": "https://stackoverflow.com/questions/30318654/eclipse-leshan-server-and-client-with-secure-keys-fails-with-requesttimeoutexcep",
        "title": "Eclipse Leshan server and client with secure keys fails with RequestTimeoutException",
        "body": "<p>The <code>LeshanStandalone.java</code> and <code>LeshanClientExample.java</code> that come with the Leshan source code are not setup with secure client connections. </p>\n\n<p>So I borrowed some code from <code>SecurityTest.java</code> and <code>SecureIntegrationTestHelper.java</code> to setup the server and client. </p>\n\n<p>My modified LeshanStandalone code:</p>\n\n<pre><code>public class LeshanStandalone {\n\n    private static final Logger LOG = LoggerFactory.getLogger(LeshanStandalone.class);\n\n    private Server server;\n    private LeshanServer lwServer;\n\n    public void start() throws NonUniqueSecurityInfoException {\n\n\n        // Build LWM2M server\n        LeshanServerBuilder builder = new LeshanServerBuilder();\n        builder.setLocalAddress(new InetSocketAddress(InetAddress.getLoopbackAddress(), 5683));\n        builder.setLocalAddressSecure(new InetSocketAddress(InetAddress.getLoopbackAddress(), 5684));\n\n        // Get public and private server key\n        PrivateKey privateKey = null;\n        PublicKey publicKey = null;\n\n        try {\n            // Get point values\n            byte[] publicX = DatatypeConverter\n                    .parseHexBinary(\"fcc28728c123b155be410fc1c0651da374fc6ebe7f96606e90d927d188894a73\");\n            byte[] publicY = DatatypeConverter\n                    .parseHexBinary(\"d2ffaa73957d76984633fc1cc54d0b763ca0559a9dff9706e9f4557dacc3f52a\");\n            byte[] privateS = DatatypeConverter\n                    .parseHexBinary(\"1dae121ba406802ef07c193c1ee4df91115aabd79c1ed7f4c0ef7ef6a5449400\");\n\n            // Get Elliptic Curve Parameter spec for secp256r1\n            AlgorithmParameters algoParameters = AlgorithmParameters.getInstance(\"EC\");\n            algoParameters.init(new ECGenParameterSpec(\"secp256r1\"));\n            ECParameterSpec parameterSpec = algoParameters.getParameterSpec(ECParameterSpec.class);\n\n            // Create key specs\n            KeySpec publicKeySpec = new ECPublicKeySpec(new ECPoint(new BigInteger(publicX), new BigInteger(publicY)),\n                    parameterSpec);\n            KeySpec privateKeySpec = new ECPrivateKeySpec(new BigInteger(privateS), parameterSpec);\n\n            // Get keys\n            publicKey = KeyFactory.getInstance(\"EC\").generatePublic(publicKeySpec);\n            privateKey = KeyFactory.getInstance(\"EC\").generatePrivate(privateKeySpec);\n\n            builder.setSecurityRegistry(new SecurityRegistryImpl(privateKey, publicKey));\n        } catch (InvalidKeySpecException | NoSuchAlgorithmException | InvalidParameterSpecException e) {\n            LOG.warn(\"Unable to load RPK.\", e);\n        }\n\n\n        lwServer = builder.build();\n\n        lwServer.getSecurityRegistry().add(SecurityInfo.newPreSharedKeyInfo(\"lwm2mClient\", \"testclient\", DatatypeConverter.parseHexBinary(\"73656372657450534b\")));\n        lwServer.start();\n\n        // Now prepare and start jetty\n        String webPort = System.getenv(\"PORT\");\n        if (webPort == null || webPort.isEmpty()) {\n            webPort = System.getProperty(\"PORT\");\n        }\n        if (webPort == null || webPort.isEmpty()) {\n            webPort = \"8080\";\n        }\n        server = new Server(Integer.valueOf(webPort));\n        WebAppContext root = new WebAppContext();\n        root.setContextPath(\"/\");\n        root.setResourceBase(this.getClass().getClassLoader().getResource(\"webapp\").toExternalForm());\n        root.setParentLoaderPriority(true);\n        server.setHandler(root);\n\n        // Create Servlet\n        EventServlet eventServlet = new EventServlet(lwServer);\n        ServletHolder eventServletHolder = new ServletHolder(eventServlet);\n        root.addServlet(eventServletHolder, \"/event/*\");\n\n        ServletHolder clientServletHolder = new ServletHolder(new ClientServlet(lwServer));\n        root.addServlet(clientServletHolder, \"/api/clients/*\");\n\n        ServletHolder securityServletHolder = new ServletHolder(new SecurityServlet(lwServer.getSecurityRegistry()));\n        root.addServlet(securityServletHolder, \"/api/security/*\");\n\n        ServletHolder objectSpecServletHolder = new ServletHolder(new ObjectSpecServlet());\n        root.addServlet(objectSpecServletHolder, \"/api/objectspecs/*\");\n\n        // Start jetty\n        try {\n            server.start();\n        } catch (Exception e) {\n            LOG.error(\"jetty error\", e);\n        }\n    }\n\n    public void stop() {\n        try {\n            lwServer.destroy();\n            server.stop();\n        } catch (Exception e) {\n            throw new RuntimeException(e);\n        }\n    }\n\n    public static void main(String[] args) throws NonUniqueSecurityInfoException {\n        new LeshanStandalone().start();\n    }\n}\n</code></pre>\n\n<p>my modified LeshanClientExample.java:</p>\n\n<pre><code>public class LeshanClientExample {\n    private String registrationID;\n\n    public static void main(final String[] args) throws Exception {\n        if (args.length != 4 &amp;&amp; args.length != 2) {\n            System.out\n                    .println(\"Usage:\\njava -jar target/leshan-client-example-*-SNAPSHOT-jar-with-dependencies.jar [ClientIP] [ClientPort] ServerIP ServerPort\");\n        } else {\n            if (args.length == 4)\n                new LeshanClientExample(args[0], Integer.parseInt(args[1]), args[2], Integer.parseInt(args[3]));\n            else\n                new LeshanClientExample(\"0\", 0, args[0], Integer.parseInt(args[1]));\n        }\n    }\n\n    public LeshanClientExample(final String localHostName, final int localPort, final String serverHostName,\n                               final int serverPort) throws Exception {\n\n        // Initialize object list\n        ObjectsInitializer initializer = new ObjectsInitializer();\n        initializer.setClassForObject(3, Device.class);\n        List&lt;ObjectEnabler&gt; enablers = initializer.createMandatory();\n\n        // Create client\n        final InetSocketAddress clientAddress = new InetSocketAddress(localHostName, localPort);\n        final InetSocketAddress serverAddress = new InetSocketAddress(serverHostName, serverPort);\n\n        CoapServer serverLocal = new CoapServer();\n\n        // Get point values\n        byte[] publicX = DatatypeConverter\n                .parseHexBinary(\"fcc28728c123b155be410fc1c0651da374fc6ebe7f96606e90d927d188894a73\");\n        byte[] publicY = DatatypeConverter\n                .parseHexBinary(\"d2ffaa73957d76984633fc1cc54d0b763ca0559a9dff9706e9f4557dacc3f52a\");\n        byte[] privateS = DatatypeConverter\n                .parseHexBinary(\"1dae121ba406802ef07c193c1ee4df91115aabd79c1ed7f4c0ef7ef6a5449400\");\n\n        // Get Elliptic Curve Parameter spec for secp256r1\n        AlgorithmParameters algoParameters = AlgorithmParameters.getInstance(\"EC\");\n        algoParameters.init(new ECGenParameterSpec(\"secp256r1\"));\n        ECParameterSpec parameterSpec = algoParameters.getParameterSpec(ECParameterSpec.class);\n\n        // Create key specs\n        KeySpec publicKeySpec = new ECPublicKeySpec(new ECPoint(new BigInteger(publicX), new BigInteger(publicY)),\n                parameterSpec);\n        KeySpec privateKeySpec = new ECPrivateKeySpec(new BigInteger(privateS), parameterSpec);\n\n\n        // Get keys\n        PublicKey serverPublicKey = KeyFactory.getInstance(\"EC\").generatePublic(publicKeySpec);\n        PrivateKey serverPrivateKey = KeyFactory.getInstance(\"EC\").generatePrivate(privateKeySpec);\n        DTLSConnector dtlsConnector = new DTLSConnector(serverAddress);\n        dtlsConnector.getConfig().setPreferredCipherSuite(CipherSuite.TLS_ECDHE_ECDSA_WITH_AES_128_CCM_8);\n        dtlsConnector.getConfig().setPskStore(new StaticPskStore(\"testclient\", DatatypeConverter.parseHexBinary(\"73656372657450534b\")));\n        dtlsConnector.getConfig().setPrivateKey(serverPrivateKey, serverPublicKey);\n        dtlsConnector.getConfig().setRequireClientAuth(true);\n\n        serverLocal.addEndpoint(new CoAPEndpoint(dtlsConnector, NetworkConfig.getStandard()));\n\n        final LeshanClient client = new LeshanClient(clientAddress, serverAddress, serverLocal, new ArrayList&lt;LwM2mObjectEnabler&gt;(\n                enablers));\n\n\n        // Start the client\n        client.start();\n\n        // Register to the server provided\n\n        RegisterResponse response = client.send(new RegisterRequest(\"lwm2mClient\"));\n\n        // Report registration response.\n        System.out.println(\"Device Registration (Success? \" + response.getCode() + \")\");\n        if (response.getCode() == ResponseCode.CREATED) {\n            System.out.println(\"\\tDevice: Registered Client Location '\" + response.getRegistrationID() + \"'\");\n            registrationID = response.getRegistrationID();\n        } else {\n            // TODO Should we have a error message on response ?\n            // System.err.println(\"\\tDevice Registration Error: \" + response.getErrorMessage());\n            System.err.println(\"\\tDevice Registration Error: \" + response.getCode());\n            System.err\n                    .println(\"If you're having issues connecting to the LWM2M endpoint, try using the DTLS port instead\");\n        }\n\n        // Deregister on shutdown and stop client.\n        Runtime.getRuntime().addShutdownHook(new Thread() {\n            @Override\n            public void run() {\n                if (registrationID != null) {\n                    System.out.println(\"\\tDevice: Deregistering Client '\" + registrationID + \"'\");\n                    client.send(new DeregisterRequest(registrationID));\n                    client.stop();\n                }\n            }\n        });\n    }\n\n    public static class Device extends BaseInstanceEnabler {\n\n        public Device() {\n            // notify new date each 5 second\n            Timer timer = new Timer();\n            timer.schedule(new TimerTask() {\n                @Override\n                public void run() {\n                    fireResourceChange(13);\n                }\n            }, 5000, 5000);\n        }\n\n        @Override\n        public ValueResponse read(int resourceid) {\n            System.out.println(\"Read on resource \" + resourceid);\n            switch (resourceid) {\n                case 0:\n                    return new ValueResponse(ResponseCode.CONTENT, new LwM2mResource(resourceid,\n                            Value.newStringValue(getManufacturer())));\n                case 1:\n                    return new ValueResponse(ResponseCode.CONTENT, new LwM2mResource(resourceid,\n                            Value.newStringValue(getModelNumber())));\n                case 2:\n                    return new ValueResponse(ResponseCode.CONTENT, new LwM2mResource(resourceid,\n                            Value.newStringValue(getSerialNumber())));\n                case 3:\n                    return new ValueResponse(ResponseCode.CONTENT, new LwM2mResource(resourceid,\n                            Value.newStringValue(getFirmwareVersion())));\n                case 9:\n                    return new ValueResponse(ResponseCode.CONTENT, new LwM2mResource(resourceid,\n                            Value.newIntegerValue(getBatteryLevel())));\n                case 10:\n                    return new ValueResponse(ResponseCode.CONTENT, new LwM2mResource(resourceid,\n                            Value.newIntegerValue(getMemoryFree())));\n                case 13:\n                    return new ValueResponse(ResponseCode.CONTENT, new LwM2mResource(resourceid,\n                            Value.newDateValue(getCurrentTime())));\n                case 14:\n                    return new ValueResponse(ResponseCode.CONTENT, new LwM2mResource(resourceid,\n                            Value.newStringValue(getUtcOffset())));\n                case 15:\n                    return new ValueResponse(ResponseCode.CONTENT, new LwM2mResource(resourceid,\n                            Value.newStringValue(getTimezone())));\n                case 16:\n                    return new ValueResponse(ResponseCode.CONTENT, new LwM2mResource(resourceid,\n                            Value.newStringValue(getSupportedBinding())));\n                default:\n                    return super.read(resourceid);\n            }\n        }\n\n        @Override\n        public LwM2mResponse execute(int resourceid, byte[] params) {\n            System.out.println(\"Execute on resource \" + resourceid + \" params \" + params);\n            return new LwM2mResponse(ResponseCode.CHANGED);\n        }\n\n        @Override\n        public LwM2mResponse write(int resourceid, LwM2mResource value) {\n            System.out.println(\"Write on resource \" + resourceid + \" value \" + value);\n            switch (resourceid) {\n                case 13:\n                    return new LwM2mResponse(ResponseCode.NOT_FOUND);\n                case 14:\n                    setUtcOffset((String) value.getValue().value);\n                    fireResourceChange(resourceid);\n                    return new LwM2mResponse(ResponseCode.CHANGED);\n                case 15:\n                    setTimezone((String) value.getValue().value);\n                    fireResourceChange(resourceid);\n                    return new LwM2mResponse(ResponseCode.CHANGED);\n                default:\n                    return super.write(resourceid, value);\n            }\n        }\n\n        private String getManufacturer() {\n            return \"Leshan Example Device\";\n        }\n\n        private String getModelNumber() {\n            return \"Model 500\";\n        }\n\n        private String getSerialNumber() {\n            return \"LT-500-000-0001\";\n        }\n\n        private String getFirmwareVersion() {\n            return \"1.0.0\";\n        }\n\n        private int getBatteryLevel() {\n            final Random rand = new Random();\n            return rand.nextInt(100);\n        }\n\n        private int getMemoryFree() {\n            final Random rand = new Random();\n            return rand.nextInt(50) + 114;\n        }\n\n        private Date getCurrentTime() {\n            return new Date();\n        }\n\n        private String utcOffset = new SimpleDateFormat(\"X\").format(Calendar.getInstance().getTime());\n        ;\n\n        private String getUtcOffset() {\n            return utcOffset;\n        }\n\n        private void setUtcOffset(String t) {\n            utcOffset = t;\n        }\n\n        private String timeZone = TimeZone.getDefault().getID();\n\n        private String getTimezone() {\n            return timeZone;\n        }\n\n        private void setTimezone(String t) {\n            timeZone = t;\n        }\n\n        private String getSupportedBinding() {\n            return \"U\";\n        }\n    }\n}\n</code></pre>\n\n<p>The server starts ok, but the client starts on 5684 with a <code>RequestTimeoutException</code>, and the server prints:</p>\n\n<pre><code>May 19, 2015 2:47:04 PM org.eclipse.californium.scandium.dtls.Record fromByteArray\nWARNING: Received illegal record content type: 68\nMay 19, 2015 2:47:07 PM org.eclipse.californium.scandium.dtls.Record fromByteArray\nWARNING: Received illegal record content type: 68\n</code></pre>\n\n<p>What have i done wrong or missing?</p>\n"
    }, {
        "tags": [
            "eclipse",
            "mqtt",
            "iot"
        ],
        "is_answered": true,
        "view_count": 961,
        "favorite_count": 0,
        "score": 2,
        "last_activity_date": 1442504359,
        "creation_date": 1438336191,
        "last_edit_date": 1442504359,
        "question_id": 31743221,
        "link": "https://stackoverflow.com/questions/31743221/kura-how-to-change-the-mqtt-messages-format",
        "title": "KURA: how to change the MQTT messages format",
        "body": "<p>The KURA MQTT cloud client publishes messages respecting the following formula (<a href=\"http://eclipse.github.io/kura/ref/mqtt-namespace.html\" rel=\"nofollow\">more details</a>):</p>\n\n<pre><code>#account-name/#client-id/#API-ID/topic\n</code></pre>\n\n<p>I want to send MQTT messages with my own format, I dont want to send the account name and the client id in the MQTT message.</p>\n\n<p>How can I do that? \nI already tried to change the configuration in the KURA web interface -> MQTTData transport and I have deleted the content of \"lwt.topic\" but without success.</p>\n"
    }, {
        "tags": [
            "xampp",
            "server",
            "mqtt",
            "iot"
        ],
        "is_answered": true,
        "view_count": 592,
        "favorite_count": 1,
        "score": 0,
        "last_activity_date": 1440494462,
        "creation_date": 1436788239,
        "last_edit_date": 1436882769,
        "question_id": 31382612,
        "link": "https://stackoverflow.com/questions/31382612/sending-value-from-cc3200-to-my-server-using-mqtt",
        "title": "sending value from cc3200 to my server using mqtt",
        "body": "<p>How can I make my server to accept the data sent by cc3200 through mqtt protocol ?Made cc3200 to publish the values successfully to my server IP address but I don't know what should I do to make my server dump those incoming values into its database.Actually I use XAMPP for server functionalities.\nany suggestion guys ?\nAm using hivemq broker</p>\n"
    }, {
        "tags": [
            "javascript",
            "mqtt",
            "iot"
        ],
        "is_answered": true,
        "view_count": 6143,
        "favorite_count": 0,
        "score": 3,
        "last_activity_date": 1439676070,
        "creation_date": 1430758407,
        "last_edit_date": 1430849063,
        "question_id": 30035552,
        "link": "https://stackoverflow.com/questions/30035552/how-to-send-message-from-a-mosca-broker-to-a-mqtt-js-client",
        "title": "How to send message from a mosca broker to a mqtt.js client",
        "body": "<p>we setup a MQTT client powered by <a href=\"https://github.com/mqttjs/MQTT.js\" rel=\"nofollow\">MQTT.js</a> (either on a desktop PC or on the actual board, is the same) and a MQTT broker powered by <a href=\"https://github.com/mcollina/mosca\" rel=\"nofollow\">mosca</a>, this one running on the desktop PC.</p>\n\n<p>We are able to successfully send a message with a specific topic <em>from client to broker</em>, but now we're stuck on the opposite: send a message <strong>from broker to client</strong>.</p>\n\n<p>We're following the code samples provided on both project docs, but with no luck. Client is able to correctly register to topic, but does not react in any way when message is sent. Broker is able to correctly send the message and also to listen to its own message, as it's listening for all messages anyway.</p>\n\n<p>Excerpt from MQTT broker:</p>\n\n\n\n<pre><code>broker.on('published', function(packet, client) {\n  console.log('MQTT broker received message');  // it passes by here\n  console.log(' - packet:', packet);\n  console.log(' - packet payload:', packet.payload.toString());\n});\n\n// ...\n\nvar packet = {\n  topic: 'our_custom_topic',\n  payload: ourCustomPayload,\n  qos: 1,\n  retain: false,  \n};\n\nconsole.log('MQTT broker sending message to client ...');\n\nbroker.publish(packet, function() {\n  console.log('Message sent');  // it passes by here\n});\n</code></pre>\n\n<p>Excerpt from MQTT client:</p>\n\n\n\n<pre><code>client.on('connect', function () {\n  console.log('MQTT client connected');\n\n  client.subscribe('our_custom_topic', { qos: 1 }, function onSubscribe(err, granted) {\n    if (err) {\n      console.log('subscribe errors:', err);  // no error shown\n    }\n\n    if (granted) {\n      console.log('subscribe granted:', granted);  // it passes by here\n    }\n  });\n});\n\n// ...\n\nclient.on('message', function (topic, message, packet) {\n  console.log('MQTT client received message');  // it DOESN'T pass by here\n  console.log(' - topic', topic);\n  console.log(' - message', JSON.stringify(message));\n  console.log(' - packet', JSON.stringify(packet));\n});\n</code></pre>\n\n<h3>Update</h3>\n\n<p>The problem seems to show up when persistence is based on mongoDb. Instead messages are correctly sent to subscribers when persistence is memory-based. Here are our pub-sub settings when relying persistence on mongoDb. Actually, it's a development instance running on mongolab.com:</p>\n\n\n\n<pre><code>var mongoDbSettings = {\n  // remote MongoLab mongodb instance\n  url: 'mongodb://mqtt-db-user:&lt;OUR-USER-CODE&gt;@&lt;THEIR-INSTANCE-SUBDOMAIN&gt;.mongolab.com:39291/sample-mqtt-datastore',\n  pubsubCollection: 'myCollections',\n};\n\nvar mongoDbBrokerSettings = {\n  port: 1883,  // mosca (mqtt) port\n\n  // using ascoltatore over MongoDB\n  backend: {\n    type: 'mongo',\n    url: mongoDbSettings.url,\n    pubsubCollection: mongoDbSettings.pubsubCollection,\n    mongo: {},\n  },\n  persistence: {\n    factory: mosca.persistence.Mongo,\n    url: mongoDbSettings.url,\n  }\n};\n\nvar broker = new mosca.Server(mongoDbBrokerSettings, function onCreated(err, broker) {\n  // assume no errors\n\n  console.log('MQTT broker is up and running');\n});\n</code></pre>\n\n<p>does anyone spot anything wrong with that?</p>\n"
    }, {
        "tags": [
            "mqtt",
            "ibm-cloud",
            "iot"
        ],
        "is_answered": true,
        "view_count": 102,
        "favorite_count": 0,
        "score": 0,
        "last_activity_date": 1438181990,
        "creation_date": 1437849779,
        "question_id": 31629912,
        "link": "https://stackoverflow.com/questions/31629912/bluemix-iot-foundation-read-only-access",
        "title": "Bluemix IoT Foundation - read-only access?",
        "body": "<p>With and API Key/Token combination we can connect from an application and subscribe/publish to any topic.</p>\n\n<p>Is there a way to prevent an application from publishing to a topic (eg. read-only access) ?</p>\n\n<p>Is it possible to limit the topics an application can connect to ?</p>\n"
    }, {
        "tags": [
            "mqtt",
            "iot",
            "broker",
            "mosquitto"
        ],
        "is_answered": true,
        "view_count": 10212,
        "favorite_count": 6,
        "score": 12,
        "last_activity_date": 1436398573,
        "creation_date": 1435916369,
        "question_id": 31203520,
        "link": "https://stackoverflow.com/questions/31203520/horizontally-scaling-mosquitto-broker",
        "title": "Horizontally scaling mosquitto broker",
        "body": "<p>I am considering <strong>mosquitto</strong> for a MQTT broker. From what I've read, I realized  that Mosquitto doesn't support Horizontal Scaling.</p>\n\n<p>So far all other criteria of my requirements can be met with Mosquitto. </p>\n\n<p>I'm not sure if the question is too generic or broad but what I want to know is, if there's any way to achieve Scaling capabilities, Load Balancing etc. for Mosquitto. </p>\n"
    }, {
        "tags": [
            "fiware",
            "iot"
        ],
        "is_answered": true,
        "view_count": 150,
        "favorite_count": 0,
        "score": 1,
        "last_activity_date": 1434552554,
        "creation_date": 1434524362,
        "question_id": 30884390,
        "link": "https://stackoverflow.com/questions/30884390/using-iotagent-node-lib",
        "title": "Using iotagent-node-lib",
        "body": "<p>I have receiving data from our sensors using GET. The request format is: <a href=\"http://IP:PORT/PATH?Operation=InsertObservation&amp;value=0.0012&amp;unit_id=123456&amp;sensor_id=75648\">http://IP:PORT/PATH?Operation=InsertObservation&amp;value=0.0012&amp;unit_id=123456&amp;sensor_id=75648</a>. How I can, using iotagent-node-lib, write them to Orion Context Broker?</p>\n"
    }, {
        "tags": [
            "messaging",
            "publish-subscribe",
            "mqtt",
            "iot"
        ],
        "is_answered": true,
        "view_count": 297,
        "favorite_count": 0,
        "score": 1,
        "last_activity_date": 1430389101,
        "creation_date": 1430323101,
        "last_edit_date": 1430389101,
        "question_id": 29948882,
        "link": "https://stackoverflow.com/questions/29948882/publish-subscribe-pattern-with-subscriber-response",
        "title": "Publish/Subscribe pattern with subscriber response",
        "body": "<p>Is this possible in a publish/subscribe pattern?</p>\n\n<ol>\n<li>A publisher publishes a message to a topic; </li>\n<li>Subscriber(s) receive(s) the message; </li>\n<li>The subscribers reply to publisher with a custom message.</li>\n</ol>\n\n<p>Is step 3 possible? I'm designing a system that will use <strong>MQTT</strong> protocol (communication between smartphones and microcontrollers). However, the subscriber needs to send an answer to the publisher other than the Acknowledged message.</p>\n"
    }, {
        "tags": [
            "arduino",
            "wso2",
            "amqp",
            "mqtt",
            "iot"
        ],
        "is_answered": true,
        "view_count": 253,
        "favorite_count": 0,
        "score": 1,
        "last_activity_date": 1430011593,
        "creation_date": 1429778543,
        "last_edit_date": 1430011200,
        "question_id": 29818106,
        "link": "https://stackoverflow.com/questions/29818106/is-there-any-way-to-connect-arduino-to-the-wso2-platform",
        "title": "Is there any way to connect Arduino to the WSO2 platform?",
        "body": "<p>I tried installing the WSO2 message broker, but from what I understand it only receive messages via AMQP protocol (not MQTT) and Arduino doesn't have a AMQP library.</p>\n\n<p>How can I make Arduino send and receive messages from WSO2 Message Broker? Is there any way to receive MQTT messages with the message broker? Should I use another broker? Is there any AMQP library for Arduino?</p>\n"
    }, {
        "tags": [
            "amazon-web-services",
            "arduino",
            "client-server",
            "mqtt",
            "iot"
        ],
        "is_answered": false,
        "view_count": 366,
        "favorite_count": 0,
        "score": -1,
        "last_activity_date": 1428348916,
        "creation_date": 1427776869,
        "question_id": 29360736,
        "link": "https://stackoverflow.com/questions/29360736/can-connect-through-ethernet-shield-but-not-when-using-mqtt-on-my-arduino",
        "title": "Can connect through ethernet shield but not when using MQTT on my arduino",
        "body": "<p>I have been trying to send messages via MQTT from my Arduino to my amazon web server.  The following code connects the ethernet client but not the MQTT client.  Why would my MQTT client not be connecting?</p>\n\n<pre><code>#include &lt;SPI.h&gt;\n#include &lt;Ethernet.h&gt;\n#include &lt;PubSubClient.h&gt;\n\nbyte mac[]    = { 0x12, 0x42, 0x98, 0x85, 0x49, 0x3A }; //MAC address of server\nchar server[] = \"http://52.1.29.117/\"; //web address of server\nIPAddress ip(172, 31, 51, 13); //IP address of server\n\nvoid callback(char* topic, byte* payload, unsigned int length) {\n  // handle message arrived\n}\n\nEthernetClient ethClient;\nPubSubClient client(server, 80, callback, ethClient);\n\nvoid setup()\n{\n    Serial.begin(9600);\n    while (!Serial) {\n        ; // wait for serial port to connect. Needed for Leonardo only\n    }\n\n    // start the Ethernet connection:\n    if (Ethernet.begin(mac) == 0) {\n        Serial.println(\"Failed to configure Ethernet using DHCP\");\n        Ethernet.begin(mac, ip);\n    }\n    delay(1000);\n    Serial.println(\"connecting...\");\n\n    if (ethClient.connect(server, 80)) {\n        Serial.println(\"connected\");\n        // Make a HTTP request:\n        ethClient.println(\"GET /search?q=arduino HTTP/1.1\");\n        ethClient.println(\"Host: www.google.com\");\n        ethClient.println(\"Connection: close\");\n        ethClient.println();\n    }\n    else {\n        Serial.println(\"connection failed\");\n    }\n\n    //  if (client.connect(server)) {\n    if (client.connect(server, \"ubuntu\", \"\")) {\n        Serial.print(\"Data sent/n\");\n        client.publish(\"hello/world\",\"hello world\");\n        client.subscribe(\"hiWorld\");\n    }\n    else {\n        Serial.print(\"nope\");\n    }\n}\n\nvoid loop()\n{\n  client.loop();\n}\n</code></pre>\n"
    }]
}